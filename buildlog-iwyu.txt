: "  SYNC    include/config/auto.conf.cmd"
make -f ./Makefile syncconfig
make -f ./scripts/Makefile.build obj=scripts/basic
make -f ./scripts/Makefile.build obj=scripts/kconfig syncconfig
scripts/kconfig/conf  --syncconfig Kconfig
make -f ./scripts/Makefile.build obj=arch/x86/entry/syscalls all
  sh ./scripts/syscallhdr.sh --abis i386 --emit-nr   arch/x86/entry/syscalls/syscall_32.tbl arch/x86/include/generated/uapi/asm/unistd_32.h
  sh ./scripts/syscallhdr.sh --abis common,64 --emit-nr   arch/x86/entry/syscalls/syscall_64.tbl arch/x86/include/generated/uapi/asm/unistd_64.h
  sh ./scripts/syscallhdr.sh --abis common,x32 --emit-nr --offset __X32_SYSCALL_BIT  arch/x86/entry/syscalls/syscall_64.tbl arch/x86/include/generated/uapi/asm/unistd_x32.h
  sh ./scripts/syscalltbl.sh --abis i386 arch/x86/entry/syscalls/syscall_32.tbl arch/x86/include/generated/asm/syscalls_32.h
make -f ./scripts/Makefile.build obj=scripts/basic
make -f ./scripts/Makefile.build obj=arch/x86/tools relocs
  clang -Wp,-MMD,arch/x86/tools/.relocs_32.o.d -Wall -Wmissing-prototypes -Wstrict-prototypes -O2 -fomit-frame-pointer -std=gnu11 -Wdeclaration-after-statement     -I./tools/include  -c -o arch/x86/tools/relocs_32.o arch/x86/tools/relocs_32.c
  clang -Wp,-MMD,arch/x86/tools/.relocs_64.o.d -Wall -Wmissing-prototypes -Wstrict-prototypes -O2 -fomit-frame-pointer -std=gnu11 -Wdeclaration-after-statement     -I./tools/include  -c -o arch/x86/tools/relocs_64.o arch/x86/tools/relocs_64.c
  clang -Wp,-MMD,arch/x86/tools/.relocs_common.o.d -Wall -Wmissing-prototypes -Wstrict-prototypes -O2 -fomit-frame-pointer -std=gnu11 -Wdeclaration-after-statement     -I./tools/include  -c -o arch/x86/tools/relocs_common.o arch/x86/tools/relocs_common.c
  clang   -o arch/x86/tools/relocs arch/x86/tools/relocs_32.o arch/x86/tools/relocs_64.o arch/x86/tools/relocs_common.o   
make -f ./scripts/Makefile.build obj=scripts/dtc
make -f ./scripts/Makefile.build obj=scripts
  clang -Wp,-MMD,scripts/.sorttable.d -Wall -Wmissing-prototypes -Wstrict-prototypes -O2 -fomit-frame-pointer -std=gnu11 -Wdeclaration-after-statement      -I./tools/include   -o scripts/sorttable scripts/sorttable.c   -lpthread
make -f ./scripts/Makefile.asm-generic obj=arch/x86/include/generated/uapi/asm \
generic=include/uapi/asm-generic
  echo "#include <asm-generic/bpf_perf_event.h>" > arch/x86/include/generated/uapi/asm/bpf_perf_event.h
  echo "#include <asm-generic/errno.h>" > arch/x86/include/generated/uapi/asm/errno.h
  echo "#include <asm-generic/fcntl.h>" > arch/x86/include/generated/uapi/asm/fcntl.h
  echo "#include <asm-generic/ioctl.h>" > arch/x86/include/generated/uapi/asm/ioctl.h
  echo "#include <asm-generic/ioctls.h>" > arch/x86/include/generated/uapi/asm/ioctls.h
  echo "#include <asm-generic/ipcbuf.h>" > arch/x86/include/generated/uapi/asm/ipcbuf.h
  echo "#include <asm-generic/param.h>" > arch/x86/include/generated/uapi/asm/param.h
  echo "#include <asm-generic/poll.h>" > arch/x86/include/generated/uapi/asm/poll.h
  echo "#include <asm-generic/resource.h>" > arch/x86/include/generated/uapi/asm/resource.h
  echo "#include <asm-generic/socket.h>" > arch/x86/include/generated/uapi/asm/socket.h
  echo "#include <asm-generic/sockios.h>" > arch/x86/include/generated/uapi/asm/sockios.h
  echo "#include <asm-generic/termbits.h>" > arch/x86/include/generated/uapi/asm/termbits.h
  echo "#include <asm-generic/termios.h>" > arch/x86/include/generated/uapi/asm/termios.h
  echo "#include <asm-generic/types.h>" > arch/x86/include/generated/uapi/asm/types.h
make -f ./scripts/Makefile.asm-generic obj=arch/x86/include/generated/asm \
generic=include/asm-generic
  echo "#include <asm-generic/early_ioremap.h>" > arch/x86/include/generated/asm/early_ioremap.h
  echo "#include <asm-generic/export.h>" > arch/x86/include/generated/asm/export.h
  echo "#include <asm-generic/mcs_spinlock.h>" > arch/x86/include/generated/asm/mcs_spinlock.h
  echo "#include <asm-generic/irq_regs.h>" > arch/x86/include/generated/asm/irq_regs.h
  echo "#include <asm-generic/kmap_size.h>" > arch/x86/include/generated/asm/kmap_size.h
  echo "#include <asm-generic/local64.h>" > arch/x86/include/generated/asm/local64.h
  echo "#include <asm-generic/mmiowb.h>" > arch/x86/include/generated/asm/mmiowb.h
  echo "#include <asm-generic/module.lds.h>" > arch/x86/include/generated/asm/module.lds.h
  echo "#include <asm-generic/platform-feature.h>" > arch/x86/include/generated/asm/platform-feature.h
  echo "#include <asm-generic/rwonce.h>" > arch/x86/include/generated/asm/rwonce.h
  echo "#include <asm-generic/unaligned.h>" > arch/x86/include/generated/asm/unaligned.h
./scripts/remove-stale-files
set -e; mkdir -p include/config/; trap "rm -f include/config/.kernel.release.tmp" EXIT; { echo "5.19.0-rc8$(sh ./scripts/setlocalversion .)"; } > include/config/.kernel.release.tmp; if [ ! -r include/config/kernel.release ] || ! cmp -s include/config/kernel.release include/config/.kernel.release.tmp; then : '  UPD     include/config/kernel.release'; mv -f include/config/.kernel.release.tmp include/config/kernel.release; fi
set -e; mkdir -p include/generated/uapi/linux/; trap "rm -f include/generated/uapi/linux/.version.h.tmp" EXIT; { 	if [ 0 -gt 255 ]; then echo \#define LINUX_VERSION_CODE 332799; else echo \#define LINUX_VERSION_CODE 332544; fi; echo '#define KERNEL_VERSION(a,b,c) (((a) << 16) + ((b) << 8) + ((c) > 255 ? 255 : (c)))'; echo \#define LINUX_VERSION_MAJOR 5; echo \#define LINUX_VERSION_PATCHLEVEL 19; echo \#define LINUX_VERSION_SUBLEVEL 0; } > include/generated/uapi/linux/.version.h.tmp; if [ ! -r include/generated/uapi/linux/version.h ] || ! cmp -s include/generated/uapi/linux/version.h include/generated/uapi/linux/.version.h.tmp; then : '  UPD     include/generated/uapi/linux/version.h'; mv -f include/generated/uapi/linux/.version.h.tmp include/generated/uapi/linux/version.h; fi
set -e; mkdir -p include/generated/; trap "rm -f include/generated/.utsrelease.h.tmp" EXIT; { 	if [ `echo -n "5.19.0-rc8" | wc -c ` -gt 64 ]; then echo '"5.19.0-rc8" exceeds 64 characters' >&2; exit 1; fi; echo \#define UTS_RELEASE \"5.19.0-rc8\"; } > include/generated/.utsrelease.h.tmp; if [ ! -r include/generated/utsrelease.h ] || ! cmp -s include/generated/utsrelease.h include/generated/.utsrelease.h.tmp; then : '  UPD     include/generated/utsrelease.h'; mv -f include/generated/.utsrelease.h.tmp include/generated/utsrelease.h; fi
make -f ./scripts/Makefile.build obj=scripts/mod
  iwyu2 -Wp,-MMD,scripts/mod/.empty.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"scripts/mod/empty"' -DKBUILD_BASENAME='"empty"' -DKBUILD_MODNAME='"empty"' -D__KBUILD_MODNAME=kmod_empty -c -o scripts/mod/empty.o scripts/mod/empty.c  

(scripts/mod/empty.c has correct #includes/fwd-decls)
  ./scripts/check-local-export scripts/mod/empty.o
  clang -Wp,-MMD,scripts/mod/.mk_elfconfig.d -Wall -Wmissing-prototypes -Wstrict-prototypes -O2 -fomit-frame-pointer -std=gnu11 -Wdeclaration-after-statement         -o scripts/mod/mk_elfconfig scripts/mod/mk_elfconfig.c   
  scripts/mod/mk_elfconfig < scripts/mod/empty.o > scripts/mod/elfconfig.h
  clang -Wp,-MMD,scripts/mod/.modpost.o.d -Wall -Wmissing-prototypes -Wstrict-prototypes -O2 -fomit-frame-pointer -std=gnu11 -Wdeclaration-after-statement       -c -o scripts/mod/modpost.o scripts/mod/modpost.c
  iwyu2 -Wp,-MMD,scripts/mod/.devicetable-offsets.s.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -DKBUILD_MODFILE='"scripts/mod/devicetable-offsets"' -DKBUILD_BASENAME='"devicetable_offsets"' -DKBUILD_MODNAME='"devicetable_offsets"' -D__KBUILD_MODNAME=kmod_devicetable_offsets -fverbose-asm -S -o scripts/mod/devicetable-offsets.s scripts/mod/devicetable-offsets.c

scripts/mod/devicetable-offsets.c should add these lines:
#include "linux/stddef.h"           // for offsetof

scripts/mod/devicetable-offsets.c should remove these lines:

The full include-list for scripts/mod/devicetable-offsets.c:
#include <linux/kbuild.h>           // for DEFINE
#include <linux/mod_devicetable.h>  // for input_device_id, usb_device_id
#include "linux/stddef.h"           // for offsetof
---
set -e; mkdir -p scripts/mod/; trap "rm -f scripts/mod/.devicetable-offsets.h.tmp" EXIT; { 	 echo "#ifndef __DEVICETABLE_OFFSETS_H__"; echo "#define __DEVICETABLE_OFFSETS_H__"; echo "/*"; echo " * DO NOT MODIFY."; echo " *"; echo " * This file was generated by Kbuild"; echo " */"; echo ""; sed -ne 	's:^[[:space:]]*\.ascii[[:space:]]*"\(.*\)".*:\1:; /^->/{s:->#\(.*\):/* \1 */:; s:^->\([^ ]*\) [\$#]*\([^ ]*\) \(.*\):#define \1 \2 /* \3 */:; s:->::; p;}' < scripts/mod/devicetable-offsets.s; echo ""; echo "#endif"; } > scripts/mod/.devicetable-offsets.h.tmp; if [ ! -r scripts/mod/devicetable-offsets.h ] || ! cmp -s scripts/mod/devicetable-offsets.h scripts/mod/.devicetable-offsets.h.tmp; then : '  UPD     scripts/mod/devicetable-offsets.h'; mv -f scripts/mod/.devicetable-offsets.h.tmp scripts/mod/devicetable-offsets.h; fi
  clang -Wp,-MMD,scripts/mod/.file2alias.o.d -Wall -Wmissing-prototypes -Wstrict-prototypes -O2 -fomit-frame-pointer -std=gnu11 -Wdeclaration-after-statement       -c -o scripts/mod/file2alias.o scripts/mod/file2alias.c
  clang -Wp,-MMD,scripts/mod/.sumversion.o.d -Wall -Wmissing-prototypes -Wstrict-prototypes -O2 -fomit-frame-pointer -std=gnu11 -Wdeclaration-after-statement       -c -o scripts/mod/sumversion.o scripts/mod/sumversion.c
  clang   -o scripts/mod/modpost scripts/mod/modpost.o scripts/mod/file2alias.o scripts/mod/sumversion.o   
make -f ./scripts/Makefile.build obj=.
  iwyu2 -Wp,-MMD,kernel/.bounds.s.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -DKBUILD_MODFILE='"./bounds"' -DKBUILD_BASENAME='"bounds"' -DKBUILD_MODNAME='"bounds"' -D__KBUILD_MODNAME=kmod_bounds -fverbose-asm -S -o kernel/bounds.s kernel/bounds.c

kernel/bounds.c should add these lines:

kernel/bounds.c should remove these lines:
- #include <linux/log2.h>  // lines 13-13

The full include-list for kernel/bounds.c:
#include <linux/kbuild.h>          // for DEFINE
#include <linux/mmzone.h>          // for __MAX_NR_ZONES
#include <linux/page-flags.h>      // for __NR_PAGEFLAGS
#include <linux/spinlock_types.h>  // for spinlock_t
---
set -e; mkdir -p include/generated/; trap "rm -f include/generated/.bounds.h.tmp" EXIT; { 	 echo "#ifndef __LINUX_BOUNDS_H__"; echo "#define __LINUX_BOUNDS_H__"; echo "/*"; echo " * DO NOT MODIFY."; echo " *"; echo " * This file was generated by Kbuild"; echo " */"; echo ""; sed -ne 	's:^[[:space:]]*\.ascii[[:space:]]*"\(.*\)".*:\1:; /^->/{s:->#\(.*\):/* \1 */:; s:^->\([^ ]*\) [\$#]*\([^ ]*\) \(.*\):#define \1 \2 /* \3 */:; s:->::; p;}' < kernel/bounds.s; echo ""; echo "#endif"; } > include/generated/.bounds.h.tmp; if [ ! -r include/generated/bounds.h ] || ! cmp -s include/generated/bounds.h include/generated/.bounds.h.tmp; then : '  UPD     include/generated/bounds.h'; mv -f include/generated/.bounds.h.tmp include/generated/bounds.h; fi
set -e; mkdir -p include/generated/; trap "rm -f include/generated/.timeconst.h.tmp" EXIT; { echo 250 | bc -q kernel/time/timeconst.bc; } > include/generated/.timeconst.h.tmp; if [ ! -r include/generated/timeconst.h ] || ! cmp -s include/generated/timeconst.h include/generated/.timeconst.h.tmp; then : '  UPD     include/generated/timeconst.h'; mv -f include/generated/.timeconst.h.tmp include/generated/timeconst.h; fi
  iwyu2 -Wp,-MMD,arch/x86/kernel/.asm-offsets.s.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -DKBUILD_MODFILE='"./asm-offsets"' -DKBUILD_BASENAME='"asm_offsets"' -DKBUILD_MODNAME='"asm_offsets"' -D__KBUILD_MODNAME=kmod_asm_offsets -fverbose-asm -S -o arch/x86/kernel/asm-offsets.s arch/x86/kernel/asm-offsets.c
In file included from arch/x86/kernel/asm-offsets.c:13:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from arch/x86/kernel/asm-offsets.c:13:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/asm-offsets.c:13:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/asm-offsets.c:13:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/asm-offsets.c:25:
In file included from arch/x86/kernel/asm-offsets_32.c:6:
In file included from ./include/linux/efi.h:20:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
5 warnings generated.
In file included from arch/x86/kernel/asm-offsets.c:13:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from arch/x86/kernel/asm-offsets.c:13:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/asm-offsets.c:13:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/asm-offsets.c:13:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/asm-offsets.c:25:
In file included from arch/x86/kernel/asm-offsets_32.c:6:
In file included from ./include/linux/efi.h:20:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^

arch/x86/kernel/asm-offsets.c should add these lines:
#include "asm/cpu_entry_area.h"         // for cpu_entry_area
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/shared/tdx.h"             // for tdx_hypercall_args
#include "asm/sigcontext.h"             // for sigcontext_32
#include "linux/compiler_attributes.h"  // for __used
#include "linux/kconfig.h"              // for IS_ENABLED

arch/x86/kernel/asm-offsets.c should remove these lines:
- #include <asm/suspend.h>  // lines 19-19
- #include <asm/thread_info.h>  // lines 16-16
- #include <linux/crypto.h>  // lines 9-9
- #include <linux/hardirq.h>  // lines 12-12
- #include <linux/stddef.h>  // lines 11-11

The full include-list for arch/x86/kernel/asm-offsets.c:
#include <asm/bootparam.h>              // for boot_params
#include <asm/processor.h>              // for tss_struct, entry_stack
#include <asm/sigframe.h>               // for rt_sigframe_ia32
#include <asm/tdx.h>                    // for tdx_module_output
#include <asm/tlbflush.h>               // for tlb_state
#include <linux/kbuild.h>               // for OFFSET, BLANK, DEFINE
#include <linux/sched.h>                // for task_struct
#include <linux/suspend.h>              // for pbe
#include "../kvm/vmx/vmx.h"             // for vcpu_vmx
#include "asm-offsets_32.c"
#include "asm/cpu_entry_area.h"         // for cpu_entry_area
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/shared/tdx.h"             // for tdx_hypercall_args
#include "asm/sigcontext.h"             // for sigcontext_32
#include "linux/compiler_attributes.h"  // for __used
#include "linux/kconfig.h"              // for IS_ENABLED
---
set -e; mkdir -p include/generated/; trap "rm -f include/generated/.asm-offsets.h.tmp" EXIT; { 	 echo "#ifndef __ASM_OFFSETS_H__"; echo "#define __ASM_OFFSETS_H__"; echo "/*"; echo " * DO NOT MODIFY."; echo " *"; echo " * This file was generated by Kbuild"; echo " */"; echo ""; sed -ne 	's:^[[:space:]]*\.ascii[[:space:]]*"\(.*\)".*:\1:; /^->/{s:->#\(.*\):/* \1 */:; s:^->\([^ ]*\) [\$#]*\([^ ]*\) \(.*\):#define \1 \2 /* \3 */:; s:->::; p;}' < arch/x86/kernel/asm-offsets.s; echo ""; echo "#endif"; } > include/generated/.asm-offsets.h.tmp; if [ ! -r include/generated/asm-offsets.h ] || ! cmp -s include/generated/asm-offsets.h include/generated/.asm-offsets.h.tmp; then : '  UPD     include/generated/asm-offsets.h'; mv -f include/generated/.asm-offsets.h.tmp include/generated/asm-offsets.h; fi
  sh scripts/checksyscalls.sh iwyu2 -Wp,-MMD,./.missing-syscalls.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"./missing-syscalls"' -DKBUILD_BASENAME='"missing_syscalls"' -DKBUILD_MODNAME='"missing_syscalls"' -D__KBUILD_MODNAME=kmod_missing_syscalls 

/tmp/checksyscalls.VWT42A should add these lines:
#include "asm-generic/bitsperlong.h"  // for BITS_PER_LONG
#include "asm/unistd_32.h"            // for __NR__llseek, __NR__newselect
#include "generated/autoconf.h"       // for CONFIG_MMU

/tmp/checksyscalls.VWT42A should remove these lines:
- #include <asm/types.h>  // lines 1-1
- #include <asm/unistd.h>  // lines 2-2

The full include-list for /tmp/checksyscalls.VWT42A:
#include "asm-generic/bitsperlong.h"  // for BITS_PER_LONG
#include "asm/unistd_32.h"            // for __NR__llseek, __NR__newselect
#include "generated/autoconf.h"       // for CONFIG_MMU
---
  sh scripts/atomic/check-atomics.sh
warning: generated include/linux/atomic/atomic-long.h has been modified.
warning: generated include/linux/atomic/atomic-arch-fallback.h has been modified.
make -f ./scripts/Makefile.build obj=init \
single-build= \
need-builtin=1 need-modorder=1
  iwyu2 -Wp,-MMD,init/.main.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -fno-function-sections -fno-data-sections    -DKBUILD_MODFILE='"init/main"' -DKBUILD_BASENAME='"main"' -DKBUILD_MODNAME='"main"' -D__KBUILD_MODNAME=kmod_main -c -o init/main.o init/main.c  
In file included from init/main.c:21:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from init/main.c:21:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from init/main.c:21:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from init/main.c:21:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from init/main.c:30:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
In file included from init/main.c:53:
In file included from ./include/linux/efi.h:20:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
In file included from init/main.c:58:
./include/linux/delayacct.h:27:44: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline int delayacct_add_tsk(struct taskstats *d,
                                           ^
In file included from init/main.c:85:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from init/main.c:102:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from init/main.c:113:
./include/kunit/test.h:509:24: warning: declaration of 'struct kunit_loc' will not be visible outside of this function [-Wvisibility]
                               const struct kunit_loc *loc,
                                            ^
./include/kunit/test.h:510:16: warning: declaration of 'enum kunit_assert_type' will not be visible outside of this function [-Wvisibility]
                               enum kunit_assert_type type,
                                    ^
./include/kunit/test.h:511:24: warning: declaration of 'struct kunit_assert' will not be visible outside of this function [-Wvisibility]
                               const struct kunit_assert *assert,
                                            ^
15 warnings generated.
In file included from init/main.c:21:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from init/main.c:21:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from init/main.c:21:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from init/main.c:21:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from init/main.c:30:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
In file included from init/main.c:53:
In file included from ./include/linux/efi.h:20:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
In file included from init/main.c:58:
./include/linux/delayacct.h:27:44: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline int delayacct_add_tsk(struct taskstats *d,
                                           ^
In file included from init/main.c:85:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from init/main.c:102:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from init/main.c:113:
./include/kunit/test.h:509:24: warning: declaration of 'struct kunit_loc' will not be visible outside of this function [-Wvisibility]
                               const struct kunit_loc *loc,
                                            ^
./include/kunit/test.h:510:16: warning: declaration of 'enum kunit_assert_type' will not be visible outside of this function [-Wvisibility]
                               enum kunit_assert_type type,
                                    ^
./include/kunit/test.h:511:24: warning: declaration of 'struct kunit_assert' will not be visible outside of this function [-Wvisibility]
                               const struct kunit_assert *assert,
                                            ^

init/main.c should add these lines:
#include <asm/bug.h>                    // for WARN
#include <asm/page_types.h>             // for THREAD_SIZE
#include <linux/build_bug.h>            // for prevent_tail_call_optimization
#include <linux/ktime.h>                // for ktime_get, timekeeping_init
#include <linux/linkage.h>              // for asmlinkage
#include <linux/preempt.h>              // for preempt_count, preempt_count_set
#include <stddef.h>                     // for NULL, size_t
#include "asm-generic/errno-base.h"     // for EINVAL, ENOENT, EPERM
#include "asm-generic/fcntl.h"          // for O_RDWR
#include "asm-generic/int-ll64.h"       // for u32
#include "asm-generic/memory_model.h"   // for page_to_pfn
#include "asm/bug.h"                    // for BUG
#include "asm/cache.h"                  // for __read_mostly
#include "asm/current.h"                // for current
#include "asm/mem_encrypt.h"            // for mem_encrypt_init
#include "asm/page.h"                   // for virt_to_page
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/pgtable.h"                // for poking_init
#include "asm/string_32.h"              // for strlen, strcpy, strcmp, memmove
#include "generated/autoconf.h"         // for CONFIG_INIT_ENV_ARG_LIMIT
#include "linux/byteorder/generic.h"    // for le32_to_cpu
#include "linux/compiler-clang.h"       // for __no_sanitize_address
#include "linux/compiler_attributes.h"  // for __weak, noinline, __visible
#include "linux/compiler_types.h"       // for inline
#include "linux/completion.h"           // for complete, wait_for_completion
#include "linux/cpuhotplug.h"           // for CPUHP_ONLINE
#include "linux/cpumask.h"              // for cpumask_of
#include "linux/cred.h"                 // for cred_init
#include "linux/err.h"                  // for IS_ERR, IS_ERR_OR_NULL
#include "linux/export.h"               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/file.h"                 // for fput
#include "linux/fs.h"                   // for filp_open, vfs_caches_init
#include "linux/gfp.h"                  // for page_alloc_init, page_alloc_i...
#include "linux/hrtimer.h"              // for hrtimers_init
#include "linux/irqflags.h"             // for irqs_disabled, local_irq_disable
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_DEBUG
#include "linux/kstrtox.h"              // for strtobool
#include "linux/ktime.h"                // for ktime_t, ktime_us_delta
#include "linux/mm.h"                   // for want_init_on_free, free_initm...
#include "linux/mmzone.h"               // for build_all_zonelists
#include "linux/nodemask.h"             // for N_MEMORY, node_states, nodema...
#include "linux/panic.h"                // for panic
#include "linux/pgtable.h"              // for init_espfix_bsp, pgtable_cach...
#include "linux/pid.h"                  // for get_pid
#include "linux/poison.h"               // for POISON_FREE_INITMEM
#include "linux/printk.h"               // for pr_err, pr_warn, pr_debug
#include "linux/sched.h"                // for CLONE_FS, CLONE_FILES
#include "linux/seq_file.h"             // for seq_file_init
#include "linux/stddef.h"               // for true, false
#include "linux/sysctl.h"               // for do_sysctl_args
#include "linux/threads.h"              // for NR_CPUS
#include "linux/timer.h"                // for init_timers
#include "linux/workqueue.h"            // for workqueue_init, workqueue_ini...

init/main.c should remove these lines:
- #include <asm/cacheflush.h>  // lines 108-108
- #include <asm/io.h>  // lines 104-104
- #include <asm/sections.h>  // lines 107-107
- #include <linux/blkdev.h>  // lines 85-85
- #include <linux/ctype.h>  // lines 24-24
- #include <linux/idr.h>  // lines 76-76
- #include <linux/io.h>  // lines 94-94
- #include <linux/ioport.h>  // lines 26-26
- #include <linux/kallsyms.h>  // lines 47-47
- #include <linux/kernel_stat.h>  // lines 38-38
- #include <linux/kmod.h>  // lines 35-35
- #include <linux/list.h>  // lines 91-91
- #include <linux/mem_encrypt.h>  // lines 98-98
- #include <linux/ptrace.h>  // lines 83-83
- #include <linux/shmem_fs.h>  // lines 80-80
- #include <linux/syscalls.h>  // lines 21-21
- #include <linux/unistd.h>  // lines 59-59
- #include <linux/writeback.h>  // lines 49-49

The full include-list for init/main.c:
#include <asm/bug.h>                    // for WARN
#include <asm/bugs.h>                   // for check_bugs
#include <asm/page_types.h>             // for THREAD_SIZE
#include <asm/setup.h>                  // for COMMAND_LINE_SIZE
#include <kunit/test.h>                 // for kunit_run_all_tests
#include <linux/acpi.h>                 // for acpi_early_init, acpi_subsyst...
#include <linux/async.h>                // for async_synchronize_full
#include <linux/binfmts.h>              // for kernel_execve
#include <linux/bootconfig.h>           // for xbc_calc_checksum, BOOTCONFIG...
#include <linux/build_bug.h>            // for prevent_tail_call_optimization
#include <linux/buildid.h>              // for init_vmlinux_build_id
#include <linux/cache.h>                // for SMP_CACHE_BYTES, __ro_after_init
#include <linux/cgroup.h>               // for cgroup_init, cgroup_init_early
#include <linux/console.h>              // for console_init
#include <linux/context_tracking.h>     // for context_tracking_init
#include <linux/cpu.h>                  // for boot_cpu_hotplug_init, boot_c...
#include <linux/cpuset.h>               // for cpuset_init, cpuset_init_smp
#include <linux/debug_locks.h>          // for locking_selftest
#include <linux/debugobjects.h>         // for debug_objects_early_init, deb...
#include <linux/delay.h>                // for calibrate_delay
#include <linux/delayacct.h>            // for delayacct_init
#include <linux/device/driver.h>        // for driver_init
#include <linux/efi.h>                  // for efi_enabled, efi_enter_virtua...
#include <linux/extable.h>              // for sort_main_extable
#include <linux/ftrace.h>               // for early_trace_init, ftrace_free...
#include <linux/init.h>                 // for __init, initcall_entry_t, obs...
#include <linux/init_syscalls.h>        // for init_dup, init_eaccess
#include <linux/initrd.h>               // for initrd_start, initrd_end, wai...
#include <linux/integrity.h>            // for integrity_load_keys
#include <linux/interrupt.h>            // for early_irq_init, init_irq_proc
#include <linux/jump_label.h>           // for jump_label_init
#include <linux/kcsan.h>                // for kcsan_init
#include <linux/kernel.h>               // for sprintf, get_option, ARRAY_SIZE
#include <linux/key.h>                  // for key_init
#include <linux/kfence.h>               // for kfence_alloc_pool, kfence_init
#include <linux/kgdb.h>                 // for kgdb_free_init_mem, dbg_late_...
#include <linux/kmemleak.h>             // for kmemleak_init
#include <linux/kprobes.h>              // for kprobe_free_init_mem
#include <linux/kthread.h>              // for kthreadd, kthreadd_task
#include <linux/ktime.h>                // for ktime_get, timekeeping_init
#include <linux/linkage.h>              // for asmlinkage
#include <linux/lockdep.h>              // for lockdep_init
#include <linux/memblock.h>             // for memblock_alloc, memblock_free
#include <linux/mempolicy.h>            // for numa_default_policy, numa_pol...
#include <linux/module.h>               // for __init_or_module
#include <linux/moduleparam.h>          // for parse_args, kernel_param, __s...
#include <linux/nmi.h>                  // for lockup_detector_init
#include <linux/padata.h>               // for padata_init
#include <linux/page_ext.h>             // for page_ext_init, page_ext_init_...
#include <linux/percpu.h>               // for setup_per_cpu_areas
#include <linux/perf_event.h>           // for perf_event_init
#include <linux/pid_namespace.h>        // for pid_idr_init, init_pid_ns
#include <linux/preempt.h>              // for preempt_count, preempt_count_set
#include <linux/proc_fs.h>              // for proc_root_init
#include <linux/proc_ns.h>              // for nsfs_init
#include <linux/profile.h>              // for profile_init
#include <linux/pti.h>                  // for pti_finalize, pti_init
#include <linux/random.h>               // for add_latent_entropy, random_init
#include <linux/rcupdate.h>             // for rcu_read_lock, rcu_read_unlock
#include <linux/rmap.h>                 // for anon_vma_init
#include <linux/rodata_test.h>          // for rodata_test
#include <linux/sched.h>                // for find_task_by_pid_ns, schedule...
#include <linux/sched/clock.h>          // for sched_clock_init
#include <linux/sched/init.h>           // for sched_init, sched_init_smp
#include <linux/sched/isolation.h>      // for housekeeping_init
#include <linux/sched/task.h>           // for fork_init, kernel_thread, pro...
#include <linux/sched/task_stack.h>     // for set_task_stack_end_magic, thr...
#include <linux/security.h>             // for early_security_init, security...
#include <linux/signal.h>               // for signals_init
#include <linux/slab.h>                 // for kfree, kmem_cache_init, kmem_...
#include <linux/smp.h>                  // for call_function_init, smp_init
#include <linux/srcu.h>                 // for srcu_init
#include <linux/stackdepot.h>           // for stack_depot_early_init
#include <linux/stackprotector.h>       // for boot_init_stack_canary
#include <linux/start_kernel.h>         // for arch_call_rest_init, rest_init
#include <linux/string.h>               // for strlcat, strlcpy, strnchr
#include <linux/taskstats_kern.h>       // for taskstats_init_early
#include <linux/tick.h>                 // for tick_init
#include <linux/types.h>                // for bool
#include <linux/utsname.h>              // for uts_ns_init
#include <linux/vmalloc.h>              // for vmalloc_init
#include <net/net_namespace.h>          // for net_ns_init
#include <stddef.h>                     // for NULL, size_t
#include <trace/events/initcall.h>      // for trace_initcall_level
#include "asm-generic/errno-base.h"     // for EINVAL, ENOENT, EPERM
#include "asm-generic/fcntl.h"          // for O_RDWR
#include "asm-generic/int-ll64.h"       // for u32
#include "asm-generic/memory_model.h"   // for page_to_pfn
#include "asm/bug.h"                    // for BUG
#include "asm/cache.h"                  // for __read_mostly
#include "asm/current.h"                // for current
#include "asm/mem_encrypt.h"            // for mem_encrypt_init
#include "asm/page.h"                   // for virt_to_page
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/pgtable.h"                // for poking_init
#include "asm/string_32.h"              // for strlen, strcpy, strcmp, memmove
#include "generated/autoconf.h"         // for CONFIG_INIT_ENV_ARG_LIMIT
#include "linux/byteorder/generic.h"    // for le32_to_cpu
#include "linux/compiler-clang.h"       // for __no_sanitize_address
#include "linux/compiler_attributes.h"  // for __weak, noinline, __visible
#include "linux/compiler_types.h"       // for inline
#include "linux/completion.h"           // for complete, wait_for_completion
#include "linux/cpuhotplug.h"           // for CPUHP_ONLINE
#include "linux/cpumask.h"              // for cpumask_of
#include "linux/cred.h"                 // for cred_init
#include "linux/err.h"                  // for IS_ERR, IS_ERR_OR_NULL
#include "linux/export.h"               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/file.h"                 // for fput
#include "linux/fs.h"                   // for filp_open, vfs_caches_init
#include "linux/gfp.h"                  // for page_alloc_init, page_alloc_i...
#include "linux/hrtimer.h"              // for hrtimers_init
#include "linux/irqflags.h"             // for irqs_disabled, local_irq_disable
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_DEBUG
#include "linux/kstrtox.h"              // for strtobool
#include "linux/ktime.h"                // for ktime_t, ktime_us_delta
#include "linux/mm.h"                   // for want_init_on_free, free_initm...
#include "linux/mmzone.h"               // for build_all_zonelists
#include "linux/nodemask.h"             // for N_MEMORY, node_states, nodema...
#include "linux/panic.h"                // for panic
#include "linux/pgtable.h"              // for init_espfix_bsp, pgtable_cach...
#include "linux/pid.h"                  // for get_pid
#include "linux/poison.h"               // for POISON_FREE_INITMEM
#include "linux/printk.h"               // for pr_err, pr_warn, pr_debug
#include "linux/sched.h"                // for CLONE_FS, CLONE_FILES
#include "linux/seq_file.h"             // for seq_file_init
#include "linux/stddef.h"               // for true, false
#include "linux/sysctl.h"               // for do_sysctl_args
#include "linux/threads.h"              // for NR_CPUS
#include "linux/timer.h"                // for init_timers
#include "linux/workqueue.h"            // for workqueue_init, workqueue_ini...
---
  ./scripts/check-local-export init/main.o
  sh ./scripts/mkcompile_h include/generated/compile.h "i386" "" "" "" "" "Debian clang version 14.0.6" "ld.lld"
  UPD     include/generated/compile.h
  iwyu2 -Wp,-MMD,init/.version.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -fno-function-sections -fno-data-sections    -DKBUILD_MODFILE='"init/version"' -DKBUILD_BASENAME='"version"' -DKBUILD_MODNAME='"version"' -D__KBUILD_MODNAME=kmod_version -c -o init/version.o init/version.c  

init/version.c should add these lines:
#include "linux/elf.h"             // for Elf32_Word, elf32_note
#include "linux/refcount.h"        // for REFCOUNT_INIT

init/version.c should remove these lines:
- #include <linux/version.h>  // lines 17-17

The full include-list for init/version.c:
#include <generated/compile.h>     // for LINUX_COMPILER, LINUX_COMPILE_BY
#include <generated/utsrelease.h>  // for UTS_RELEASE
#include <linux/build-salt.h>      // for BUILD_SALT
#include <linux/elfnote-lto.h>     // for BUILD_LTO_INFO
#include <linux/export.h>          // for EXPORT_SYMBOL_GPL
#include <linux/proc_ns.h>         // for PROC_UTS_INIT_INO
#include <linux/uts.h>             // for UTS_DOMAINNAME, UTS_NODENAME, UTS_...
#include <linux/utsname.h>         // for init_user_ns, uts_namespace
#include "linux/elf.h"             // for Elf32_Word, elf32_note
#include "linux/refcount.h"        // for REFCOUNT_INIT
---
  ./scripts/check-local-export init/version.o
  iwyu2 -Wp,-MMD,init/.do_mounts.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -fno-function-sections -fno-data-sections    -DKBUILD_MODFILE='"init/mounts"' -DKBUILD_BASENAME='"do_mounts"' -DKBUILD_MODNAME='"mounts"' -D__KBUILD_MODNAME=kmod_mounts -c -o init/do_mounts.o init/do_mounts.c  
In file included from init/do_mounts.c:6:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from init/do_mounts.c:6:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from init/do_mounts.c:6:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from init/do_mounts.c:7:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from init/do_mounts.c:22:
In file included from ./include/linux/nfs_fs.h:28:
In file included from ./include/linux/sunrpc/auth.h:14:
In file included from ./include/linux/sunrpc/msg_prot.h:200:
In file included from ./include/linux/inet.h:42:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from init/do_mounts.c:22:
In file included from ./include/linux/nfs_fs.h:28:
./include/linux/sunrpc/auth.h:132:18: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                             struct xdr_stream *xdr);
                                                    ^
./include/linux/sunrpc/auth.h:135:19: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                              struct xdr_stream *xdr);
                                                     ^
./include/linux/sunrpc/auth.h:137:19: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                              struct xdr_stream *xdr);
                                                     ^
./include/linux/sunrpc/auth.h:139:15: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                                 struct xdr_stream *xdr);
                                                        ^
./include/linux/sunrpc/auth.h:167:15: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                          struct xdr_stream *xdr);
                                                 ^
./include/linux/sunrpc/auth.h:169:15: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                          struct xdr_stream *xdr);
                                                 ^
./include/linux/sunrpc/auth.h:171:14: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                                struct xdr_stream *xdr);
                                                       ^
./include/linux/sunrpc/auth.h:173:14: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                         struct xdr_stream *xdr);
                                                ^
./include/linux/sunrpc/auth.h:175:17: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                                   struct xdr_stream *xdr);
                                                          ^
./include/linux/sunrpc/auth.h:177:17: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                            struct xdr_stream *xdr);
                                                   ^
In file included from init/do_mounts.c:28:
In file included from init/do_mounts.h:3:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
16 warnings generated.
In file included from init/do_mounts.c:6:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from init/do_mounts.c:6:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from init/do_mounts.c:6:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from init/do_mounts.c:7:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from init/do_mounts.c:22:
In file included from ./include/linux/nfs_fs.h:28:
In file included from ./include/linux/sunrpc/auth.h:14:
In file included from ./include/linux/sunrpc/msg_prot.h:200:
In file included from ./include/linux/inet.h:42:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from init/do_mounts.c:22:
In file included from ./include/linux/nfs_fs.h:28:
./include/linux/sunrpc/auth.h:132:18: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                             struct xdr_stream *xdr);
                                                    ^
./include/linux/sunrpc/auth.h:135:19: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                              struct xdr_stream *xdr);
                                                     ^
./include/linux/sunrpc/auth.h:137:19: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                              struct xdr_stream *xdr);
                                                     ^
./include/linux/sunrpc/auth.h:139:15: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                                 struct xdr_stream *xdr);
                                                        ^
./include/linux/sunrpc/auth.h:167:15: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                          struct xdr_stream *xdr);
                                                 ^
./include/linux/sunrpc/auth.h:169:15: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                          struct xdr_stream *xdr);
                                                 ^
./include/linux/sunrpc/auth.h:171:14: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                                struct xdr_stream *xdr);
                                                       ^
./include/linux/sunrpc/auth.h:173:14: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                         struct xdr_stream *xdr);
                                                ^
./include/linux/sunrpc/auth.h:175:17: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                                   struct xdr_stream *xdr);
                                                          ^
./include/linux/sunrpc/auth.h:177:17: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                            struct xdr_stream *xdr);
                                                   ^
In file included from init/do_mounts.c:28:
In file included from init/do_mounts.h:3:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^

init/do_mounts.h should add these lines:
#include <sys/types.h>             // for dev_t
#include "linux/compiler_types.h"  // for inline
#include "linux/kdev_t.h"          // for new_encode_dev
#include "linux/stat.h"            // for S_IFBLK
#include "linux/types.h"           // for bool

init/do_mounts.h should remove these lines:
- #include <linux/blkdev.h>  // lines 3-3
- #include <linux/kernel.h>  // lines 2-2
- #include <linux/major.h>  // lines 9-9
- #include <linux/mount.h>  // lines 8-8
- #include <linux/root_dev.h>  // lines 10-10
- #include <linux/slab.h>  // lines 7-7
- #include <linux/syscalls.h>  // lines 5-5
- #include <linux/unistd.h>  // lines 6-6

The full include-list for init/do_mounts.h:
#include <linux/init.h>            // for __init
#include <linux/init_syscalls.h>   // for init_mknod, init_unlink
#include <sys/types.h>             // for dev_t
#include "linux/compiler_types.h"  // for inline
#include "linux/kdev_t.h"          // for new_encode_dev
#include "linux/stat.h"            // for S_IFBLK
#include "linux/types.h"           // for bool
---

init/do_mounts.c should add these lines:
#include <stddef.h>                  // for NULL, size_t
#include "asm-generic/errno-base.h"  // for EINVAL, EACCES, ENOMEM
#include "asm/current.h"             // for current
#include "asm/page_types.h"          // for PAGE_SIZE
#include "asm/string_32.h"           // for strcmp, strlen, strncmp, strncpy
#include "linux/blkdev.h"            // for printk_all_partitions, BDEVNAME_...
#include "linux/dcache.h"            // for dentry
#include "linux/device/driver.h"     // for driver_probe_done, wait_for_devi...
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"               // for GFP_KERNEL, alloc_page, __get_fr...
#include "linux/init_syscalls.h"     // for init_mount, init_chdir, init_chroot
#include "linux/kconfig.h"           // for IS_ENABLED
#include "linux/kern_levels.h"       // for KERN_INFO
#include "linux/kernel.h"            // for sscanf, scnprintf
#include "linux/kstrtox.h"           // for simple_strtoul
#include "linux/mm.h"                // for put_page, page_address
#include "linux/panic.h"             // for panic
#include "linux/path.h"              // for path
#include "linux/printk.h"            // for printk, pr_warn
#include "linux/stddef.h"            // for false, true
#include "linux/string.h"            // for strlcpy
struct fs_context;

init/do_mounts.c should remove these lines:
- #include <linux/ctype.h>  // lines 4-4
- #include <linux/initrd.h>  // lines 15-15
- #include <linux/module.h>  // lines 2-2
- #include <linux/nfs_fs.h>  // lines 22-22
- #include <linux/nfs_fs_sb.h>  // lines 23-23
- #include <linux/nfs_mount.h>  // lines 24-24
- #include <linux/security.h>  // lines 9-9
- #include <linux/slab.h>  // lines 18-18
- #include <linux/suspend.h>  // lines 7-7
- #include <linux/tty.h>  // lines 6-6

The full include-list for init/do_mounts.c:
#include "do_mounts.h"
#include <linux/async.h>             // for async_synchronize_full
#include <linux/delay.h>             // for msleep, ssleep
#include <linux/device.h>            // for devtmpfs_mount
#include <linux/fs.h>                // for kill_litter_super, file_system_type
#include <linux/fs_struct.h>         // for fs_struct
#include <linux/init.h>              // for __init, __setup, __initdata, ini...
#include <linux/mount.h>             // for name_to_dev_t
#include <linux/raid/detect.h>       // for md_run_setup
#include <linux/ramfs.h>             // for ramfs_init_fs_context
#include <linux/root_dev.h>          // for Root_CIFS, Root_NFS, Root_RAM0
#include <linux/sched.h>             // for task_struct
#include <linux/shmem_fs.h>          // for shmem_init_fs_context
#include <stddef.h>                  // for NULL, size_t
#include <uapi/linux/mount.h>        // for MS_RDONLY, MS_MOVE, MS_SILENT
#include "asm-generic/errno-base.h"  // for EINVAL, EACCES, ENOMEM
#include "asm/current.h"             // for current
#include "asm/page_types.h"          // for PAGE_SIZE
#include "asm/string_32.h"           // for strcmp, strlen, strncmp, strncpy
#include "linux/blkdev.h"            // for printk_all_partitions, BDEVNAME_...
#include "linux/dcache.h"            // for dentry
#include "linux/device/driver.h"     // for driver_probe_done, wait_for_devi...
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"               // for GFP_KERNEL, alloc_page, __get_fr...
#include "linux/init_syscalls.h"     // for init_mount, init_chdir, init_chroot
#include "linux/kconfig.h"           // for IS_ENABLED
#include "linux/kern_levels.h"       // for KERN_INFO
#include "linux/kernel.h"            // for sscanf, scnprintf
#include "linux/kstrtox.h"           // for simple_strtoul
#include "linux/mm.h"                // for put_page, page_address
#include "linux/panic.h"             // for panic
#include "linux/path.h"              // for path
#include "linux/printk.h"            // for printk, pr_warn
#include "linux/stddef.h"            // for false, true
#include "linux/string.h"            // for strlcpy
struct fs_context;
---
  ./scripts/check-local-export init/do_mounts.o
  iwyu2 -Wp,-MMD,init/.do_mounts_initrd.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -fno-function-sections -fno-data-sections    -DKBUILD_MODFILE='"init/mounts"' -DKBUILD_BASENAME='"do_mounts_initrd"' -DKBUILD_MODNAME='"mounts"' -D__KBUILD_MODNAME=kmod_mounts -c -o init/do_mounts_initrd.o init/do_mounts_initrd.c  
In file included from init/do_mounts_initrd.c:13:
In file included from init/do_mounts.h:3:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from init/do_mounts_initrd.c:13:
In file included from init/do_mounts.h:3:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from init/do_mounts_initrd.c:13:
In file included from init/do_mounts.h:3:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from init/do_mounts_initrd.c:13:
In file included from init/do_mounts.h:3:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from init/do_mounts_initrd.c:13:
In file included from init/do_mounts.h:5:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
5 warnings generated.
In file included from init/do_mounts_initrd.c:13:
In file included from init/do_mounts.h:3:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from init/do_mounts_initrd.c:13:
In file included from init/do_mounts.h:3:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from init/do_mounts_initrd.c:13:
In file included from init/do_mounts.h:3:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from init/do_mounts_initrd.c:13:
In file included from init/do_mounts.h:3:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from init/do_mounts_initrd.c:13:
In file included from init/do_mounts.h:5:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

init/do_mounts_initrd.c should add these lines:
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for ENOENT
#include "asm/current.h"             // for current
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/init.h"              // for __init, __initdata, early_param
#include "linux/init_syscalls.h"     // for init_chdir, init_mount, init_chroot
#include "linux/kdev_t.h"            // for new_decode_dev, new_encode_dev
#include "linux/kern_levels.h"       // for KERN_NOTICE
#include "linux/printk.h"            // for printk, pr_warn
#include "linux/root_dev.h"          // for Root_RAM0, ROOT_DEV
#include "linux/sched.h"             // for CLONE_FILES, CLONE_FS
#include "linux/stddef.h"            // for false, true
#include "linux/syscalls.h"          // for ksys_setsid, ksys_unshare
#include "linux/types.h"             // for phys_addr_t, bool
#include "linux/umh.h"               // for call_usermodehelper_exec, call_u...
struct cred;

init/do_mounts_initrd.c should remove these lines:
- #include <linux/freezer.h>  // lines 9-9
- #include <linux/kmod.h>  // lines 10-10
- #include <linux/minix_fs.h>  // lines 5-5
- #include <linux/romfs_fs.h>  // lines 6-6
- #include <linux/unistd.h>  // lines 2-2

The full include-list for init/do_mounts_initrd.c:
#include <linux/fs.h>                // for MNT_DETACH
#include <linux/initrd.h>            // for console_on_rootfs
#include <linux/kernel.h>            // for memparse
#include <linux/sched.h>             // for PF_FREEZER_SKIP, task_struct
#include <stddef.h>                  // for NULL
#include <uapi/linux/mount.h>        // for MS_MOVE, MS_RDONLY
#include "asm-generic/errno-base.h"  // for ENOENT
#include "asm/current.h"             // for current
#include "do_mounts.h"               // for create_dev, mount_block_root
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/init.h"              // for __init, __initdata, early_param
#include "linux/init_syscalls.h"     // for init_chdir, init_mount, init_chroot
#include "linux/kdev_t.h"            // for new_decode_dev, new_encode_dev
#include "linux/kern_levels.h"       // for KERN_NOTICE
#include "linux/printk.h"            // for printk, pr_warn
#include "linux/root_dev.h"          // for Root_RAM0, ROOT_DEV
#include "linux/sched.h"             // for CLONE_FILES, CLONE_FS
#include "linux/stddef.h"            // for false, true
#include "linux/syscalls.h"          // for ksys_setsid, ksys_unshare
#include "linux/types.h"             // for phys_addr_t, bool
#include "linux/umh.h"               // for call_usermodehelper_exec, call_u...
struct cred;
---
  ./scripts/check-local-export init/do_mounts_initrd.o
  iwyu2 -Wp,-MMD,init/.initramfs.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -fno-function-sections -fno-data-sections    -DKBUILD_MODFILE='"init/initramfs"' -DKBUILD_BASENAME='"initramfs"' -DKBUILD_MODNAME='"initramfs"' -D__KBUILD_MODNAME=kmod_initramfs -c -o init/initramfs.o init/initramfs.c  
In file included from init/initramfs.c:3:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from init/initramfs.c:3:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from init/initramfs.c:3:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from init/initramfs.c:11:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from init/initramfs.c:3:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from init/initramfs.c:3:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from init/initramfs.c:3:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from init/initramfs.c:11:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

init/initramfs.c should add these lines:
#include <sys/types.h>                  // for gid_t, uid_t
#include <cstdio>                       // for NULL, ssize_t, size_t, va_list
#include "asm-generic/errno-base.h"     // for EAGAIN, EINTR
#include "asm-generic/fcntl.h"          // for O_CREAT, O_TRUNC, O_WRONLY
#include "asm-generic/int-ll64.h"       // for u32, u64
#include "asm/page.h"                   // for __va
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/string_32.h"              // for memcmp, strcmp, strcpy, memcpy
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/compiler_types.h"       // for inline
#include "linux/err.h"                  // for IS_ERR
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/fcntl.h"                // for AT_SYMLINK_NOFOLLOW
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kdev_t.h"               // for new_encode_dev, MKDEV
#include "linux/kern_levels.h"          // for KERN_INFO, KERN_EMERG
#include "linux/kernel.h"               // for snprintf
#include "linux/kstrtox.h"              // for simple_strtoul, strtobool
#include "linux/limits.h"               // for PATH_MAX
#include "linux/math.h"                 // for round_down, round_up
#include "linux/panic.h"                // for panic
#include "linux/poison.h"               // for POISON_FREE_INITMEM
#include "linux/printk.h"               // for printk, pr_err, pr_cont, pr_d...
#include "linux/stat.h"                 // for kstat, S_IFMT, S_ISDIR, S_ISREG
#include "linux/stdarg.h"               // for va_end, va_start
#include "linux/stddef.h"               // for false, true
#include "linux/time64.h"               // for time64_t
struct path;

init/initramfs.c should remove these lines:
- #include <linux/delay.h>  // lines 8-8
- #include <linux/dirent.h>  // lines 10-10
- #include <linux/fcntl.h>  // lines 7-7
- #include <linux/kexec.h>  // lines 529-529
- #include <linux/namei.h>  // lines 16-16
- #include <linux/string.h>  // lines 9-9
- #include <linux/syscalls.h>  // lines 11-11
- #include <linux/utime.h>  // lines 12-12

The full include-list for init/initramfs.c:
#include <linux/async.h>                // for async_domain, async_schedule_...
#include <linux/decompress/generic.h>   // for decompress_method, decompress_fn
#include <linux/file.h>                 // for flush_delayed_fput, fput
#include <linux/fs.h>                   // for filp_open, kernel_write, vfs_...
#include <linux/init.h>                 // for __init, __initdata, __setup
#include <linux/init_syscalls.h>        // for init_chown, init_chmod, init_...
#include <linux/initrd.h>               // for initrd_start, initrd_end, phy...
#include <linux/memblock.h>             // for memblock_is_region_memory
#include <linux/mm.h>                   // for free_reserved_area, show_mem
#include <linux/slab.h>                 // for kfree, kmalloc
#include <linux/task_work.h>            // for task_work_run
#include <linux/types.h>                // for loff_t, umode_t, bool, phys_a...
#include <linux/umh.h>                  // for usermodehelper_enable
#include <sys/types.h>                  // for gid_t, uid_t
#include <cstdio>                       // for NULL, ssize_t, size_t, va_list
#include "asm-generic/errno-base.h"     // for EAGAIN, EINTR
#include "asm-generic/fcntl.h"          // for O_CREAT, O_TRUNC, O_WRONLY
#include "asm-generic/int-ll64.h"       // for u32, u64
#include "asm/page.h"                   // for __va
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/string_32.h"              // for memcmp, strcmp, strcpy, memcpy
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/compiler_types.h"       // for inline
#include "linux/err.h"                  // for IS_ERR
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/fcntl.h"                // for AT_SYMLINK_NOFOLLOW
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kdev_t.h"               // for new_encode_dev, MKDEV
#include "linux/kern_levels.h"          // for KERN_INFO, KERN_EMERG
#include "linux/kernel.h"               // for snprintf
#include "linux/kstrtox.h"              // for simple_strtoul, strtobool
#include "linux/limits.h"               // for PATH_MAX
#include "linux/math.h"                 // for round_down, round_up
#include "linux/panic.h"                // for panic
#include "linux/poison.h"               // for POISON_FREE_INITMEM
#include "linux/printk.h"               // for printk, pr_err, pr_cont, pr_d...
#include "linux/stat.h"                 // for kstat, S_IFMT, S_ISDIR, S_ISREG
#include "linux/stdarg.h"               // for va_end, va_start
#include "linux/stddef.h"               // for false, true
#include "linux/time64.h"               // for time64_t
struct path;
---
  ./scripts/check-local-export init/initramfs.o
  iwyu2 -Wp,-MMD,init/.calibrate.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -fno-function-sections -fno-data-sections    -DKBUILD_MODFILE='"init/calibrate"' -DKBUILD_BASENAME='"calibrate"' -DKBUILD_MODNAME='"calibrate"' -D__KBUILD_MODNAME=kmod_calibrate -c -o init/calibrate.o init/calibrate.c  

init/calibrate.c should add these lines:
#include <asm-generic/percpu.h>  // for per_cpu, DEFINE_PER_CPU
#include <stddef.h>              // for NULL
#include "asm-generic/delay.h"   // for __delay
#include "asm-generic/param.h"   // for HZ
#include "asm/timex.h"           // for ARCH_HAS_READ_CURRENT_TIMER
#include "asm/tsc.h"             // for calibrate_delay_is_known
#include "linux/kern_levels.h"   // for KERN_NOTICE
#include "linux/kstrtox.h"       // for simple_strtoul
#include "linux/printk.h"        // for pr_info, printk, pr_cont
#include "linux/stddef.h"        // for true
#include "linux/types.h"         // for bool

init/calibrate.c should remove these lines:
- #include <linux/percpu.h>  // lines 13-13

The full include-list for init/calibrate.c:
#include <asm-generic/percpu.h>  // for per_cpu, DEFINE_PER_CPU
#include <linux/delay.h>         // for calibrate_delay, calibration_delay_done
#include <linux/init.h>          // for __init, __setup
#include <linux/jiffies.h>       // for jiffies, time_before_eq
#include <linux/smp.h>           // for smp_processor_id
#include <linux/timex.h>         // for read_current_timer
#include <stddef.h>              // for NULL
#include "asm-generic/delay.h"   // for __delay
#include "asm-generic/param.h"   // for HZ
#include "asm/timex.h"           // for ARCH_HAS_READ_CURRENT_TIMER
#include "asm/tsc.h"             // for calibrate_delay_is_known
#include "linux/kern_levels.h"   // for KERN_NOTICE
#include "linux/kstrtox.h"       // for simple_strtoul
#include "linux/printk.h"        // for pr_info, printk, pr_cont
#include "linux/stddef.h"        // for true
#include "linux/types.h"         // for bool
---
  ./scripts/check-local-export init/calibrate.o
  iwyu2 -Wp,-MMD,init/.init_task.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -fno-function-sections -fno-data-sections    -DKBUILD_MODFILE='"init/init_task"' -DKBUILD_BASENAME='"init_task"' -DKBUILD_MODNAME='"init_task"' -D__KBUILD_MODNAME=kmod_init_task -c -o init/init_task.o init/init_task.c  
In file included from init/init_task.c:2:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from init/init_task.c:2:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from init/init_task.c:2:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from init/init_task.c:2:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
4 warnings generated.
In file included from init/init_task.c:2:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from init/init_task.c:2:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from init/init_task.c:2:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from init/init_task.c:2:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^

include/linux/init_task.h should add these lines:
#include "linux/compiler_attributes.h"  // for __section
#include "linux/cred.h"                 // for cred
#include "linux/nsproxy.h"              // for nsproxy
#include "linux/sched.h"                // for files_struct, fs_struct
#include "linux/spinlock_types_raw.h"   // for __RAW_SPIN_LOCK_UNLOCKED

include/linux/init_task.h should remove these lines:
- #include <asm/thread_info.h>  // lines 23-23
- #include <linux/ftrace.h>  // lines 9-9
- #include <linux/ipc.h>  // lines 10-10
- #include <linux/irqflags.h>  // lines 6-6
- #include <linux/livepatch.h>  // lines 20-20
- #include <linux/lockdep.h>  // lines 8-8
- #include <linux/mm_types.h>  // lines 21-21
- #include <linux/pid_namespace.h>  // lines 11-11
- #include <linux/rbtree.h>  // lines 15-15
- #include <linux/rcupdate.h>  // lines 5-5
- #include <linux/refcount.h>  // lines 16-16
- #include <linux/sched/autogroup.h>  // lines 17-17
- #include <linux/sched/rt.h>  // lines 19-19
- #include <linux/securebits.h>  // lines 13-13
- #include <linux/seqlock.h>  // lines 14-14
- #include <linux/user_namespace.h>  // lines 12-12
- #include <linux/utsname.h>  // lines 7-7
- #include <net/net_namespace.h>  // lines 18-18

The full include-list for include/linux/init_task.h:
#include "linux/compiler_attributes.h"  // for __section
#include "linux/cred.h"                 // for cred
#include "linux/nsproxy.h"              // for nsproxy
#include "linux/sched.h"                // for files_struct, fs_struct
#include "linux/spinlock_types_raw.h"   // for __RAW_SPIN_LOCK_UNLOCKED
---

init/init_task.c should add these lines:
#include <stddef.h>                   // for NULL
#include "asm-generic/resource.h"     // for INIT_RLIMITS
#include "asm-generic/signal-defs.h"  // for SIG_DFL
#include "asm/cache.h"                // for L1_CACHE_BYTES
#include "asm/processor.h"            // for INIT_THREAD
#include "asm/thread_info.h"          // for INIT_THREAD_INFO
#include "linux/cpumask.h"            // for CPU_MASK_ALL
#include "linux/list.h"               // for LIST_HEAD_INIT, HLIST_HEAD_INIT
#include "linux/mm_types.h"           // for init_mm
#include "linux/mutex.h"              // for mutex, __MUTEX_INITIALIZER
#include "linux/pid.h"                // for init_struct_pid, PIDTYPE_PGID
#include "linux/posix-timers.h"       // for INIT_CPU_TIMERS
#include "linux/rcupdate.h"           // for RCU_POINTER_INITIALIZER
#include "linux/refcount.h"           // for REFCOUNT_INIT
#include "linux/restart_block.h"      // for do_no_restart_syscall
#include "linux/rwsem.h"              // for __RWSEM_INITIALIZER
#include "linux/sched/prio.h"         // for MAX_PRIO
#include "linux/sched/signal.h"       // for signal_struct, sighand_struct
#include "linux/signal_types.h"       // for sigpending
#include "linux/spinlock_types.h"     // for __SPIN_LOCK_UNLOCKED
#include "linux/threads.h"            // for NR_CPUS
#include "linux/wait.h"               // for wait_queue_head_t, __WAIT_QUEUE...

init/init_task.c should remove these lines:
- #include <linux/audit.h>  // lines 12-12
- #include <linux/fs.h>  // lines 10-10
- #include <linux/init.h>  // lines 9-9
- #include <linux/mm.h>  // lines 11-11
- #include <linux/mqueue.h>  // lines 4-4
- #include <linux/numa.h>  // lines 13-13
- #include <linux/sched/sysctl.h>  // lines 6-6
- #include <linux/scs.h>  // lines 14-14
- #include <linux/uaccess.h>  // lines 16-16

The full include-list for init/init_task.c:
#include <linux/init_task.h>
#include <linux/export.h>             // for EXPORT_SYMBOL
#include <linux/sched.h>              // for task_struct, sched_entity, sche...
#include <linux/sched/rt.h>           // for RR_TIMESLICE
#include <linux/sched/task.h>         // for init_task
#include <stddef.h>                   // for NULL
#include "asm-generic/resource.h"     // for INIT_RLIMITS
#include "asm-generic/signal-defs.h"  // for SIG_DFL
#include "asm/cache.h"                // for L1_CACHE_BYTES
#include "asm/processor.h"            // for INIT_THREAD
#include "asm/thread_info.h"          // for INIT_THREAD_INFO
#include "linux/cpumask.h"            // for CPU_MASK_ALL
#include "linux/list.h"               // for LIST_HEAD_INIT, HLIST_HEAD_INIT
#include "linux/mm_types.h"           // for init_mm
#include "linux/mutex.h"              // for mutex, __MUTEX_INITIALIZER
#include "linux/pid.h"                // for init_struct_pid, PIDTYPE_PGID
#include "linux/posix-timers.h"       // for INIT_CPU_TIMERS
#include "linux/rcupdate.h"           // for RCU_POINTER_INITIALIZER
#include "linux/refcount.h"           // for REFCOUNT_INIT
#include "linux/restart_block.h"      // for do_no_restart_syscall
#include "linux/rwsem.h"              // for __RWSEM_INITIALIZER
#include "linux/sched/prio.h"         // for MAX_PRIO
#include "linux/sched/signal.h"       // for signal_struct, sighand_struct
#include "linux/signal_types.h"       // for sigpending
#include "linux/spinlock_types.h"     // for __SPIN_LOCK_UNLOCKED
#include "linux/threads.h"            // for NR_CPUS
#include "linux/wait.h"               // for wait_queue_head_t, __WAIT_QUEUE...
---
  ./scripts/check-local-export init/init_task.o
  rm -f init/built-in.a; echo main.o version.o do_mounts.o do_mounts_initrd.o initramfs.o calibrate.o init_task.o | sed -E 's:([^ ]+):init/:g' | xargs llvm-ar cDPrST init/built-in.a
make -f ./scripts/Makefile.build obj=usr \
single-build= \
need-builtin=1 need-modorder=1
  clang -Wp,-MMD,usr/.gen_init_cpio.d -Wall -Wmissing-prototypes -Wstrict-prototypes -O2 -fomit-frame-pointer -std=gnu11 -Wdeclaration-after-statement         -o usr/gen_init_cpio usr/gen_init_cpio.c   
  sh usr/gen_initramfs.sh -o usr/initramfs_data.cpio -l usr/.initramfs_data.cpio.d  -u 0  -g 0 elo
  cat usr/initramfs_data.cpio > usr/initramfs_inc_data
  iwyu2 -Wp,-MMD,usr/.initramfs_data.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -D__ASSEMBLY__ -fno-PIE --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -m32 -fno-lto    -c -o usr/initramfs_data.o usr/initramfs_data.S 
  ./scripts/check-local-export usr/initramfs_data.o
  rm -f usr/built-in.a; echo initramfs_data.o | sed -E 's:([^ ]+):usr/:g' | xargs llvm-ar cDPrST usr/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86 \
single-build= \
need-builtin=1 need-modorder=1
make -f ./scripts/Makefile.build obj=arch/x86/entry \
 \
need-builtin=1 \
need-modorder=1
make -f ./scripts/Makefile.build obj=arch/x86/entry/vdso \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,arch/x86/entry/vdso/.vma.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/entry/vdso/vma"' -DKBUILD_BASENAME='"vma"' -DKBUILD_MODNAME='"vma"' -D__KBUILD_MODNAME=kmod_vma -c -o arch/x86/entry/vdso/vma.o arch/x86/entry/vdso/vma.c  
In file included from arch/x86/entry/vdso/vma.c:15:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/entry/vdso/vma.c:15:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/entry/vdso/vma.c:15:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/entry/vdso/vma.c:24:
In file included from ./arch/x86/include/asm/tlb.h:8:
In file included from ./include/asm-generic/tlb.h:15:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/entry/vdso/vma.c:15:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/entry/vdso/vma.c:15:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/entry/vdso/vma.c:15:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/entry/vdso/vma.c:24:
In file included from ./arch/x86/include/asm/tlb.h:8:
In file included from ./include/asm-generic/tlb.h:15:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/entry/vdso/vma.c should add these lines:
#include <asm/bug.h>                   // for BUG_ON
#include <stddef.h>                    // for NULL, size_t
#include "asm-generic/errno-base.h"    // for EEXIST, EINTR
#include "asm-generic/memory_model.h"  // for page_to_pfn
#include "asm/alternative.h"           // for apply_alternatives
#include "asm/cache.h"                 // for __read_mostly
#include "asm/clocksource.h"           // for vclock_was_used
#include "asm/current.h"               // for current
#include "asm/elf.h"                   // for arch_setup_additional_pages
#include "asm/io.h"                    // for virt_to_phys
#include "asm/mmu.h"                   // for mm_context_t
#include "asm/page_types.h"            // for PAGE_SHIFT, PAGE_SIZE
#include "asm/pgtable.h"               // for pgprot_decrypted
#include "asm/ptrace.h"                // for pt_regs
#include "asm/thread_info.h"           // for in_ia32_syscall
#include "linux/compiler.h"            // for unlikely
#include "linux/compiler_types.h"      // for __user, inline
#include "linux/mm_types.h"            // for mm_struct, mm_struct::(anonymous)
#include "linux/mmap_lock.h"           // for mmap_write_unlock, mmap_write_...
#include "linux/stddef.h"              // for false, true
#include "linux/types.h"               // for bool
#include "vdso/clocksource.h"          // for VDSO_CLOCKMODE_HVCLOCK, VDSO_C...

arch/x86/entry/vdso/vma.c should remove these lines:
- #include <asm/cpufeature.h>  // lines 27-27
- #include <asm/desc.h>  // lines 26-26
- #include <asm/proto.h>  // lines 21-21
- #include <asm/tlb.h>  // lines 24-24
- #include <asm/vgtod.h>  // lines 20-20
- #include <linux/cpu.h>  // lines 15-15
- #include <linux/elf.h>  // lines 14-14
- #include <linux/random.h>  // lines 13-13
- #include <linux/sched/task_stack.h>  // lines 10-10
- #include <linux/slab.h>  // lines 11-11
- #include <linux/time_namespace.h>  // lines 17-17

The full include-list for arch/x86/entry/vdso/vma.c:
#include <asm/bug.h>                   // for BUG_ON
#include <asm/page.h>                  // for __pa_symbol, __pa, virt_to_page
#include <asm/pvclock.h>               // for pvclock_get_pvti_cpu0_va
#include <asm/vdso.h>                  // for vdso_image, vdso_image_32, ini...
#include <asm/vvar.h>                  // for __vvar_page, _vdso_data_offset
#include <asm/vvar.h>                  // for __vvar_page, _vdso_data_offset
#include <clocksource/hyperv_timer.h>  // for hv_get_tsc_page
#include <linux/err.h>                 // for IS_ERR, PTR_ERR, IS_ERR_VALUE
#include <linux/init.h>                // for __init
#include <linux/mm.h>                  // for vmf_insert_pfn, vm_fault, vm_f...
#include <linux/ptrace.h>              // for current_pt_regs
#include <linux/sched.h>               // for task_struct
#include <stddef.h>                    // for NULL, size_t
#include "asm-generic/errno-base.h"    // for EEXIST, EINTR
#include "asm-generic/memory_model.h"  // for page_to_pfn
#include "asm/alternative.h"           // for apply_alternatives
#include "asm/cache.h"                 // for __read_mostly
#include "asm/clocksource.h"           // for vclock_was_used
#include "asm/current.h"               // for current
#include "asm/elf.h"                   // for arch_setup_additional_pages
#include "asm/io.h"                    // for virt_to_phys
#include "asm/mmu.h"                   // for mm_context_t
#include "asm/page_types.h"            // for PAGE_SHIFT, PAGE_SIZE
#include "asm/pgtable.h"               // for pgprot_decrypted
#include "asm/ptrace.h"                // for pt_regs
#include "asm/thread_info.h"           // for in_ia32_syscall
#include "linux/compiler.h"            // for unlikely
#include "linux/compiler_types.h"      // for __user, inline
#include "linux/mm_types.h"            // for mm_struct, mm_struct::(anonymous)
#include "linux/mmap_lock.h"           // for mmap_write_unlock, mmap_write_...
#include "linux/stddef.h"              // for false, true
#include "linux/types.h"               // for bool
#include "vdso/clocksource.h"          // for VDSO_CLOCKMODE_HVCLOCK, VDSO_C...
struct linux_binprm;  // lines 54-54
---
  ./scripts/check-local-export arch/x86/entry/vdso/vma.o
  iwyu2 -Wp,-MMD,arch/x86/entry/vdso/.extable.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/entry/vdso/extable"' -DKBUILD_BASENAME='"extable"' -DKBUILD_MODNAME='"extable"' -D__KBUILD_MODNAME=kmod_extable -c -o arch/x86/entry/vdso/extable.o arch/x86/entry/vdso/extable.c  
In file included from arch/x86/entry/vdso/extable.c:5:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/entry/vdso/extable.c:5:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/entry/vdso/extable.c:5:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/entry/vdso/extable.c:5:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/entry/vdso/extable.c:5:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/entry/vdso/extable.c:5:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/entry/vdso/extable.c:5:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/entry/vdso/extable.c:5:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/entry/vdso/extable.c should add these lines:
#include "asm/mmu.h"         // for mm_context_t
#include "asm/ptrace.h"      // for pt_regs
#include "asm/trapnr.h"      // for X86_TRAP_BP, X86_TRAP_DB
#include "linux/mm_types.h"  // for mm_struct, mm_struct::(anonymous)
#include "linux/sched.h"     // for task_struct
#include "linux/stddef.h"    // for false, true
#include "linux/types.h"     // for bool

arch/x86/entry/vdso/extable.c should remove these lines:
- #include <asm/traps.h>  // lines 5-5
- #include <linux/err.h>  // lines 2-2
- #include <linux/mm.h>  // lines 3-3

The full include-list for arch/x86/entry/vdso/extable.c:
#include <asm/current.h>     // for current
#include <asm/vdso.h>        // for vdso_image, fixup_vdso_exception
#include "asm/mmu.h"         // for mm_context_t
#include "asm/ptrace.h"      // for pt_regs
#include "asm/trapnr.h"      // for X86_TRAP_BP, X86_TRAP_DB
#include "linux/mm_types.h"  // for mm_struct, mm_struct::(anonymous)
#include "linux/sched.h"     // for task_struct
#include "linux/stddef.h"    // for false, true
#include "linux/types.h"     // for bool
---
  ./scripts/check-local-export arch/x86/entry/vdso/extable.o
  iwyu2 -Wp,-MMD,arch/x86/entry/vdso/.vdso32-setup.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/entry/vdso/vdso32-setup"' -DKBUILD_BASENAME='"vdso32_setup"' -DKBUILD_MODNAME='"vdso32_setup"' -D__KBUILD_MODNAME=kmod_vdso32_setup -c -o arch/x86/entry/vdso/vdso32-setup.o arch/x86/entry/vdso/vdso32-setup.c  

arch/x86/entry/vdso/vdso32-setup.c should add these lines:
#include <stddef.h>         // for NULL
#include "asm/cache.h"      // for __read_mostly
#include "linux/kstrtox.h"  // for simple_strtoul
#include "linux/printk.h"   // for pr_warn

arch/x86/entry/vdso/vdso32-setup.c should remove these lines:
- #include <linux/elf.h>  // lines 14-14
- #include <linux/kernel.h>  // lines 12-12
- #include <linux/mm_types.h>  // lines 13-13
- #include <linux/smp.h>  // lines 11-11

The full include-list for arch/x86/entry/vdso/vdso32-setup.c:
#include <asm/processor.h>  // for sysenter_setup
#include <asm/vdso.h>       // for init_vdso_image, vdso_image_32
#include <linux/init.h>     // for __init, __setup, __setup_param
#include <stddef.h>         // for NULL
#include "asm/cache.h"      // for __read_mostly
#include "linux/kstrtox.h"  // for simple_strtoul
#include "linux/printk.h"   // for pr_warn
---
  ./scripts/check-local-export arch/x86/entry/vdso/vdso32-setup.o
  iwyu2 -E -Wp,-MMD,arch/x86/entry/vdso/vdso32/.vdso32.lds.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./=  -P -C -P -Ux86 -D__ASSEMBLY__ -DLINKER_SCRIPT -o arch/x86/entry/vdso/vdso32/vdso32.lds arch/x86/entry/vdso/vdso32/vdso32.lds.S
  iwyu2 -Wp,-MMD,arch/x86/entry/vdso/vdso32/.note.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -D__ASSEMBLY__ -fno-PIE --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -m32 -fno-lto -DBUILD_VDSO    -c -o arch/x86/entry/vdso/vdso32/note.o arch/x86/entry/vdso/vdso32/note.S 
  ./scripts/check-local-export arch/x86/entry/vdso/vdso32/note.o
  iwyu2 -Wp,-MMD,arch/x86/entry/vdso/vdso32/.system_call.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -D__ASSEMBLY__ -fno-PIE --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -m32 -fno-lto -DBUILD_VDSO    -c -o arch/x86/entry/vdso/vdso32/system_call.o arch/x86/entry/vdso/vdso32/system_call.S 
  ./scripts/check-local-export arch/x86/entry/vdso/vdso32/system_call.o
  iwyu2 -Wp,-MMD,arch/x86/entry/vdso/vdso32/.sigreturn.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -D__ASSEMBLY__ -fno-PIE --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -m32 -fno-lto -DBUILD_VDSO    -c -o arch/x86/entry/vdso/vdso32/sigreturn.o arch/x86/entry/vdso/vdso32/sigreturn.S 
  ./scripts/check-local-export arch/x86/entry/vdso/vdso32/sigreturn.o
  iwyu2 -Wp,-MMD,arch/x86/entry/vdso/vdso32/.vclock_gettime.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -m32 -msoft-float -mregparm=0 -fpic -fno-stack-protector -foptimize-sibling-calls -fno-omit-frame-pointer -DDISABLE_BRANCH_PROFILING    -DKBUILD_MODFILE='"arch/x86/entry/vdso/vclock_gettime"' -DKBUILD_BASENAME='"vclock_gettime"' -DKBUILD_MODNAME='"vclock_gettime"' -D__KBUILD_MODNAME=kmod_vclock_gettime -c -o arch/x86/entry/vdso/vdso32/vclock_gettime.o arch/x86/entry/vdso/vdso32/vclock_gettime.c  

arch/x86/entry/vdso/vclock_gettime.c should add these lines:
#include <asm/posix_types.h>                    // for __kernel_old_time_t
#include <sys/types.h>                          // for clockid_t
struct __kernel_old_timeval;
struct __kernel_timespec;
struct old_timespec32;
struct timezone;

arch/x86/entry/vdso/vclock_gettime.c should remove these lines:
- #include <linux/kernel.h>  // lines 12-12
- #include <linux/time.h>  // lines 11-11
- #include <linux/types.h>  // lines 13-13

The full include-list for arch/x86/entry/vdso/vclock_gettime.c:
#include <asm/posix_types.h>                    // for __kernel_old_time_t
#include <sys/types.h>                          // for clockid_t
#include "../../../../lib/vdso/gettimeofday.c"  // for __cvdso_clock_getres_...
struct __kernel_old_timeval;
struct __kernel_timespec;
struct old_timespec32;
struct timezone;
---

(arch/x86/entry/vdso/vdso32/vclock_gettime.c has correct #includes/fwd-decls)
  ./scripts/check-local-export arch/x86/entry/vdso/vdso32/vclock_gettime.o
  ld.lld -o arch/x86/entry/vdso/vdso32.so.dbg -shared --hash-style=both --build-id=sha1  --eh-frame-hdr -Bsymbolic -m elf_i386 -soname linux-gate.so.1 -T arch/x86/entry/vdso/vdso32/vdso32.lds arch/x86/entry/vdso/vdso32/note.o arch/x86/entry/vdso/vdso32/system_call.o arch/x86/entry/vdso/vdso32/sigreturn.o arch/x86/entry/vdso/vdso32/vclock_gettime.o && sh ./arch/x86/entry/vdso/checkundef.sh 'llvm-nm' 'arch/x86/entry/vdso/vdso32.so.dbg'; if llvm-objdump -R arch/x86/entry/vdso/vdso32.so.dbg | egrep -h "R_X86_64_JUMP_SLOT|R_X86_64_GLOB_DAT|R_X86_64_RELATIVE| R_386_GLOB_DAT|R_386_JMP_SLOT|R_386_RELATIVE"; then (echo >&2 "arch/x86/entry/vdso/vdso32.so.dbg: dynamic relocations are not supported"; rm -f arch/x86/entry/vdso/vdso32.so.dbg; /bin/false); fi
  llvm-objcopy -S --remove-section __ex_table  arch/x86/entry/vdso/vdso32.so.dbg arch/x86/entry/vdso/vdso32.so
  clang -Wp,-MMD,arch/x86/entry/vdso/.vdso2c.d -Wall -Wmissing-prototypes -Wstrict-prototypes -O2 -fomit-frame-pointer -std=gnu11 -Wdeclaration-after-statement     -I./tools/include -I./include/uapi -I./arch//include/uapi    -o arch/x86/entry/vdso/vdso2c arch/x86/entry/vdso/vdso2c.c   
  arch/x86/entry/vdso/vdso2c arch/x86/entry/vdso/vdso32.so.dbg arch/x86/entry/vdso/vdso32.so arch/x86/entry/vdso/vdso-image-32.c
  iwyu2 -Wp,-MMD,arch/x86/entry/vdso/.vdso-image-32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/entry/vdso/vdso-image-32"' -DKBUILD_BASENAME='"vdso_image_32"' -DKBUILD_MODNAME='"vdso_image_32"' -D__KBUILD_MODNAME=kmod_vdso_image_32 -c -o arch/x86/entry/vdso/vdso-image-32.o arch/x86/entry/vdso/vdso-image-32.c  

arch/x86/entry/vdso/vdso-image-32.c should add these lines:
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler_attributes.h"  // for __aligned

arch/x86/entry/vdso/vdso-image-32.c should remove these lines:
- #include <linux/linkage.h>  // lines 3-3

The full include-list for arch/x86/entry/vdso/vdso-image-32.c:
#include <asm/page_types.h>             // for PAGE_SIZE
#include <asm/vdso.h>                   // for vdso_image
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler_attributes.h"  // for __aligned
---
  ./scripts/check-local-export arch/x86/entry/vdso/vdso-image-32.o
  rm -f arch/x86/entry/vdso/built-in.a; echo vma.o extable.o vdso32-setup.o vdso-image-32.o | sed -E 's:([^ ]+):arch/x86/entry/vdso/:g' | xargs llvm-ar cDPrST arch/x86/entry/vdso/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/entry/vsyscall \
 \
need-builtin=1 \
need-modorder=1
  rm -f arch/x86/entry/vsyscall/built-in.a; echo  | sed -E 's:([^ ]+):arch/x86/entry/vsyscall/:g' | xargs llvm-ar cDPrST arch/x86/entry/vsyscall/built-in.a
  iwyu2 -Wp,-MMD,arch/x86/entry/.entry.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -D__ASSEMBLY__ -fno-PIE --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -m32 -fno-lto    -c -o arch/x86/entry/entry.o arch/x86/entry/entry.S 
  ./scripts/check-local-export arch/x86/entry/entry.o
  iwyu2 -Wp,-MMD,arch/x86/entry/.entry_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -D__ASSEMBLY__ -fno-PIE --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -m32 -fno-lto    -c -o arch/x86/entry/entry_32.o arch/x86/entry/entry_32.S 
  ./scripts/check-local-export arch/x86/entry/entry_32.o
  iwyu2 -Wp,-MMD,arch/x86/entry/.thunk_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -D__ASSEMBLY__ -fno-PIE --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -m32 -fno-lto    -c -o arch/x86/entry/thunk_32.o arch/x86/entry/thunk_32.S 
  ./scripts/check-local-export arch/x86/entry/thunk_32.o
  iwyu2 -Wp,-MMD,arch/x86/entry/.syscall_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/entry/syscall_32"' -DKBUILD_BASENAME='"syscall_32"' -DKBUILD_MODNAME='"syscall_32"' -D__KBUILD_MODNAME=kmod_syscall_32 -c -o arch/x86/entry/syscall_32.o arch/x86/entry/syscall_32.c  
In file included from arch/x86/entry/syscall_32.c:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/entry/syscall_32.c:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/entry/syscall_32.c:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/entry/syscall_32.c:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/entry/syscall_32.c:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/entry/syscall_32.c:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/entry/syscall_32.c:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/entry/syscall_32.c:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/entry/syscall_32.c should add these lines:
#include "linux/compiler_attributes.h"  // for __visible
struct pt_regs;

arch/x86/entry/syscall_32.c should remove these lines:
- #include <linux/cache.h>  // lines 6-6
- #include <linux/linkage.h>  // lines 4-4
- #include <linux/syscalls.h>  // lines 7-7

The full include-list for arch/x86/entry/syscall_32.c:
#include <asm/syscall.h>                // for ia32_sys_call_table, sys_call...
#include <asm/syscalls_32.h>  // lines 14-14
#include <asm/syscalls_32.h>  // lines 20-20
#include "linux/compiler_attributes.h"  // for __visible
struct pt_regs;
---
  ./scripts/check-local-export arch/x86/entry/syscall_32.o
  iwyu2 -Wp,-MMD,arch/x86/entry/.common.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -fno-stack-protector    -DKBUILD_MODFILE='"arch/x86/entry/common"' -DKBUILD_BASENAME='"common"' -DKBUILD_MODNAME='"common"' -D__KBUILD_MODNAME=kmod_common -c -o arch/x86/entry/common.o arch/x86/entry/common.c  
In file included from arch/x86/entry/common.c:13:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/entry/common.c:13:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/entry/common.c:13:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/entry/common.c:13:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/entry/common.c:13:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/entry/common.c:13:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/entry/common.c:13:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/entry/common.c:13:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/entry/common.c should add these lines:
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include "asm-generic/errno-base.h"     // for EFAULT
#include "asm-generic/errno.h"          // for ENOSYS
#include "asm-generic/int-ll64.h"       // for u32
#include "asm/cpufeatures.h"            // for X86_FEATURE_SEP
#include "asm/current.h"                // for current
#include "asm/mmu.h"                    // for mm_context_t
#include "asm/processor-flags.h"        // for X86_EFLAGS_IF, X86_EFLAGS_RF
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/segment.h"                // for __USER_CS, __USER_DS
#include "asm/thread_info.h"            // for TS_COMPAT, thread_info
#include "asm/uaccess.h"                // for __get_user, get_user
#include "asm/unistd.h"                 // for IA32_NR_syscalls
#include "linux/compiler.h"             // for likely
#include "linux/compiler_attributes.h"  // for __visible, __always_inline
#include "linux/compiler_types.h"       // for noinstr, __force, __user
#include "linux/instrumentation.h"      // for instrumentation_end, instrume...
#include "linux/irqflags.h"             // for local_irq_disable
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/mm_types.h"             // for mm_struct, mm_struct::(anonym...
#include "linux/randomize_kstack.h"     // for add_random_kstack_offset
#include "linux/stddef.h"               // for false, true
#include "linux/thread_info.h"          // for current_thread_info
#include "linux/types.h"                // for bool

arch/x86/entry/common.c should remove these lines:
- #include <asm/desc.h>  // lines 24-24
- #include <asm/fpu/api.h>  // lines 28-28
- #include <asm/io_bitmap.h>  // lines 30-30
- #include <asm/irq_stack.h>  // lines 32-32
- #include <asm/nospec-branch.h>  // lines 29-29
- #include <asm/traps.h>  // lines 25-25
- #include <linux/errno.h>  // lines 16-16
- #include <linux/export.h>  // lines 18-18
- #include <linux/kernel.h>  // lines 10-10
- #include <linux/mm.h>  // lines 14-14
- #include <linux/ptrace.h>  // lines 17-17
- #include <linux/sched/task_stack.h>  // lines 12-12
- #include <linux/smp.h>  // lines 15-15
- #include <linux/uaccess.h>  // lines 21-21

The full include-list for arch/x86/entry/common.c:
#include <asm/cpufeature.h>             // for static_cpu_has
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/syscall.h>                // for ia32_sys_call_table
#include <asm/vdso.h>                   // for vdso_image, vdso_image_32
#include <linux/entry-common.h>         // for syscall_exit_to_user_mode
#include <linux/nospec.h>               // for array_index_nospec
#include <linux/sched.h>                // for task_struct
#include <linux/syscalls.h>             // for SYSCALL_DEFINE0, __ia32_sys_n...
#include "asm-generic/errno-base.h"     // for EFAULT
#include "asm-generic/errno.h"          // for ENOSYS
#include "asm-generic/int-ll64.h"       // for u32
#include "asm/cpufeatures.h"            // for X86_FEATURE_SEP
#include "asm/current.h"                // for current
#include "asm/mmu.h"                    // for mm_context_t
#include "asm/processor-flags.h"        // for X86_EFLAGS_IF, X86_EFLAGS_RF
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/segment.h"                // for __USER_CS, __USER_DS
#include "asm/thread_info.h"            // for TS_COMPAT, thread_info
#include "asm/uaccess.h"                // for __get_user, get_user
#include "asm/unistd.h"                 // for IA32_NR_syscalls
#include "linux/compiler.h"             // for likely
#include "linux/compiler_attributes.h"  // for __visible, __always_inline
#include "linux/compiler_types.h"       // for noinstr, __force, __user
#include "linux/instrumentation.h"      // for instrumentation_end, instrume...
#include "linux/irqflags.h"             // for local_irq_disable
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/mm_types.h"             // for mm_struct, mm_struct::(anonym...
#include "linux/randomize_kstack.h"     // for add_random_kstack_offset
#include "linux/stddef.h"               // for false, true
#include "linux/thread_info.h"          // for current_thread_info
#include "linux/types.h"                // for bool
---
  ./scripts/check-local-export arch/x86/entry/common.o
  rm -f arch/x86/entry/built-in.a; echo entry.o entry_32.o thunk_32.o syscall_32.o common.o vdso/built-in.a vsyscall/built-in.a | sed -E 's:([^ ]+):arch/x86/entry/:g' | xargs llvm-ar cDPrST arch/x86/entry/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/events \
 \
need-builtin=1 \
need-modorder=1
make -f ./scripts/Makefile.build obj=arch/x86/events/amd \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,arch/x86/events/amd/.core.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/events/amd/core"' -DKBUILD_BASENAME='"core"' -DKBUILD_MODNAME='"core"' -D__KBUILD_MODNAME=kmod_core -c -o arch/x86/events/amd/core.o arch/x86/events/amd/core.c  
In file included from arch/x86/events/amd/core.c:2:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/amd/core.c:2:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/amd/core.c:2:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/amd/core.c:2:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/events/amd/core.c:2:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/amd/core.c:2:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/amd/core.c:2:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/amd/core.c:2:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/events/amd/core.c should add these lines:
#include <asm-generic/percpu.h>                // for this_cpu_ptr, per_cpu
#include <asm/bitops.h>                        // for test_bit, __set_bit
#include <asm/bug.h>                           // for WARN_ON_ONCE, WARN_ON
#include <asm/cpufeatures.h>                   // for REQUIRED_MASK0, REQUIR...
#include <asm/percpu.h>                        // for this_cpu_add_8, this_c...
#include <linux/bitmap.h>                      // for for_each_set_bit
#include <cstdio>                              // for NULL, ssize_t
#include "asm-generic/delay.h"                 // for udelay
#include "asm-generic/errno-base.h"            // for EINVAL, ENODEV, ENOENT
#include "asm-generic/errno.h"                 // for EOPNOTSUPP
#include "asm-generic/int-ll64.h"              // for u64
#include "asm-generic/topology.h"              // for cpu_to_node
#include "asm/cache.h"                         // for __read_mostly
#include "asm/cpufeature.h"                    // for boot_cpu_has
#include "asm/cpufeatures.h"                   // for X86_FEATURE_PERFCTR_CORE
#include "asm/hardirq.h"                       // for (anonymous), inc_irq_stat
#include "asm/msr-index.h"                     // for MSR_AMD64_PERF_CNTR_GL...
#include "asm/msr.h"                           // for wrmsrl, rdmsrl
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/percpu.h"                        // for __pcpu_op2_1, __pcpu_o...
#include "asm/perf_event.h"                    // for AMD64_RAW_EVENT_MASK
#include "asm/processor.h"                     // for cpuinfo_x86, boot_cpu_...
#include "asm/string_32.h"                     // for memcpy
#include "asm/topology.h"                      // for topology_die_id
#include "linux/atomic/atomic-instrumented.h"  // for cmpxchg
#include "linux/bitops.h"                      // for hweight_long
#include "linux/bits.h"                        // for BIT_ULL
#include "linux/compiler_types.h"              // for inline
#include "linux/cpumask.h"                     // for for_each_online_cpu
#include "linux/device.h"                      // for device_attribute, DEVI...
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/kernel.h"                      // for snprintf, ARRAY_SIZE
#include "linux/perf_event.h"                  // for PERF_COUNT_HW_CACHE_RE...
#include "linux/preempt.h"                     // for in_nmi
#include "linux/printk.h"                      // for pr_cont
#include "linux/static_call.h"                 // for DEFINE_STATIC_CALL
#include "linux/static_call_types.h"           // for static_call
#include "linux/stddef.h"                      // for false, true
#include "linux/stringify.h"                   // for __stringify
#include "linux/sysfs.h"                       // for attribute_group, attri...
struct kobject;
struct pt_regs;

arch/x86/events/amd/core.c should remove these lines:
- #include <asm/apic.h>  // lines 11-11
- #include <linux/delay.h>  // lines 8-8
- #include <linux/jump_label.h>  // lines 3-3

The full include-list for arch/x86/events/amd/core.c:
#include <asm-generic/percpu.h>                // for this_cpu_ptr, per_cpu
#include <asm/apicdef.h>                       // for BAD_APICID
#include <asm/bitops.h>                        // for test_bit, __set_bit
#include <asm/bug.h>                           // for WARN_ON_ONCE, WARN_ON
#include <asm/cpufeatures.h>                   // for REQUIRED_MASK0, REQUIR...
#include <asm/nmi.h>                           // for NMI_DONE, NMI_HANDLED
#include <asm/percpu.h>                        // for this_cpu_add_8, this_c...
#include <linux/bitmap.h>                      // for for_each_set_bit
#include <linux/export.h>                      // for EXPORT_SYMBOL_GPL
#include <linux/init.h>                        // for __initconst, __init
#include <linux/jiffies.h>                     // for jiffies, msecs_to_jiffies
#include <linux/perf_event.h>                  // for perf_event, hw_perf_event
#include <linux/slab.h>                        // for kfree, kzalloc_node
#include <linux/types.h>                       // for bool, umode_t
#include <cstdio>                              // for NULL, ssize_t
#include "../perf_event.h"                     // for C, x86_pmu, cpu_hw_events
#include "asm-generic/delay.h"                 // for udelay
#include "asm-generic/errno-base.h"            // for EINVAL, ENODEV, ENOENT
#include "asm-generic/errno.h"                 // for EOPNOTSUPP
#include "asm-generic/int-ll64.h"              // for u64
#include "asm-generic/topology.h"              // for cpu_to_node
#include "asm/cache.h"                         // for __read_mostly
#include "asm/cpufeature.h"                    // for boot_cpu_has
#include "asm/cpufeatures.h"                   // for X86_FEATURE_PERFCTR_CORE
#include "asm/hardirq.h"                       // for (anonymous), inc_irq_stat
#include "asm/msr-index.h"                     // for MSR_AMD64_PERF_CNTR_GL...
#include "asm/msr.h"                           // for wrmsrl, rdmsrl
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/percpu.h"                        // for __pcpu_op2_1, __pcpu_o...
#include "asm/perf_event.h"                    // for AMD64_RAW_EVENT_MASK
#include "asm/processor.h"                     // for cpuinfo_x86, boot_cpu_...
#include "asm/string_32.h"                     // for memcpy
#include "asm/topology.h"                      // for topology_die_id
#include "linux/atomic/atomic-instrumented.h"  // for cmpxchg
#include "linux/bitops.h"                      // for hweight_long
#include "linux/bits.h"                        // for BIT_ULL
#include "linux/compiler_types.h"              // for inline
#include "linux/cpumask.h"                     // for for_each_online_cpu
#include "linux/device.h"                      // for device_attribute, DEVI...
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/kernel.h"                      // for snprintf, ARRAY_SIZE
#include "linux/perf_event.h"                  // for PERF_COUNT_HW_CACHE_RE...
#include "linux/preempt.h"                     // for in_nmi
#include "linux/printk.h"                      // for pr_cont
#include "linux/static_call.h"                 // for DEFINE_STATIC_CALL
#include "linux/static_call_types.h"           // for static_call
#include "linux/stddef.h"                      // for false, true
#include "linux/stringify.h"                   // for __stringify
#include "linux/sysfs.h"                       // for attribute_group, attri...
struct kobject;
struct pt_regs;
---
  ./scripts/check-local-export arch/x86/events/amd/core.o
  rm -f arch/x86/events/amd/built-in.a; echo core.o | sed -E 's:([^ ]+):arch/x86/events/amd/:g' | xargs llvm-ar cDPrST arch/x86/events/amd/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/events/intel \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,arch/x86/events/intel/.core.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/events/intel/core"' -DKBUILD_BASENAME='"core"' -DKBUILD_MODNAME='"core"' -D__KBUILD_MODNAME=kmod_core -c -o arch/x86/events/intel/core.o arch/x86/events/intel/core.c  
In file included from arch/x86/events/intel/core.c:25:
In file included from arch/x86/events/intel/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/intel/core.c:25:
In file included from arch/x86/events/intel/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/intel/core.c:25:
In file included from arch/x86/events/intel/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/intel/core.c:25:
In file included from arch/x86/events/intel/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/events/intel/core.c:25:
In file included from arch/x86/events/intel/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/intel/core.c:25:
In file included from arch/x86/events/intel/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/intel/core.c:25:
In file included from arch/x86/events/intel/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/intel/core.c:25:
In file included from arch/x86/events/intel/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/events/intel/core.c should add these lines:
#include <asm-generic/percpu.h>                // for this_cpu_ptr, per_cpu
#include <asm/bitops.h>                        // for test_bit, __clear_bit
#include <asm/bug.h>                           // for WARN_ON_ONCE, WARN
#include <asm/cpufeatures.h>                   // for REQUIRED_MASK0, REQUIR...
#include <asm/percpu.h>                        // for raw_cpu_read_8, this_c...
#include <linux/bitmap.h>                      // for for_each_set_bit
#include <linux/bitops.h>                      // for fls
#include <linux/build_bug.h>                   // for unlikely
#include <cstdio>                              // for NULL, ssize_t, size_t
#include "asm-generic/bitops/const_hweight.h"  // for hweight64
#include "asm-generic/errno-base.h"            // for EINVAL, EBUSY, ENODEV
#include "asm-generic/errno.h"                 // for EOPNOTSUPP, ENODATA
#include "asm-generic/int-ll64.h"              // for u64, u16, u8, s64, u32
#include "asm-generic/local64.h"               // for local64_add, local64_read
#include "asm-generic/rwonce.h"                // for WRITE_ONCE
#include "asm-generic/topology.h"              // for cpu_to_node
#include "asm/apicdef.h"                       // for APIC_DM_NMI, APIC_LVTPC
#include "asm/cache.h"                         // for __read_mostly
#include "asm/cpu.h"                           // for get_this_hybrid_cpu_type
#include "asm/cpufeatures.h"                   // for X86_FEATURE_RTM, X86_F...
#include "asm/intel_ds.h"                      // for MAX_PEBS_EVENTS, debug...
#include "asm/msr-index.h"                     // for MSR_OFFCORE_RSP_0, MSR...
#include "asm/msr.h"                           // for wrmsrl, wrmsrl_safe
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/percpu.h"                        // for __pcpu_op2_1, __pcpu_o...
#include "asm/perf_event.h"                    // for perf_guest_switch_msr
#include "asm/processor.h"                     // for boot_cpu_data, cpuinfo...
#include "asm/string_32.h"                     // for memcpy
#include "asm/topology.h"                      // for topology_max_smt_threads
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec, atomic_inc
#include "linux/bitmap.h"                      // for bitmap_copy
#include "linux/bits.h"                        // for BIT_ULL
#include "linux/compiler_attributes.h"         // for fallthrough, __always_...
#include "linux/compiler_types.h"              // for inline
#include "linux/container_of.h"                // for container_of
#include "linux/cpu.h"                         // for cpus_read_lock, cpus_r...
#include "linux/cpumask.h"                     // for cpumap_print_to_pagebuf
#include "linux/device.h"                      // for device_attribute, dev_...
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/irqflags.h"                    // for local_irq_save, local_...
#include "linux/jump_label.h"                  // for static_branch_enable
#include "linux/kern_levels.h"                 // for KERN_ERR
#include "linux/kernel.h"                      // for snprintf, ARRAY_SIZE
#include "linux/kstrtox.h"                     // for kstrtobool, kstrtoul
#include "linux/list.h"                        // for list_entry_is_head
#include "linux/lockdep.h"                     // for lockdep_assert_held
#include "linux/math64.h"                      // for mul_u64_u32_div
#include "linux/minmax.h"                      // for max, min_t
#include "linux/mutex.h"                       // for mutex, mutex_lock, mut...
#include "linux/perf_event.h"                  // for PERF_COUNT_HW_CACHE_RE...
#include "linux/printk.h"                      // for pr_cont, pr_info, pr_warn
#include "linux/smp.h"                         // for on_each_cpu, smp_proce...
#include "linux/spinlock.h"                    // for raw_spin_lock, raw_spi...
#include "linux/stat.h"                        // for S_IRUGO
#include "linux/static_call.h"                 // for static_call_update
#include "linux/sysfs.h"                       // for attribute_group, attri...
#include "linux/topology.h"                    // for topology_sibling_cpumask
#include "vdso/bits.h"                         // for BIT
struct kobject;
struct pt_regs;

arch/x86/events/intel/core.c should remove these lines:
- #include <linux/export.h>  // lines 15-15

The full include-list for arch/x86/events/intel/core.c:
#include <asm-generic/percpu.h>                // for this_cpu_ptr, per_cpu
#include <asm/apic.h>                          // for apic_write
#include <asm/bitops.h>                        // for test_bit, __clear_bit
#include <asm/bug.h>                           // for WARN_ON_ONCE, WARN
#include <asm/cpu_device_id.h>                 // for INTEL_CPU_DESC, x86_cp...
#include <asm/cpufeature.h>                    // for boot_cpu_has, cpu_has
#include <asm/cpufeatures.h>                   // for REQUIRED_MASK0, REQUIR...
#include <asm/hardirq.h>                       // for (anonymous), inc_irq_stat
#include <asm/intel-family.h>                  // for INTEL_FAM6_KABYLAKE
#include <asm/intel_pt.h>                      // for is_intel_pt_event
#include <asm/percpu.h>                        // for raw_cpu_read_8, this_c...
#include <linux/bitmap.h>                      // for for_each_set_bit
#include <linux/bitops.h>                      // for fls
#include <linux/build_bug.h>                   // for unlikely
#include <linux/init.h>                        // for __initconst, __init
#include <linux/nmi.h>                         // for hardlockup_detector_pe...
#include <linux/slab.h>                        // for kfree, kzalloc_node
#include <linux/stddef.h>                      // for true, false
#include <linux/types.h>                       // for bool, umode_t, list_head
#include <cstdio>                              // for NULL, ssize_t, size_t
#include "../perf_event.h"                     // for C, x86_pmu, cpu_hw_events
#include "asm-generic/bitops/const_hweight.h"  // for hweight64
#include "asm-generic/errno-base.h"            // for EINVAL, EBUSY, ENODEV
#include "asm-generic/errno.h"                 // for EOPNOTSUPP, ENODATA
#include "asm-generic/int-ll64.h"              // for u64, u16, u8, s64, u32
#include "asm-generic/local64.h"               // for local64_add, local64_read
#include "asm-generic/rwonce.h"                // for WRITE_ONCE
#include "asm-generic/topology.h"              // for cpu_to_node
#include "asm/apicdef.h"                       // for APIC_DM_NMI, APIC_LVTPC
#include "asm/cache.h"                         // for __read_mostly
#include "asm/cpu.h"                           // for get_this_hybrid_cpu_type
#include "asm/cpufeatures.h"                   // for X86_FEATURE_RTM, X86_F...
#include "asm/intel_ds.h"                      // for MAX_PEBS_EVENTS, debug...
#include "asm/msr-index.h"                     // for MSR_OFFCORE_RSP_0, MSR...
#include "asm/msr.h"                           // for wrmsrl, wrmsrl_safe
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/percpu.h"                        // for __pcpu_op2_1, __pcpu_o...
#include "asm/perf_event.h"                    // for perf_guest_switch_msr
#include "asm/processor.h"                     // for boot_cpu_data, cpuinfo...
#include "asm/string_32.h"                     // for memcpy
#include "asm/topology.h"                      // for topology_max_smt_threads
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec, atomic_inc
#include "linux/bitmap.h"                      // for bitmap_copy
#include "linux/bits.h"                        // for BIT_ULL
#include "linux/compiler_attributes.h"         // for fallthrough, __always_...
#include "linux/compiler_types.h"              // for inline
#include "linux/container_of.h"                // for container_of
#include "linux/cpu.h"                         // for cpus_read_lock, cpus_r...
#include "linux/cpumask.h"                     // for cpumap_print_to_pagebuf
#include "linux/device.h"                      // for device_attribute, dev_...
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/irqflags.h"                    // for local_irq_save, local_...
#include "linux/jump_label.h"                  // for static_branch_enable
#include "linux/kern_levels.h"                 // for KERN_ERR
#include "linux/kernel.h"                      // for snprintf, ARRAY_SIZE
#include "linux/kstrtox.h"                     // for kstrtobool, kstrtoul
#include "linux/list.h"                        // for list_entry_is_head
#include "linux/lockdep.h"                     // for lockdep_assert_held
#include "linux/math64.h"                      // for mul_u64_u32_div
#include "linux/minmax.h"                      // for max, min_t
#include "linux/mutex.h"                       // for mutex, mutex_lock, mut...
#include "linux/perf_event.h"                  // for PERF_COUNT_HW_CACHE_RE...
#include "linux/printk.h"                      // for pr_cont, pr_info, pr_warn
#include "linux/smp.h"                         // for on_each_cpu, smp_proce...
#include "linux/spinlock.h"                    // for raw_spin_lock, raw_spi...
#include "linux/stat.h"                        // for S_IRUGO
#include "linux/static_call.h"                 // for static_call_update
#include "linux/sysfs.h"                       // for attribute_group, attri...
#include "linux/topology.h"                    // for topology_sibling_cpumask
#include "vdso/bits.h"                         // for BIT
struct kobject;
struct pt_regs;
---
  ./scripts/check-local-export arch/x86/events/intel/core.o
  iwyu2 -Wp,-MMD,arch/x86/events/intel/.bts.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/events/intel/bts"' -DKBUILD_BASENAME='"bts"' -DKBUILD_MODNAME='"bts"' -D__KBUILD_MODNAME=kmod_bts -c -o arch/x86/events/intel/bts.o arch/x86/events/intel/bts.c  
In file included from arch/x86/events/intel/bts.c:15:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/intel/bts.c:15:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/intel/bts.c:15:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/intel/bts.c:21:
In file included from arch/x86/events/intel/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/events/intel/bts.c:15:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/intel/bts.c:15:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/intel/bts.c:15:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/intel/bts.c:21:
In file included from arch/x86/events/intel/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/events/intel/bts.c should add these lines:
#include <asm-generic/percpu.h>      // for this_cpu_ptr, per_cpu, DEFINE_PE...
#include <asm/bitops.h>              // for test_bit
#include <asm/bug.h>                 // for WARN_ON_ONCE
#include <asm/cpufeatures.h>         // for REQUIRED_MASK0, REQUIRED_MASK1
#include <linux/mm.h>                // for PagePrivate
#include <stddef.h>                  // for NULL, size_t
#include "asm-generic/errno-base.h"  // for EBUSY, ENODEV, ENOSPC, EINVAL
#include "asm-generic/int-ll64.h"    // for u64, s64
#include "asm-generic/rwonce.h"      // for READ_ONCE, WRITE_ONCE
#include "asm-generic/topology.h"    // for cpu_to_node
#include "asm/barrier.h"             // for wmb
#include "asm/cmpxchg.h"             // for __xchg_wrong_size
#include "asm/cpufeature.h"          // for boot_cpu_has
#include "asm/cpufeatures.h"         // for X86_FEATURE_DTES64, X86_FEATURE_PTI
#include "asm/intel_ds.h"            // for debug_store
#include "asm/local.h"               // for local_xchg, local_add, local_read
#include "asm/page.h"                // for virt_to_page
#include "asm/page_types.h"          // for PAGE_SHIFT, PAGE_SIZE
#include "asm/string_32.h"           // for memset
#include "linux/compiler.h"          // for barrier
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/init.h"              // for __init, arch_initcall
#include "linux/mm.h"                // for page_address
#include "linux/mm_types.h"          // for page (ptr only), page_private
#include "linux/perf_event.h"        // for perf_output_handle, perf_aux_out...
#include "linux/sched.h"             // for perf_sw_context
#include "linux/smp.h"               // for raw_smp_processor_id
#include "linux/stddef.h"            // for offsetof

arch/x86/events/intel/bts.c should remove these lines:
- #include <linux/bitops.h>  // lines 11-11
- #include <linux/coredump.h>  // lines 16-16
- #include <linux/debugfs.h>  // lines 14-14
- #include <linux/device.h>  // lines 15-15
- #include <linux/sizes.h>  // lines 18-18

The full include-list for arch/x86/events/intel/bts.c:
#include <asm-generic/percpu.h>      // for this_cpu_ptr, per_cpu, DEFINE_PE...
#include <asm/bitops.h>              // for test_bit
#include <asm/bug.h>                 // for WARN_ON_ONCE
#include <asm/cpufeatures.h>         // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/perf_event.h>          // for ARCH_PERFMON_EVENTSEL_INT, ARCH_...
#include <linux/mm.h>                // for PagePrivate
#include <linux/slab.h>              // for kfree, kzalloc_node
#include <linux/types.h>             // for bool
#include <stddef.h>                  // for NULL, size_t
#include "../perf_event.h"           // for cpu_hw_events, x86_del_exclusive
#include "asm-generic/errno-base.h"  // for EBUSY, ENODEV, ENOSPC, EINVAL
#include "asm-generic/int-ll64.h"    // for u64, s64
#include "asm-generic/rwonce.h"      // for READ_ONCE, WRITE_ONCE
#include "asm-generic/topology.h"    // for cpu_to_node
#include "asm/barrier.h"             // for wmb
#include "asm/cmpxchg.h"             // for __xchg_wrong_size
#include "asm/cpufeature.h"          // for boot_cpu_has
#include "asm/cpufeatures.h"         // for X86_FEATURE_DTES64, X86_FEATURE_PTI
#include "asm/intel_ds.h"            // for debug_store
#include "asm/local.h"               // for local_xchg, local_add, local_read
#include "asm/page.h"                // for virt_to_page
#include "asm/page_types.h"          // for PAGE_SHIFT, PAGE_SIZE
#include "asm/string_32.h"           // for memset
#include "linux/compiler.h"          // for barrier
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/init.h"              // for __init, arch_initcall
#include "linux/mm.h"                // for page_address
#include "linux/mm_types.h"          // for page (ptr only), page_private
#include "linux/perf_event.h"        // for perf_output_handle, perf_aux_out...
#include "linux/sched.h"             // for perf_sw_context
#include "linux/smp.h"               // for raw_smp_processor_id
#include "linux/stddef.h"            // for offsetof
---
  ./scripts/check-local-export arch/x86/events/intel/bts.o
  iwyu2 -Wp,-MMD,arch/x86/events/intel/.ds.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/events/intel/ds"' -DKBUILD_BASENAME='"ds"' -DKBUILD_MODNAME='"ds"' -D__KBUILD_MODNAME=kmod_ds -c -o arch/x86/events/intel/ds.o arch/x86/events/intel/ds.c  
In file included from arch/x86/events/intel/ds.c:7:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/intel/ds.c:7:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/intel/ds.c:7:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/intel/ds.c:12:
In file included from arch/x86/events/intel/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/events/intel/ds.c:7:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/intel/ds.c:7:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/intel/ds.c:7:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/intel/ds.c:12:
In file included from arch/x86/events/intel/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/events/intel/ds.c should add these lines:
#include <asm-generic/percpu.h>         // for this_cpu_ptr, per_cpu, per_cp...
#include <asm/bitops.h>                 // for test_bit
#include <asm/bug.h>                    // for WARN_ON_ONCE, WARN_ON, WARN_ONCE
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/percpu.h>                 // for this_cpu_read_8, raw_cpu_read_8
#include <linux/bitmap.h>               // for for_each_set_bit, find_first_bit
#include <stddef.h>                     // for NULL, size_t
#include "asm-generic/errno-base.h"     // for ENOMEM
#include "asm-generic/getorder.h"       // for get_order
#include "asm-generic/int-ll64.h"       // for u64, u32, s64, u8
#include "asm-generic/local64.h"        // for local64_set, local64_add, loc...
#include "asm-generic/siginfo.h"        // for POLL_IN
#include "asm-generic/topology.h"       // for cpu_to_node
#include "asm/cpufeature.h"             // for boot_cpu_has
#include "asm/cpufeatures.h"            // for X86_FEATURE_BTS, X86_FEATURE_...
#include "asm/fpu/types.h"              // for lbr_entry
#include "asm/intel_ds.h"               // for debug_store, BTS_BUFFER_SIZE
#include "asm/msr-index.h"              // for MSR_IA32_DS_AREA, DEBUGCTLMSR...
#include "asm/msr.h"                    // for wrmsrl, wrmsr_on_cpu, rdpmcl
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/perf_regs.h"              // for PERF_REG_EXTENDED_MASK
#include "asm/pgtable_types.h"          // for PAGE_KERNEL, PAGE_NONE, pgprot_t
#include "asm/processor.h"              // for get_debugctlmsr, update_debug...
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/string_32.h"              // for memset
#include "asm/tsc.h"                    // for native_sched_clock_from_tsc
#include "asm/uaccess.h"                // for copy_from_user_nmi
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __always_inline
#include "linux/compiler_types.h"       // for inline, __user
#include "linux/container_of.h"         // for container_of
#include "linux/cpumask.h"              // for for_each_possible_cpu
#include "linux/gfp.h"                  // for GFP_KERNEL, __alloc_pages_node
#include "linux/init.h"                 // for __init
#include "linux/mm.h"                   // for page_address
#include "linux/perf_event.h"           // for PERF_MEM_S, perf_event, PERF_...
#include "linux/preempt.h"              // for preempt_disable, preempt_enable
#include "linux/printk.h"               // for pr_cont
#include "linux/rcupdate.h"             // for rcu_read_lock, rcu_read_unlock
#include "linux/smp.h"                  // for smp_processor_id
#include "linux/stddef.h"               // for true, false

arch/x86/events/intel/ds.c should remove these lines:
- #include <linux/bitops.h>  // lines 2-2

The full include-list for arch/x86/events/intel/ds.c:
#include <asm-generic/percpu.h>         // for this_cpu_ptr, per_cpu, per_cp...
#include <asm/bitops.h>                 // for test_bit
#include <asm/bug.h>                    // for WARN_ON_ONCE, WARN_ON, WARN_ONCE
#include <asm/cpu_entry_area.h>         // for get_cpu_entry_area, cea_set_pte
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/insn.h>                   // for insn, insn_get_length, insn_init
#include <asm/io.h>                     // for virt_to_phys
#include <asm/percpu.h>                 // for this_cpu_read_8, raw_cpu_read_8
#include <asm/perf_event.h>             // for INTEL_PMC_IDX_FIXED, pebs_gprs
#include <asm/tlbflush.h>               // for flush_tlb_kernel_range
#include <linux/bitmap.h>               // for for_each_set_bit, find_first_bit
#include <linux/slab.h>                 // for kfree, kzalloc_node
#include <linux/types.h>                // for bool, gfp_t, phys_addr_t
#include <stddef.h>                     // for NULL, size_t
#include "../perf_event.h"              // for cpu_hw_events, x86_pmu, INTEL...
#include "asm-generic/errno-base.h"     // for ENOMEM
#include "asm-generic/getorder.h"       // for get_order
#include "asm-generic/int-ll64.h"       // for u64, u32, s64, u8
#include "asm-generic/local64.h"        // for local64_set, local64_add, loc...
#include "asm-generic/siginfo.h"        // for POLL_IN
#include "asm-generic/topology.h"       // for cpu_to_node
#include "asm/cpufeature.h"             // for boot_cpu_has
#include "asm/cpufeatures.h"            // for X86_FEATURE_BTS, X86_FEATURE_...
#include "asm/fpu/types.h"              // for lbr_entry
#include "asm/intel_ds.h"               // for debug_store, BTS_BUFFER_SIZE
#include "asm/msr-index.h"              // for MSR_IA32_DS_AREA, DEBUGCTLMSR...
#include "asm/msr.h"                    // for wrmsrl, wrmsr_on_cpu, rdpmcl
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/perf_regs.h"              // for PERF_REG_EXTENDED_MASK
#include "asm/pgtable_types.h"          // for PAGE_KERNEL, PAGE_NONE, pgprot_t
#include "asm/processor.h"              // for get_debugctlmsr, update_debug...
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/string_32.h"              // for memset
#include "asm/tsc.h"                    // for native_sched_clock_from_tsc
#include "asm/uaccess.h"                // for copy_from_user_nmi
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __always_inline
#include "linux/compiler_types.h"       // for inline, __user
#include "linux/container_of.h"         // for container_of
#include "linux/cpumask.h"              // for for_each_possible_cpu
#include "linux/gfp.h"                  // for GFP_KERNEL, __alloc_pages_node
#include "linux/init.h"                 // for __init
#include "linux/mm.h"                   // for page_address
#include "linux/perf_event.h"           // for PERF_MEM_S, perf_event, PERF_...
#include "linux/preempt.h"              // for preempt_disable, preempt_enable
#include "linux/printk.h"               // for pr_cont
#include "linux/rcupdate.h"             // for rcu_read_lock, rcu_read_unlock
#include "linux/smp.h"                  // for smp_processor_id
#include "linux/stddef.h"               // for true, false
---
  ./scripts/check-local-export arch/x86/events/intel/ds.o
  iwyu2 -Wp,-MMD,arch/x86/events/intel/.knc.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/events/intel/knc"' -DKBUILD_BASENAME='"knc"' -DKBUILD_MODNAME='"knc"' -D__KBUILD_MODNAME=kmod_knc -c -o arch/x86/events/intel/knc.o arch/x86/events/intel/knc.c  
In file included from arch/x86/events/intel/knc.c:4:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/intel/knc.c:4:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/intel/knc.c:4:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/intel/knc.c:4:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/events/intel/knc.c:4:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/intel/knc.c:4:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/intel/knc.c:4:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/intel/knc.c:4:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/events/intel/knc.c should add these lines:
#include <asm-generic/percpu.h>    // for this_cpu_ptr
#include <asm/bitops.h>            // for test_bit
#include <asm/bug.h>               // for WARN_ONCE
#include <asm/percpu.h>            // for this_cpu_add_8
#include <linux/bitmap.h>          // for for_each_set_bit
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u64
#include "asm/msr-index.h"         // for MSR_KNC_EVNTSEL0, MSR_KNC_PERFCTR0
#include "asm/msr.h"               // for wrmsrl, wrmsrl_safe, rdmsrl
#include "asm/percpu.h"            // for __pcpu_op1_1, __pcpu_op1_2, __pcpu...
#include "asm/perf_event.h"        // for ARCH_PERFMON_EVENTSEL_ENABLE, ARCH...
#include "asm/string_32.h"         // for memcpy
#include "linux/compiler_types.h"  // for inline
#include "linux/device.h"          // for device_attribute
#include "linux/init.h"            // for __initconst, __init
#include "linux/kernel.h"          // for ARRAY_SIZE
#include "linux/perf_event.h"      // for PERF_COUNT_HW_CACHE_RESULT_ACCESS
struct pt_regs;

arch/x86/events/intel/knc.c should remove these lines:
- #include <linux/types.h>  // lines 5-5

The full include-list for arch/x86/events/intel/knc.c:
#include <asm-generic/percpu.h>    // for this_cpu_ptr
#include <asm/bitops.h>            // for test_bit
#include <asm/bug.h>               // for WARN_ONCE
#include <asm/hardirq.h>           // for (anonymous), inc_irq_stat
#include <asm/percpu.h>            // for this_cpu_add_8
#include <linux/bitmap.h>          // for for_each_set_bit
#include <linux/perf_event.h>      // for hw_perf_event, hw_perf_event::(ano...
#include <stddef.h>                // for NULL
#include "../perf_event.h"         // for C, INTEL_EVENT_CONSTRAINT, cpu_hw_...
#include "asm-generic/int-ll64.h"  // for u64
#include "asm/msr-index.h"         // for MSR_KNC_EVNTSEL0, MSR_KNC_PERFCTR0
#include "asm/msr.h"               // for wrmsrl, wrmsrl_safe, rdmsrl
#include "asm/percpu.h"            // for __pcpu_op1_1, __pcpu_op1_2, __pcpu...
#include "asm/perf_event.h"        // for ARCH_PERFMON_EVENTSEL_ENABLE, ARCH...
#include "asm/string_32.h"         // for memcpy
#include "linux/compiler_types.h"  // for inline
#include "linux/device.h"          // for device_attribute
#include "linux/init.h"            // for __initconst, __init
#include "linux/kernel.h"          // for ARRAY_SIZE
#include "linux/perf_event.h"      // for PERF_COUNT_HW_CACHE_RESULT_ACCESS
struct pt_regs;
---
  ./scripts/check-local-export arch/x86/events/intel/knc.o
  iwyu2 -Wp,-MMD,arch/x86/events/intel/.lbr.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/events/intel/lbr"' -DKBUILD_BASENAME='"lbr"' -DKBUILD_MODNAME='"lbr"' -D__KBUILD_MODNAME=kmod_lbr -c -o arch/x86/events/intel/lbr.o arch/x86/events/intel/lbr.c  
In file included from arch/x86/events/intel/lbr.c:2:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/intel/lbr.c:2:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/intel/lbr.c:2:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/intel/lbr.c:2:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/events/intel/lbr.c:2:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/intel/lbr.c:2:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/intel/lbr.c:2:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/intel/lbr.c:2:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/events/intel/lbr.c should add these lines:
#include <asm-generic/percpu.h>         // for this_cpu_ptr, per_cpu_ptr
#include <asm/bitops.h>                 // for test_bit
#include <asm/bug.h>                    // for WARN_ON_ONCE, WARN_ON
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <linux/bitops.h>               // for __ffs, fls
#include <stddef.h>                     // for NULL, size_t
#include "asm-generic/errno-base.h"     // for EINVAL
#include "asm-generic/errno.h"          // for EOPNOTSUPP
#include "asm-generic/int-ll64.h"       // for u64, u16, s64, u32, u8
#include "asm-generic/topology.h"       // for cpu_to_node
#include "asm/cpufeature.h"             // for static_cpu_has, boot_cpu_has
#include "asm/cpufeatures.h"            // for X86_FEATURE_ARCH_LBR, X86_FEA...
#include "asm/current.h"                // for current
#include "asm/fpu/types.h"              // for lbr_entry, XFEATURE_MASK_LBR
#include "asm/fpu/xstate.h"             // for xfeature_size, xsaves, xrstors
#include "asm/inat_types.h"             // for insn_byte_t
#include "asm/msr-index.h"              // for MSR_LBR_TOS, MSR_LBR_NHM_FROM
#include "asm/processor.h"              // for boot_cpu_data, cpuid, cpuinfo...
#include "asm/uaccess.h"                // for copy_from_user_nmi
#include "linux/bits.h"                 // for BIT_ULL
#include "linux/compiler_attributes.h"  // for __always_inline, fallthrough
#include "linux/compiler_types.h"       // for inline, __user
#include "linux/cpumask.h"              // for for_each_possible_cpu
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                  // for GFP_KERNEL, __GFP_ZERO
#include "linux/init.h"                 // for __init
#include "linux/jump_label.h"           // for static_branch_enable, DEFINE_...
#include "linux/kernel.h"               // for kernel_text_address
#include "linux/minmax.h"               // for swap
#include "linux/perf_event.h"           // for perf_branch_entry, PERF_BR_UN...
#include "linux/printk.h"               // for pr_cont
#include "linux/sched.h"                // for task_struct
#include "linux/slab.h"                 // for kmem_cache_alloc_node, kmem_c...
#include "linux/smp.h"                  // for smp_processor_id
#include "linux/stddef.h"               // for false, true

arch/x86/events/intel/lbr.c should remove these lines:

The full include-list for arch/x86/events/intel/lbr.c:
#include <asm-generic/percpu.h>         // for this_cpu_ptr, per_cpu_ptr
#include <asm/bitops.h>                 // for test_bit
#include <asm/bug.h>                    // for WARN_ON_ONCE, WARN_ON
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/insn.h>                   // for insn, MAX_INSN_SIZE, insn_field
#include <asm/msr.h>                    // for wrmsrl, rdmsrl, wrmsrl_safe
#include <asm/perf_event.h>             // for cpuid28_eax, cpuid28_ebx, cpu...
#include <linux/bitops.h>               // for __ffs, fls
#include <linux/perf_event.h>           // for perf_event, perf_event_context
#include <linux/types.h>                // for bool
#include <stddef.h>                     // for NULL, size_t
#include "../perf_event.h"              // for x86_pmu, cpu_hw_events, task_...
#include "asm-generic/errno-base.h"     // for EINVAL
#include "asm-generic/errno.h"          // for EOPNOTSUPP
#include "asm-generic/int-ll64.h"       // for u64, u16, s64, u32, u8
#include "asm-generic/topology.h"       // for cpu_to_node
#include "asm/cpufeature.h"             // for static_cpu_has, boot_cpu_has
#include "asm/cpufeatures.h"            // for X86_FEATURE_ARCH_LBR, X86_FEA...
#include "asm/current.h"                // for current
#include "asm/fpu/types.h"              // for lbr_entry, XFEATURE_MASK_LBR
#include "asm/fpu/xstate.h"             // for xfeature_size, xsaves, xrstors
#include "asm/inat_types.h"             // for insn_byte_t
#include "asm/msr-index.h"              // for MSR_LBR_TOS, MSR_LBR_NHM_FROM
#include "asm/processor.h"              // for boot_cpu_data, cpuid, cpuinfo...
#include "asm/uaccess.h"                // for copy_from_user_nmi
#include "linux/bits.h"                 // for BIT_ULL
#include "linux/compiler_attributes.h"  // for __always_inline, fallthrough
#include "linux/compiler_types.h"       // for inline, __user
#include "linux/cpumask.h"              // for for_each_possible_cpu
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                  // for GFP_KERNEL, __GFP_ZERO
#include "linux/init.h"                 // for __init
#include "linux/jump_label.h"           // for static_branch_enable, DEFINE_...
#include "linux/kernel.h"               // for kernel_text_address
#include "linux/minmax.h"               // for swap
#include "linux/perf_event.h"           // for perf_branch_entry, PERF_BR_UN...
#include "linux/printk.h"               // for pr_cont
#include "linux/sched.h"                // for task_struct
#include "linux/slab.h"                 // for kmem_cache_alloc_node, kmem_c...
#include "linux/smp.h"                  // for smp_processor_id
#include "linux/stddef.h"               // for false, true
---
  ./scripts/check-local-export arch/x86/events/intel/lbr.o
  iwyu2 -Wp,-MMD,arch/x86/events/intel/.p4.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/events/intel/p4"' -DKBUILD_BASENAME='"p4"' -DKBUILD_MODNAME='"p4"' -D__KBUILD_MODNAME=kmod_p4 -c -o arch/x86/events/intel/p4.o arch/x86/events/intel/p4.c  
In file included from arch/x86/events/intel/p4.c:10:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/intel/p4.c:10:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/intel/p4.c:10:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/intel/p4.c:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/events/intel/p4.c:10:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/intel/p4.c:10:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/intel/p4.c:10:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/intel/p4.c:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/events/intel/p4.c should add these lines:
#include <asm-generic/percpu.h>                      // for this_cpu_ptr
#include <asm/bitops.h>                              // for test_bit, __set_bit
#include <asm/bug.h>                                 // for WARN_ON_ONCE
#include <asm/percpu.h>                              // for this_cpu_add_8
#include <linux/build_bug.h>                         // for unlikely
#include <stddef.h>                                  // for NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit
#include "asm-generic/errno-base.h"                  // for EINVAL, ENODEV
#include "asm-generic/int-ll64.h"                    // for u64, u32
#include "asm/apicdef.h"                             // for APIC_DM_NMI, API...
#include "asm/msr-index.h"                           // for MSR_P4_FSB_ESCR1
#include "asm/msr.h"                                 // for wrmsrl_safe, wrmsrl
#include "asm/percpu.h"                              // for __pcpu_op1_1
#include "asm/perf_event.h"                          // for X86_PMC_IDX_MAX
#include "asm/processor.h"                           // for boot_cpu_data
#include "asm/string_32.h"                           // for memcpy
#include "linux/bitmap.h"                            // for bitmap_zero
#include "linux/bitops.h"                            // for BITS_TO_LONGS
#include "linux/build_bug.h"                         // for BUILD_BUG_ON
#include "linux/compiler_types.h"                    // for inline
#include "linux/device.h"                            // for device_attribute
#include "linux/init.h"                              // for __initconst, __init
#include "linux/kernel.h"                            // for ARRAY_SIZE
#include "linux/perf_event.h"                        // for PERF_COUNT_HW_CA...
#include "linux/printk.h"                            // for pr_cont
#include "linux/smp.h"                               // for smp_processor_id
#include "linux/stddef.h"                            // for false, true
#include "linux/types.h"                             // for bool
struct pt_regs;

arch/x86/events/intel/p4.c should remove these lines:

The full include-list for arch/x86/events/intel/p4.c:
#include <asm-generic/percpu.h>                      // for this_cpu_ptr
#include <asm/apic.h>                                // for apic_write
#include <asm/bitops.h>                              // for test_bit, __set_bit
#include <asm/bug.h>                                 // for WARN_ON_ONCE
#include <asm/hardirq.h>                             // for (anonymous), inc...
#include <asm/percpu.h>                              // for this_cpu_add_8
#include <asm/perf_event_p4.h>                       // for P4_ESCR_EMASK_BIT
#include <linux/build_bug.h>                         // for unlikely
#include <linux/perf_event.h>                        // for hw_perf_event
#include <stddef.h>                                  // for NULL
#include "../perf_event.h"                           // for C, cpu_hw_events
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit
#include "asm-generic/errno-base.h"                  // for EINVAL, ENODEV
#include "asm-generic/int-ll64.h"                    // for u64, u32
#include "asm/apicdef.h"                             // for APIC_DM_NMI, API...
#include "asm/msr-index.h"                           // for MSR_P4_FSB_ESCR1
#include "asm/msr.h"                                 // for wrmsrl_safe, wrmsrl
#include "asm/percpu.h"                              // for __pcpu_op1_1
#include "asm/perf_event.h"                          // for X86_PMC_IDX_MAX
#include "asm/processor.h"                           // for boot_cpu_data
#include "asm/string_32.h"                           // for memcpy
#include "linux/bitmap.h"                            // for bitmap_zero
#include "linux/bitops.h"                            // for BITS_TO_LONGS
#include "linux/build_bug.h"                         // for BUILD_BUG_ON
#include "linux/compiler_types.h"                    // for inline
#include "linux/device.h"                            // for device_attribute
#include "linux/init.h"                              // for __initconst, __init
#include "linux/kernel.h"                            // for ARRAY_SIZE
#include "linux/perf_event.h"                        // for PERF_COUNT_HW_CA...
#include "linux/printk.h"                            // for pr_cont
#include "linux/smp.h"                               // for smp_processor_id
#include "linux/stddef.h"                            // for false, true
#include "linux/types.h"                             // for bool
struct pt_regs;
---
  ./scripts/check-local-export arch/x86/events/intel/p4.o
  iwyu2 -Wp,-MMD,arch/x86/events/intel/.p6.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/events/intel/p6"' -DKBUILD_BASENAME='"p6"' -DKBUILD_MODNAME='"p6"' -D__KBUILD_MODNAME=kmod_p6 -c -o arch/x86/events/intel/p6.o arch/x86/events/intel/p6.c  
In file included from arch/x86/events/intel/p6.c:2:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/intel/p6.c:2:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/intel/p6.c:2:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/intel/p6.c:2:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/events/intel/p6.c:2:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/intel/p6.c:2:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/intel/p6.c:2:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/intel/p6.c:2:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/events/intel/p6.c should add these lines:
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for ENODEV
#include "asm-generic/int-ll64.h"    // for u64
#include "asm/msr-index.h"           // for MSR_P6_EVNTSEL0, MSR_P6_PERFCTR0
#include "asm/msr.h"                 // for wrmsrl, wrmsrl_safe, rdmsrl
#include "asm/perf_event.h"          // for ARCH_PERFMON_EVENTSEL_ENABLE
#include "asm/processor.h"           // for boot_cpu_data, cpuinfo_x86
#include "asm/string_32.h"           // for memcpy
#include "linux/compiler_types.h"    // for inline
#include "linux/device.h"            // for device_attribute
#include "linux/init.h"              // for __init, __initconst
#include "linux/kernel.h"            // for ARRAY_SIZE
#include "linux/perf_event.h"        // for PERF_COUNT_HW_CACHE_RESULT_ACCESS
#include "linux/printk.h"            // for pr_cont, pr_warn

arch/x86/events/intel/p6.c should remove these lines:
- #include <linux/types.h>  // lines 3-3

The full include-list for arch/x86/events/intel/p6.c:
#include <linux/perf_event.h>        // for PMU_FORMAT_ATTR, hw_perf_event
#include <stddef.h>                  // for NULL
#include "../perf_event.h"           // for C, INTEL_EVENT_CONSTRAINT, x86_pmu
#include "asm-generic/errno-base.h"  // for ENODEV
#include "asm-generic/int-ll64.h"    // for u64
#include "asm/msr-index.h"           // for MSR_P6_EVNTSEL0, MSR_P6_PERFCTR0
#include "asm/msr.h"                 // for wrmsrl, wrmsrl_safe, rdmsrl
#include "asm/perf_event.h"          // for ARCH_PERFMON_EVENTSEL_ENABLE
#include "asm/processor.h"           // for boot_cpu_data, cpuinfo_x86
#include "asm/string_32.h"           // for memcpy
#include "linux/compiler_types.h"    // for inline
#include "linux/device.h"            // for device_attribute
#include "linux/init.h"              // for __init, __initconst
#include "linux/kernel.h"            // for ARRAY_SIZE
#include "linux/perf_event.h"        // for PERF_COUNT_HW_CACHE_RESULT_ACCESS
#include "linux/printk.h"            // for pr_cont, pr_warn
---
  ./scripts/check-local-export arch/x86/events/intel/p6.o
  iwyu2 -Wp,-MMD,arch/x86/events/intel/.pt.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/events/intel/pt"' -DKBUILD_BASENAME='"pt"' -DKBUILD_MODNAME='"pt"' -D__KBUILD_MODNAME=kmod_pt -c -o arch/x86/events/intel/pt.o arch/x86/events/intel/pt.c  
In file included from arch/x86/events/intel/pt.c:19:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/intel/pt.c:19:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/intel/pt.c:19:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/intel/pt.c:27:
In file included from arch/x86/events/intel/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/events/intel/pt.c:19:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/intel/pt.c:19:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/intel/pt.c:19:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/intel/pt.c:27:
In file included from arch/x86/events/intel/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/events/intel/pt.h should add these lines:
#include <stddef.h>                // for size_t
#include "asm-generic/int-ll64.h"  // for u64, u32
#include "asm-generic/local64.h"   // for local64_t
#include "asm/intel_pt.h"          // for PT_CPUID_LEAVES, PT_CPUID_REGS_NUM
#include "asm/local.h"             // for local_t
#include "linux/compiler_types.h"  // for inline
#include "linux/perf_event.h"      // for perf_output_handle, pmu
#include "linux/types.h"           // for bool, list_head

arch/x86/events/intel/pt.h should remove these lines:

The full include-list for arch/x86/events/intel/pt.h:
#include <stddef.h>                // for size_t
#include "asm-generic/int-ll64.h"  // for u64, u32
#include "asm-generic/local64.h"   // for local64_t
#include "asm/intel_pt.h"          // for PT_CPUID_LEAVES, PT_CPUID_REGS_NUM
#include "asm/local.h"             // for local_t
#include "linux/compiler_types.h"  // for inline
#include "linux/perf_event.h"      // for perf_output_handle, pmu
#include "linux/types.h"           // for bool, list_head
---

arch/x86/events/intel/pt.c should add these lines:
#include <asm-generic/percpu.h>      // for this_cpu_ptr, DEFINE_PER_CPU
#include <asm/bug.h>                 // for WARN_ON_ONCE, BUG_ON
#include <asm/cpufeatures.h>         // for REQUIRED_MASK0, REQUIRED_MASK1
#include <linux/bitops.h>            // for __ffs
#include <linux/mm.h>                // for PagePrivate
#include <cstdio>                    // for NULL, size_t, ssize_t
#include "asm-generic/errno-base.h"  // for ENOMEM, EINVAL, EBUSY, ENODEV
#include "asm-generic/errno.h"       // for EOPNOTSUPP
#include "asm-generic/rwonce.h"      // for READ_ONCE, WRITE_ONCE
#include "asm-generic/topology.h"    // for cpu_to_node
#include "asm/barrier.h"             // for wmb
#include "asm/cmpxchg.h"             // for __xchg_wrong_size
#include "asm/cpufeature.h"          // for boot_cpu_has
#include "asm/cpufeatures.h"         // for X86_FEATURE_INTEL_PT, X86_FEATUR...
#include "asm/msr-index.h"           // for RTIT_CTL_TRACEEN, RTIT_CTL_BRANC...
#include "asm/msr.h"                 // for wrmsrl, rdmsrl, rdmsrl_safe_on_cpu
#include "asm/page.h"                // for virt_to_page
#include "asm/page_types.h"          // for PAGE_SHIFT, PAGE_SIZE, PAGE_MASK
#include "asm/processor.h"           // for CPUID_EBX, CPUID_ECX, CPUID_EAX
#include "asm/string_32.h"           // for memcpy, memset
#include "linux/build_bug.h"         // for BUILD_BUG_ON
#include "linux/cache.h"             // for __ro_after_init
#include "linux/container_of.h"      // for container_of
#include "linux/cpu.h"               // for cpus_read_lock, cpus_read_unlock
#include "linux/cpumask.h"           // for for_each_online_cpu
#include "linux/errno.h"             // for ENOTSUPP
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"               // for GFP_KERNEL, alloc_pages_node
#include "linux/init.h"              // for __init, arch_initcall
#include "linux/irqflags.h"          // for local_irq_restore, local_irq_save
#include "linux/kernel.h"            // for sprintf, ARRAY_SIZE, snprintf
#include "linux/list.h"              // for list_for_each_entry, INIT_LIST_HEAD
#include "linux/mm.h"                // for offset_in_page, page_address
#include "linux/mm_types.h"          // for page_private
#include "linux/path.h"              // for path
#include "linux/pfn.h"               // for PFN_DOWN
#include "linux/printk.h"            // for pr_debug, pr_warn, pr_err_rateli...
#include "linux/sched.h"             // for perf_sw_context
#include "linux/smp.h"               // for raw_smp_processor_id
#include "linux/stat.h"              // for S_IRUGO
#include "linux/stddef.h"            // for false, true
#include "linux/stringify.h"         // for __stringify
#include "linux/sysfs.h"             // for attribute_group, attribute, sysf...
#include "vdso/bits.h"               // for BIT
#include "vdso/limits.h"             // for ULONG_MAX

arch/x86/events/intel/pt.c should remove these lines:
- #include <asm/insn.h>  // lines 22-22
- #include <linux/bits.h>  // lines 16-16
- #include <linux/limits.h>  // lines 17-17

The full include-list for arch/x86/events/intel/pt.c:
#include "pt.h"
#include <asm-generic/percpu.h>      // for this_cpu_ptr, DEFINE_PER_CPU
#include <asm/bug.h>                 // for WARN_ON_ONCE, BUG_ON
#include <asm/cpufeatures.h>         // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/intel-family.h>        // for INTEL_FAM6_BROADWELL, INTEL_FAM6...
#include <asm/intel_pt.h>            // for PT_CAP_topa_multiple_entries
#include <asm/io.h>                  // for page_to_phys, phys_to_virt, virt...
#include <asm/perf_event.h>          // for intel_pt_handle_vmx
#include <linux/bitops.h>            // for __ffs
#include <linux/device.h>            // for device_attribute, dev_ext_attribute
#include <linux/mm.h>                // for PagePrivate
#include <linux/slab.h>              // for kfree, kzalloc, kzalloc_node
#include <linux/types.h>             // for list_head, bool, gfp_t, phys_addr_t
#include <cstdio>                    // for NULL, size_t, ssize_t
#include "../perf_event.h"           // for x86_add_exclusive, x86_del_exclu...
#include "asm-generic/errno-base.h"  // for ENOMEM, EINVAL, EBUSY, ENODEV
#include "asm-generic/errno.h"       // for EOPNOTSUPP
#include "asm-generic/rwonce.h"      // for READ_ONCE, WRITE_ONCE
#include "asm-generic/topology.h"    // for cpu_to_node
#include "asm/barrier.h"             // for wmb
#include "asm/cmpxchg.h"             // for __xchg_wrong_size
#include "asm/cpufeature.h"          // for boot_cpu_has
#include "asm/cpufeatures.h"         // for X86_FEATURE_INTEL_PT, X86_FEATUR...
#include "asm/msr-index.h"           // for RTIT_CTL_TRACEEN, RTIT_CTL_BRANC...
#include "asm/msr.h"                 // for wrmsrl, rdmsrl, rdmsrl_safe_on_cpu
#include "asm/page.h"                // for virt_to_page
#include "asm/page_types.h"          // for PAGE_SHIFT, PAGE_SIZE, PAGE_MASK
#include "asm/processor.h"           // for CPUID_EBX, CPUID_ECX, CPUID_EAX
#include "asm/string_32.h"           // for memcpy, memset
#include "linux/build_bug.h"         // for BUILD_BUG_ON
#include "linux/cache.h"             // for __ro_after_init
#include "linux/container_of.h"      // for container_of
#include "linux/cpu.h"               // for cpus_read_lock, cpus_read_unlock
#include "linux/cpumask.h"           // for for_each_online_cpu
#include "linux/errno.h"             // for ENOTSUPP
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"               // for GFP_KERNEL, alloc_pages_node
#include "linux/init.h"              // for __init, arch_initcall
#include "linux/irqflags.h"          // for local_irq_restore, local_irq_save
#include "linux/kernel.h"            // for sprintf, ARRAY_SIZE, snprintf
#include "linux/list.h"              // for list_for_each_entry, INIT_LIST_HEAD
#include "linux/mm.h"                // for offset_in_page, page_address
#include "linux/mm_types.h"          // for page_private
#include "linux/path.h"              // for path
#include "linux/pfn.h"               // for PFN_DOWN
#include "linux/printk.h"            // for pr_debug, pr_warn, pr_err_rateli...
#include "linux/sched.h"             // for perf_sw_context
#include "linux/smp.h"               // for raw_smp_processor_id
#include "linux/stat.h"              // for S_IRUGO
#include "linux/stddef.h"            // for false, true
#include "linux/stringify.h"         // for __stringify
#include "linux/sysfs.h"             // for attribute_group, attribute, sysf...
#include "vdso/bits.h"               // for BIT
#include "vdso/limits.h"             // for ULONG_MAX
---
  ./scripts/check-local-export arch/x86/events/intel/pt.o
  rm -f arch/x86/events/intel/built-in.a; echo core.o bts.o ds.o knc.o lbr.o p4.o p6.o pt.o | sed -E 's:([^ ]+):arch/x86/events/intel/:g' | xargs llvm-ar cDPrST arch/x86/events/intel/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/events/zhaoxin \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,arch/x86/events/zhaoxin/.core.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/events/zhaoxin/core"' -DKBUILD_BASENAME='"core"' -DKBUILD_MODNAME='"core"' -D__KBUILD_MODNAME=kmod_core -c -o arch/x86/events/zhaoxin/core.o arch/x86/events/zhaoxin/core.c  
In file included from arch/x86/events/zhaoxin/core.c:19:
In file included from arch/x86/events/zhaoxin/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/zhaoxin/core.c:19:
In file included from arch/x86/events/zhaoxin/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/zhaoxin/core.c:19:
In file included from arch/x86/events/zhaoxin/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/zhaoxin/core.c:19:
In file included from arch/x86/events/zhaoxin/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/events/zhaoxin/core.c:19:
In file included from arch/x86/events/zhaoxin/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/zhaoxin/core.c:19:
In file included from arch/x86/events/zhaoxin/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/zhaoxin/core.c:19:
In file included from arch/x86/events/zhaoxin/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/zhaoxin/core.c:19:
In file included from arch/x86/events/zhaoxin/../perf_event.h:15:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/events/zhaoxin/core.c should add these lines:
#include <asm-generic/percpu.h>      // for this_cpu_ptr
#include <asm/bitops.h>              // for __test_and_clear_bit, test_bit
#include <asm/percpu.h>              // for this_cpu_add_8
#include <linux/bitmap.h>            // for for_each_set_bit
#include <linux/build_bug.h>         // for unlikely
#include <cstdio>                    // for NULL, ssize_t
#include "asm-generic/errno-base.h"  // for ENODEV
#include "asm-generic/int-ll64.h"    // for u64
#include "asm/apicdef.h"             // for APIC_DM_NMI, APIC_LVTPC
#include "asm/cache.h"               // for __read_mostly
#include "asm/msr-index.h"           // for MSR_CORE_PERF_GLOBAL_CTRL, MSR_C...
#include "asm/msr.h"                 // for wrmsrl, rdmsrl
#include "asm/percpu.h"              // for __pcpu_op1_1, __pcpu_op1_2, __pc...
#include "asm/perf_event.h"          // for cpuid10_eax, cpuid10_eax::(anony...
#include "asm/processor.h"           // for boot_cpu_data, cpuinfo_x86, cpuid
#include "asm/string_32.h"           // for memcpy
#include "linux/compiler_types.h"    // for inline
#include "linux/device.h"            // for device_attribute
#include "linux/kernel.h"            // for ARRAY_SIZE
#include "linux/perf_event.h"        // for PERF_COUNT_HW_CACHE_RESULT_ACCESS
#include "linux/printk.h"            // for pr_cont, pr_info, pr_warn
struct pt_regs;

arch/x86/events/zhaoxin/core.c should remove these lines:
- #include <asm/cpufeature.h>  // lines 15-15
- #include <linux/export.h>  // lines 12-12
- #include <linux/nmi.h>  // lines 13-13
- #include <linux/slab.h>  // lines 11-11
- #include <linux/stddef.h>  // lines 8-8
- #include <linux/types.h>  // lines 9-9

The full include-list for arch/x86/events/zhaoxin/core.c:
#include <asm-generic/percpu.h>      // for this_cpu_ptr
#include <asm/apic.h>                // for apic_write
#include <asm/bitops.h>              // for __test_and_clear_bit, test_bit
#include <asm/hardirq.h>             // for (anonymous), inc_irq_stat
#include <asm/percpu.h>              // for this_cpu_add_8
#include <linux/bitmap.h>            // for for_each_set_bit
#include <linux/build_bug.h>         // for unlikely
#include <linux/init.h>              // for __initconst, __init
#include <cstdio>                    // for NULL, ssize_t
#include "../perf_event.h"           // for C, x86_pmu, event_constraint
#include "asm-generic/errno-base.h"  // for ENODEV
#include "asm-generic/int-ll64.h"    // for u64
#include "asm/apicdef.h"             // for APIC_DM_NMI, APIC_LVTPC
#include "asm/cache.h"               // for __read_mostly
#include "asm/msr-index.h"           // for MSR_CORE_PERF_GLOBAL_CTRL, MSR_C...
#include "asm/msr.h"                 // for wrmsrl, rdmsrl
#include "asm/percpu.h"              // for __pcpu_op1_1, __pcpu_op1_2, __pc...
#include "asm/perf_event.h"          // for cpuid10_eax, cpuid10_eax::(anony...
#include "asm/processor.h"           // for boot_cpu_data, cpuinfo_x86, cpuid
#include "asm/string_32.h"           // for memcpy
#include "linux/compiler_types.h"    // for inline
#include "linux/device.h"            // for device_attribute
#include "linux/kernel.h"            // for ARRAY_SIZE
#include "linux/perf_event.h"        // for PERF_COUNT_HW_CACHE_RESULT_ACCESS
#include "linux/printk.h"            // for pr_cont, pr_info, pr_warn
struct pt_regs;
---
  ./scripts/check-local-export arch/x86/events/zhaoxin/core.o
  rm -f arch/x86/events/zhaoxin/built-in.a; echo core.o | sed -E 's:([^ ]+):arch/x86/events/zhaoxin/:g' | xargs llvm-ar cDPrST arch/x86/events/zhaoxin/built-in.a
  iwyu2 -Wp,-MMD,arch/x86/events/.core.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/events/core"' -DKBUILD_BASENAME='"core"' -DKBUILD_MODNAME='"core"' -D__KBUILD_MODNAME=kmod_core -c -o arch/x86/events/core.o arch/x86/events/core.c  
In file included from arch/x86/events/core.c:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/core.c:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/core.c:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/core.c:15:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/events/core.c:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/events/core.c:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/events/core.c:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/events/core.c:15:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/events/core.c should add these lines:
#include <asm-generic/percpu.h>                // for this_cpu_ptr, per_cpu
#include <asm/bitops.h>                        // for test_bit, __clear_bit
#include <asm/bug.h>                           // for WARN_ON_ONCE, WARN_ON
#include <asm/cpufeatures.h>                   // for REQUIRED_MASK0, REQUIR...
#include <asm/percpu.h>                        // for raw_cpu_read_8, raw_cp...
#include <asm/uaccess.h>                       // for __access_ok
#include <linux/bitmap.h>                      // for for_each_set_bit_from
#include <linux/build_bug.h>                   // for unlikely, barrier
#include <cstdio>                              // for NULL, ssize_t, size_t
#include "asm-generic/bitops/const_hweight.h"  // for hweight64
#include "asm-generic/errno-base.h"            // for EINVAL, ENOENT, EBUSY
#include "asm-generic/errno.h"                 // for EOPNOTSUPP
#include "asm-generic/int-ll64.h"              // for u64, u32, s64, u8
#include "asm-generic/kprobes.h"               // for NOKPROBE_SYMBOL
#include "asm-generic/local64.h"               // for local64_set, local64_read
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "asm/apicdef.h"                       // for APIC_DM_NMI, APIC_LVTPC
#include "asm/cache.h"                         // for __read_mostly
#include "asm/cpu.h"                           // for get_this_hybrid_cpu_type
#include "asm/cpufeature.h"                    // for boot_cpu_has
#include "asm/cpufeatures.h"                   // for X86_FEATURE_APIC, X86_...
#include "asm/current.h"                       // for current
#include "asm/desc_defs.h"                     // for desc_struct
#include "asm/hardirq.h"                       // for (anonymous), inc_irq_stat
#include "asm/mmu.h"                           // for mm_context_t
#include "asm/msr-index.h"                     // for MSR_CORE_PERF_GLOBAL_CTRL
#include "asm/msr.h"                           // for wrmsrl, rdmsrl_safe
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/percpu.h"                        // for __pcpu_op2_1, __pcpu_o...
#include "asm/perf_event.h"                    // for INTEL_PMC_IDX_FIXED
#include "asm/perf_regs.h"                     // for PERF_REG_EXTENDED_MASK
#include "asm/processor-flags.h"               // for X86_VM_MASK, X86_EFLAG...
#include "asm/processor.h"                     // for X86_VENDOR_AMD, X86_VE...
#include "asm/ptrace.h"                        // for pt_regs, user_mode
#include "asm/segment.h"                       // for GDT_ENTRIES, SEGMENT_LDT
#include "asm/string_32.h"                     // for strchr, memcpy, memset
#include "asm/topology.h"                      // for topology_max_smt_threads
#include "asm/uaccess.h"                       // for __get_user
#include "linux/atomic/atomic-instrumented.h"  // for atomic_inc, atomic_dec
#include "linux/bitmap.h"                      // for bitmap_empty, bitmap_zero
#include "linux/bits.h"                        // for BIT_ULL
#include "linux/cache.h"                       // for __ro_after_init
#include "linux/compiler_attributes.h"         // for fallthrough
#include "linux/compiler_types.h"              // for inline, __user
#include "linux/container_of.h"                // for container_of
#include "linux/cpuhotplug.h"                  // for cpuhp_remove_state
#include "linux/cpumask.h"                     // for cpumask_empty, cpumask...
#include "linux/err.h"                         // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/errno.h"                       // for ENOTSUPP
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/irqflags.h"                    // for local_irq_restore, loc...
#include "linux/jump_label.h"                  // for DEFINE_STATIC_KEY_FALSE
#include "linux/kernel.h"                      // for sprintf, snprintf, ARR...
#include "linux/kstrtox.h"                     // for kstrtoul
#include "linux/lockdep.h"                     // for lockdep_assert_irqs_di...
#include "linux/minmax.h"                      // for max, min
#include "linux/mm_types.h"                    // for mm_cpumask, mm_struct
#include "linux/mmap_lock.h"                   // for mmap_assert_write_locked
#include "linux/mutex.h"                       // for mutex_unlock, mutex
#include "linux/perf_event.h"                  // for perf_event (ptr only)
#include "linux/printk.h"                      // for pr_info, pr_cont, pr_err
#include "linux/smp.h"                         // for on_each_cpu_mask, smp_...
#include "linux/stat.h"                        // for S_IRUSR, S_IWUSR
#include "linux/static_call_types.h"           // for static_call
#include "linux/stddef.h"                      // for false, true
#include "linux/sysfs.h"                       // for attribute_group, attri...
#include "linux/types.h"                       // for bool, atomic_t, list_head
struct kobject;

arch/x86/events/core.c should remove these lines:
- #include <asm/alternative.h>  // lines 37-37
- #include <asm/ldt.h>  // lines 42-42
- #include <asm/smp.h>  // lines 36-36
- #include <linux/bitops.h>  // lines 28-28
- #include <linux/capability.h>  // lines 16-16
- #include <linux/cpu.h>  // lines 27-27
- #include <linux/hardirq.h>  // lines 18-18
- #include <linux/kdebug.h>  // lines 22-22
- #include <linux/kprobes.h>  // lines 19-19
- #include <linux/notifier.h>  // lines 17-17
- #include <linux/sched/mm.h>  // lines 23-23

The full include-list for arch/x86/events/core.c:
#include <asm-generic/percpu.h>                // for this_cpu_ptr, per_cpu
#include <asm/apic.h>                          // for apic_write
#include <asm/bitops.h>                        // for test_bit, __clear_bit
#include <asm/bug.h>                           // for WARN_ON_ONCE, WARN_ON
#include <asm/cpufeatures.h>                   // for REQUIRED_MASK0, REQUIR...
#include <asm/desc.h>                          // for gdt_page, get_desc_base
#include <asm/mmu_context.h>                   // for cr4_update_pce
#include <asm/nmi.h>                           // for nmiaction, NMI_DONE
#include <asm/percpu.h>                        // for raw_cpu_read_8, raw_cp...
#include <asm/stacktrace.h>                    // for stack_frame
#include <asm/timer.h>                         // for cyc2ns_data, cyc2ns_re...
#include <asm/tlbflush.h>                      // for nmi_uaccess_okay
#include <asm/uaccess.h>                       // for __access_ok
#include <asm/unwind.h>                        // for unwind_start, unwind_done
#include <linux/bitmap.h>                      // for for_each_set_bit_from
#include <linux/build_bug.h>                   // for unlikely, barrier
#include <linux/device.h>                      // for dev_get_drvdata, devic...
#include <linux/export.h>                      // for EXPORT_SYMBOL_GPL
#include <linux/init.h>                        // for __init, early_initcall
#include <linux/nospec.h>                      // for array_index_nospec
#include <linux/perf_event.h>                  // for perf_event, hw_perf_event
#include <linux/sched/clock.h>                 // for sched_clock, sched_clo...
#include <linux/slab.h>                        // for kfree, kzalloc
#include <linux/static_call.h>                 // for static_call_update
#include <linux/uaccess.h>                     // for pagefault_disable, pag...
#include <cstdio>                              // for NULL, ssize_t, size_t
#include "asm-generic/bitops/const_hweight.h"  // for hweight64
#include "asm-generic/errno-base.h"            // for EINVAL, ENOENT, EBUSY
#include "asm-generic/errno.h"                 // for EOPNOTSUPP
#include "asm-generic/int-ll64.h"              // for u64, u32, s64, u8
#include "asm-generic/kprobes.h"               // for NOKPROBE_SYMBOL
#include "asm-generic/local64.h"               // for local64_set, local64_read
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "asm/apicdef.h"                       // for APIC_DM_NMI, APIC_LVTPC
#include "asm/cache.h"                         // for __read_mostly
#include "asm/cpu.h"                           // for get_this_hybrid_cpu_type
#include "asm/cpufeature.h"                    // for boot_cpu_has
#include "asm/cpufeatures.h"                   // for X86_FEATURE_APIC, X86_...
#include "asm/current.h"                       // for current
#include "asm/desc_defs.h"                     // for desc_struct
#include "asm/hardirq.h"                       // for (anonymous), inc_irq_stat
#include "asm/mmu.h"                           // for mm_context_t
#include "asm/msr-index.h"                     // for MSR_CORE_PERF_GLOBAL_CTRL
#include "asm/msr.h"                           // for wrmsrl, rdmsrl_safe
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/percpu.h"                        // for __pcpu_op2_1, __pcpu_o...
#include "asm/perf_event.h"                    // for INTEL_PMC_IDX_FIXED
#include "asm/perf_regs.h"                     // for PERF_REG_EXTENDED_MASK
#include "asm/processor-flags.h"               // for X86_VM_MASK, X86_EFLAG...
#include "asm/processor.h"                     // for X86_VENDOR_AMD, X86_VE...
#include "asm/ptrace.h"                        // for pt_regs, user_mode
#include "asm/segment.h"                       // for GDT_ENTRIES, SEGMENT_LDT
#include "asm/string_32.h"                     // for strchr, memcpy, memset
#include "asm/topology.h"                      // for topology_max_smt_threads
#include "asm/uaccess.h"                       // for __get_user
#include "linux/atomic/atomic-instrumented.h"  // for atomic_inc, atomic_dec
#include "linux/bitmap.h"                      // for bitmap_empty, bitmap_zero
#include "linux/bits.h"                        // for BIT_ULL
#include "linux/cache.h"                       // for __ro_after_init
#include "linux/compiler_attributes.h"         // for fallthrough
#include "linux/compiler_types.h"              // for inline, __user
#include "linux/container_of.h"                // for container_of
#include "linux/cpuhotplug.h"                  // for cpuhp_remove_state
#include "linux/cpumask.h"                     // for cpumask_empty, cpumask...
#include "linux/err.h"                         // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/errno.h"                       // for ENOTSUPP
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/irqflags.h"                    // for local_irq_restore, loc...
#include "linux/jump_label.h"                  // for DEFINE_STATIC_KEY_FALSE
#include "linux/kernel.h"                      // for sprintf, snprintf, ARR...
#include "linux/kstrtox.h"                     // for kstrtoul
#include "linux/lockdep.h"                     // for lockdep_assert_irqs_di...
#include "linux/minmax.h"                      // for max, min
#include "linux/mm_types.h"                    // for mm_cpumask, mm_struct
#include "linux/mmap_lock.h"                   // for mmap_assert_write_locked
#include "linux/mutex.h"                       // for mutex_unlock, mutex
#include "linux/perf_event.h"                  // for perf_event (ptr only)
#include "linux/printk.h"                      // for pr_info, pr_cont, pr_err
#include "linux/smp.h"                         // for on_each_cpu_mask, smp_...
#include "linux/stat.h"                        // for S_IRUSR, S_IWUSR
#include "linux/static_call_types.h"           // for static_call
#include "linux/stddef.h"                      // for false, true
#include "linux/sysfs.h"                       // for attribute_group, attri...
#include "linux/types.h"                       // for bool, atomic_t, list_head
#include "perf_event.h"                        // for cpu_hw_events, x86_pmu
struct kobject;
---
  ./scripts/check-local-export arch/x86/events/core.o
  iwyu2 -Wp,-MMD,arch/x86/events/.probe.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/events/probe"' -DKBUILD_BASENAME='"probe"' -DKBUILD_MODNAME='"probe"' -D__KBUILD_MODNAME=kmod_probe -c -o arch/x86/events/probe.o arch/x86/events/probe.c  

arch/x86/events/probe.h should add these lines:
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u64
#include "linux/types.h"           // for bool

arch/x86/events/probe.h should remove these lines:
- #include <linux/sysfs.h>  // lines 4-4

The full include-list for arch/x86/events/probe.h:
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u64
#include "linux/types.h"           // for bool
---

arch/x86/events/probe.c should add these lines:
#include "asm-generic/bitsperlong.h"  // for BITS_PER_LONG
#include "asm/msr.h"                  // for rdmsrl_safe
#include "linux/sysfs.h"              // for attribute_group, attribute (ptr...
#include "vdso/bits.h"                // for BIT
struct kobject;

arch/x86/events/probe.c should remove these lines:
- #include <linux/bits.h>  // lines 4-4

The full include-list for arch/x86/events/probe.c:
#include "probe.h"
#include <linux/export.h>             // for EXPORT_SYMBOL_GPL
#include <linux/types.h>              // for bool, umode_t
#include "asm-generic/bitsperlong.h"  // for BITS_PER_LONG
#include "asm/msr.h"                  // for rdmsrl_safe
#include "linux/sysfs.h"              // for attribute_group, attribute (ptr...
#include "vdso/bits.h"                // for BIT
struct kobject;
---
  ./scripts/check-local-export arch/x86/events/probe.o
  rm -f arch/x86/events/built-in.a; echo core.o probe.o amd/built-in.a intel/built-in.a zhaoxin/built-in.a | sed -E 's:([^ ]+):arch/x86/events/:g' | xargs llvm-ar cDPrST arch/x86/events/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/realmode \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,arch/x86/realmode/.init.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/realmode/init"' -DKBUILD_BASENAME='"init"' -DKBUILD_MODNAME='"init"' -D__KBUILD_MODNAME=kmod_init -c -o arch/x86/realmode/init.o arch/x86/realmode/init.c  

arch/x86/realmode/init.c should add these lines:
#include <asm/bug.h>                 // for WARN_ON
#include <asm/pgtable.h>             // for initial_page_table
#include <stddef.h>                  // for size_t
#include "asm-generic/int-ll64.h"    // for u32, u16
#include "asm-generic/set_memory.h"  // for set_memory_nx, set_memory_ro
#include "asm/page.h"                // for __pa, __pa_symbol, __va
#include "asm/page_types.h"          // for PAGE_SHIFT, PAGE_SIZE
#include "asm/pgtable_types.h"       // for pgd_t
#include "asm/processor.h"           // for load_cr3
#include "asm/segment.h"             // for __BOOT_DS
#include "asm/string_32.h"           // for memcpy
#include "linux/init.h"              // for __init, early_initcall
#include "linux/mm.h"                // for PAGE_ALIGN
#include "linux/panic.h"             // for panic
#include "linux/printk.h"            // for pr_info
#include "linux/sizes.h"             // for SZ_1M
#include "linux/types.h"             // for phys_addr_t

arch/x86/realmode/init.c should remove these lines:
- #include <asm/crash.h>  // lines 11-11
- #include <asm/sev.h>  // lines 12-12
- #include <linux/io.h>  // lines 2-2
- #include <linux/pgtable.h>  // lines 6-6

The full include-list for arch/x86/realmode/init.c:
#include <asm/bug.h>                 // for WARN_ON
#include <asm/pgtable.h>             // for initial_page_table
#include <asm/realmode.h>            // for real_mode_header, real_mode_blob
#include <asm/set_memory.h>          // for set_memory_decrypted
#include <asm/tlbflush.h>            // for __flush_tlb_all
#include <linux/cc_platform.h>       // for cc_platform_has, CC_ATTR_HOST_ME...
#include <linux/memblock.h>          // for memblock_phys_alloc_range, membl...
#include <linux/slab.h>              // for slab_is_available
#include <stddef.h>                  // for size_t
#include "asm-generic/int-ll64.h"    // for u32, u16
#include "asm-generic/set_memory.h"  // for set_memory_nx, set_memory_ro
#include "asm/page.h"                // for __pa, __pa_symbol, __va
#include "asm/page_types.h"          // for PAGE_SHIFT, PAGE_SIZE
#include "asm/pgtable_types.h"       // for pgd_t
#include "asm/processor.h"           // for load_cr3
#include "asm/segment.h"             // for __BOOT_DS
#include "asm/string_32.h"           // for memcpy
#include "linux/init.h"              // for __init, early_initcall
#include "linux/mm.h"                // for PAGE_ALIGN
#include "linux/panic.h"             // for panic
#include "linux/printk.h"            // for pr_info
#include "linux/sizes.h"             // for SZ_1M
#include "linux/types.h"             // for phys_addr_t
---
  ./scripts/check-local-export arch/x86/realmode/init.o
make -f ./scripts/Makefile.build obj=arch/x86/realmode/rm arch/x86/realmode/rm/realmode.bin
  iwyu2 -Wp,-MMD,arch/x86/realmode/rm/.header.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -D_WAKEUP -I./arch/x86/boot -D__ASSEMBLY__    -c -o arch/x86/realmode/rm/header.o arch/x86/realmode/rm/header.S 
  ./scripts/check-local-export arch/x86/realmode/rm/header.o
  iwyu2 -Wp,-MMD,arch/x86/realmode/rm/.trampoline_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -D_WAKEUP -I./arch/x86/boot -D__ASSEMBLY__    -c -o arch/x86/realmode/rm/trampoline_32.o arch/x86/realmode/rm/trampoline_32.S 
  ./scripts/check-local-export arch/x86/realmode/rm/trampoline_32.o
  iwyu2 -Wp,-MMD,arch/x86/realmode/rm/.stack.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -D_WAKEUP -I./arch/x86/boot -D__ASSEMBLY__    -c -o arch/x86/realmode/rm/stack.o arch/x86/realmode/rm/stack.S 
  ./scripts/check-local-export arch/x86/realmode/rm/stack.o
  iwyu2 -Wp,-MMD,arch/x86/realmode/rm/.reboot.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -D_WAKEUP -I./arch/x86/boot -D__ASSEMBLY__    -c -o arch/x86/realmode/rm/reboot.o arch/x86/realmode/rm/reboot.S 
  ./scripts/check-local-export arch/x86/realmode/rm/reboot.o
  llvm-nm arch/x86/realmode/rm/header.o arch/x86/realmode/rm/trampoline_32.o arch/x86/realmode/rm/stack.o arch/x86/realmode/rm/reboot.o | sed -n -r -e 's/^([0-9a-fA-F]+) [ABCDGRSTVW] (.+)$/pa_ = ;/p' | sort | uniq > arch/x86/realmode/rm/pasyms.h
  iwyu2 -E -Wp,-MMD,arch/x86/realmode/rm/.realmode.lds.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./=  -P -C -I./arch/x86/realmode/rm -P -Ux86 -D__ASSEMBLY__ -DLINKER_SCRIPT -o arch/x86/realmode/rm/realmode.lds arch/x86/realmode/rm/realmode.lds.S
  ld.lld -m elf_i386 -mllvm -import-instr-limit=5  -m elf_i386 --emit-relocs -T arch/x86/realmode/rm/realmode.lds arch/x86/realmode/rm/header.o arch/x86/realmode/rm/trampoline_32.o arch/x86/realmode/rm/stack.o arch/x86/realmode/rm/reboot.o -o arch/x86/realmode/rm/realmode.elf
  arch/x86/tools/relocs --realmode arch/x86/realmode/rm/realmode.elf > arch/x86/realmode/rm/realmode.relocs
  llvm-objcopy  -O binary arch/x86/realmode/rm/realmode.elf arch/x86/realmode/rm/realmode.bin
  iwyu2 -Wp,-MMD,arch/x86/realmode/.rmpiggy.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -D__ASSEMBLY__ -fno-PIE --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -m32 -fno-lto    -c -o arch/x86/realmode/rmpiggy.o arch/x86/realmode/rmpiggy.S 
  ./scripts/check-local-export arch/x86/realmode/rmpiggy.o
  rm -f arch/x86/realmode/built-in.a; echo init.o rmpiggy.o | sed -E 's:([^ ]+):arch/x86/realmode/:g' | xargs llvm-ar cDPrST arch/x86/realmode/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/kernel \
 \
need-builtin=1 \
need-modorder=1
make -f ./scripts/Makefile.build obj=arch/x86/kernel/fpu \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,arch/x86/kernel/fpu/.init.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/fpu/init"' -DKBUILD_BASENAME='"init"' -DKBUILD_MODNAME='"init"' -D__KBUILD_MODNAME=kmod_init -c -o arch/x86/kernel/fpu/init.o arch/x86/kernel/fpu/init.c  

arch/x86/kernel/fpu/init.c should add these lines:
#include <asm/bitops.h>            // for test_bit
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include "asm-generic/int-ll64.h"  // for u16
#include "asm/cpufeature.h"        // for boot_cpu_has, setup_clear_cpu_cap
#include "asm/cpufeatures.h"       // for X86_FEATURE_FPU, X86_FEATURE_FXSR
#include "asm/current.h"           // for current
#include "asm/fpu/types.h"         // for fpu, fpu_state_config, fpstate
#include "asm/processor-flags.h"   // for X86_CR0_EM, X86_CR0_TS, X86_CR4_OS...
#include "asm/processor.h"         // for thread_struct, boot_cpu_data, cpui...
#include "asm/special_insns.h"     // for read_cr0, write_cr0
#include "linux/align.h"           // for ALIGN
#include "linux/build_bug.h"       // for BUILD_BUG_ON
#include "linux/cache.h"           // for __ro_after_init
#include "linux/export.h"          // for EXPORT_SYMBOL_GPL
#include "linux/printk.h"          // for pr_emerg, pr_info
#include "linux/stddef.h"          // for offsetof, offsetofend
#include "linux/types.h"           // for bool
struct fpu__init_task_struct_size::;
struct fpu__init_task_struct_size::;
struct fpu__init_task_struct_size::;
struct fpu__init_task_struct_size::;
struct fpu__init_task_struct_size::;
struct fpu__init_task_struct_size::;

arch/x86/kernel/fpu/init.c should remove these lines:
- #include <asm/setup.h>  // lines 7-7
- #include "legacy.h"  // lines 14-14

The full include-list for arch/x86/kernel/fpu/init.c:
#include <asm/bitops.h>            // for test_bit
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/fpu/api.h>           // for fpu__init_cpu, fpu__init_system
#include <asm/tlbflush.h>          // for cr4_set_bits
#include <linux/init.h>            // for __init, __initdata
#include <linux/sched.h>           // for task_struct
#include <linux/sched/task.h>      // for arch_task_struct_size
#include "asm-generic/int-ll64.h"  // for u16
#include "asm/cpufeature.h"        // for boot_cpu_has, setup_clear_cpu_cap
#include "asm/cpufeatures.h"       // for X86_FEATURE_FPU, X86_FEATURE_FXSR
#include "asm/current.h"           // for current
#include "asm/fpu/types.h"         // for fpu, fpu_state_config, fpstate
#include "asm/processor-flags.h"   // for X86_CR0_EM, X86_CR0_TS, X86_CR4_OS...
#include "asm/processor.h"         // for thread_struct, boot_cpu_data, cpui...
#include "asm/special_insns.h"     // for read_cr0, write_cr0
#include "internal.h"              // for fpstate_reset, fpstate_init_user
#include "linux/align.h"           // for ALIGN
#include "linux/build_bug.h"       // for BUILD_BUG_ON
#include "linux/cache.h"           // for __ro_after_init
#include "linux/export.h"          // for EXPORT_SYMBOL_GPL
#include "linux/printk.h"          // for pr_emerg, pr_info
#include "linux/stddef.h"          // for offsetof, offsetofend
#include "linux/types.h"           // for bool
#include "xstate.h"                // for fpu__init_cpu_xstate, fpu__init_sy...
struct fpu__init_task_struct_size::;
struct fpu__init_task_struct_size::;
struct fpu__init_task_struct_size::;
struct fpu__init_task_struct_size::;
struct fpu__init_task_struct_size::;
struct fpu__init_task_struct_size::;
---
  ./scripts/check-local-export arch/x86/kernel/fpu/init.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/fpu/.bugs.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/fpu/bugs"' -DKBUILD_BASENAME='"bugs"' -DKBUILD_MODNAME='"bugs"' -D__KBUILD_MODNAME=kmod_bugs -c -o arch/x86/kernel/fpu/bugs.o arch/x86/kernel/fpu/bugs.c  

arch/x86/kernel/fpu/bugs.c should add these lines:
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include "asm-generic/int-ll64.h"  // for s32
#include "asm/cpufeature.h"        // for boot_cpu_has, set_cpu_bug
#include "asm/cpufeatures.h"       // for X86_BUG_FDIV, X86_FEATURE_FPU
#include "asm/processor.h"         // for boot_cpu_data
#include "linux/init.h"            // for __initdata, __init
#include "linux/printk.h"          // for pr_warn

arch/x86/kernel/fpu/bugs.c should remove these lines:

The full include-list for arch/x86/kernel/fpu/bugs.c:
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/fpu/api.h>           // for kernel_fpu_begin, kernel_fpu_end
#include "asm-generic/int-ll64.h"  // for s32
#include "asm/cpufeature.h"        // for boot_cpu_has, set_cpu_bug
#include "asm/cpufeatures.h"       // for X86_BUG_FDIV, X86_FEATURE_FPU
#include "asm/processor.h"         // for boot_cpu_data
#include "linux/init.h"            // for __initdata, __init
#include "linux/printk.h"          // for pr_warn
---
  ./scripts/check-local-export arch/x86/kernel/fpu/bugs.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/fpu/.core.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/fpu/core"' -DKBUILD_BASENAME='"core"' -DKBUILD_MODNAME='"core"' -D__KBUILD_MODNAME=kmod_core -c -o arch/x86/kernel/fpu/core.o arch/x86/kernel/fpu/core.c  
In file included from arch/x86/kernel/fpu/core.c:11:
In file included from ./arch/x86/include/asm/fpu/sched.h:10:
In file included from ./arch/x86/include/asm/trace/fpu.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/fpu/core.c:11:
In file included from ./arch/x86/include/asm/fpu/sched.h:10:
In file included from ./arch/x86/include/asm/trace/fpu.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/fpu/core.c:11:
In file included from ./arch/x86/include/asm/fpu/sched.h:10:
In file included from ./arch/x86/include/asm/trace/fpu.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/fpu/core.c:14:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/kernel/fpu/core.c:11:
In file included from ./arch/x86/include/asm/fpu/sched.h:10:
In file included from ./arch/x86/include/asm/trace/fpu.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/fpu/core.c:11:
In file included from ./arch/x86/include/asm/fpu/sched.h:10:
In file included from ./arch/x86/include/asm/trace/fpu.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/fpu/core.c:11:
In file included from ./arch/x86/include/asm/fpu/sched.h:10:
In file included from ./arch/x86/include/asm/trace/fpu.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/fpu/core.c:14:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/fpu/core.c should add these lines:
#include <asm-generic/percpu.h>    // for this_cpu_read, DEFINE_PER_CPU, thi...
#include <asm/bug.h>               // for WARN_ON_ONCE
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/percpu.h>            // for this_cpu_read_8, this_cpu_write_8
#include "asm-generic/int-ll64.h"  // for u64
#include "asm-generic/siginfo.h"   // for FPE_FLTDIV, FPE_FLTINV, FPE_FLTOVF
#include "asm/asm.h"               // for _ASM_EXTABLE
#include "asm/cpufeature.h"        // for boot_cpu_has, cpu_feature_enabled
#include "asm/cpufeatures.h"       // for X86_FEATURE_FPU, X86_FEATURE_FXSR
#include "asm/current.h"           // for current
#include "asm/fpu/xstate.h"        // for fpu_state_size_dynamic, XFEATURE_M...
#include "asm/percpu.h"            // for __pcpu_op2_1, __pcpu_op2_2, __pcpu...
#include "asm/pkru.h"              // for pkru_write_default
#include "asm/processor.h"         // for thread_struct, fpu_thread_struct_w...
#include "asm/string_32.h"         // for memcpy
#include "asm/thread_info.h"       // for TIF_NEED_FPU_LOAD
#include "asm/trapnr.h"            // for X86_TRAP_MF
#include "linux/build_bug.h"       // for BUILD_BUG_ON
#include "linux/cache.h"           // for __ro_after_init
#include "linux/compiler.h"        // for likely, unlikely
#include "linux/compiler_types.h"  // for inline
#include "linux/export.h"          // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include "linux/jiffies.h"         // for jiffies
#include "linux/kconfig.h"         // for IS_ENABLED
#include "linux/preempt.h"         // for preempt_disable, preempt_enable
#include "linux/sched.h"           // for task_struct, set_tsk_thread_flag
#include "linux/sched/signal.h"    // for sighand_struct
#include "linux/smp.h"             // for smp_processor_id
#include "linux/spinlock.h"        // for spin_lock_irq, spin_unlock_irq
#include "linux/stddef.h"          // for false, true, offsetof
#include "linux/thread_info.h"     // for test_thread_flag, set_thread_flag
#include "linux/types.h"           // for bool

arch/x86/kernel/fpu/core.c should remove these lines:
- #include <asm/fpu/regset.h>  // lines 10-10
- #include <asm/irq_regs.h>  // lines 15-15
- #include <asm/traps.h>  // lines 14-14
- #include <linux/hardirq.h>  // lines 19-19
- #include <linux/pkeys.h>  // lines 20-20
- #include <linux/vmalloc.h>  // lines 21-21
- #include <uapi/asm/kvm.h>  // lines 17-17

The full include-list for arch/x86/kernel/fpu/core.c:
#include <asm-generic/percpu.h>    // for this_cpu_read, DEFINE_PER_CPU, thi...
#include <asm/bug.h>               // for WARN_ON_ONCE
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/fpu/api.h>           // for fpregs_unlock, fpregs_lock, fpstat...
#include <asm/fpu/sched.h>         // for fpu__drop, fpu_clone, fpu_flush_th...
#include <asm/fpu/signal.h>        // for fpu__clear_user_states, restore_fp...
#include <asm/fpu/types.h>         // for fpstate, fpu, fpregs_state, fpu_st...
#include <asm/percpu.h>            // for this_cpu_read_8, this_cpu_write_8
#include <asm/trace/fpu.h>         // for trace_x86_fpu_after_save, trace_x8...
#include "asm-generic/int-ll64.h"  // for u64
#include "asm-generic/siginfo.h"   // for FPE_FLTDIV, FPE_FLTINV, FPE_FLTOVF
#include "asm/asm.h"               // for _ASM_EXTABLE
#include "asm/cpufeature.h"        // for boot_cpu_has, cpu_feature_enabled
#include "asm/cpufeatures.h"       // for X86_FEATURE_FPU, X86_FEATURE_FXSR
#include "asm/current.h"           // for current
#include "asm/fpu/xstate.h"        // for fpu_state_size_dynamic, XFEATURE_M...
#include "asm/percpu.h"            // for __pcpu_op2_1, __pcpu_op2_2, __pcpu...
#include "asm/pkru.h"              // for pkru_write_default
#include "asm/processor.h"         // for thread_struct, fpu_thread_struct_w...
#include "asm/string_32.h"         // for memcpy
#include "asm/thread_info.h"       // for TIF_NEED_FPU_LOAD
#include "asm/trapnr.h"            // for X86_TRAP_MF
#include "context.h"               // for fpregs_restore_userregs, __cpu_inv...
#include "internal.h"              // for use_xsave, use_fxsr, WARN_ON_FPU
#include "legacy.h"                // for frstor, fxrstor, fxsave, ldmxcsr
#include "linux/build_bug.h"       // for BUILD_BUG_ON
#include "linux/cache.h"           // for __ro_after_init
#include "linux/compiler.h"        // for likely, unlikely
#include "linux/compiler_types.h"  // for inline
#include "linux/export.h"          // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include "linux/jiffies.h"         // for jiffies
#include "linux/kconfig.h"         // for IS_ENABLED
#include "linux/preempt.h"         // for preempt_disable, preempt_enable
#include "linux/sched.h"           // for task_struct, set_tsk_thread_flag
#include "linux/sched/signal.h"    // for sighand_struct
#include "linux/smp.h"             // for smp_processor_id
#include "linux/spinlock.h"        // for spin_lock_irq, spin_unlock_irq
#include "linux/stddef.h"          // for false, true, offsetof
#include "linux/thread_info.h"     // for test_thread_flag, set_thread_flag
#include "linux/types.h"           // for bool
#include "xstate.h"                // for os_xrstor, os_xrstor_supervisor
---
  ./scripts/check-local-export arch/x86/kernel/fpu/core.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/fpu/.regset.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/fpu/regset"' -DKBUILD_BASENAME='"regset"' -DKBUILD_MODNAME='"regset"' -D__KBUILD_MODNAME=kmod_regset -c -o arch/x86/kernel/fpu/regset.o arch/x86/kernel/fpu/regset.c  
In file included from arch/x86/kernel/fpu/regset.c:12:
In file included from arch/x86/kernel/fpu/context.h:6:
In file included from ./arch/x86/include/asm/trace/fpu.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/fpu/regset.c:12:
In file included from arch/x86/kernel/fpu/context.h:6:
In file included from ./arch/x86/include/asm/trace/fpu.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/fpu/regset.c:12:
In file included from arch/x86/kernel/fpu/context.h:6:
In file included from ./arch/x86/include/asm/trace/fpu.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/kernel/fpu/regset.c:12:
In file included from arch/x86/kernel/fpu/context.h:6:
In file included from ./arch/x86/include/asm/trace/fpu.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/fpu/regset.c:12:
In file included from arch/x86/kernel/fpu/context.h:6:
In file included from ./arch/x86/include/asm/trace/fpu.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/fpu/regset.c:12:
In file included from arch/x86/kernel/fpu/context.h:6:
In file included from ./arch/x86/include/asm/trace/fpu.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/kernel/fpu/regset.c should add these lines:
#include <asm/cpufeatures.h>         // for REQUIRED_MASK0, REQUIRED_MASK1
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for ENODEV, EINVAL, EFAULT, ENOMEM
#include "asm-generic/int-ll64.h"    // for u32, __u16, u16
#include "asm/cpufeature.h"          // for cpu_feature_enabled, boot_cpu_has
#include "asm/cpufeatures.h"         // for X86_FEATURE_FXSR, X86_FEATURE_XSAVE
#include "asm/current.h"             // for current
#include "asm/fpu/types.h"           // for fxregs_state, fpu, fpregs_state
#include "asm/processor.h"           // for thread_struct
#include "asm/sigcontext.h"          // for _fpxreg, _fpreg
#include "asm/string_32.h"           // for memcpy, memset
#include "asm/thread_info.h"         // for in_ia32_syscall
#include "asm/user_32.h"             // for user_i387_struct
#include "linux/build_bug.h"         // for BUILD_BUG_ON
#include "linux/compiler_types.h"    // for __user, inline
#include "linux/regset.h"            // for membuf_write, user_regset_copyin
#include "linux/sched.h"             // for task_struct
#include "linux/uaccess.h"           // for copy_from_user

arch/x86/kernel/fpu/regset.c should remove these lines:
- #include <linux/sched/task_stack.h>  // lines 5-5

The full include-list for arch/x86/kernel/fpu/regset.c:
#include <asm/cpufeatures.h>         // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/fpu/api.h>             // for fpu_sync_fpstate
#include <asm/fpu/regset.h>          // for fpregs_soft_get, fpregs_soft_set
#include <asm/fpu/signal.h>          // for user_i387_ia32_struct, convert_f...
#include <linux/vmalloc.h>           // for vfree, vmalloc
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for ENODEV, EINVAL, EFAULT, ENOMEM
#include "asm-generic/int-ll64.h"    // for u32, __u16, u16
#include "asm/cpufeature.h"          // for cpu_feature_enabled, boot_cpu_has
#include "asm/cpufeatures.h"         // for X86_FEATURE_FXSR, X86_FEATURE_XSAVE
#include "asm/current.h"             // for current
#include "asm/fpu/types.h"           // for fxregs_state, fpu, fpregs_state
#include "asm/processor.h"           // for thread_struct
#include "asm/sigcontext.h"          // for _fpxreg, _fpreg
#include "asm/string_32.h"           // for memcpy, memset
#include "asm/thread_info.h"         // for in_ia32_syscall
#include "asm/user_32.h"             // for user_i387_struct
#include "context.h"                 // for __fpu_invalidate_fpregs_state
#include "internal.h"                // for use_xsave, WARN_ON_FPU
#include "legacy.h"                  // for mxcsr_feature_mask
#include "linux/build_bug.h"         // for BUILD_BUG_ON
#include "linux/compiler_types.h"    // for __user, inline
#include "linux/regset.h"            // for membuf_write, user_regset_copyin
#include "linux/sched.h"             // for task_struct
#include "linux/uaccess.h"           // for copy_from_user
#include "xstate.h"                  // for copy_xstate_to_uabi_buf, copy_ua...
---
  ./scripts/check-local-export arch/x86/kernel/fpu/regset.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/fpu/.signal.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/fpu/signal"' -DKBUILD_BASENAME='"signal"' -DKBUILD_MODNAME='"signal"' -D__KBUILD_MODNAME=kmod_signal -c -o arch/x86/kernel/fpu/signal.o arch/x86/kernel/fpu/signal.c  
In file included from arch/x86/kernel/fpu/signal.c:7:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/fpu/signal.c:7:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/fpu/signal.c:7:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/kernel/fpu/signal.c:7:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/fpu/signal.c:7:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/fpu/signal.c:7:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/kernel/fpu/signal.c should add these lines:
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for __u32, u32, u64, __u16
#include "asm/cpufeature.h"        // for cpu_feature_enabled, static_cpu_has
#include "asm/cpufeatures.h"       // for X86_FEATURE_FPU
#include "asm/current.h"           // for current
#include "asm/fpu/api.h"           // for fpregs_unlock, fpregs_lock, fpregs...
#include "asm/fpu/types.h"         // for fregs_state, xregs_state, fpstate
#include "asm/processor.h"         // for thread_struct
#include "asm/sigcontext.h"        // for _fpx_sw_bytes, _fpstate_32, FP_XST...
#include "asm/thread_info.h"       // for TIF_NEED_FPU_LOAD
#include "asm/uaccess.h"           // for __clear_user, __put_user, __get_user
#include "asm/user_32.h"           // for user_i387_struct
#include "generated/autoconf.h"    // for CONFIG_X86_32
#include "linux/compiler.h"        // for likely, unlikely
#include "linux/compiler_types.h"  // for __user, inline
#include "linux/init.h"            // for __init
#include "linux/kconfig.h"         // for IS_ENABLED, __ARG_PLACEHOLDER_1
#include "linux/math.h"            // for round_down
#include "linux/regset.h"          // for membuf
#include "linux/sched.h"           // for task_struct
#include "linux/stddef.h"          // for false, true
#include "linux/thread_info.h"     // for test_thread_flag, set_thread_flag
#include "linux/types.h"           // for bool
#include "linux/uaccess.h"         // for __copy_from_user, __copy_to_user

arch/x86/kernel/fpu/signal.c should remove these lines:
- #include <asm/fpu/xstate.h>  // lines 12-12
- #include <asm/sigframe.h>  // lines 14-14
- #include <linux/compat.h>  // lines 6-6
- #include <linux/cpu.h>  // lines 7-7

The full include-list for arch/x86/kernel/fpu/signal.c:
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/fpu/regset.h>        // for fpregs_soft_get, fpregs_soft_set
#include <asm/fpu/signal.h>        // for fpu__clear_user_states, user_i387_...
#include <asm/trace/fpu.h>         // for trace_x86_fpu_xstate_check_failed
#include <asm/trapnr.h>            // for X86_TRAP_PF
#include <linux/pagemap.h>         // for fault_in_readable
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for __u32, u32, u64, __u16
#include "asm/cpufeature.h"        // for cpu_feature_enabled, static_cpu_has
#include "asm/cpufeatures.h"       // for X86_FEATURE_FPU
#include "asm/current.h"           // for current
#include "asm/fpu/api.h"           // for fpregs_unlock, fpregs_lock, fpregs...
#include "asm/fpu/types.h"         // for fregs_state, xregs_state, fpstate
#include "asm/processor.h"         // for thread_struct
#include "asm/sigcontext.h"        // for _fpx_sw_bytes, _fpstate_32, FP_XST...
#include "asm/thread_info.h"       // for TIF_NEED_FPU_LOAD
#include "asm/uaccess.h"           // for __clear_user, __put_user, __get_user
#include "asm/user_32.h"           // for user_i387_struct
#include "context.h"               // for __cpu_invalidate_fpregs_state, __f...
#include "generated/autoconf.h"    // for CONFIG_X86_32
#include "internal.h"              // for use_xsave, use_fxsr, init_fpstate
#include "legacy.h"                // for fxrstor_from_user_sigframe, fnsave...
#include "linux/compiler.h"        // for likely, unlikely
#include "linux/compiler_types.h"  // for __user, inline
#include "linux/init.h"            // for __init
#include "linux/kconfig.h"         // for IS_ENABLED, __ARG_PLACEHOLDER_1
#include "linux/math.h"            // for round_down
#include "linux/regset.h"          // for membuf
#include "linux/sched.h"           // for task_struct
#include "linux/stddef.h"          // for false, true
#include "linux/thread_info.h"     // for test_thread_flag, set_thread_flag
#include "linux/types.h"           // for bool
#include "linux/uaccess.h"         // for __copy_from_user, __copy_to_user
#include "xstate.h"                // for xfeatures_mask_supervisor, copy_si...
---
  ./scripts/check-local-export arch/x86/kernel/fpu/signal.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/fpu/.xstate.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/fpu/xstate"' -DKBUILD_BASENAME='"xstate"' -DKBUILD_MODNAME='"xstate"' -D__KBUILD_MODNAME=kmod_xstate -c -o arch/x86/kernel/fpu/xstate.o arch/x86/kernel/fpu/xstate.c  
In file included from arch/x86/kernel/fpu/xstate.c:9:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/fpu/xstate.c:9:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/fpu/xstate.c:9:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/kernel/fpu/xstate.c:9:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/fpu/xstate.c:9:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/fpu/xstate.c:9:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/kernel/fpu/xstate.h should add these lines:
#include <asm/cpufeatures.h>          // for REQUIRED_MASK0, REQUIRED_MASK1
#include "asm-generic/errno-base.h"   // for EPERM
#include "asm-generic/int-ll64.h"     // for u64, u32
#include "asm-generic/rwonce.h"       // for READ_ONCE
#include "asm/alternative.h"          // for ALTERNATIVE, ALTERNATIVE_3, alt...
#include "asm/asm.h"                  // for _ASM_EXTABLE_TYPE, _ASM_EXTABLE...
#include "asm/cpufeatures.h"          // for X86_FEATURE_XSAVES, X86_FEATURE...
#include "asm/current.h"              // for current
#include "asm/extable_fixup_types.h"  // for EX_TYPE_FAULT_MCE_SAFE, EX_TYPE...
#include "asm/fpu/types.h"            // for fpstate, fpu_state_perm, fpregs...
#include "asm/processor.h"            // for thread_struct
#include "asm/smap.h"                 // for clac, stac
#include "internal.h"                 // for WARN_ON_FPU
#include "linux/compiler_types.h"     // for inline, __user, __force
#include "linux/sched.h"              // for task_struct
#include "linux/stddef.h"             // for false, true
#include "linux/types.h"              // for bool

arch/x86/kernel/fpu/xstate.h should remove these lines:

The full include-list for arch/x86/kernel/fpu/xstate.h:
#include <asm/cpufeature.h>           // for cpu_feature_enabled
#include <asm/cpufeatures.h>          // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/fpu/xcr.h>              // for xfeatures_in_use
#include <asm/fpu/xstate.h>           // for fpu_state_size_dynamic, XFEATUR...
#include "asm-generic/errno-base.h"   // for EPERM
#include "asm-generic/int-ll64.h"     // for u64, u32
#include "asm-generic/rwonce.h"       // for READ_ONCE
#include "asm/alternative.h"          // for ALTERNATIVE, ALTERNATIVE_3, alt...
#include "asm/asm.h"                  // for _ASM_EXTABLE_TYPE, _ASM_EXTABLE...
#include "asm/cpufeatures.h"          // for X86_FEATURE_XSAVES, X86_FEATURE...
#include "asm/current.h"              // for current
#include "asm/extable_fixup_types.h"  // for EX_TYPE_FAULT_MCE_SAFE, EX_TYPE...
#include "asm/fpu/types.h"            // for fpstate, fpu_state_perm, fpregs...
#include "asm/processor.h"            // for thread_struct
#include "asm/smap.h"                 // for clac, stac
#include "internal.h"                 // for WARN_ON_FPU
#include "linux/compiler_types.h"     // for inline, __user, __force
#include "linux/sched.h"              // for task_struct
#include "linux/stddef.h"             // for false, true
#include "linux/types.h"              // for bool
struct membuf;  // lines 41-41
---

arch/x86/kernel/fpu/xstate.c should add these lines:
#include <asm/bug.h>                    // for WARN_ONCE, WARN_ON_ONCE, WARN_ON
#include <linux/bitmap.h>               // for for_each_set_bit_from
#include <linux/build_bug.h>            // for unlikely
#include <stddef.h>                     // for NULL
#include "asm-generic/bitops/fls64.h"   // for fls64
#include "asm-generic/errno.h"          // for EOPNOTSUPP
#include "asm/cpufeature.h"             // for cpu_feature_enabled, boot_cpu...
#include "asm/fpu/xstate.h"             // for XSTATE_CPUID, XFEATURE_MASK_U...
#include "asm/msr-index.h"              // for MSR_IA32_XSS, MSR_IA32_XFD
#include "asm/msr.h"                    // for wrmsrl
#include "asm/processor-flags.h"        // for X86_CR4_OSXSAVE
#include "asm/string_32.h"              // for memcpy, memset
#include "asm/uaccess.h"                // for put_user
#include "linux/align.h"                // for ALIGN
#include "linux/bits.h"                 // for BIT_ULL
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/init.h"                 // for __init, __initdata
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kernel.h"               // for ARRAY_SIZE
#include "linux/minmax.h"               // for min
#include "linux/printk.h"               // for pr_info, pr_err, pr_warn
#include "linux/regset.h"               // for membuf_write, membuf_zero
#include "linux/string.h"               // for memchr_inv
#include "linux/stringify.h"            // for __stringify
#include "linux/uaccess.h"              // for copy_from_user
#include "vdso/bits.h"                  // for BIT

arch/x86/kernel/fpu/xstate.c should remove these lines:
- #include <asm/elf.h>  // lines 24-24
- #include <asm/fpu/regset.h>  // lines 18-18
- #include <asm/fpu/signal.h>  // lines 19-19
- #include <linux/bitops.h>  // lines 7-7
- #include <linux/compat.h>  // lines 8-8
- #include <linux/cpu.h>  // lines 9-9
- #include <linux/mman.h>  // lines 10-10
- #include <linux/nospec.h>  // lines 11-11
- #include <linux/pkeys.h>  // lines 12-12
- #include <linux/proc_fs.h>  // lines 14-14
- #include <linux/seq_file.h>  // lines 13-13
- #include <linux/vmalloc.h>  // lines 15-15
- #include "context.h"  // lines 26-26

The full include-list for arch/x86/kernel/fpu/xstate.c:
#include "xstate.h"
#include <asm/bug.h>                    // for WARN_ONCE, WARN_ON_ONCE, WARN_ON
#include <asm/fpu/api.h>                // for cpu_has_xfeatures, fpu__resum...
#include <asm/fpu/xcr.h>                // for xsetbv, XCR_XFEATURE_ENABLED_...
#include <asm/prctl.h>                  // for ARCH_GET_XCOMP_GUEST_PERM
#include <asm/tlbflush.h>               // for cr4_clear_bits, cr4_set_bits
#include <linux/bitmap.h>               // for for_each_set_bit_from
#include <linux/build_bug.h>            // for unlikely
#include <stddef.h>                     // for NULL
#include "asm-generic/bitops/fls64.h"   // for fls64
#include "asm-generic/errno.h"          // for EOPNOTSUPP
#include "asm/cpufeature.h"             // for cpu_feature_enabled, boot_cpu...
#include "asm/fpu/xstate.h"             // for XSTATE_CPUID, XFEATURE_MASK_U...
#include "asm/msr-index.h"              // for MSR_IA32_XSS, MSR_IA32_XFD
#include "asm/msr.h"                    // for wrmsrl
#include "asm/processor-flags.h"        // for X86_CR4_OSXSAVE
#include "asm/string_32.h"              // for memcpy, memset
#include "asm/uaccess.h"                // for put_user
#include "internal.h"                   // for init_fpstate, fpstate_reset
#include "legacy.h"                     // for fxsave, mxcsr_feature_mask
#include "linux/align.h"                // for ALIGN
#include "linux/bits.h"                 // for BIT_ULL
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/init.h"                 // for __init, __initdata
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kernel.h"               // for ARRAY_SIZE
#include "linux/minmax.h"               // for min
#include "linux/printk.h"               // for pr_info, pr_err, pr_warn
#include "linux/regset.h"               // for membuf_write, membuf_zero
#include "linux/string.h"               // for memchr_inv
#include "linux/stringify.h"            // for __stringify
#include "linux/uaccess.h"              // for copy_from_user
#include "vdso/bits.h"                  // for BIT
---
  ./scripts/check-local-export arch/x86/kernel/fpu/xstate.o
  rm -f arch/x86/kernel/fpu/built-in.a; echo init.o bugs.o core.o regset.o signal.o xstate.o | sed -E 's:([^ ]+):arch/x86/kernel/fpu/:g' | xargs llvm-ar cDPrST arch/x86/kernel/fpu/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/kernel/cpu \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.cacheinfo.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/cacheinfo"' -DKBUILD_BASENAME='"cacheinfo"' -DKBUILD_MODNAME='"cacheinfo"' -D__KBUILD_MODNAME=kmod_cacheinfo -c -o arch/x86/kernel/cpu/cacheinfo.o arch/x86/kernel/cpu/cacheinfo.c  
In file included from arch/x86/kernel/cpu/cacheinfo.c:17:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^
2 warnings generated.
In file included from arch/x86/kernel/cpu/cacheinfo.c:17:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^

arch/x86/kernel/cpu/cacheinfo.c should add these lines:
#include <asm-generic/percpu.h>         // for per_cpu, __this_cpu_read
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/percpu.h>                 // for raw_cpu_read_8
#include "asm-generic/errno-base.h"     // for EINVAL, EIO, ENOENT
#include "asm-generic/int-ll64.h"       // for u32, u16
#include "asm/cpufeatures.h"            // for X86_FEATURE_TOPOEXT, X86_FEAT...
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/processor.h"              // for cpuinfo_x86, cpuid_count, cpuid
#include "linux/bitops.h"               // for get_count_order
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/cpumask.h"              // for cpumask_set_cpu, cpu_online
#include "linux/stddef.h"               // for true

arch/x86/kernel/cpu/cacheinfo.c should remove these lines:
- #include <asm/amd_nb.h>  // lines 21-21
- #include <linux/capability.h>  // lines 15-15
- #include <linux/cpu.h>  // lines 13-13
- #include <linux/pci.h>  // lines 17-17
- #include <linux/sched.h>  // lines 14-14
- #include <linux/slab.h>  // lines 11-11
- #include <linux/sysfs.h>  // lines 16-16

The full include-list for arch/x86/kernel/cpu/cacheinfo.c:
#include <asm-generic/percpu.h>         // for per_cpu, __this_cpu_read
#include <asm/cacheinfo.h>              // for cacheinfo_amd_init_llc_id
#include <asm/cpufeature.h>             // for boot_cpu_has
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/percpu.h>                 // for raw_cpu_read_8
#include <asm/smp.h>                    // for cpu_llc_id, cpu_llc_shared_mask
#include <linux/cacheinfo.h>            // for cacheinfo, get_cpu_cacheinfo
#include "asm-generic/errno-base.h"     // for EINVAL, EIO, ENOENT
#include "asm-generic/int-ll64.h"       // for u32, u16
#include "asm/cpufeatures.h"            // for X86_FEATURE_TOPOEXT, X86_FEAT...
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/processor.h"              // for cpuinfo_x86, cpuid_count, cpuid
#include "cpu.h"                        // for cpu_detect_cache_sizes, init_...
#include "linux/bitops.h"               // for get_count_order
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/cpumask.h"              // for cpumask_set_cpu, cpu_online
#include "linux/stddef.h"               // for true
---
  ./scripts/check-local-export arch/x86/kernel/cpu/cacheinfo.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.scattered.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/scattered"' -DKBUILD_BASENAME='"scattered"' -DKBUILD_MODNAME='"scattered"' -D__KBUILD_MODNAME=kmod_scattered -c -o arch/x86/kernel/cpu/scattered.o arch/x86/kernel/cpu/scattered.c  
In file included from arch/x86/kernel/cpu/scattered.c:5:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/scattered.c:5:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/scattered.c:5:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/kernel/cpu/scattered.c:5:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/scattered.c:5:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/scattered.c:5:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/kernel/cpu/scattered.c should add these lines:
#include "asm-generic/int-ll64.h"  // for u32, u8, u16
#include "asm/cpufeature.h"        // for set_cpu_cap
#include "asm/cpufeatures.h"       // for X86_FEATURE_MBA, X86_FEATURE_APERF...

arch/x86/kernel/cpu/scattered.c should remove these lines:
- #include <asm/apic.h>  // lines 8-8
- #include <asm/memtype.h>  // lines 7-7
- #include <linux/cpu.h>  // lines 5-5

The full include-list for arch/x86/kernel/cpu/scattered.c:
#include <asm/processor.h>         // for CPUID_EDX, CPUID_EBX, CPUID_ECX
#include "asm-generic/int-ll64.h"  // for u32, u8, u16
#include "asm/cpufeature.h"        // for set_cpu_cap
#include "asm/cpufeatures.h"       // for X86_FEATURE_MBA, X86_FEATURE_APERF...
#include "cpu.h"                   // for init_scattered_cpuid_features
---
  ./scripts/check-local-export arch/x86/kernel/cpu/scattered.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.topology.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/topology"' -DKBUILD_BASENAME='"topology"' -DKBUILD_MODNAME='"topology"' -D__KBUILD_MODNAME=kmod_topology -c -o arch/x86/kernel/cpu/topology.o arch/x86/kernel/cpu/topology.c  
In file included from arch/x86/kernel/cpu/topology.c:8:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/topology.c:8:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/topology.c:8:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/kernel/cpu/topology.c:8:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/topology.c:8:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/topology.c:8:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/kernel/cpu/topology.c should add these lines:
#include "asm/cache.h"     // for __read_mostly
#include "linux/export.h"  // for EXPORT_SYMBOL
struct cpuinfo_x86;

arch/x86/kernel/cpu/topology.c should remove these lines:
- #include <asm/apic.h>  // lines 9-9
- #include <asm/memtype.h>  // lines 10-10
- #include <asm/processor.h>  // lines 11-11
- #include <linux/cpu.h>  // lines 8-8

The full include-list for arch/x86/kernel/cpu/topology.c:
#include "asm/cache.h"     // for __read_mostly
#include "cpu.h"           // for detect_extended_topology, detect_extended_...
#include "linux/export.h"  // for EXPORT_SYMBOL
struct cpuinfo_x86;
---
  ./scripts/check-local-export arch/x86/kernel/cpu/topology.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.common.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -fno-stack-protector    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/common"' -DKBUILD_BASENAME='"common"' -DKBUILD_MODNAME='"common"' -D__KBUILD_MODNAME=kmod_common -c -o arch/x86/kernel/cpu/common.o arch/x86/kernel/cpu/common.c  
In file included from arch/x86/kernel/cpu/common.c:28:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/common.c:28:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/common.c:28:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/cpu/common.c:62:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/kernel/cpu/common.c:28:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/common.c:28:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/common.c:28:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/cpu/common.c:62:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/cpu/common.c should add these lines:
#include <asm-generic/percpu.h>         // for DEFINE_PER_CPU, EXPORT_PER_CP...
#include <asm/bug.h>                    // for BUG_ON, WARN_ONCE
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/page_types.h>             // for THREAD_SIZE
#include <asm/percpu.h>                 // for this_cpu_read_8, this_cpu_wri...
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EINVAL
#include "asm-generic/int-ll64.h"       // for __u32, u32, u16, u64, s32
#include "asm/apicdef.h"                // for BAD_APICID
#include "asm/cache.h"                  // for __read_mostly
#include "asm/cpu_entry_area.h"         // for cpu_entry_stack, get_cpu_entr...
#include "asm/cpufeature.h"             // for setup_clear_cpu_cap, cpu_has
#include "asm/cpufeatures.h"            // for NCAPINTS, NBUGINTS, X86_FEATU...
#include "asm/cpumask.h"                // for setup_cpu_local_masks
#include "asm/current.h"                // for current
#include "asm/desc_defs.h"              // for GDT_ENTRY_INIT, desc_ptr
#include "asm/ibt.h"                    // for HAS_KERNEL_IBT, __noendbr
#include "asm/irqflags.h"               // for native_save_fl
#include "asm/msr-index.h"              // for MSR_FS_BASE, MSR_IA32_BBL_CR_CTL
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/pgtable_32_types.h"       // for pgtable_l5_enabled
#include "asm/pkru.h"                   // for pkru_write_default
#include "asm/processor-flags.h"        // for X86_CR0_WP, X86_CR4_UMIP, X86...
#include "asm/segment.h"                // for GDT_ENTRY_APMBIOS_BASE, __loa...
#include "asm/special_insns.h"          // for __write_cr4, __read_cr4, nati...
#include "asm/string_32.h"              // for strcpy, strcmp, memset, strlen
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler.h"             // for unlikely, barrier
#include "linux/compiler_attributes.h"  // for __always_inline, __aligned
#include "linux/compiler_types.h"       // for inline
#include "linux/cpu.h"                  // for cpu_init
#include "linux/jump_label.h"           // for static_branch_likely, static_...
#include "linux/kconfig.h"              // for IS_ENABLED, IS_MODULE
#include "linux/kstrtox.h"              // for kstrtouint
#include "linux/lockdep.h"              // for lockdep_assert_irqs_disabled
#include "linux/mm_types.h"             // for init_mm
#include "linux/mod_devicetable.h"      // for X86_FEATURE_ANY, X86_STEPPING...
#include "linux/panic.h"                // for add_taint, LOCKDEP_STILL_OK
#include "linux/preempt.h"              // for INIT_PREEMPT_COUNT
#include "linux/printk.h"               // for pr_cont, pr_info, pr_err, pr_...
#include "linux/sched.h"                // for task_struct
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool
#include "vdso/bits.h"                  // for BIT

arch/x86/kernel/cpu/common.c should remove these lines:
- #include <asm/asm.h>  // lines 50-50
- #include <asm/hypervisor.h>  // lines 32-32
- #include <asm/memtype.h>  // lines 55-55
- #include <asm/microcode.h>  // lines 56-56
- #include <asm/numa.h>  // lines 49-49
- #include <asm/perf_event.h>  // lines 28-28
- #include <asm/sections.h>  // lines 36-36
- #include <asm/setup.h>  // lines 42-42
- #include <asm/stackprotector.h>  // lines 27-27
- #include <asm/vsyscall.h>  // lines 37-37
- #include <linux/atomic.h>  // lines 40-40
- #include <linux/bitops.h>  // lines 7-7
- #include <linux/io.h>  // lines 22-22
- #include <linux/kgdb.h>  // lines 20-20
- #include <linux/kprobes.h>  // lines 19-19
- #include <linux/linkage.h>  // lines 6-6
- #include <linux/memblock.h>  // lines 5-5
- #include <linux/numa.h>  // lines 48-48
- #include <linux/percpu.h>  // lines 10-10
- #include <linux/pgtable.h>  // lines 24-24
- #include <linux/sched/clock.h>  // lines 15-15
- #include <linux/syscore_ops.h>  // lines 23-23
- #include <linux/topology.h>  // lines 38-38

The full include-list for arch/x86/kernel/cpu/common.c:
#include <asm-generic/percpu.h>         // for DEFINE_PER_CPU, EXPORT_PER_CP...
#include <asm/apic.h>                   // for apic_smt_update, x2apic_setup
#include <asm/archrandom.h>             // for x86_init_rdrand
#include <asm/bug.h>                    // for BUG_ON, WARN_ONCE
#include <asm/bugs.h>                   // for cpu_bugs_smt_update
#include <asm/cmdline.h>                // for cmdline_find_option_bool, cmd...
#include <asm/cpu.h>                    // for sld_setup, x86_family, x86_model
#include <asm/cpu_device_id.h>          // for X86_MATCH_VENDOR_FAM_MODEL
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/debugreg.h>               // for set_debugreg
#include <asm/desc.h>                   // for get_cpu_gdt_ro, get_cpu_gdt_rw
#include <asm/doublefault.h>            // for doublefault_init_cpu_tss
#include <asm/fpu/api.h>                // for fpu__init_cpu, fpu__init_system
#include <asm/hwcap2.h>                 // for HWCAP2_FSGSBASE
#include <asm/intel-family.h>           // for INTEL_FAM6_ATOM_TREMONT_D
#include <asm/mce.h>                    // for mcheck_cpu_init
#include <asm/microcode_intel.h>        // for show_ucode_info_early
#include <asm/mmu_context.h>            // for load_mm_ldt, enter_lazy_tlb
#include <asm/msr.h>                    // for wrmsrl, wrmsr, rdmsrl_safe
#include <asm/mtrr.h>                   // for mtrr_ap_init
#include <asm/page_types.h>             // for THREAD_SIZE
#include <asm/percpu.h>                 // for this_cpu_read_8, this_cpu_wri...
#include <asm/processor.h>              // for cpuinfo_x86, X86_VENDOR_INTEL
#include <asm/proto.h>                  // for syscall_init, entry_SYSENTER_32
#include <asm/sev.h>                    // for setup_ghcb
#include <asm/sigframe.h>               // for init_sigframe_size
#include <asm/tlbflush.h>               // for cpu_tlbstate, tlb_state, cr4_...
#include <asm/traps.h>                  // for ibt_selftest
#include <asm/uv/uv.h>                  // for is_uv_system, uv_cpu_init
#include <linux/cpumask.h>              // for alloc_bootmem_cpumask_var
#include <linux/ctype.h>                // for isspace
#include <linux/delay.h>                // for loops_per_jiffy
#include <linux/export.h>               // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include <linux/init.h>                 // for __init, boot_command_line
#include <linux/kernel.h>               // for get_option, sprintf
#include <linux/sched/mm.h>             // for mmgrab
#include <linux/sched/smt.h>            // for arch_smt_update
#include <linux/sched/task.h>           // for init_task, init_thread_union
#include <linux/smp.h>                  // for raw_smp_processor_id, get_cpu
#include <linux/string.h>               // for strsep
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EINVAL
#include "asm-generic/int-ll64.h"       // for __u32, u32, u16, u64, s32
#include "asm/apicdef.h"                // for BAD_APICID
#include "asm/cache.h"                  // for __read_mostly
#include "asm/cpu_entry_area.h"         // for cpu_entry_stack, get_cpu_entr...
#include "asm/cpufeature.h"             // for setup_clear_cpu_cap, cpu_has
#include "asm/cpufeatures.h"            // for NCAPINTS, NBUGINTS, X86_FEATU...
#include "asm/cpumask.h"                // for setup_cpu_local_masks
#include "asm/current.h"                // for current
#include "asm/desc_defs.h"              // for GDT_ENTRY_INIT, desc_ptr
#include "asm/ibt.h"                    // for HAS_KERNEL_IBT, __noendbr
#include "asm/irqflags.h"               // for native_save_fl
#include "asm/msr-index.h"              // for MSR_FS_BASE, MSR_IA32_BBL_CR_CTL
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/pgtable_32_types.h"       // for pgtable_l5_enabled
#include "asm/pkru.h"                   // for pkru_write_default
#include "asm/processor-flags.h"        // for X86_CR0_WP, X86_CR4_UMIP, X86...
#include "asm/segment.h"                // for GDT_ENTRY_APMBIOS_BASE, __loa...
#include "asm/special_insns.h"          // for __write_cr4, __read_cr4, nati...
#include "asm/string_32.h"              // for strcpy, strcmp, memset, strlen
#include "cpu.h"                        // for cpu_dev, init_scattered_cpuid...
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler.h"             // for unlikely, barrier
#include "linux/compiler_attributes.h"  // for __always_inline, __aligned
#include "linux/compiler_types.h"       // for inline
#include "linux/cpu.h"                  // for cpu_init
#include "linux/jump_label.h"           // for static_branch_likely, static_...
#include "linux/kconfig.h"              // for IS_ENABLED, IS_MODULE
#include "linux/kstrtox.h"              // for kstrtouint
#include "linux/lockdep.h"              // for lockdep_assert_irqs_disabled
#include "linux/mm_types.h"             // for init_mm
#include "linux/mod_devicetable.h"      // for X86_FEATURE_ANY, X86_STEPPING...
#include "linux/panic.h"                // for add_taint, LOCKDEP_STILL_OK
#include "linux/preempt.h"              // for INIT_PREEMPT_COUNT
#include "linux/printk.h"               // for pr_cont, pr_info, pr_err, pr_...
#include "linux/sched.h"                // for task_struct
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool
#include "vdso/bits.h"                  // for BIT
---
  ./scripts/check-local-export arch/x86/kernel/cpu/common.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.rdrand.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/rdrand"' -DKBUILD_BASENAME='"rdrand"' -DKBUILD_MODNAME='"rdrand"' -D__KBUILD_MODNAME=kmod_rdrand -c -o arch/x86/kernel/cpu/rdrand.o arch/x86/kernel/cpu/rdrand.c  

arch/x86/kernel/cpu/rdrand.c should add these lines:
#include "asm/cpufeature.h"   // for setup_clear_cpu_cap
#include "asm/cpufeatures.h"  // for X86_FEATURE_RDRAND, X86_FEATURE_RDSEED
#include "linux/init.h"       // for __init, __setup

arch/x86/kernel/cpu/rdrand.c should remove these lines:
- #include <asm/archrandom.h>  // lines 11-11
- #include <asm/processor.h>  // lines 10-10
- #include <asm/sections.h>  // lines 12-12

The full include-list for arch/x86/kernel/cpu/rdrand.c:
#include "asm/cpufeature.h"   // for setup_clear_cpu_cap
#include "asm/cpufeatures.h"  // for X86_FEATURE_RDRAND, X86_FEATURE_RDSEED
#include "linux/init.h"       // for __init, __setup
---
  ./scripts/check-local-export arch/x86/kernel/cpu/rdrand.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.match.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/match"' -DKBUILD_BASENAME='"match"' -DKBUILD_MODNAME='"match"' -D__KBUILD_MODNAME=kmod_match -c -o arch/x86/kernel/cpu/match.o arch/x86/kernel/cpu/match.c  
In file included from arch/x86/kernel/cpu/match.c:4:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/match.c:4:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/match.c:4:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/kernel/cpu/match.c:4:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/match.c:4:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/match.c:4:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/kernel/cpu/match.c should add these lines:
#include <asm/cpufeatures.h>        // for REQUIRED_MASK0, REQUIRED_MASK1
#include <stddef.h>                 // for NULL
#include "asm/processor.h"          // for cpuinfo_x86, boot_cpu_data
#include "linux/mod_devicetable.h"  // for x86_cpu_id, X86_FAMILY_ANY, X86_F...
#include "linux/stddef.h"           // for false, true
#include "linux/types.h"            // for bool
#include "vdso/bits.h"              // for BIT

arch/x86/kernel/cpu/match.c should remove these lines:
- #include <linux/cpu.h>  // lines 4-4
- #include <linux/slab.h>  // lines 6-6

The full include-list for arch/x86/kernel/cpu/match.c:
#include <asm/cpu_device_id.h>      // for x86_cpu_desc, x86_cpu_has_min_mic...
#include <asm/cpufeature.h>         // for cpu_has
#include <asm/cpufeatures.h>        // for REQUIRED_MASK0, REQUIRED_MASK1
#include <linux/export.h>           // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <stddef.h>                 // for NULL
#include "asm/processor.h"          // for cpuinfo_x86, boot_cpu_data
#include "linux/mod_devicetable.h"  // for x86_cpu_id, X86_FAMILY_ANY, X86_F...
#include "linux/stddef.h"           // for false, true
#include "linux/types.h"            // for bool
#include "vdso/bits.h"              // for BIT
---
  ./scripts/check-local-export arch/x86/kernel/cpu/match.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.bugs.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/bugs"' -DKBUILD_BASENAME='"bugs"' -DKBUILD_MODNAME='"bugs"' -D__KBUILD_MODNAME=kmod_bugs -c -o arch/x86/kernel/cpu/bugs.o arch/x86/kernel/cpu/bugs.c  
In file included from arch/x86/kernel/cpu/bugs.c:13:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/bugs.c:13:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/bugs.c:13:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/kernel/cpu/bugs.c:13:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/bugs.c:13:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/bugs.c:13:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/kernel/cpu/bugs.c should add these lines:
#include <asm-generic/percpu.h>         // for this_cpu_read, DEFINE_PER_CPU
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/percpu.h>                 // for this_cpu_read_8, this_cpu_wri...
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EINVAL, EPERM, ERANGE, ENODEV
#include "asm-generic/int-ll64.h"       // for u64
#include "asm/cpufeature.h"             // for boot_cpu_has, boot_cpu_has_bug
#include "asm/cpufeatures.h"            // for X86_BUG_MDS, X86_BUG_MMIO_STA...
#include "asm/current.h"                // for current
#include "asm/e820/types.h"             // for E820_TYPE_RAM
#include "asm/msr-index.h"              // for SPEC_CTRL_SSBD, SPEC_CTRL_STIBP
#include "asm/nospec-branch.h"          // for SPECTRE_V2_USER_NONE, SPECTRE...
#include "asm/page_types.h"             // for PAGE_SHIFT
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/string_32.h"              // for strcmp, strchr, strlen, strncmp
#include "asm/thread_info.h"            // for TIF_SPEC_L1D_FLUSH, TIF_SPEC_...
#include "generated/autoconf.h"         // for CONFIG_PGTABLE_LEVELS
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for inline
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/jump_label.h"           // for static_branch_enable, DEFINE_...
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kernel.h"               // for ARRAY_SIZE
#include "linux/mutex.h"                // for mutex, mutex_lock, mutex_unlock
#include "linux/panic.h"                // for panic
#include "linux/printk.h"               // for pr_info, pr_err, pr_warn_once
#include "linux/sched.h"                // for task_clear_spec_ssb_noexec
#include "linux/smp.h"                  // for on_each_cpu
#include "linux/stddef.h"               // for false, true
#include "linux/thread_info.h"          // for clear_ti_thread_flag, set_ti_...
#include "linux/types.h"                // for bool
#include "linux/utsname.h"              // for new_utsname
#include "vdso/limits.h"                // for ULLONG_MAX

arch/x86/kernel/cpu/bugs.c should remove these lines:
- #include <asm/hypervisor.h>  // lines 34-34
- #include <asm/paravirt.h>  // lines 29-29
- #include <asm/processor-flags.h>  // lines 25-25
- #include <asm/set_memory.h>  // lines 31-31
- #include <asm/tlbflush.h>  // lines 35-35
- #include <linux/module.h>  // lines 14-14
- #include <linux/pgtable.h>  // lines 18-18

The full include-list for arch/x86/kernel/cpu/bugs.c:
#include <asm-generic/percpu.h>         // for this_cpu_read, DEFINE_PER_CPU
#include <asm/alternative.h>            // for alternative_instructions
#include <asm/bugs.h>                   // for check_bugs, cpu_bugs_smt_update
#include <asm/cmdline.h>                // for cmdline_find_option, cmdline_...
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/e820/api.h>               // for e820__mapped_any
#include <asm/fpu/api.h>                // for fpu__init_check_bugs
#include <asm/intel-family.h>           // for INTEL_FAM6_BROADWELL, INTEL_F...
#include <asm/msr.h>                    // for wrmsrl, rdmsrl
#include <asm/percpu.h>                 // for this_cpu_read_8, this_cpu_wri...
#include <asm/processor.h>              // for cpuinfo_x86, boot_cpu_data
#include <asm/spec-ctrl.h>              // for ssbd_spec_ctrl_to_tif, specul...
#include <asm/vmx.h>                    // for VMENTER_L1D_FLUSH_AUTO, vmx_l...
#include <linux/bpf.h>                  // for unprivileged_ebpf_enabled
#include <linux/cpu.h>                  // for cpu_mitigations_off, cpu_smt_...
#include <linux/init.h>                 // for __init, early_param, boot_com...
#include <linux/nospec.h>               // for arch_prctl_spec_ctrl_get, arc...
#include <linux/prctl.h>                // for PR_SPEC_PRCTL, PR_SPEC_DISABLE
#include <linux/sched/smt.h>            // for sched_smt_active, arch_smt_up...
#include <linux/utsname.h>              // for init_utsname
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EINVAL, EPERM, ERANGE, ENODEV
#include "asm-generic/int-ll64.h"       // for u64
#include "asm/cpufeature.h"             // for boot_cpu_has, boot_cpu_has_bug
#include "asm/cpufeatures.h"            // for X86_BUG_MDS, X86_BUG_MMIO_STA...
#include "asm/current.h"                // for current
#include "asm/e820/types.h"             // for E820_TYPE_RAM
#include "asm/msr-index.h"              // for SPEC_CTRL_SSBD, SPEC_CTRL_STIBP
#include "asm/nospec-branch.h"          // for SPECTRE_V2_USER_NONE, SPECTRE...
#include "asm/page_types.h"             // for PAGE_SHIFT
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/string_32.h"              // for strcmp, strchr, strlen, strncmp
#include "asm/thread_info.h"            // for TIF_SPEC_L1D_FLUSH, TIF_SPEC_...
#include "cpu.h"                        // for x86_read_arch_cap_msr, update...
#include "generated/autoconf.h"         // for CONFIG_PGTABLE_LEVELS
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for inline
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/jump_label.h"           // for static_branch_enable, DEFINE_...
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kernel.h"               // for ARRAY_SIZE
#include "linux/mutex.h"                // for mutex, mutex_lock, mutex_unlock
#include "linux/panic.h"                // for panic
#include "linux/printk.h"               // for pr_info, pr_err, pr_warn_once
#include "linux/sched.h"                // for task_clear_spec_ssb_noexec
#include "linux/smp.h"                  // for on_each_cpu
#include "linux/stddef.h"               // for false, true
#include "linux/thread_info.h"          // for clear_ti_thread_flag, set_ti_...
#include "linux/types.h"                // for bool
#include "linux/utsname.h"              // for new_utsname
#include "vdso/limits.h"                // for ULLONG_MAX
---
  ./scripts/check-local-export arch/x86/kernel/cpu/bugs.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.aperfmperf.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/aperfmperf"' -DKBUILD_BASENAME='"aperfmperf"' -DKBUILD_MODNAME='"aperfmperf"' -D__KBUILD_MODNAME=kmod_aperfmperf -c -o arch/x86/kernel/cpu/aperfmperf.o arch/x86/kernel/cpu/aperfmperf.c  
In file included from arch/x86/kernel/cpu/aperfmperf.c:9:
In file included from ./include/linux/cpufreq.h:12:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/aperfmperf.c:9:
In file included from ./include/linux/cpufreq.h:12:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/aperfmperf.c:9:
In file included from ./include/linux/cpufreq.h:12:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/kernel/cpu/aperfmperf.c:9:
In file included from ./include/linux/cpufreq.h:12:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/aperfmperf.c:9:
In file included from ./include/linux/cpufreq.h:12:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/aperfmperf.c:9:
In file included from ./include/linux/cpufreq.h:12:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/kernel/cpu/aperfmperf.c should add these lines:
#include <asm-generic/percpu.h>    // for this_cpu_write, DEFINE_PER_CPU_SHA...
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/percpu.h>            // for this_cpu_write_8
#include "asm-generic/int-ll64.h"  // for u64
#include "asm-generic/param.h"     // for HZ
#include "asm/cpufeature.h"        // for cpu_feature_enabled
#include "asm/cpufeatures.h"       // for X86_FEATURE_APERFMPERF
#include "asm/msr-index.h"         // for MSR_IA32_APERF, MSR_IA32_MPERF
#include "asm/msr.h"               // for rdmsrl
#include "asm/percpu.h"            // for __pcpu_cast_1, __pcpu_cast_2, __pc...
#include "asm/topology.h"          // for arch_scale_freq_tick
#include "asm/tsc.h"               // for cpu_khz
#include "linux/compiler_types.h"  // for inline
#include "linux/init.h"            // for __init, early_initcall
#include "linux/jiffies.h"         // for jiffies
#include "linux/seqlock.h"         // for __seqprop_mutex_ptr, __seqprop_ptr

arch/x86/kernel/cpu/aperfmperf.c should remove these lines:
- #include <asm/cpu_device_id.h>  // lines 21-21
- #include <asm/intel-family.h>  // lines 22-22
- #include <linux/delay.h>  // lines 10-10
- #include <linux/ktime.h>  // lines 11-11
- #include <linux/percpu.h>  // lines 13-13
- #include <linux/rcupdate.h>  // lines 14-14
- #include <linux/sched/isolation.h>  // lines 15-15
- #include <linux/sched/topology.h>  // lines 16-16
- #include <linux/smp.h>  // lines 17-17
- #include <linux/syscore_ops.h>  // lines 18-18
- #include "cpu.h"  // lines 24-24

The full include-list for arch/x86/kernel/cpu/aperfmperf.c:
#include <asm-generic/percpu.h>    // for this_cpu_write, DEFINE_PER_CPU_SHA...
#include <asm/cpu.h>               // for ap_init_aperfmperf
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/percpu.h>            // for this_cpu_write_8
#include <linux/cpufreq.h>         // for cpufreq_quick_get, arch_freq_get_o...
#include <linux/math64.h>          // for div64_u64
#include "asm-generic/int-ll64.h"  // for u64
#include "asm-generic/param.h"     // for HZ
#include "asm/cpufeature.h"        // for cpu_feature_enabled
#include "asm/cpufeatures.h"       // for X86_FEATURE_APERFMPERF
#include "asm/msr-index.h"         // for MSR_IA32_APERF, MSR_IA32_MPERF
#include "asm/msr.h"               // for rdmsrl
#include "asm/percpu.h"            // for __pcpu_cast_1, __pcpu_cast_2, __pc...
#include "asm/topology.h"          // for arch_scale_freq_tick
#include "asm/tsc.h"               // for cpu_khz
#include "linux/compiler_types.h"  // for inline
#include "linux/init.h"            // for __init, early_initcall
#include "linux/jiffies.h"         // for jiffies
#include "linux/seqlock.h"         // for __seqprop_mutex_ptr, __seqprop_ptr
---
  ./scripts/check-local-export arch/x86/kernel/cpu/aperfmperf.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.cpuid-deps.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/cpuid-deps"' -DKBUILD_BASENAME='"cpuid_deps"' -DKBUILD_MODNAME='"cpuid_deps"' -D__KBUILD_MODNAME=kmod_cpuid_deps -c -o arch/x86/kernel/cpu/cpuid-deps.o arch/x86/kernel/cpu/cpuid-deps.c  

arch/x86/kernel/cpu/cpuid-deps.c should add these lines:
#include <asm/bitops.h>                              // for __set_bit, __tes...
#include <asm/bug.h>                                 // for WARN_ON
#include <stddef.h>                                  // for NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/int-ll64.h"                    // for u32
#include "asm/cpufeatures.h"                         // for X86_FEATURE_AVX512F
#include "asm/processor.h"                           // for boot_cpu_data
#include "asm/string_32.h"                           // for memset
#include "linux/compiler_types.h"                    // for inline
#include "linux/stddef.h"                            // for false, true
#include "linux/types.h"                             // for DECLARE_BITMAP

arch/x86/kernel/cpu/cpuid-deps.c should remove these lines:
- #include <linux/init.h>  // lines 3-3
- #include <linux/kernel.h>  // lines 2-2
- #include <linux/module.h>  // lines 4-4

The full include-list for arch/x86/kernel/cpu/cpuid-deps.c:
#include <asm/bitops.h>                              // for __set_bit, __tes...
#include <asm/bug.h>                                 // for WARN_ON
#include <asm/cpufeature.h>                          // for clear_cpu_cap
#include <stddef.h>                                  // for NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/int-ll64.h"                    // for u32
#include "asm/cpufeatures.h"                         // for X86_FEATURE_AVX512F
#include "asm/processor.h"                           // for boot_cpu_data
#include "asm/string_32.h"                           // for memset
#include "linux/compiler_types.h"                    // for inline
#include "linux/stddef.h"                            // for false, true
#include "linux/types.h"                             // for DECLARE_BITMAP
---
  ./scripts/check-local-export arch/x86/kernel/cpu/cpuid-deps.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.umwait.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/umwait"' -DKBUILD_BASENAME='"umwait"' -DKBUILD_MODNAME='"umwait"' -D__KBUILD_MODNAME=kmod_umwait -c -o arch/x86/kernel/cpu/umwait.o arch/x86/kernel/cpu/umwait.c  
In file included from arch/x86/kernel/cpu/umwait.c:3:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from arch/x86/kernel/cpu/umwait.c:3:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/umwait.c:3:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/umwait.c:3:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from arch/x86/kernel/cpu/umwait.c:3:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from arch/x86/kernel/cpu/umwait.c:3:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/umwait.c:3:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/umwait.c:3:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/kernel/cpu/umwait.c should add these lines:
#include <asm/cpufeatures.h>         // for REQUIRED_MASK0, REQUIRED_MASK1
#include <cstdio>                    // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"  // for EINVAL, ENODEV
#include "asm-generic/int-ll64.h"    // for u32
#include "asm-generic/rwonce.h"      // for READ_ONCE, WRITE_ONCE
#include "asm/cpufeature.h"          // for boot_cpu_has
#include "asm/cpufeatures.h"         // for X86_FEATURE_WAITPKG
#include "asm/msr-index.h"           // for MSR_IA32_UMWAIT_CONTROL_TIME_MASK
#include "linux/cache.h"             // for __ro_after_init
#include "linux/compiler_types.h"    // for inline
#include "linux/cpuhotplug.h"        // for cpuhp_setup_state, CPUHP_AP_ONLI...
#include "linux/device.h"            // for device_attribute, DEVICE_ATTR_RW
#include "linux/device/bus.h"        // for bus_type
#include "linux/init.h"              // for __init, device_initcall
#include "linux/irqflags.h"          // for local_irq_disable, local_irq_enable
#include "linux/kernel.h"            // for sprintf
#include "linux/kstrtox.h"           // for kstrtobool, kstrtou32
#include "linux/lockdep.h"           // for lockdep_assert_irqs_disabled
#include "linux/mutex.h"             // for mutex, mutex_lock, mutex_unlock
#include "linux/smp.h"               // for on_each_cpu
#include "linux/sysfs.h"             // for sysfs_create_group, attribute_group
#include "linux/types.h"             // for bool

arch/x86/kernel/cpu/umwait.c should remove these lines:
- #include <asm/mwait.h>  // lines 7-7
- #include <linux/suspend.h>  // lines 3-3

The full include-list for arch/x86/kernel/cpu/umwait.c:
#include <asm/cpufeatures.h>         // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/msr.h>                 // for wrmsr, rdmsrl
#include <linux/cpu.h>               // for cpu_subsys
#include <linux/syscore_ops.h>       // for register_syscore_ops, syscore_ops
#include <cstdio>                    // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"  // for EINVAL, ENODEV
#include "asm-generic/int-ll64.h"    // for u32
#include "asm-generic/rwonce.h"      // for READ_ONCE, WRITE_ONCE
#include "asm/cpufeature.h"          // for boot_cpu_has
#include "asm/cpufeatures.h"         // for X86_FEATURE_WAITPKG
#include "asm/msr-index.h"           // for MSR_IA32_UMWAIT_CONTROL_TIME_MASK
#include "linux/cache.h"             // for __ro_after_init
#include "linux/compiler_types.h"    // for inline
#include "linux/cpuhotplug.h"        // for cpuhp_setup_state, CPUHP_AP_ONLI...
#include "linux/device.h"            // for device_attribute, DEVICE_ATTR_RW
#include "linux/device/bus.h"        // for bus_type
#include "linux/init.h"              // for __init, device_initcall
#include "linux/irqflags.h"          // for local_irq_disable, local_irq_enable
#include "linux/kernel.h"            // for sprintf
#include "linux/kstrtox.h"           // for kstrtobool, kstrtou32
#include "linux/lockdep.h"           // for lockdep_assert_irqs_disabled
#include "linux/mutex.h"             // for mutex, mutex_lock, mutex_unlock
#include "linux/smp.h"               // for on_each_cpu
#include "linux/sysfs.h"             // for sysfs_create_group, attribute_group
#include "linux/types.h"             // for bool
---
  ./scripts/check-local-export arch/x86/kernel/cpu/umwait.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.feat_ctl.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/feat_ctl"' -DKBUILD_BASENAME='"feat_ctl"' -DKBUILD_MODNAME='"feat_ctl"' -D__KBUILD_MODNAME=kmod_feat_ctl -c -o arch/x86/kernel/cpu/feat_ctl.o arch/x86/kernel/cpu/feat_ctl.c  

arch/x86/kernel/cpu/feat_ctl.c should add these lines:
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include "asm-generic/int-ll64.h"  // for u64
#include "asm/cpufeatures.h"       // for X86_FEATURE_SGX, X86_FEATURE_VMX
#include "asm/msr.h"               // for rdmsrl_safe, wrmsrl
#include "linux/init.h"            // for __init, early_param
#include "linux/kconfig.h"         // for IS_ENABLED
#include "linux/printk.h"          // for pr_err_once
#include "linux/stddef.h"          // for false
#include "linux/types.h"           // for bool
struct cpuinfo_x86;

arch/x86/kernel/cpu/feat_ctl.c should remove these lines:
- #include <asm/processor.h>  // lines 6-6
- #include <asm/vmx.h>  // lines 7-7
- #include "cpu.h"  // lines 8-8

The full include-list for arch/x86/kernel/cpu/feat_ctl.c:
#include <asm/cpufeature.h>        // for clear_cpu_cap, cpu_has, setup_clea...
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/msr-index.h>         // for FEAT_CTL_LOCKED, FEAT_CTL_SGX_ENABLED
#include <linux/tboot.h>           // for tboot_enabled
#include "asm-generic/int-ll64.h"  // for u64
#include "asm/cpufeatures.h"       // for X86_FEATURE_SGX, X86_FEATURE_VMX
#include "asm/msr.h"               // for rdmsrl_safe, wrmsrl
#include "linux/init.h"            // for __init, early_param
#include "linux/kconfig.h"         // for IS_ENABLED
#include "linux/printk.h"          // for pr_err_once
#include "linux/stddef.h"          // for false
#include "linux/types.h"           // for bool
struct cpuinfo_x86;
---
  ./scripts/check-local-export arch/x86/kernel/cpu/feat_ctl.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.intel.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/intel"' -DKBUILD_BASENAME='"intel"' -DKBUILD_MODNAME='"intel"' -D__KBUILD_MODNAME=kmod_intel -c -o arch/x86/kernel/cpu/intel.o arch/x86/kernel/cpu/intel.c  
In file included from arch/x86/kernel/cpu/intel.c:21:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/intel.c:21:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/intel.c:21:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/cpu/intel.c:28:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/kernel/cpu/intel.c:21:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/intel.c:21:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/intel.c:21:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/cpu/intel.c:28:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/cpu/intel.c should add these lines:
#include <asm-generic/percpu.h>         // for this_cpu_or, this_cpu_read
#include <asm/bug.h>                    // for WARN_ONCE
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/percpu.h>                 // for this_cpu_or_8, this_cpu_read_8
#include <asm/signal.h>                 // for SIGBUS
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EINTR
#include "asm-generic/int-ll64.h"       // for u16, u64, u32, u8
#include "asm-generic/param.h"          // for HZ
#include "asm-generic/siginfo.h"        // for BUS_ADRALN
#include "asm/cache.h"                  // for __read_mostly
#include "asm/cpufeatures.h"            // for X86_FEATURE_SPLIT_LOCK_DETECT
#include "asm/current.h"                // for current
#include "asm/microcode.h"              // for cpu_signature, ucode_cpu_info
#include "asm/msr-index.h"              // for MSR_TEST_CTRL, MSR_IA32_MISC_...
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/processor-flags.h"        // for X86_EFLAGS_AC
#include "asm/processor.h"              // for cpuinfo_x86, msr_misc_feature...
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/string_32.h"              // for strcpy, strlen, strncmp, memset
#include "asm/trapnr.h"                 // for X86_TRAP_AC
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for inline
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/mod_devicetable.h"      // for x86_cpu_id
#include "linux/panic.h"                // for add_taint, LOCKDEP_NOW_UNRELI...
#include "linux/printk.h"               // for pr_info, pr_warn, pr_info_once
#include "linux/ratelimit.h"            // for ratelimit_set_flags, ratelimi...
#include "linux/ratelimit_types.h"      // for ratelimit_state, RATELIMIT_MS...
#include "linux/sched/signal.h"         // for force_sig_fault
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool

arch/x86/kernel/cpu/intel.c should remove these lines:
- #include <asm/numa.h>  // lines 30-30
- #include <asm/traps.h>  // lines 28-28
- #include <linux/pgtable.h>  // lines 3-3
- #include <linux/sched/clock.h>  // lines 9-9
- #include <linux/string.h>  // lines 5-5
- #include <linux/thread_info.h>  // lines 11-11
- #include <linux/uaccess.h>  // lines 13-13

The full include-list for arch/x86/kernel/cpu/intel.c:
#include <asm-generic/percpu.h>         // for this_cpu_or, this_cpu_read
#include <asm/bug.h>                    // for WARN_ONCE
#include <asm/bugs.h>                   // for ppro_with_ram_bug
#include <asm/cmdline.h>                // for cmdline_find_option
#include <asm/cpu.h>                    // for init_ia32_feat_ctl, x86_family
#include <asm/cpu_device_id.h>          // for X86_MATCH_INTEL_FAM6_MODEL
#include <asm/cpufeature.h>             // for setup_clear_cpu_cap, boot_cpu...
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/elf.h>                    // for ELF_HWCAP2
#include <asm/hwcap2.h>                 // for HWCAP2_RING3MWAIT
#include <asm/intel-family.h>           // for INTEL_FAM6_KABYLAKE, INTEL_FA...
#include <asm/microcode_intel.h>        // for intel_get_microcode_revision
#include <asm/msr.h>                    // for wrmsrl, rdmsrl_safe, rdmsrl
#include <asm/percpu.h>                 // for this_cpu_or_8, this_cpu_read_8
#include <asm/resctrl.h>                // for resctrl_cpu_detect
#include <asm/signal.h>                 // for SIGBUS
#include <asm/thermal.h>                // for intel_init_thermal
#include <linux/bitops.h>               // for get_count_order
#include <linux/cpuhotplug.h>           // for cpuhp_setup_state, CPUHP_AP_O...
#include <linux/delay.h>                // for msleep, msleep_interruptible
#include <linux/init.h>                 // for __init, __initconst, __setup
#include <linux/kernel.h>               // for sscanf, ARRAY_SIZE
#include <linux/sched.h>                // for task_struct
#include <linux/semaphore.h>            // for down_interruptible, up, DEFIN...
#include <linux/smp.h>                  // for get_cpu, put_cpu
#include <linux/workqueue.h>            // for work_struct, schedule_delayed...
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EINTR
#include "asm-generic/int-ll64.h"       // for u16, u64, u32, u8
#include "asm-generic/param.h"          // for HZ
#include "asm-generic/siginfo.h"        // for BUS_ADRALN
#include "asm/cache.h"                  // for __read_mostly
#include "asm/cpufeatures.h"            // for X86_FEATURE_SPLIT_LOCK_DETECT
#include "asm/current.h"                // for current
#include "asm/microcode.h"              // for cpu_signature, ucode_cpu_info
#include "asm/msr-index.h"              // for MSR_TEST_CTRL, MSR_IA32_MISC_...
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/processor-flags.h"        // for X86_EFLAGS_AC
#include "asm/processor.h"              // for cpuinfo_x86, msr_misc_feature...
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/string_32.h"              // for strcpy, strlen, strncmp, memset
#include "asm/trapnr.h"                 // for X86_TRAP_AC
#include "cpu.h"                        // for _tlb_table, detect_extended_t...
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for inline
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/mod_devicetable.h"      // for x86_cpu_id
#include "linux/panic.h"                // for add_taint, LOCKDEP_NOW_UNRELI...
#include "linux/printk.h"               // for pr_info, pr_warn, pr_info_once
#include "linux/ratelimit.h"            // for ratelimit_set_flags, ratelimi...
#include "linux/ratelimit_types.h"      // for ratelimit_state, RATELIMIT_MS...
#include "linux/sched/signal.h"         // for force_sig_fault
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool
---
  ./scripts/check-local-export arch/x86/kernel/cpu/intel.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.intel_pconfig.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/intel_pconfig"' -DKBUILD_BASENAME='"intel_pconfig"' -DKBUILD_MODNAME='"intel_pconfig"' -D__KBUILD_MODNAME=kmod_intel_pconfig -c -o arch/x86/kernel/cpu/intel_pconfig.o arch/x86/kernel/cpu/intel_pconfig.c  

arch/x86/kernel/cpu/intel_pconfig.c should add these lines:
#include <asm/bug.h>               // for WARN_ON_ONCE
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include "asm-generic/int-ll64.h"  // for u64
#include "asm/cache.h"             // for __read_mostly
#include "asm/cpufeatures.h"       // for X86_FEATURE_PCONFIG
#include "asm/processor.h"         // for cpuid_regs, cpuid_count
#include "linux/build_bug.h"       // for BUILD_BUG_ON
#include "linux/init.h"            // for __init, arch_initcall
#include "vdso/limits.h"           // for INT_MAX

arch/x86/kernel/cpu/intel_pconfig.c should remove these lines:

The full include-list for arch/x86/kernel/cpu/intel_pconfig.c:
#include <asm/bug.h>               // for WARN_ON_ONCE
#include <asm/cpufeature.h>        // for boot_cpu_has
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/intel_pconfig.h>     // for PCONFIG_TARGET_NR, pconfig_target
#include "asm-generic/int-ll64.h"  // for u64
#include "asm/cache.h"             // for __read_mostly
#include "asm/cpufeatures.h"       // for X86_FEATURE_PCONFIG
#include "asm/processor.h"         // for cpuid_regs, cpuid_count
#include "linux/build_bug.h"       // for BUILD_BUG_ON
#include "linux/init.h"            // for __init, arch_initcall
#include "vdso/limits.h"           // for INT_MAX
---
  ./scripts/check-local-export arch/x86/kernel/cpu/intel_pconfig.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.tsx.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/tsx"' -DKBUILD_BASENAME='"tsx"' -DKBUILD_MODNAME='"tsx"' -D__KBUILD_MODNAME=kmod_tsx -c -o arch/x86/kernel/cpu/tsx.o arch/x86/kernel/cpu/tsx.c  

arch/x86/kernel/cpu/tsx.c should add these lines:
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include "asm-generic/int-ll64.h"  // for u64
#include "asm/cpufeature.h"        // for setup_clear_cpu_cap, boot_cpu_has
#include "asm/cpufeatures.h"       // for X86_FEATURE_HLE, X86_FEATURE_RTM
#include "asm/msr-index.h"         // for MSR_IA32_TSX_CTRL, TSX_CTRL_CPUID_...
#include "asm/msr.h"               // for wrmsrl, rdmsrl
#include "asm/string_32.h"         // for strcmp
#include "generated/autoconf.h"    // for CONFIG_X86_INTEL_TSX_MODE_OFF
#include "linux/cache.h"           // for __ro_after_init
#include "linux/init.h"            // for __init, boot_command_line
#include "linux/kconfig.h"         // for IS_ENABLED, __ARG_PLACEHOLDER_1
#include "linux/printk.h"          // for pr_err
#include "linux/types.h"           // for bool

arch/x86/kernel/cpu/tsx.c should remove these lines:
- #include <linux/cpufeature.h>  // lines 11-11

The full include-list for arch/x86/kernel/cpu/tsx.c:
#include <asm/cmdline.h>           // for cmdline_find_option
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include "asm-generic/int-ll64.h"  // for u64
#include "asm/cpufeature.h"        // for setup_clear_cpu_cap, boot_cpu_has
#include "asm/cpufeatures.h"       // for X86_FEATURE_HLE, X86_FEATURE_RTM
#include "asm/msr-index.h"         // for MSR_IA32_TSX_CTRL, TSX_CTRL_CPUID_...
#include "asm/msr.h"               // for wrmsrl, rdmsrl
#include "asm/string_32.h"         // for strcmp
#include "cpu.h"                   // for TSX_CTRL_DISABLE, TSX_CTRL_ENABLE
#include "generated/autoconf.h"    // for CONFIG_X86_INTEL_TSX_MODE_OFF
#include "linux/cache.h"           // for __ro_after_init
#include "linux/init.h"            // for __init, boot_command_line
#include "linux/kconfig.h"         // for IS_ENABLED, __ARG_PLACEHOLDER_1
#include "linux/printk.h"          // for pr_err
#include "linux/types.h"           // for bool
---
  ./scripts/check-local-export arch/x86/kernel/cpu/tsx.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.amd.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/amd"' -DKBUILD_BASENAME='"amd"' -DKBUILD_MODNAME='"amd"' -D__KBUILD_MODNAME=kmod_amd -c -o arch/x86/kernel/cpu/amd.o arch/x86/kernel/cpu/amd.c  
In file included from arch/x86/kernel/cpu/amd.c:15:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/amd.c:15:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/amd.c:15:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/kernel/cpu/amd.c:15:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/amd.c:15:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/amd.c:15:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/kernel/cpu/amd.c should add these lines:
#include <asm-generic/percpu.h>         // for per_cpu
#include <asm/bug.h>                    // for WARN_ONCE
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include "asm-generic/errno-base.h"     // for EINVAL
#include "asm-generic/int-ll64.h"       // for u32, u16, u64
#include "asm/cpufeature.h"             // for cpu_has, set_cpu_cap, clear_c...
#include "asm/cpufeatures.h"            // for X86_FEATURE_TOPOEXT, X86_FEAT...
#include "asm/elf.h"                    // for va_align, va_alignment, ALIGN...
#include "asm/mem_encrypt.h"            // for sme_me_mask
#include "asm/msr-index.h"              // for MSR_K6_WHCR, MSR_K7_HWCR, MSR...
#include "asm/msr.h"                    // for msr_set_bit, wrmsr, msr_clear...
#include "asm/page_types.h"             // for PAGE_MASK, PAGE_SHIFT
#include "asm/shared/io.h"              // for inl, outl
#include "asm/special_insns.h"          // for wbinvd
#include "asm/string_32.h"              // for strcmp, strcpy
#include "asm/topology.h"               // for __max_die_per_package
#include "generated/autoconf.h"         // for CONFIG_X86_32
#include "linux/compiler.h"             // for OPTIMIZER_HIDE_VAR
#include "linux/compiler_attributes.h"  // for __visible, fallthrough
#include "linux/compiler_types.h"       // for inline
#include "linux/init.h"                 // for __init, early_param
#include "linux/irqflags.h"             // for local_irq_restore, local_irq_...
#include "linux/kconfig.h"              // for IS_ENABLED, __ARG_PLACEHOLDER_1
#include "linux/panic.h"                // for add_taint, LOCKDEP_NOW_UNRELI...
#include "linux/printk.h"               // for pr_info, pr_info_once, pr_cont
#include "linux/smp.h"                  // for smp_processor_id
#include "linux/stddef.h"               // for true, false
#include "linux/types.h"                // for bool
#include "vdso/bits.h"                  // for BIT

arch/x86/kernel/cpu/amd.c should remove these lines:
- #include <asm/apic.h>  // lines 13-13
- #include <asm/cpu.h>  // lines 15-15
- #include <asm/numa.h>  // lines 18-18
- #include <asm/pci-direct.h>  // lines 19-19
- #include <linux/elf.h>  // lines 4-4
- #include <linux/io.h>  // lines 7-7
- #include <linux/sched.h>  // lines 8-8
- #include <linux/sched/clock.h>  // lines 9-9
- #include <linux/topology.h>  // lines 11-11

The full include-list for arch/x86/kernel/cpu/amd.c:
#include <asm-generic/percpu.h>         // for per_cpu
#include <asm/bug.h>                    // for WARN_ONCE
#include <asm/cacheinfo.h>              // for cacheinfo_amd_init_llc_id
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/debugreg.h>               // for set_dr_addr_mask
#include <asm/delay.h>                  // for use_mwaitx_delay
#include <asm/processor.h>              // for cpuinfo_x86, cpuid, ENTRIES
#include <asm/resctrl.h>                // for resctrl_cpu_detect
#include <asm/smp.h>                    // for cpu_llc_id, smp_num_siblings
#include <asm/spec-ctrl.h>              // for x86_amd_ls_cfg_base, x86_amd_...
#include <linux/bitops.h>               // for get_count_order, BIT_64
#include <linux/export.h>               // for EXPORT_SYMBOL_GPL
#include <linux/mm.h>                   // for get_num_physpages
#include <linux/random.h>               // for get_random_int
#include "asm-generic/errno-base.h"     // for EINVAL
#include "asm-generic/int-ll64.h"       // for u32, u16, u64
#include "asm/cpufeature.h"             // for cpu_has, set_cpu_cap, clear_c...
#include "asm/cpufeatures.h"            // for X86_FEATURE_TOPOEXT, X86_FEAT...
#include "asm/elf.h"                    // for va_align, va_alignment, ALIGN...
#include "asm/mem_encrypt.h"            // for sme_me_mask
#include "asm/msr-index.h"              // for MSR_K6_WHCR, MSR_K7_HWCR, MSR...
#include "asm/msr.h"                    // for msr_set_bit, wrmsr, msr_clear...
#include "asm/page_types.h"             // for PAGE_MASK, PAGE_SHIFT
#include "asm/shared/io.h"              // for inl, outl
#include "asm/special_insns.h"          // for wbinvd
#include "asm/string_32.h"              // for strcmp, strcpy
#include "asm/topology.h"               // for __max_die_per_package
#include "cpu.h"                        // for check_null_seg_clears_base
#include "generated/autoconf.h"         // for CONFIG_X86_32
#include "linux/compiler.h"             // for OPTIMIZER_HIDE_VAR
#include "linux/compiler_attributes.h"  // for __visible, fallthrough
#include "linux/compiler_types.h"       // for inline
#include "linux/init.h"                 // for __init, early_param
#include "linux/irqflags.h"             // for local_irq_restore, local_irq_...
#include "linux/kconfig.h"              // for IS_ENABLED, __ARG_PLACEHOLDER_1
#include "linux/panic.h"                // for add_taint, LOCKDEP_NOW_UNRELI...
#include "linux/printk.h"               // for pr_info, pr_info_once, pr_cont
#include "linux/smp.h"                  // for smp_processor_id
#include "linux/stddef.h"               // for true, false
#include "linux/types.h"                // for bool
#include "vdso/bits.h"                  // for BIT
---
  ./scripts/check-local-export arch/x86/kernel/cpu/amd.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.hygon.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/hygon"' -DKBUILD_BASENAME='"hygon"' -DKBUILD_MODNAME='"hygon"' -D__KBUILD_MODNAME=kmod_hygon -c -o arch/x86/kernel/cpu/hygon.o arch/x86/kernel/cpu/hygon.c  
In file included from arch/x86/kernel/cpu/hygon.c:11:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/hygon.c:11:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/hygon.c:11:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/kernel/cpu/hygon.c:11:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/hygon.c:11:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/hygon.c:11:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/kernel/cpu/hygon.c should add these lines:
#include <asm-generic/percpu.h>    // for per_cpu
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include "asm-generic/int-ll64.h"  // for u16, u32, u64
#include "asm/cpufeature.h"        // for set_cpu_cap, cpu_has, boot_cpu_has
#include "asm/cpufeatures.h"       // for X86_FEATURE_TOPOEXT, X86_FEATURE_C...
#include "asm/msr-index.h"         // for MSR_FAM10H_NODE_ID, MSR_AMD64_LS_CFG
#include "asm/msr.h"               // for msr_set_bit, rdmsrl, rdmsrl_safe
#include "asm/processor.h"         // for cpuinfo_x86, ENTRIES, cpuid, cpuid...
#include "asm/topology.h"          // for __max_die_per_package
#include "linux/bitops.h"          // for get_count_order
#include "linux/printk.h"          // for FW_BUG, pr_warn
#include "linux/smp.h"             // for smp_processor_id
#include "vdso/bits.h"             // for BIT

arch/x86/kernel/cpu/hygon.c should remove these lines:
- #include <asm/cpu.h>  // lines 11-11
- #include <asm/numa.h>  // lines 13-13
- #include <linux/io.h>  // lines 9-9

The full include-list for arch/x86/kernel/cpu/hygon.c:
#include <asm-generic/percpu.h>    // for per_cpu
#include <asm/cacheinfo.h>         // for cacheinfo_hygon_init_llc_id
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/delay.h>             // for use_mwaitx_delay
#include <asm/smp.h>               // for cpu_llc_id, smp_num_siblings, hard...
#include <asm/spec-ctrl.h>         // for x86_amd_ls_cfg_base, x86_amd_ls_cf...
#include "asm-generic/int-ll64.h"  // for u16, u32, u64
#include "asm/cpufeature.h"        // for set_cpu_cap, cpu_has, boot_cpu_has
#include "asm/cpufeatures.h"       // for X86_FEATURE_TOPOEXT, X86_FEATURE_C...
#include "asm/msr-index.h"         // for MSR_FAM10H_NODE_ID, MSR_AMD64_LS_CFG
#include "asm/msr.h"               // for msr_set_bit, rdmsrl, rdmsrl_safe
#include "asm/processor.h"         // for cpuinfo_x86, ENTRIES, cpuid, cpuid...
#include "asm/topology.h"          // for __max_die_per_package
#include "cpu.h"                   // for check_null_seg_clears_base, cpu_de...
#include "linux/bitops.h"          // for get_count_order
#include "linux/printk.h"          // for FW_BUG, pr_warn
#include "linux/smp.h"             // for smp_processor_id
#include "vdso/bits.h"             // for BIT
---
  ./scripts/check-local-export arch/x86/kernel/cpu/hygon.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.cyrix.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/cyrix"' -DKBUILD_BASENAME='"cyrix"' -DKBUILD_MODNAME='"cyrix"' -D__KBUILD_MODNAME=kmod_cyrix -c -o arch/x86/kernel/cpu/cyrix.o arch/x86/kernel/cpu/cyrix.c  
In file included from arch/x86/kernel/cpu/cyrix.c:4:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/cyrix.c:4:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/cyrix.c:4:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/cpu/cyrix.c:4:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^
5 warnings generated.
In file included from arch/x86/kernel/cpu/cyrix.c:4:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/cyrix.c:4:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/cyrix.c:4:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/cpu/cyrix.c:4:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^

arch/x86/kernel/cpu/cyrix.c should add these lines:
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u8
#include "asm/cpufeatures.h"       // for X86_FEATURE_CYRIX_ARR, X86_BUG_COMA
#include "asm/processor-flags.h"   // for CX86_CCR3, CX86_CCR2, CX86_CCR4
#include "asm/processor.h"         // for cpuinfo_x86, X86_VENDOR_CYRIX, X86...
#include "asm/special_insns.h"     // for read_cr0, write_cr0
#include "asm/string_32.h"         // for strcpy, strcat
#include "linux/compiler_types.h"  // for inline
#include "linux/irqflags.h"        // for local_irq_restore, local_irq_save
#include "linux/printk.h"          // for pr_info

arch/x86/kernel/cpu/cyrix.c should remove these lines:
- #include <asm/dma.h>  // lines 5-5
- #include <asm/pci-direct.h>  // lines 10-10
- #include <asm/processor-flags.h>  // lines 8-8
- #include <asm/tsc.h>  // lines 11-11
- #include <linux/bitops.h>  // lines 2-2
- #include <linux/io.h>  // lines 6-6
- #include <linux/pci.h>  // lines 4-4
- #include <linux/sched.h>  // lines 13-13
- #include <linux/sched/clock.h>  // lines 14-14
- #include <linux/timer.h>  // lines 9-9

The full include-list for arch/x86/kernel/cpu/cyrix.c:
#include <asm/cpufeature.h>        // for clear_cpu_cap, set_cpu_cap, set_cp...
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/processor-cyrix.h>   // for getCx86, setCx86
#include <linux/delay.h>           // for calibrate_delay, loops_per_jiffy
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u8
#include "asm/cpufeatures.h"       // for X86_FEATURE_CYRIX_ARR, X86_BUG_COMA
#include "asm/processor-flags.h"   // for CX86_CCR3, CX86_CCR2, CX86_CCR4
#include "asm/processor.h"         // for cpuinfo_x86, X86_VENDOR_CYRIX, X86...
#include "asm/special_insns.h"     // for read_cr0, write_cr0
#include "asm/string_32.h"         // for strcpy, strcat
#include "cpu.h"                   // for cpu_detect_cache_sizes, cpu_dev
#include "linux/compiler_types.h"  // for inline
#include "linux/irqflags.h"        // for local_irq_restore, local_irq_save
#include "linux/printk.h"          // for pr_info
---
  ./scripts/check-local-export arch/x86/kernel/cpu/cyrix.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.centaur.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/centaur"' -DKBUILD_BASENAME='"centaur"' -DKBUILD_MODNAME='"centaur"' -D__KBUILD_MODNAME=kmod_centaur -c -o arch/x86/kernel/cpu/centaur.o arch/x86/kernel/cpu/centaur.c  
In file included from arch/x86/kernel/cpu/centaur.c:6:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/centaur.c:6:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/centaur.c:6:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/kernel/cpu/centaur.c:6:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/centaur.c:6:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/centaur.c:6:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/kernel/cpu/centaur.c should add these lines:
#include "asm-generic/int-ll64.h"  // for u32, __u32
#include "asm/cpufeatures.h"       // for X86_FEATURE_3DNOW, X86_FEATURE_CEN...
#include "asm/msr-index.h"         // for MSR_VIA_FCR, MSR_IDT_FCR1, MSR_VIA...
#include "asm/processor.h"         // for cpuinfo_x86, cpuid_eax, cpuid_edx
#include "linux/kernel.h"          // for sprintf
#include "linux/printk.h"          // for pr_info, pr_notice

arch/x86/kernel/cpu/centaur.c should remove these lines:
- #include <asm/e820/api.h>  // lines 8-8
- #include <asm/mtrr.h>  // lines 9-9
- #include <linux/sched.h>  // lines 3-3
- #include <linux/sched/clock.h>  // lines 4-4

The full include-list for arch/x86/kernel/cpu/centaur.c:
#include <asm/cpu.h>               // for init_ia32_feat_ctl
#include <asm/cpufeature.h>        // for set_cpu_cap, clear_cpu_cap, CPUID_...
#include <asm/msr.h>               // for wrmsr, rdmsr
#include "asm-generic/int-ll64.h"  // for u32, __u32
#include "asm/cpufeatures.h"       // for X86_FEATURE_3DNOW, X86_FEATURE_CEN...
#include "asm/msr-index.h"         // for MSR_VIA_FCR, MSR_IDT_FCR1, MSR_VIA...
#include "asm/processor.h"         // for cpuinfo_x86, cpuid_eax, cpuid_edx
#include "cpu.h"                   // for detect_ht, detect_num_cpu_cores
#include "linux/kernel.h"          // for sprintf
#include "linux/printk.h"          // for pr_info, pr_notice
---
  ./scripts/check-local-export arch/x86/kernel/cpu/centaur.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.transmeta.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/transmeta"' -DKBUILD_BASENAME='"transmeta"' -DKBUILD_MODNAME='"transmeta"' -D__KBUILD_MODNAME=kmod_transmeta -c -o arch/x86/kernel/cpu/transmeta.o arch/x86/kernel/cpu/transmeta.c  

arch/x86/kernel/cpu/transmeta.c should add these lines:
#include "asm-generic/int-ll64.h"  // for __u32, u32
#include "asm/cpufeatures.h"       // for X86_FEATURE_CONSTANT_TSC
#include "asm/processor.h"         // for cpu_info, cpuid, cpuid_eax, cpuid_edx
#include "linux/printk.h"          // for pr_info

arch/x86/kernel/cpu/transmeta.c should remove these lines:
- #include <linux/kernel.h>  // lines 2-2
- #include <linux/mm.h>  // lines 5-5
- #include <linux/sched.h>  // lines 3-3
- #include <linux/sched/clock.h>  // lines 4-4

The full include-list for arch/x86/kernel/cpu/transmeta.c:
#include <asm/cpufeature.h>        // for CPUID_1_EDX, CPUID_8086_0001_EDX
#include <asm/msr.h>               // for wrmsr, rdmsr
#include "asm-generic/int-ll64.h"  // for __u32, u32
#include "asm/cpufeatures.h"       // for X86_FEATURE_CONSTANT_TSC
#include "asm/processor.h"         // for cpu_info, cpuid, cpuid_eax, cpuid_edx
#include "cpu.h"                   // for cpu_detect_cache_sizes, cpu_dev
#include "linux/printk.h"          // for pr_info
---
  ./scripts/check-local-export arch/x86/kernel/cpu/transmeta.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.umc.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/umc"' -DKBUILD_BASENAME='"umc"' -DKBUILD_MODNAME='"umc"' -D__KBUILD_MODNAME=kmod_umc -c -o arch/x86/kernel/cpu/umc.o arch/x86/kernel/cpu/umc.c  

arch/x86/kernel/cpu/umc.c should add these lines:

arch/x86/kernel/cpu/umc.c should remove these lines:
- #include <linux/kernel.h>  // lines 2-2

The full include-list for arch/x86/kernel/cpu/umc.c:
#include <asm/processor.h>  // for X86_VENDOR_UMC
#include "cpu.h"            // for cpu_dev, cpu_dev_register
---
  ./scripts/check-local-export arch/x86/kernel/cpu/umc.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.zhaoxin.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/zhaoxin"' -DKBUILD_BASENAME='"zhaoxin"' -DKBUILD_MODNAME='"zhaoxin"' -D__KBUILD_MODNAME=kmod_zhaoxin -c -o arch/x86/kernel/cpu/zhaoxin.o arch/x86/kernel/cpu/zhaoxin.c  
In file included from arch/x86/kernel/cpu/zhaoxin.c:5:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/zhaoxin.c:5:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/zhaoxin.c:5:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/kernel/cpu/zhaoxin.c:5:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/cpu/zhaoxin.c:5:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/cpu/zhaoxin.c:5:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/kernel/cpu/zhaoxin.c should add these lines:
#include "asm-generic/int-ll64.h"  // for u32, __u32
#include "asm/cpufeatures.h"       // for X86_FEATURE_CONSTANT_TSC, X86_FEAT...
#include "asm/msr.h"               // for wrmsr, rdmsr
#include "asm/processor.h"         // for cpuinfo_x86, cpuid_eax, cpuid_edx
#include "linux/bitops.h"          // for get_count_order
#include "linux/printk.h"          // for pr_info

arch/x86/kernel/cpu/zhaoxin.c should remove these lines:
- #include <linux/sched.h>  // lines 2-2
- #include <linux/sched/clock.h>  // lines 3-3

The full include-list for arch/x86/kernel/cpu/zhaoxin.c:
#include <asm/cpu.h>               // for init_ia32_feat_ctl
#include <asm/cpufeature.h>        // for set_cpu_cap, CPUID_C000_0001_EDX
#include "asm-generic/int-ll64.h"  // for u32, __u32
#include "asm/cpufeatures.h"       // for X86_FEATURE_CONSTANT_TSC, X86_FEAT...
#include "asm/msr.h"               // for wrmsr, rdmsr
#include "asm/processor.h"         // for cpuinfo_x86, cpuid_eax, cpuid_edx
#include "cpu.h"                   // for detect_ht, detect_num_cpu_cores
#include "linux/bitops.h"          // for get_count_order
#include "linux/printk.h"          // for pr_info
---
  ./scripts/check-local-export arch/x86/kernel/cpu/zhaoxin.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/cpu/.vortex.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/cpu/vortex"' -DKBUILD_BASENAME='"vortex"' -DKBUILD_MODNAME='"vortex"' -D__KBUILD_MODNAME=kmod_vortex -c -o arch/x86/kernel/cpu/vortex.o arch/x86/kernel/cpu/vortex.c  

arch/x86/kernel/cpu/vortex.c should add these lines:

arch/x86/kernel/cpu/vortex.c should remove these lines:
- #include <linux/kernel.h>  // lines 2-2

The full include-list for arch/x86/kernel/cpu/vortex.c:
#include <asm/processor.h>  // for X86_VENDOR_VORTEX
#include "cpu.h"            // for cpu_dev, cpu_dev_register
---
  ./scripts/check-local-export arch/x86/kernel/cpu/vortex.o
  rm -f arch/x86/kernel/cpu/built-in.a; echo cacheinfo.o scattered.o topology.o common.o rdrand.o match.o bugs.o aperfmperf.o cpuid-deps.o umwait.o feat_ctl.o intel.o intel_pconfig.o tsx.o amd.o hygon.o cyrix.o centaur.o transmeta.o umc.o zhaoxin.o vortex.o | sed -E 's:([^ ]+):arch/x86/kernel/cpu/:g' | xargs llvm-ar cDPrST arch/x86/kernel/cpu/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/kernel/acpi \
 \
need-builtin=1 \
need-modorder=1
  rm -f arch/x86/kernel/acpi/built-in.a; echo  | sed -E 's:([^ ]+):arch/x86/kernel/acpi/:g' | xargs llvm-ar cDPrST arch/x86/kernel/acpi/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/kernel/apic \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,arch/x86/kernel/apic/.hw_nmi.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/apic/hw_nmi"' -DKBUILD_BASENAME='"hw_nmi"' -DKBUILD_MODNAME='"hw_nmi"' -D__KBUILD_MODNAME=kmod_hw_nmi -c -o arch/x86/kernel/apic/hw_nmi.o arch/x86/kernel/apic/hw_nmi.c  

arch/x86/kernel/apic/hw_nmi.c should add these lines:

arch/x86/kernel/apic/hw_nmi.c should remove these lines:
- #include <asm/apic.h>  // lines 13-13
- #include <asm/nmi.h>  // lines 14-14
- #include <linux/cpumask.h>  // lines 16-16
- #include <linux/delay.h>  // lines 22-22
- #include <linux/init.h>  // lines 21-21
- #include <linux/kdebug.h>  // lines 17-17
- #include <linux/kprobes.h>  // lines 19-19
- #include <linux/nmi.h>  // lines 20-20
- #include <linux/notifier.h>  // lines 18-18
- #include <linux/thread_info.h>  // lines 12-12

The full include-list for arch/x86/kernel/apic/hw_nmi.c:
---
  ./scripts/check-local-export arch/x86/kernel/apic/hw_nmi.o
  rm -f arch/x86/kernel/apic/built-in.a; echo hw_nmi.o | sed -E 's:([^ ]+):arch/x86/kernel/apic/:g' | xargs llvm-ar cDPrST arch/x86/kernel/apic/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/kernel/kprobes \
 \
need-builtin=1 \
need-modorder=1
  rm -f arch/x86/kernel/kprobes/built-in.a; echo  | sed -E 's:([^ ]+):arch/x86/kernel/kprobes/:g' | xargs llvm-ar cDPrST arch/x86/kernel/kprobes/built-in.a
  iwyu2 -Wp,-MMD,arch/x86/kernel/.head_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -D__ASSEMBLY__ -fno-PIE --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -m32 -fno-lto    -c -o arch/x86/kernel/head_32.o arch/x86/kernel/head_32.S 
  ./scripts/check-local-export arch/x86/kernel/head_32.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.head32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/head32"' -DKBUILD_BASENAME='"head32"' -DKBUILD_MODNAME='"head32"' -D__KBUILD_MODNAME=kmod_head32 -c -o arch/x86/kernel/head32.o arch/x86/kernel/head32.c  

arch/x86/kernel/head32.c should add these lines:
#include <asm/pgtable.h>                // for LOWMEM_PAGES, PAGE_TABLE_SIZE
#include <linux/linkage.h>              // for asmlinkage
#include "asm-generic/sections.h"       // for _end
#include "asm/bootparam.h"              // for X86_SUBARCH_CE4100, X86_SUBAR...
#include "asm/page_types.h"             // for PAGE_OFFSET, PAGE_SHIFT, PAGE...
#include "asm/pgtable-2level_types.h"   // for pte_t, PGDIR_SHIFT, PTRS_PER_PTE
#include "asm/pgtable_types.h"          // for pgd_t, PTE_PFN_MASK, PDE_IDEN...
#include "asm/x86_init.h"               // for x86_early_init_platform_quirks
#include "linux/compiler_attributes.h"  // for __visible

arch/x86/kernel/head32.c should remove these lines:
- #include <asm/apic.h>  // lines 19-19
- #include <asm/bios_ebda.h>  // lines 21-21
- #include <asm/e820/api.h>  // lines 17-17
- #include <linux/memblock.h>  // lines 12-12
- #include <linux/mm.h>  // lines 11-11

The full include-list for arch/x86/kernel/head32.c:
#include <asm/bootparam_utils.h>        // for sanitize_boot_params
#include <asm/desc.h>                   // for idt_setup_early_handler
#include <asm/io_apic.h>                // for setup_ioapic_ids_from_mpc
#include <asm/page.h>                   // for __pa
#include <asm/pgtable.h>                // for LOWMEM_PAGES, PAGE_TABLE_SIZE
#include <asm/sections.h>               // for __brk_base, _brk_end
#include <asm/setup.h>                  // for x86_ce4100_early_setup, x86_i...
#include <asm/tlbflush.h>               // for cr4_init_shadow
#include <linux/init.h>                 // for __init
#include <linux/linkage.h>              // for asmlinkage
#include <linux/start_kernel.h>         // for start_kernel
#include "asm-generic/sections.h"       // for _end
#include "asm/bootparam.h"              // for X86_SUBARCH_CE4100, X86_SUBAR...
#include "asm/page_types.h"             // for PAGE_OFFSET, PAGE_SHIFT, PAGE...
#include "asm/pgtable-2level_types.h"   // for pte_t, PGDIR_SHIFT, PTRS_PER_PTE
#include "asm/pgtable_types.h"          // for pgd_t, PTE_PFN_MASK, PDE_IDEN...
#include "asm/x86_init.h"               // for x86_early_init_platform_quirks
#include "linux/compiler_attributes.h"  // for __visible
---
  ./scripts/check-local-export arch/x86/kernel/head32.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.ebda.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/ebda"' -DKBUILD_BASENAME='"ebda"' -DKBUILD_MODNAME='"ebda"' -D__KBUILD_MODNAME=kmod_ebda -c -o arch/x86/kernel/ebda.o arch/x86/kernel/ebda.c  

arch/x86/kernel/ebda.c should add these lines:
#include "asm/page.h"        // for __va
#include "asm/x86_init.h"    // for x86_legacy_features, x86_platform, x86_p...

arch/x86/kernel/ebda.c should remove these lines:
- #include <asm/setup.h>  // lines 6-6
- #include <linux/kernel.h>  // lines 2-2

The full include-list for arch/x86/kernel/ebda.c:
#include <asm/bios_ebda.h>   // for get_bios_ebda, reserve_bios_regions
#include <linux/init.h>      // for __init
#include <linux/memblock.h>  // for memblock_reserve
#include "asm/page.h"        // for __va
#include "asm/x86_init.h"    // for x86_legacy_features, x86_platform, x86_p...
---
  ./scripts/check-local-export arch/x86/kernel/ebda.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.platform-quirks.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/platform-quirks"' -DKBUILD_BASENAME='"platform_quirks"' -DKBUILD_MODNAME='"platform_quirks"' -D__KBUILD_MODNAME=kmod_platform_quirks -c -o arch/x86/kernel/platform-quirks.o arch/x86/kernel/platform-quirks.c  

arch/x86/kernel/platform-quirks.c should add these lines:
#include "asm/bootparam.h"  // for X86_SUBARCH_CE4100, X86_SUBARCH_INTEL_MID
#include "asm/x86_init.h"   // for x86_platform, x86_platform_ops, x86_legac...
#include "linux/types.h"    // for bool

arch/x86/kernel/platform-quirks.c should remove these lines:
- #include <asm/bios_ebda.h>  // lines 6-6
- #include <linux/kernel.h>  // lines 2-2

The full include-list for arch/x86/kernel/platform-quirks.c:
#include <asm/setup.h>      // for boot_params
#include <linux/init.h>     // for __init
#include "asm/bootparam.h"  // for X86_SUBARCH_CE4100, X86_SUBARCH_INTEL_MID
#include "asm/x86_init.h"   // for x86_platform, x86_platform_ops, x86_legac...
#include "linux/types.h"    // for bool
---
  ./scripts/check-local-export arch/x86/kernel/platform-quirks.o
  iwyu2 -E -Wp,-MMD,arch/x86/kernel/.vmlinux.lds.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./=  -Ui386 -P -Ux86 -D__ASSEMBLY__ -DLINKER_SCRIPT -o arch/x86/kernel/vmlinux.lds arch/x86/kernel/vmlinux.lds.S
  iwyu2 -Wp,-MMD,arch/x86/kernel/.process_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/process_32"' -DKBUILD_BASENAME='"process_32"' -DKBUILD_MODNAME='"process_32"' -D__KBUILD_MODNAME=kmod_process_32 -c -o arch/x86/kernel/process_32.o arch/x86/kernel/process_32.c  
In file included from arch/x86/kernel/process_32.c:12:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/process_32.c:12:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/process_32.c:12:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/process_32.c:29:
In file included from ./include/linux/mc146818rtc.h:15:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
In file included from arch/x86/kernel/process_32.c:40:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
5 warnings generated.
In file included from arch/x86/kernel/process_32.c:12:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/process_32.c:12:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/process_32.c:12:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/process_32.c:29:
In file included from ./include/linux/mc146818rtc.h:15:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
In file included from arch/x86/kernel/process_32.c:40:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/process_32.c should add these lines:
#include <asm-generic/percpu.h>         // for this_cpu_write
#include <asm/bug.h>                    // for BUG_ON
#include <asm/page_types.h>             // for THREAD_SIZE
#include <asm/percpu.h>                 // for this_cpu_write_8
#include "asm-generic/int-ll64.h"       // for u16
#include "asm/current.h"                // for current_task
#include "asm/debugreg.h"               // for DR6_RESERVED
#include "asm/kdebug.h"                 // for SHOW_REGS_ALL, __show_regs
#include "asm/percpu.h"                 // for __pcpu_cast_1, __pcpu_cast_2
#include "asm/pgtable.h"                // for arch_end_context_switch
#include "asm/processor-flags.h"        // for X86_EFLAGS_IF
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/segment.h"                // for __USER_DS, __loadsegment_gs
#include "asm/special_insns.h"          // for __read_cr3, __read_cr4, read_cr0
#include "asm/stacktrace.h"             // for show_ip
#include "asm/thread_info.h"            // for TIF_NEED_FPU_LOAD
#include "linux/compiler_attributes.h"  // for __visible
#include "linux/printk.h"               // for printk
#include "linux/thread_info.h"          // for test_thread_flag

arch/x86/kernel/process_32.c should remove these lines:
- #include <asm/cpu.h>  // lines 50-50
- #include <asm/ldt.h>  // lines 42-42
- #include <asm/tlbflush.h>  // lines 49-49
- #include <linux/cpu.h>  // lines 12-12
- #include <linux/delay.h>  // lines 27-27
- #include <linux/elfcore.h>  // lines 20-20
- #include <linux/err.h>  // lines 47-47
- #include <linux/errno.h>  // lines 13-13
- #include <linux/fs.h>  // lines 17-17
- #include <linux/interrupt.h>  // lines 26-26
- #include <linux/io.h>  // lines 38-38
- #include <linux/kallsyms.h>  // lines 31-31
- #include <linux/kdebug.h>  // lines 39-39
- #include <linux/kernel.h>  // lines 18-18
- #include <linux/mc146818rtc.h>  // lines 29-29
- #include <linux/mm.h>  // lines 19-19
- #include <linux/percpu.h>  // lines 34-34
- #include <linux/personality.h>  // lines 33-33
- #include <linux/prctl.h>  // lines 35-35
- #include <linux/ptrace.h>  // lines 32-32
- #include <linux/reboot.h>  // lines 28-28
- #include <linux/sched/task.h>  // lines 15-15
- #include <linux/slab.h>  // lines 23-23
- #include <linux/stddef.h>  // lines 22-22
- #include <linux/uaccess.h>  // lines 37-37
- #include <linux/user.h>  // lines 25-25
- #include <linux/vmalloc.h>  // lines 24-24

The full include-list for arch/x86/kernel/process_32.c:
#include <asm-generic/percpu.h>         // for this_cpu_write
#include <asm/bug.h>                    // for BUG_ON
#include <asm/debugreg.h>               // for get_debugreg
#include <asm/desc.h>                   // for load_TLS
#include <asm/fpu/sched.h>              // for switch_fpu_finish, switch_fpu...
#include <asm/page_types.h>             // for THREAD_SIZE
#include <asm/percpu.h>                 // for this_cpu_write_8
#include <asm/processor.h>              // for cpu_current_top_of_stack, thr...
#include <asm/proto.h>                  // for do_arch_prctl_common
#include <asm/resctrl.h>                // for resctrl_sched_in
#include <asm/switch_to.h>              // for refresh_sysenter_cs, update_t...
#include <asm/vm86.h>                   // for release_vm86_irqs
#include <linux/export.h>               // for EXPORT_SYMBOL_GPL
#include <linux/ftrace.h>               // for __notrace_funcgraph
#include <linux/sched.h>                // for task_struct
#include <linux/sched/task_stack.h>     // for task_stack_page
#include <linux/smp.h>                  // for smp_processor_id
#include <linux/syscalls.h>             // for __MAP2, SYSCALL_DEFINE2
#include "asm-generic/int-ll64.h"       // for u16
#include "asm/current.h"                // for current_task
#include "asm/debugreg.h"               // for DR6_RESERVED
#include "asm/kdebug.h"                 // for SHOW_REGS_ALL, __show_regs
#include "asm/percpu.h"                 // for __pcpu_cast_1, __pcpu_cast_2
#include "asm/pgtable.h"                // for arch_end_context_switch
#include "asm/processor-flags.h"        // for X86_EFLAGS_IF
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/segment.h"                // for __USER_DS, __loadsegment_gs
#include "asm/special_insns.h"          // for __read_cr3, __read_cr4, read_cr0
#include "asm/stacktrace.h"             // for show_ip
#include "asm/thread_info.h"            // for TIF_NEED_FPU_LOAD
#include "linux/compiler_attributes.h"  // for __visible
#include "linux/printk.h"               // for printk
#include "linux/thread_info.h"          // for test_thread_flag
#include "process.h"                    // for switch_to_extra
---
  ./scripts/check-local-export arch/x86/kernel/process_32.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.signal.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/signal"' -DKBUILD_BASENAME='"signal"' -DKBUILD_MODNAME='"signal"' -D__KBUILD_MODNAME=kmod_signal -c -o arch/x86/kernel/signal.o arch/x86/kernel/signal.c  
In file included from arch/x86/kernel/signal.c:28:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/signal.c:28:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/signal.c:28:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/signal.c:28:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/kernel/signal.c:28:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/signal.c:28:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/signal.c:28:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/signal.c:28:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/signal.c should add these lines:
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <signal.h>                     // for sigset_t, size_t
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EFAULT, EINTR
#include "asm-generic/int-ll64.h"       // for u64, __u64, __u32, u32, u16, u8
#include "asm-generic/signal-defs.h"    // for SA_ONSTACK, SA_RESTART, SA_SI...
#include "asm-generic/ucontext.h"       // for ucontext
#include "asm/cpufeature.h"             // for static_cpu_has
#include "asm/cpufeatures.h"            // for X86_FEATURE_XSAVE
#include "asm/current.h"                // for current
#include "asm/elf.h"                    // for get_sigframe_size
#include "asm/fpu/types.h"              // for fpu, fpu_state_perm
#include "asm/mmu.h"                    // for mm_context_t
#include "asm/processor-flags.h"        // for X86_EFLAGS_DF, X86_EFLAGS_RF
#include "asm/ptrace.h"                 // for pt_regs, v8086_mode
#include "asm/segment.h"                // for __USER_DS, __USER_CS, __loads...
#include "asm/sigcontext.h"             // for sigcontext_32, sigcontext
#include "asm/thread_info.h"            // for TIF_SINGLESTEP
#include "asm/uaccess.h"                // for unsafe_put_user, __get_user
#include "asm/unistd_32.h"              // for __NR_restart_syscall, __NR_rt...
#include "asm/vm86.h"                   // for VM86_SIGNAL
#include "generated/autoconf.h"         // for CONFIG_X86_32
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler.h"             // for likely, unlikely
#include "linux/compiler_attributes.h"  // for __always_inline, fallthrough
#include "linux/compiler_types.h"       // for __user, inline
#include "linux/init.h"                 // for __init, __setup
#include "linux/kconfig.h"              // for __ARG_PLACEHOLDER_1, IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_CONT, KERN_EMERG, KERN_INFO
#include "linux/lockdep.h"              // for lockdep_assert_held
#include "linux/math.h"                 // for round_up
#include "linux/mm_types.h"             // for mm_struct, mm_struct::(anonym...
#include "linux/printk.h"               // for printk_ratelimit, pr_info
#include "linux/ptrace.h"               // for user_disable_single_step, cur...
#include "linux/restart_block.h"        // for do_no_restart_syscall, restar...
#include "linux/sched/signal.h"         // for __on_sig_stack, force_sig
#include "linux/signal.h"               // for set_current_blocked, copy_sig...
#include "linux/signal_types.h"         // for ksignal, k_sigaction, sigaction
#include "linux/thread_info.h"          // for test_thread_flag
#include "linux/types.h"                // for bool

arch/x86/kernel/signal.c should remove these lines:
- #include <asm/mce.h>  // lines 36-36
- #include <linux/context_tracking.h>  // lines 27-27
- #include <linux/kernel.h>  // lines 17-17
- #include <linux/personality.h>  // lines 23-23
- #include <linux/sched/task_stack.h>  // lines 14-14
- #include <linux/smp.h>  // lines 16-16
- #include <linux/unistd.h>  // lines 21-21
- #include <linux/uprobes.h>  // lines 26-26
- #include <linux/user-return-notifier.h>  // lines 25-25
- #include <linux/wait.h>  // lines 20-20

The full include-list for arch/x86/kernel/signal.c:
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/fpu/signal.h>             // for copy_fpstate_to_sigframe, fpu...
#include <asm/fpu/xstate.h>             // for fpu_state_size_dynamic, XFEAT...
#include <asm/processor.h>              // for thread_struct
#include <asm/sigframe.h>               // for rt_sigframe, sigframe, sigfra...
#include <asm/sighandling.h>            // for FIX_EFLAGS, signal_fault
#include <asm/signal.h>                 // for SA_RESTORER, compat_sigset_t
#include <asm/syscall.h>                // for syscall_get_error, syscall_ge...
#include <asm/ucontext.h>               // for UC_FP_XSTATE
#include <asm/vdso.h>                   // for vdso_image, vdso_image_32
#include <asm/vm86.h>                   // for save_v86_state
#include <linux/entry-common.h>         // for arch_do_signal_or_restart
#include <linux/errno.h>                // for ERESTARTNOHAND, ERESTARTNOINTR
#include <linux/kstrtox.h>              // for kstrtobool
#include <linux/mm.h>                   // for print_vma_addr
#include <linux/sched.h>                // for task_struct, task_pid_nr, rse...
#include <linux/stddef.h>               // for true, false
#include <linux/syscalls.h>             // for SYSCALL_DEFINE0
#include <linux/uaccess.h>              // for copy_from_user
#include <signal.h>                     // for sigset_t, size_t
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EFAULT, EINTR
#include "asm-generic/int-ll64.h"       // for u64, __u64, __u32, u32, u16, u8
#include "asm-generic/signal-defs.h"    // for SA_ONSTACK, SA_RESTART, SA_SI...
#include "asm-generic/ucontext.h"       // for ucontext
#include "asm/cpufeature.h"             // for static_cpu_has
#include "asm/cpufeatures.h"            // for X86_FEATURE_XSAVE
#include "asm/current.h"                // for current
#include "asm/elf.h"                    // for get_sigframe_size
#include "asm/fpu/types.h"              // for fpu, fpu_state_perm
#include "asm/mmu.h"                    // for mm_context_t
#include "asm/processor-flags.h"        // for X86_EFLAGS_DF, X86_EFLAGS_RF
#include "asm/ptrace.h"                 // for pt_regs, v8086_mode
#include "asm/segment.h"                // for __USER_DS, __USER_CS, __loads...
#include "asm/sigcontext.h"             // for sigcontext_32, sigcontext
#include "asm/thread_info.h"            // for TIF_SINGLESTEP
#include "asm/uaccess.h"                // for unsafe_put_user, __get_user
#include "asm/unistd_32.h"              // for __NR_restart_syscall, __NR_rt...
#include "asm/vm86.h"                   // for VM86_SIGNAL
#include "generated/autoconf.h"         // for CONFIG_X86_32
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler.h"             // for likely, unlikely
#include "linux/compiler_attributes.h"  // for __always_inline, fallthrough
#include "linux/compiler_types.h"       // for __user, inline
#include "linux/init.h"                 // for __init, __setup
#include "linux/kconfig.h"              // for __ARG_PLACEHOLDER_1, IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_CONT, KERN_EMERG, KERN_INFO
#include "linux/lockdep.h"              // for lockdep_assert_held
#include "linux/math.h"                 // for round_up
#include "linux/mm_types.h"             // for mm_struct, mm_struct::(anonym...
#include "linux/printk.h"               // for printk_ratelimit, pr_info
#include "linux/ptrace.h"               // for user_disable_single_step, cur...
#include "linux/restart_block.h"        // for do_no_restart_syscall, restar...
#include "linux/sched/signal.h"         // for __on_sig_stack, force_sig
#include "linux/signal.h"               // for set_current_blocked, copy_sig...
#include "linux/signal_types.h"         // for ksignal, k_sigaction, sigaction
#include "linux/thread_info.h"          // for test_thread_flag
#include "linux/types.h"                // for bool
---
  ./scripts/check-local-export arch/x86/kernel/signal.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.traps.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/traps"' -DKBUILD_BASENAME='"traps"' -DKBUILD_MODNAME='"traps"' -D__KBUILD_MODNAME=kmod_traps -c -o arch/x86/kernel/traps.o arch/x86/kernel/traps.c  
In file included from arch/x86/kernel/traps.c:50:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/traps.c:50:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/traps.c:50:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/traps.c:50:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/kernel/traps.c:50:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/traps.c:50:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/traps.c:50:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/traps.c:50:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/traps.c should add these lines:
#include <asm/bug.h>                    // for WARN_ON_ONCE, WARN, WARN_ON
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/page_types.h>             // for TASK_SIZE_MAX
#include <asm/signal.h>                 // for SIGSEGV, SIGBUS, SIGFPE, SIGILL
#include <linux/rcupdate.h>             // for rcu_is_watching
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EFAULT, EPERM
#include "asm-generic/int-ll64.h"       // for u64, u8
#include "asm-generic/kprobes.h"        // for NOKPROBE_SYMBOL, nokprobe_inline
#include "asm-generic/siginfo.h"        // for BUS_ADRALN, FPE_INTDIV, ILL_B...
#include "asm/bug.h"                    // for INSN_UD2, LEN_UD2
#include "asm/cpufeature.h"             // for static_cpu_has, cpu_feature_e...
#include "asm/cpufeatures.h"            // for X86_FEATURE_UMIP, X86_FEATURE...
#include "asm/current.h"                // for current
#include "asm/debugreg.h"               // for DR_STEP, DR6_RESERVED, DR_BUS...
#include "asm/extable.h"                // for fixup_exception
#include "asm/idtentry.h"               // for DEFINE_IDTENTRY, DEFINE_IDTEN...
#include "asm/irq_vectors.h"            // for NR_VECTORS
#include "asm/kdebug.h"                 // for die, DIE_TRAP, die_addr, DIE_...
#include "asm/mem_encrypt.h"            // for sev_es_init_vc_handling
#include "asm/msr-index.h"              // for MSR_IA32_DEBUGCTLMSR, MSR_IA3...
#include "asm/msr.h"                    // for wrmsrl, rdmsrl
#include "asm/processor-flags.h"        // for X86_EFLAGS_IF, X86_CR0_TS
#include "asm/ptrace.h"                 // for user_mode, pt_regs, v8086_mode
#include "asm/special_insns.h"          // for read_cr0, write_cr0
#include "asm/thread_info.h"            // for TIF_BLOCKSTEP
#include "asm/trapnr.h"                 // for X86_TRAP_GP, X86_TRAP_AC, X86...
#include "asm/uaccess.h"                // for get_user
#include "linux/compiler_attributes.h"  // for __always_inline
#include "linux/compiler_types.h"       // for __user, inline, noinstr
#include "linux/cpu.h"                  // for cpu_init, trap_init
#include "linux/entry-common.h"         // for irqentry_nmi_enter, irqentry_...
#include "linux/instrumentation.h"      // for instrumentation_begin, instru...
#include "linux/irqflags.h"             // for local_irq_disable, local_irq_...
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_CONT
#include "linux/notifier.h"             // for NOTIFY_STOP
#include "linux/panic.h"                // for panic
#include "linux/preempt.h"              // for preemptible
#include "linux/printk.h"               // for printk_ratelimit, pr_cont
#include "linux/rcupdate.h"             // for RCU_LOCKDEP_WARN
#include "linux/sched/signal.h"         // for force_sig, force_sig_fault
#include "linux/signal.h"               // for unhandled_signal, show_unhand...
#include "linux/stddef.h"               // for false, true
#include "linux/thread_info.h"          // for clear_thread_flag, test_threa...
#include "linux/types.h"                // for bool, DECLARE_BITMAP

arch/x86/kernel/traps.c should remove these lines:
- #include <asm/alternative.h>  // lines 58-58
- #include <asm/fixmap.h>  // lines 56-56
- #include <asm/ftrace.h>  // lines 49-49
- #include <asm/mach_traps.h>  // lines 57-57
- #include <asm/mce.h>  // lines 55-55
- #include <asm/processor-flags.h>  // lines 67-67
- #include <asm/realmode.h>  // lines 47-47
- #include <asm/setup.h>  // lines 68-68
- #include <asm/stacktrace.h>  // lines 44-44
- #include <asm/tdx.h>  // lines 65-65
- #include <linux/atomic.h>  // lines 41-41
- #include <linux/context_tracking.h>  // lines 15-15
- #include <linux/delay.h>  // lines 28-28
- #include <linux/errno.h>  // lines 29-29
- #include <linux/export.h>  // lines 24-24
- #include <linux/hardirq.h>  // lines 40-40
- #include <linux/interrupt.h>  // lines 16-16
- #include <linux/io.h>  // lines 39-39
- #include <linux/kallsyms.h>  // lines 17-17
- #include <linux/kexec.h>  // lines 30-30
- #include <linux/kgdb.h>  // lines 22-22
- #include <linux/nmi.h>  // lines 36-36
- #include <linux/ptrace.h>  // lines 25-25
- #include <linux/sched/task_stack.h>  // lines 32-32
- #include <linux/smp.h>  // lines 38-38
- #include <linux/spinlock.h>  // lines 18-18
- #include <linux/string.h>  // lines 27-27
- #include <linux/timer.h>  // lines 33-33

The full include-list for arch/x86/kernel/traps.c:
#include <asm/bug.h>                    // for WARN_ON_ONCE, WARN, WARN_ON
#include <asm/cpu.h>                    // for handle_bus_lock, handle_user_...
#include <asm/cpu_entry_area.h>         // for setup_cpu_entry_areas
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/debugreg.h>               // for local_db_restore, local_db_save
#include <asm/desc.h>                   // for idt_setup_traps
#include <asm/fpu/api.h>                // for fpu__exception_code, fpu_sync...
#include <asm/fpu/xstate.h>             // for xfd_enable_feature
#include <asm/insn-eval.h>              // for insn_get_addr_ref, insn_get_e...
#include <asm/insn.h>                   // for MAX_INSN_SIZE, insn, insn_dec...
#include <asm/page_types.h>             // for TASK_SIZE_MAX
#include <asm/processor.h>              // for thread_struct, cpu_init_excep...
#include <asm/proto.h>                  // for __begin_SYSENTER_singlestep_r...
#include <asm/signal.h>                 // for SIGSEGV, SIGBUS, SIGFPE, SIGILL
#include <asm/text-patching.h>          // for poke_int3_handler
#include <asm/traps.h>                  // for get_si_code
#include <asm/umip.h>                   // for fixup_umip_exception
#include <asm/vdso.h>                   // for fixup_vdso_exception
#include <asm/vm86.h>                   // for handle_vm86_trap, handle_vm86...
#include <linux/bug.h>                  // for report_bug, BUG_TRAP_TYPE_WARN
#include <linux/init.h>                 // for __init
#include <linux/kdebug.h>               // for notify_die
#include <linux/kernel.h>               // for snprintf
#include <linux/kprobes.h>              // for kprobe_fault_handler, kprobe_...
#include <linux/mm.h>                   // for print_vma_addr
#include <linux/rcupdate.h>             // for rcu_is_watching
#include <linux/sched.h>                // for task_struct, task_pid_nr
#include <linux/uaccess.h>              // for copy_from_kernel_nofault
#include <linux/uprobes.h>              // for uprobe_get_trap_addr
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EFAULT, EPERM
#include "asm-generic/int-ll64.h"       // for u64, u8
#include "asm-generic/kprobes.h"        // for NOKPROBE_SYMBOL, nokprobe_inline
#include "asm-generic/siginfo.h"        // for BUS_ADRALN, FPE_INTDIV, ILL_B...
#include "asm/bug.h"                    // for INSN_UD2, LEN_UD2
#include "asm/cpufeature.h"             // for static_cpu_has, cpu_feature_e...
#include "asm/cpufeatures.h"            // for X86_FEATURE_UMIP, X86_FEATURE...
#include "asm/current.h"                // for current
#include "asm/debugreg.h"               // for DR_STEP, DR6_RESERVED, DR_BUS...
#include "asm/extable.h"                // for fixup_exception
#include "asm/idtentry.h"               // for DEFINE_IDTENTRY, DEFINE_IDTEN...
#include "asm/irq_vectors.h"            // for NR_VECTORS
#include "asm/kdebug.h"                 // for die, DIE_TRAP, die_addr, DIE_...
#include "asm/mem_encrypt.h"            // for sev_es_init_vc_handling
#include "asm/msr-index.h"              // for MSR_IA32_DEBUGCTLMSR, MSR_IA3...
#include "asm/msr.h"                    // for wrmsrl, rdmsrl
#include "asm/processor-flags.h"        // for X86_EFLAGS_IF, X86_CR0_TS
#include "asm/ptrace.h"                 // for user_mode, pt_regs, v8086_mode
#include "asm/special_insns.h"          // for read_cr0, write_cr0
#include "asm/thread_info.h"            // for TIF_BLOCKSTEP
#include "asm/trapnr.h"                 // for X86_TRAP_GP, X86_TRAP_AC, X86...
#include "asm/uaccess.h"                // for get_user
#include "linux/compiler_attributes.h"  // for __always_inline
#include "linux/compiler_types.h"       // for __user, inline, noinstr
#include "linux/cpu.h"                  // for cpu_init, trap_init
#include "linux/entry-common.h"         // for irqentry_nmi_enter, irqentry_...
#include "linux/instrumentation.h"      // for instrumentation_begin, instru...
#include "linux/irqflags.h"             // for local_irq_disable, local_irq_...
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_CONT
#include "linux/notifier.h"             // for NOTIFY_STOP
#include "linux/panic.h"                // for panic
#include "linux/preempt.h"              // for preemptible
#include "linux/printk.h"               // for printk_ratelimit, pr_cont
#include "linux/rcupdate.h"             // for RCU_LOCKDEP_WARN
#include "linux/sched/signal.h"         // for force_sig, force_sig_fault
#include "linux/signal.h"               // for unhandled_signal, show_unhand...
#include "linux/stddef.h"               // for false, true
#include "linux/thread_info.h"          // for clear_thread_flag, test_threa...
#include "linux/types.h"                // for bool, DECLARE_BITMAP
---
  ./scripts/check-local-export arch/x86/kernel/traps.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.idt.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/idt"' -DKBUILD_BASENAME='"idt"' -DKBUILD_MODNAME='"idt"' -D__KBUILD_MODNAME=kmod_idt -c -o arch/x86/kernel/idt.o arch/x86/kernel/idt.c  
In file included from arch/x86/kernel/idt.c:9:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/idt.c:9:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/idt.c:9:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/idt.c:9:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/kernel/idt.c:9:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/idt.c:9:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/idt.c:9:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/idt.c:9:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/idt.c should add these lines:
#include <asm/bug.h>                                 // for WARN_ON
#include <linux/bitmap.h>                            // for for_each_clear_b...
#include <stddef.h>                                  // for NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit, test_an...
#include "asm-generic/set_memory.h"                  // for set_memory_ro
#include "asm/desc_defs.h"                           // for GATE_INTERRUPT
#include "asm/irq_vectors.h"                         // for FIRST_EXTERNAL_V...
#include "asm/page.h"                                // for __pa_symbol
#include "asm/pgtable_areas.h"                       // for CPU_ENTRY_AREA_R...
#include "asm/pgtable_types.h"                       // for PAGE_KERNEL_RO
#include "asm/segment.h"                             // for __KERNEL_CS, IDT...
#include "asm/trapnr.h"                              // for X86_TRAP_DB, X86...
#include "linux/cache.h"                             // for __ro_after_init
#include "linux/init.h"                              // for __init, __initconst
#include "linux/kernel.h"                            // for ARRAY_SIZE
#include "linux/linkage.h"                           // for __page_aligned_bss
#include "linux/lockdep.h"                           // for lockdep_assert_i...
#include "linux/stddef.h"                            // for true, false
#include "linux/types.h"                             // for bool

arch/x86/kernel/idt.c should remove these lines:
- #include <asm/set_memory.h>  // lines 8-8
- #include <asm/traps.h>  // lines 9-9
- #include <linux/interrupt.h>  // lines 5-5

The full include-list for arch/x86/kernel/idt.c:
#include <asm/bug.h>                                 // for WARN_ON
#include <asm/cpu_entry_area.h>                      // for cea_set_pte
#include <asm/desc.h>                                // for load_idt, system...
#include <asm/hw_irq.h>                              // for irq_entries_start
#include <asm/idtentry.h>                            // for asm_exc_debug
#include <asm/proto.h>                               // for entry_INT80_32
#include <linux/bitmap.h>                            // for for_each_clear_b...
#include <stddef.h>                                  // for NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit, test_an...
#include "asm-generic/set_memory.h"                  // for set_memory_ro
#include "asm/desc_defs.h"                           // for GATE_INTERRUPT
#include "asm/irq_vectors.h"                         // for FIRST_EXTERNAL_V...
#include "asm/page.h"                                // for __pa_symbol
#include "asm/pgtable_areas.h"                       // for CPU_ENTRY_AREA_R...
#include "asm/pgtable_types.h"                       // for PAGE_KERNEL_RO
#include "asm/segment.h"                             // for __KERNEL_CS, IDT...
#include "asm/trapnr.h"                              // for X86_TRAP_DB, X86...
#include "linux/cache.h"                             // for __ro_after_init
#include "linux/init.h"                              // for __init, __initconst
#include "linux/kernel.h"                            // for ARRAY_SIZE
#include "linux/linkage.h"                           // for __page_aligned_bss
#include "linux/lockdep.h"                           // for lockdep_assert_i...
#include "linux/stddef.h"                            // for true, false
#include "linux/types.h"                             // for bool
---
  ./scripts/check-local-export arch/x86/kernel/idt.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.irq.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -I ./arch/x86/kernel/../include/asm/trace    -DKBUILD_MODFILE='"arch/x86/kernel/irq"' -DKBUILD_BASENAME='"irq"' -DKBUILD_MODNAME='"irq"' -D__KBUILD_MODNAME=kmod_irq -c -o arch/x86/kernel/irq.o arch/x86/kernel/irq.c  
In file included from arch/x86/kernel/irq.c:5:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/irq.c:5:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/irq.c:5:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/irq.c:23:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/kernel/irq.c:5:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/irq.c:5:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/irq.c:5:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/irq.c:23:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/irq.c should add these lines:
#include <asm-generic/percpu.h>                // for per_cpu, DEFINE_PER_CP...
#include <asm/percpu.h>                        // for raw_cpu_read_8, raw_cp...
#include <linux/rcupdate.h>                    // for rcu_is_watching
#include "asm-generic/int-ll64.h"              // for u64
#include "asm-generic/irq_regs.h"              // for set_irq_regs
#include "asm/hardirq.h"                       // for (anonymous), ack_bad_irq
#include "asm/idtentry.h"                      // for DEFINE_IDTENTRY_IRQ
#include "asm/percpu.h"                        // for __pcpu_op2_1, __pcpu_o...
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read
#include "linux/compiler.h"                    // for likely
#include "linux/compiler_attributes.h"         // for __always_inline
#include "linux/cpumask.h"                     // for for_each_online_cpu
#include "linux/err.h"                         // for IS_ERR_OR_NULL
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/printk.h"                      // for printk_ratelimit, pr_e...
#include "linux/rcupdate.h"                    // for RCU_LOCKDEP_WARN
#include "linux/types.h"                       // for atomic_t
struct pt_regs;

arch/x86/kernel/irq.c should remove these lines:
- #include <asm/desc.h>  // lines 22-22
- #include <asm/io_apic.h>  // lines 18-18
- #include <asm/irq_stack.h>  // lines 16-16
- #include <asm/mce.h>  // lines 20-20
- #include <asm/thermal.h>  // lines 24-24
- #include <asm/trace/irq_vectors.h>  // lines 27-27
- #include <asm/traps.h>  // lines 23-23
- #include <linux/cpu.h>  // lines 5-5
- #include <linux/delay.h>  // lines 12-12
- #include <linux/export.h>  // lines 13-13
- #include <linux/ftrace.h>  // lines 11-11
- #include <linux/kernel_stat.h>  // lines 7-7
- #include <linux/of.h>  // lines 8-8

The full include-list for arch/x86/kernel/irq.c:
#include <asm-generic/percpu.h>                // for per_cpu, DEFINE_PER_CP...
#include <asm/apic.h>                          // for ack_APIC_irq
#include <asm/hw_irq.h>                        // for vector_irq, VECTOR_UNUSED
#include <asm/irq.h>                           // for __handle_irq
#include <asm/percpu.h>                        // for raw_cpu_read_8, raw_cp...
#include <linux/interrupt.h>                   // for arch_show_interrupts
#include <linux/irq.h>                         // for generic_handle_irq_desc
#include <linux/rcupdate.h>                    // for rcu_is_watching
#include <linux/seq_file.h>                    // for seq_printf, seq_puts
#include <linux/smp.h>                         // for smp_processor_id
#include "asm-generic/int-ll64.h"              // for u64
#include "asm-generic/irq_regs.h"              // for set_irq_regs
#include "asm/hardirq.h"                       // for (anonymous), ack_bad_irq
#include "asm/idtentry.h"                      // for DEFINE_IDTENTRY_IRQ
#include "asm/percpu.h"                        // for __pcpu_op2_1, __pcpu_o...
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read
#include "linux/compiler.h"                    // for likely
#include "linux/compiler_attributes.h"         // for __always_inline
#include "linux/cpumask.h"                     // for for_each_online_cpu
#include "linux/err.h"                         // for IS_ERR_OR_NULL
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/printk.h"                      // for printk_ratelimit, pr_e...
#include "linux/rcupdate.h"                    // for RCU_LOCKDEP_WARN
#include "linux/types.h"                       // for atomic_t
struct pt_regs;
---
  ./scripts/check-local-export arch/x86/kernel/irq.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.irq_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/irq_32"' -DKBUILD_BASENAME='"irq_32"' -DKBUILD_MODNAME='"irq_32"' -D__KBUILD_MODNAME=kmod_irq_32 -c -o arch/x86/kernel/irq_32.o arch/x86/kernel/irq_32.c  
In file included from arch/x86/kernel/irq_32.c:17:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/irq_32.c:17:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/irq_32.c:17:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/kernel/irq_32.c:17:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/irq_32.c:17:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/irq_32.c:17:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/kernel/irq_32.c should add these lines:
#include <asm-generic/percpu.h>         // for per_cpu, DEFINE_PER_CPU, __th...
#include <asm/page_types.h>             // for THREAD_SIZE_ORDER, THREAD_SIZE
#include <asm/percpu.h>                 // for raw_cpu_read_8
#include "asm-generic/errno-base.h"     // for ENOMEM
#include "asm-generic/int-ll64.h"       // for u32
#include "asm-generic/softirq_stack.h"  // for do_softirq_own_stack
#include "asm-generic/topology.h"       // for cpu_to_node
#include "asm/asm.h"                    // for current_stack_pointer
#include "asm/irq.h"                    // for __handle_irq, irq_init_percpu...
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/processor.h"              // for irq_stack
#include "asm/ptrace.h"                 // for user_mode, pt_regs (ptr only)
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_types.h"       // for inline
#include "linux/gfp.h"                  // for alloc_pages_node, __free_pages
#include "linux/thread_info.h"          // for THREADINFO_GFP

arch/x86/kernel/irq_32.c should remove these lines:
- #include <asm/apic.h>  // lines 23-23
- #include <asm/softirq_stack.h>  // lines 25-25
- #include <linux/cpu.h>  // lines 17-17
- #include <linux/delay.h>  // lines 18-18
- #include <linux/kernel_stat.h>  // lines 15-15
- #include <linux/notifier.h>  // lines 16-16
- #include <linux/percpu.h>  // lines 20-20
- #include <linux/seq_file.h>  // lines 12-12
- #include <linux/uaccess.h>  // lines 19-19

The full include-list for arch/x86/kernel/irq_32.c:
#include <asm-generic/percpu.h>         // for per_cpu, DEFINE_PER_CPU, __th...
#include <asm/nospec-branch.h>          // for CALL_NOSPEC
#include <asm/page_types.h>             // for THREAD_SIZE_ORDER, THREAD_SIZE
#include <asm/percpu.h>                 // for raw_cpu_read_8
#include <linux/interrupt.h>            // for __do_softirq
#include <linux/irq.h>                  // for generic_handle_irq_desc, irq_...
#include <linux/mm.h>                   // for page_address
#include "asm-generic/errno-base.h"     // for ENOMEM
#include "asm-generic/int-ll64.h"       // for u32
#include "asm-generic/softirq_stack.h"  // for do_softirq_own_stack
#include "asm-generic/topology.h"       // for cpu_to_node
#include "asm/asm.h"                    // for current_stack_pointer
#include "asm/irq.h"                    // for __handle_irq, irq_init_percpu...
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/processor.h"              // for irq_stack
#include "asm/ptrace.h"                 // for user_mode, pt_regs (ptr only)
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_types.h"       // for inline
#include "linux/gfp.h"                  // for alloc_pages_node, __free_pages
#include "linux/thread_info.h"          // for THREADINFO_GFP
---
  ./scripts/check-local-export arch/x86/kernel/irq_32.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.dumpstack_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/dumpstack_32"' -DKBUILD_BASENAME='"dumpstack_32"' -DKBUILD_MODNAME='"dumpstack_32"' -D__KBUILD_MODNAME=kmod_dumpstack_32 -c -o arch/x86/kernel/dumpstack_32.o arch/x86/kernel/dumpstack_32.c  

arch/x86/kernel/dumpstack_32.c should add these lines:
#include <asm-generic/percpu.h>      // for this_cpu_read
#include <asm/page_types.h>          // for THREAD_SIZE
#include <asm/percpu.h>              // for this_cpu_read_8
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm/cpu_entry_area.h"      // for get_cpu_entry_area, doublefault_...
#include "asm/current.h"             // for current
#include "asm/percpu.h"              // for __pcpu_op2_1, __pcpu_op2_2, __pc...
#include "asm/processor.h"           // for cpu_tss_rw, hardirq_stack_ptr
#include "linux/kern_levels.h"       // for KERN_WARNING
#include "linux/printk.h"            // for printk_deferred_once
#include "linux/smp.h"               // for raw_smp_processor_id
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool
struct task_struct;

arch/x86/kernel/dumpstack_32.c should remove these lines:
- #include <linux/bug.h>  // lines 16-16
- #include <linux/export.h>  // lines 12-12
- #include <linux/hardirq.h>  // lines 10-10
- #include <linux/kallsyms.h>  // lines 7-7
- #include <linux/kdebug.h>  // lines 11-11
- #include <linux/kexec.h>  // lines 14-14
- #include <linux/kprobes.h>  // lines 8-8
- #include <linux/nmi.h>  // lines 17-17
- #include <linux/ptrace.h>  // lines 13-13
- #include <linux/sched/debug.h>  // lines 6-6
- #include <linux/sysfs.h>  // lines 15-15
- #include <linux/uaccess.h>  // lines 9-9

The full include-list for arch/x86/kernel/dumpstack_32.c:
#include <asm-generic/percpu.h>      // for this_cpu_read
#include <asm/page_types.h>          // for THREAD_SIZE
#include <asm/percpu.h>              // for this_cpu_read_8
#include <asm/stacktrace.h>          // for stack_info, in_entry_stack, in_t...
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm/cpu_entry_area.h"      // for get_cpu_entry_area, doublefault_...
#include "asm/current.h"             // for current
#include "asm/percpu.h"              // for __pcpu_op2_1, __pcpu_op2_2, __pc...
#include "asm/processor.h"           // for cpu_tss_rw, hardirq_stack_ptr
#include "linux/kern_levels.h"       // for KERN_WARNING
#include "linux/printk.h"            // for printk_deferred_once
#include "linux/smp.h"               // for raw_smp_processor_id
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool
struct task_struct;
---
  ./scripts/check-local-export arch/x86/kernel/dumpstack_32.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.time.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/time"' -DKBUILD_BASENAME='"time"' -DKBUILD_MODNAME='"time"' -D__KBUILD_MODNAME=kmod_time -c -o arch/x86/kernel/time.o arch/x86/kernel/time.c  

arch/x86/kernel/time.c should add these lines:
#include <asm/cpufeatures.h>    // for REQUIRED_MASK0, REQUIRED_MASK1, REQUI...
#include <linux/spinlock.h>     // for in_lock_functions
#include <stddef.h>             // for NULL
#include "asm/cpufeature.h"     // for static_cpu_has
#include "asm/cpufeatures.h"    // for X86_FEATURE_WAITPKG
#include "asm/delay.h"          // for use_tpause_delay
#include "asm/ptrace.h"         // for instruction_pointer, user_mode, profi...
#include "asm/tsc.h"            // for tsc_init
#include "linux/init.h"         // for __init, late_time_init
#include "linux/irqreturn.h"    // for IRQ_HANDLED, irqreturn_t
#include "linux/printk.h"       // for pr_info, pr_warn
#include "vdso/clocksource.h"   // for VDSO_CLOCKMODE_NONE

arch/x86/kernel/time.c should remove these lines:
- #include <asm/i8259.h>  // lines 23-23
- #include <asm/timer.h>  // lines 24-24
- #include <asm/vsyscall.h>  // lines 21-21
- #include <linux/i8253.h>  // lines 17-17
- #include <linux/irq.h>  // lines 16-16
- #include <linux/time.h>  // lines 18-18

The full include-list for arch/x86/kernel/time.c:
#include <asm/cpufeatures.h>    // for REQUIRED_MASK0, REQUIRED_MASK1, REQUI...
#include <asm/hpet.h>           // for hpet_enable
#include <asm/time.h>           // for pit_timer_init, global_clock_event
#include <asm/x86_init.h>       // for x86_init, x86_init_ops, x86_init_irqs
#include <linux/clockchips.h>   // for clock_event_device
#include <linux/clocksource.h>  // for clocksource, CLOCKSOURCE_MASK, clocks...
#include <linux/export.h>       // for EXPORT_SYMBOL
#include <linux/interrupt.h>    // for request_irq, IRQF_IRQPOLL, IRQF_NOBAL...
#include <linux/spinlock.h>     // for in_lock_functions
#include <stddef.h>             // for NULL
#include "asm/cpufeature.h"     // for static_cpu_has
#include "asm/cpufeatures.h"    // for X86_FEATURE_WAITPKG
#include "asm/delay.h"          // for use_tpause_delay
#include "asm/ptrace.h"         // for instruction_pointer, user_mode, profi...
#include "asm/tsc.h"            // for tsc_init
#include "linux/init.h"         // for __init, late_time_init
#include "linux/irqreturn.h"    // for IRQ_HANDLED, irqreturn_t
#include "linux/printk.h"       // for pr_info, pr_warn
#include "vdso/clocksource.h"   // for VDSO_CLOCKMODE_NONE
---
  ./scripts/check-local-export arch/x86/kernel/time.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.ioport.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/ioport"' -DKBUILD_BASENAME='"ioport"' -DKBUILD_MODNAME='"ioport"' -D__KBUILD_MODNAME=kmod_ioport -c -o arch/x86/kernel/ioport.o arch/x86/kernel/ioport.c  
In file included from arch/x86/kernel/ioport.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/ioport.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/ioport.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/ioport.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/kernel/ioport.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/ioport.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/ioport.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/ioport.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/ioport.c should add these lines:
#include "asm-generic/errno.h"  // for ENOSYS
#include "asm/ptrace.h"         // for pt_regs

arch/x86/kernel/ioport.c should remove these lines:
- #include <asm/desc.h>  // lines 15-15
- #include <asm/io_bitmap.h>  // lines 14-14
- #include <linux/bitmap.h>  // lines 9-9
- #include <linux/capability.h>  // lines 6-6
- #include <linux/ioport.h>  // lines 10-10
- #include <linux/sched.h>  // lines 11-11
- #include <linux/security.h>  // lines 7-7
- #include <linux/slab.h>  // lines 12-12

The full include-list for arch/x86/kernel/ioport.c:
#include <asm/syscalls.h>       // for ksys_ioperm
#include <linux/syscalls.h>     // for __MAP1, __MAP3, SYSCALL_DEFINE1, SYSC...
#include "asm-generic/errno.h"  // for ENOSYS
#include "asm/ptrace.h"         // for pt_regs
---
  ./scripts/check-local-export arch/x86/kernel/ioport.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.dumpstack.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/dumpstack"' -DKBUILD_BASENAME='"dumpstack"' -DKBUILD_MODNAME='"dumpstack"' -D__KBUILD_MODNAME=kmod_dumpstack -c -o arch/x86/kernel/dumpstack.o arch/x86/kernel/dumpstack.c  

arch/x86/kernel/dumpstack.c should add these lines:
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/page_types.h>             // for THREAD_SIZE
#include <asm/signal.h>                 // for SIGSEGV
#include <linux/spinlock.h>             // for arch_spin_lock, arch_spin_try...
#include <linux/spinlock_types_raw.h>   // for __ARCH_SPIN_LOCK_UNLOCKED
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EPERM
#include "asm-generic/int-ll64.h"       // for u8
#include "asm-generic/kprobes.h"        // for NOKPROBE_SYMBOL
#include "asm-generic/rwonce.h"         // for READ_ONCE_NOCHECK
#include "asm/cpufeature.h"             // for boot_cpu_has
#include "asm/cpufeatures.h"            // for X86_FEATURE_PTI
#include "asm/current.h"                // for current
#include "asm/kdebug.h"                 // for __show_regs, SHOW_REGS_ALL
#include "asm/processor.h"              // for entry_stack, task_pt_regs
#include "asm/ptrace.h"                 // for user_mode, pt_regs
#include "asm/uaccess.h"                // for copy_from_user_nmi
#include "linux/align.h"                // for PTR_ALIGN
#include "linux/compiler_attributes.h"  // for __noreturn
#include "linux/compiler_types.h"       // for noinstr, __user
#include "linux/irqflags.h"             // for raw_local_irq_restore, raw_lo...
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_DEFAULT
#include "linux/kernel.h"               // for bust_spinlocks, __kernel_text...
#include "linux/mm.h"                   // for debug_pagealloc_enabled, PAGE...
#include "linux/notifier.h"             // for NOTIFY_STOP
#include "linux/panic.h"                // for panic, add_taint, oops_enter
#include "linux/preempt.h"              // for in_interrupt
#include "linux/printk.h"               // for printk, console_verbose, show...
#include "linux/sched.h"                // for task_struct
#include "linux/smp.h"                  // for smp_processor_id
#include "linux/stddef.h"               // for false, true
#include "linux/stringify.h"            // for __stringify
#include "linux/types.h"                // for bool

arch/x86/kernel/dumpstack.c should remove these lines:
- #include <linux/bug.h>  // lines 17-17
- #include <linux/hardirq.h>  // lines 9-9
- #include <linux/kallsyms.h>  // lines 5-5
- #include <linux/kprobes.h>  // lines 6-6
- #include <linux/ptrace.h>  // lines 12-12
- #include <linux/sysfs.h>  // lines 19-19
- #include <linux/utsname.h>  // lines 8-8

The full include-list for arch/x86/kernel/dumpstack.c:
#include <asm/cpu_entry_area.h>         // for cpu_entry_stack
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/page_types.h>             // for THREAD_SIZE
#include <asm/signal.h>                 // for SIGSEGV
#include <asm/stacktrace.h>             // for stack_info, get_stack_info
#include <asm/unwind.h>                 // for unwind_get_entry_regs, unwind...
#include <linux/ftrace.h>               // for ftrace_graph_ret_addr
#include <linux/kasan.h>                // for kasan_non_canonical_hook, kas...
#include <linux/kdebug.h>               // for notify_die
#include <linux/kexec.h>                // for crash_kexec, kexec_should_crash
#include <linux/module.h>               // for print_modules
#include <linux/nmi.h>                  // for touch_nmi_watchdog
#include <linux/sched/debug.h>          // for show_regs, show_stack
#include <linux/sched/task_stack.h>     // for task_stack_page
#include <linux/spinlock.h>             // for arch_spin_lock, arch_spin_try...
#include <linux/spinlock_types_raw.h>   // for __ARCH_SPIN_LOCK_UNLOCKED
#include <linux/uaccess.h>              // for copy_from_kernel_nofault
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EPERM
#include "asm-generic/int-ll64.h"       // for u8
#include "asm-generic/kprobes.h"        // for NOKPROBE_SYMBOL
#include "asm-generic/rwonce.h"         // for READ_ONCE_NOCHECK
#include "asm/cpufeature.h"             // for boot_cpu_has
#include "asm/cpufeatures.h"            // for X86_FEATURE_PTI
#include "asm/current.h"                // for current
#include "asm/kdebug.h"                 // for __show_regs, SHOW_REGS_ALL
#include "asm/processor.h"              // for entry_stack, task_pt_regs
#include "asm/ptrace.h"                 // for user_mode, pt_regs
#include "asm/uaccess.h"                // for copy_from_user_nmi
#include "linux/align.h"                // for PTR_ALIGN
#include "linux/compiler_attributes.h"  // for __noreturn
#include "linux/compiler_types.h"       // for noinstr, __user
#include "linux/irqflags.h"             // for raw_local_irq_restore, raw_lo...
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_DEFAULT
#include "linux/kernel.h"               // for bust_spinlocks, __kernel_text...
#include "linux/mm.h"                   // for debug_pagealloc_enabled, PAGE...
#include "linux/notifier.h"             // for NOTIFY_STOP
#include "linux/panic.h"                // for panic, add_taint, oops_enter
#include "linux/preempt.h"              // for in_interrupt
#include "linux/printk.h"               // for printk, console_verbose, show...
#include "linux/sched.h"                // for task_struct
#include "linux/smp.h"                  // for smp_processor_id
#include "linux/stddef.h"               // for false, true
#include "linux/stringify.h"            // for __stringify
#include "linux/types.h"                // for bool
---
  ./scripts/check-local-export arch/x86/kernel/dumpstack.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.nmi.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/nmi"' -DKBUILD_BASENAME='"nmi"' -DKBUILD_MODNAME='"nmi"' -D__KBUILD_MODNAME=kmod_nmi -c -o arch/x86/kernel/nmi.o arch/x86/kernel/nmi.c  
In file included from arch/x86/kernel/nmi.c:29:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/nmi.c:29:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/nmi.c:29:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/nmi.c:29:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/kernel/nmi.c:29:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/nmi.c:29:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/nmi.c:29:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/nmi.c:29:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/nmi.c should add these lines:
#include <asm-generic/percpu.h>        // for DEFINE_PER_CPU, __this_cpu_add
#include <asm/bug.h>                   // for WARN_ON_ONCE, WARN
#include <asm/percpu.h>                // for raw_cpu_add_8, raw_cpu_write_8
#include <stddef.h>                    // for NULL
#include "asm-generic/delay.h"         // for udelay
#include "asm-generic/errno-base.h"    // for EINVAL
#include "asm-generic/int-ll64.h"      // for u64
#include "asm-generic/kprobes.h"       // for NOKPROBE_SYMBOL
#include "asm/cpumask.h"               // for arch_cpu_is_offline
#include "asm/debugreg.h"              // for local_db_save, local_db_restore
#include "asm/div64.h"                 // for do_div
#include "asm/hardirq.h"               // for (anonymous), inc_irq_stat
#include "asm/idtentry.h"              // for DEFINE_IDTENTRY_RAW, exc_nmi
#include "asm/percpu.h"                // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/ptrace.h"                // for pt_regs, user_mode
#include "asm/shared/io.h"             // for outb
#include "asm/special_insns.h"         // for read_cr2, write_cr2
#include "asm/string_32.h"             // for strcmp
#include "asm/vdso/processor.h"        // for cpu_relax
#include "linux/compiler.h"            // for unlikely
#include "linux/compiler_types.h"      // for noinstr
#include "linux/entry-common.h"        // for irqentry_nmi_enter, irqentry_n...
#include "linux/init.h"                // for __init, __setup, fs_initcall
#include "linux/instrumentation.h"     // for instrumentation_begin, instrum...
#include "linux/kconfig.h"             // for IS_ENABLED, IS_MODULE
#include "linux/kern_levels.h"         // for KERN_INFO
#include "linux/list.h"                // for list_empty, LIST_HEAD_INIT
#include "linux/panic.h"               // for nmi_panic, panic_on_io_nmi
#include "linux/preempt.h"             // for in_nmi
#include "linux/printk.h"              // for pr_emerg, printk_ratelimited
#include "linux/rculist.h"             // for list_add_rcu, list_add_tail_rcu
#include "linux/rcupdate.h"            // for rcu_read_lock, rcu_read_unlock
#include "linux/smp.h"                 // for smp_processor_id
#include "linux/spinlock_types_raw.h"  // for __RAW_SPIN_LOCK_UNLOCKED, DEFI...
#include "linux/stddef.h"              // for false, true
#include "linux/types.h"               // for list_head, bool
#include "vdso/time64.h"               // for NSEC_PER_MSEC

arch/x86/kernel/nmi.c should remove these lines:
- #include <asm/cpu_entry_area.h>  // lines 28-28
- #include <linux/atomic.h>  // lines 25-25
- #include <linux/delay.h>  // lines 20-20
- #include <linux/hardirq.h>  // lines 21-21
- #include <linux/kdebug.h>  // lines 16-16
- #include <linux/kprobes.h>  // lines 15-15
- #include <linux/ratelimit.h>  // lines 22-22
- #include <linux/slab.h>  // lines 23-23

The full include-list for arch/x86/kernel/nmi.c:
#include <asm-generic/percpu.h>        // for DEFINE_PER_CPU, __this_cpu_add
#include <asm/bug.h>                   // for WARN_ON_ONCE, WARN
#include <asm/cache.h>                 // for __read_mostly
#include <asm/mach_traps.h>            // for NMI_REASON_PORT, reassert_nmi
#include <asm/nmi.h>                   // for nmiaction, NMI_IO_CHECK, NMI_SERR
#include <asm/nospec-branch.h>         // for mds_user_clear_cpu_buffers
#include <asm/percpu.h>                // for raw_cpu_add_8, raw_cpu_write_8
#include <asm/reboot.h>                // for run_crash_ipi_callback
#include <asm/sev.h>                   // for sev_es_ist_enter, sev_es_ist_exit
#include <asm/traps.h>                 // for panic_on_unrecovered_nmi
#include <asm/x86_init.h>              // for x86_platform, x86_platform_ops
#include <linux/debugfs.h>             // for debugfs_create_u64, arch_debug...
#include <linux/export.h>              // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include <linux/nmi.h>                 // for touch_nmi_watchdog
#include <linux/sched/clock.h>         // for sched_clock
#include <linux/sched/debug.h>         // for show_regs
#include <linux/spinlock.h>            // for raw_spin_lock_irqsave, raw_spi...
#include <stddef.h>                    // for NULL
#include <trace/events/nmi.h>          // for trace_nmi_handler
#include "asm-generic/delay.h"         // for udelay
#include "asm-generic/errno-base.h"    // for EINVAL
#include "asm-generic/int-ll64.h"      // for u64
#include "asm-generic/kprobes.h"       // for NOKPROBE_SYMBOL
#include "asm/cpumask.h"               // for arch_cpu_is_offline
#include "asm/debugreg.h"              // for local_db_save, local_db_restore
#include "asm/div64.h"                 // for do_div
#include "asm/hardirq.h"               // for (anonymous), inc_irq_stat
#include "asm/idtentry.h"              // for DEFINE_IDTENTRY_RAW, exc_nmi
#include "asm/percpu.h"                // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/ptrace.h"                // for pt_regs, user_mode
#include "asm/shared/io.h"             // for outb
#include "asm/special_insns.h"         // for read_cr2, write_cr2
#include "asm/string_32.h"             // for strcmp
#include "asm/vdso/processor.h"        // for cpu_relax
#include "linux/compiler.h"            // for unlikely
#include "linux/compiler_types.h"      // for noinstr
#include "linux/entry-common.h"        // for irqentry_nmi_enter, irqentry_n...
#include "linux/init.h"                // for __init, __setup, fs_initcall
#include "linux/instrumentation.h"     // for instrumentation_begin, instrum...
#include "linux/kconfig.h"             // for IS_ENABLED, IS_MODULE
#include "linux/kern_levels.h"         // for KERN_INFO
#include "linux/list.h"                // for list_empty, LIST_HEAD_INIT
#include "linux/panic.h"               // for nmi_panic, panic_on_io_nmi
#include "linux/preempt.h"             // for in_nmi
#include "linux/printk.h"              // for pr_emerg, printk_ratelimited
#include "linux/rculist.h"             // for list_add_rcu, list_add_tail_rcu
#include "linux/rcupdate.h"            // for rcu_read_lock, rcu_read_unlock
#include "linux/smp.h"                 // for smp_processor_id
#include "linux/spinlock_types_raw.h"  // for __RAW_SPIN_LOCK_UNLOCKED, DEFI...
#include "linux/stddef.h"              // for false, true
#include "linux/types.h"               // for list_head, bool
#include "vdso/time64.h"               // for NSEC_PER_MSEC
---
  ./scripts/check-local-export arch/x86/kernel/nmi.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.setup.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/setup"' -DKBUILD_BASENAME='"setup"' -DKBUILD_MODNAME='"setup"' -D__KBUILD_MODNAME=kmod_setup -c -o arch/x86/kernel/setup.o arch/x86/kernel/setup.c  
In file included from arch/x86/kernel/setup.c:8:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
In file included from arch/x86/kernel/setup.c:13:
In file included from ./include/linux/efi.h:20:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
In file included from arch/x86/kernel/setup.c:19:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^
In file included from arch/x86/kernel/setup.c:21:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
8 warnings generated.
In file included from arch/x86/kernel/setup.c:8:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
In file included from arch/x86/kernel/setup.c:13:
In file included from ./include/linux/efi.h:20:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
In file included from arch/x86/kernel/setup.c:19:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^
In file included from arch/x86/kernel/setup.c:21:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/setup.c should add these lines:
#include <asm/bug.h>                    // for BUG_ON
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/page_types.h>             // for find_low_pfn_range, __START_K...
#include <asm/pgtable.h>                // for sync_initial_page_table, swap...
#include <linux/pgtable.h>              // for clone_pgd_range, early_alloc_...
#include <linux/timex.h>                // for CLOCK_TICK_RATE
#include <stddef.h>                     // for size_t
#include "asm-generic/early_ioremap.h"  // for early_memremap, early_memunmap
#include "asm-generic/int-ll64.h"       // for u64, u32
#include "asm-generic/pgtable-nopud.h"  // for PUD_SHIFT
#include "asm-generic/sections.h"       // for _edata, _etext, __bss_start
#include "asm/bootparam.h"              // for boot_params, setup_data, setu...
#include "asm/cache.h"                  // for __read_mostly
#include "asm/cpufeature.h"             // for boot_cpu_has, setup_clear_cpu...
#include "asm/cpufeatures.h"            // for X86_FEATURE_NX, X86_FEATURE_APIC
#include "asm/desc.h"                   // for idt_setup_early_pf, idt_setup...
#include "asm/e820/api.h"               // for e820__end_of_ram_pfn, e820__r...
#include "asm/e820/types.h"             // for E820_TYPE_RAM, BIOS_BEGIN
#include "asm/io.h"                     // for io_delay_init
#include "asm/ist.h"                    // for ist_info
#include "asm/mem_encrypt.h"            // for sev_setup_arch
#include "asm/mpspec.h"                 // for e820__memblock_alloc_reserved...
#include "asm/page.h"                   // for __pa_symbol
#include "asm/page_types.h"             // for PAGE_SHIFT, PAGE_SIZE, get_ma...
#include "asm/pci.h"                    // for early_quirks
#include "asm/pgtable_32_areas.h"       // for MODULES_VADDR
#include "asm/pgtable_types.h"          // for _PAGE_NX, __supported_pte_mask
#include "asm/processor-flags.h"        // for X86_CR4_PCIDE
#include "asm/processor.h"              // for cpuinfo_x86, early_cpu_init
#include "asm/sections.h"               // for __brk_base, __brk_limit, __en...
#include "asm/setup.h"                  // for _text, early_platform_quirks
#include "asm/special_insns.h"          // for __read_cr4
#include "asm/string_32.h"              // for memcpy, memset
#include "asm/tlbflush.h"               // for __flush_tlb_all
#include "asm/tsc.h"                    // for tsc_early_init
#include "asm/x86_init.h"               // for x86_init, x86_init_ops, x86_i...
#include "linux/apm_bios.h"             // for apm_info
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler_attributes.h"  // for __visible
#include "linux/compiler_types.h"       // for inline
#include "linux/crash_core.h"           // for parse_crashkernel, parse_cras...
#include "linux/export.h"               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/init.h"                 // for __init, boot_command_line
#include "linux/ioport.h"               // for resource, IORESOURCE_BUSY
#include "linux/jiffies.h"              // for register_refined_jiffies
#include "linux/jump_label.h"           // for jump_label_init
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kdev_t.h"               // for old_decode_dev
#include "linux/kern_levels.h"          // for KERN_INFO, KERN_DEBUG, KERN_N...
#include "linux/kernel.h"               // for ARRAY_SIZE
#include "linux/kexec.h"                // for crashk_res
#include "linux/mm.h"                   // for PAGE_ALIGN, setup_initial_ini...
#include "linux/notifier.h"             // for atomic_notifier_chain_register
#include "linux/panic.h"                // for panic
#include "linux/pfn.h"                  // for PFN_DOWN, PFN_PHYS
#include "linux/printk.h"               // for printk, pr_info, pr_warn, set...
#include "linux/screen_info.h"          // for screen_info
#include "linux/sizes.h"                // for SZ_16M, SZ_512M, SZ_1M, SZ_64K
#include "linux/stddef.h"               // for false, true
#include "linux/string.h"               // for strscpy
#include "linux/types.h"                // for bool
#include "video/edid.h"                 // for edid_info

arch/x86/kernel/setup.c should remove these lines:
- #include <asm/gart.h>  // lines 37-37
- #include <asm/pci-direct.h>  // lines 47-47
- #include <linux/crash_dump.h>  // lines 10-10
- #include <linux/pci.h>  // lines 19-19
- #include <linux/swiotlb.h>  // lines 25-25
- #include <linux/vmalloc.h>  // lines 53-53

The full include-list for arch/x86/kernel/setup.c:
#include <asm/apic.h>                   // for generic_apic_probe, init_apic...
#include <asm/bios_ebda.h>              // for reserve_bios_regions
#include <asm/bug.h>                    // for BUG_ON
#include <asm/bugs.h>                   // for ppro_with_ram_bug
#include <asm/cpu.h>                    // for prefill_possible_map
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/efi.h>                    // for efi_find_mirror, efi_memblock...
#include <asm/hypervisor.h>             // for init_hypervisor_platform
#include <asm/io_apic.h>                // for io_apic_init_mappings
#include <asm/kasan.h>                  // for kasan_init
#include <asm/kaslr.h>                  // for kernel_randomize_memory
#include <asm/mce.h>                    // for mcheck_init
#include <asm/memtype.h>                // for init_cache_modes, pat_disable
#include <asm/mtrr.h>                   // for mtrr_bp_init, mtrr_trim_uncac...
#include <asm/numa.h>                   // for init_cpu_to_node, init_gi_nodes
#include <asm/olpc_ofw.h>               // for olpc_ofw_detect, setup_olpc_o...
#include <asm/page_types.h>             // for find_low_pfn_range, __START_K...
#include <asm/pgtable.h>                // for sync_initial_page_table, swap...
#include <asm/prom.h>                   // for add_dtb, x86_dtb_init
#include <asm/proto.h>                  // for x86_configure_nx
#include <asm/realmode.h>               // for reserve_real_mode
#include <asm/thermal.h>                // for therm_lvt_init
#include <asm/unwind.h>                 // for unwind_init
#include <asm/vsyscall.h>               // for map_vsyscall
#include <linux/acpi.h>                 // for acpi_boot_init, acpi_boot_tab...
#include <linux/console.h>              // for conswitchp, vga_con
#include <linux/dma-map-ops.h>          // for dma_contiguous_reserve
#include <linux/dmi.h>                  // for dmi_setup
#include <linux/efi.h>                  // for efi_enabled, EFI_BOOT, efi_es...
#include <linux/hugetlb.h>              // for hugetlb_cma_reserve
#include <linux/initrd.h>               // for initrd_start, initrd_end, phy...
#include <linux/iscsi_ibft.h>           // for reserve_ibft_region
#include <linux/memblock.h>             // for memblock_reserve, memblock_ph...
#include <linux/panic_notifier.h>       // for panic_notifier_list
#include <linux/pgtable.h>              // for clone_pgd_range, early_alloc_...
#include <linux/root_dev.h>             // for ROOT_DEV
#include <linux/static_call.h>          // for static_call_init
#include <linux/tboot.h>                // for tboot_probe
#include <linux/timex.h>                // for CLOCK_TICK_RATE
#include <linux/usb/xhci-dbgp.h>        // for early_xdbc_register_console
#include <stddef.h>                     // for size_t
#include <uapi/linux/mount.h>           // for MS_RDONLY
#include <xen/xen.h>                    // for xen_pv_domain
#include "asm-generic/early_ioremap.h"  // for early_memremap, early_memunmap
#include "asm-generic/int-ll64.h"       // for u64, u32
#include "asm-generic/pgtable-nopud.h"  // for PUD_SHIFT
#include "asm-generic/sections.h"       // for _edata, _etext, __bss_start
#include "asm/bootparam.h"              // for boot_params, setup_data, setu...
#include "asm/cache.h"                  // for __read_mostly
#include "asm/cpufeature.h"             // for boot_cpu_has, setup_clear_cpu...
#include "asm/cpufeatures.h"            // for X86_FEATURE_NX, X86_FEATURE_APIC
#include "asm/desc.h"                   // for idt_setup_early_pf, idt_setup...
#include "asm/e820/api.h"               // for e820__end_of_ram_pfn, e820__r...
#include "asm/e820/types.h"             // for E820_TYPE_RAM, BIOS_BEGIN
#include "asm/io.h"                     // for io_delay_init
#include "asm/ist.h"                    // for ist_info
#include "asm/mem_encrypt.h"            // for sev_setup_arch
#include "asm/mpspec.h"                 // for e820__memblock_alloc_reserved...
#include "asm/page.h"                   // for __pa_symbol
#include "asm/page_types.h"             // for PAGE_SHIFT, PAGE_SIZE, get_ma...
#include "asm/pci.h"                    // for early_quirks
#include "asm/pgtable_32_areas.h"       // for MODULES_VADDR
#include "asm/pgtable_types.h"          // for _PAGE_NX, __supported_pte_mask
#include "asm/processor-flags.h"        // for X86_CR4_PCIDE
#include "asm/processor.h"              // for cpuinfo_x86, early_cpu_init
#include "asm/sections.h"               // for __brk_base, __brk_limit, __en...
#include "asm/setup.h"                  // for _text, early_platform_quirks
#include "asm/special_insns.h"          // for __read_cr4
#include "asm/string_32.h"              // for memcpy, memset
#include "asm/tlbflush.h"               // for __flush_tlb_all
#include "asm/tsc.h"                    // for tsc_early_init
#include "asm/x86_init.h"               // for x86_init, x86_init_ops, x86_i...
#include "linux/apm_bios.h"             // for apm_info
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler_attributes.h"  // for __visible
#include "linux/compiler_types.h"       // for inline
#include "linux/crash_core.h"           // for parse_crashkernel, parse_cras...
#include "linux/export.h"               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/init.h"                 // for __init, boot_command_line
#include "linux/ioport.h"               // for resource, IORESOURCE_BUSY
#include "linux/jiffies.h"              // for register_refined_jiffies
#include "linux/jump_label.h"           // for jump_label_init
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kdev_t.h"               // for old_decode_dev
#include "linux/kern_levels.h"          // for KERN_INFO, KERN_DEBUG, KERN_N...
#include "linux/kernel.h"               // for ARRAY_SIZE
#include "linux/kexec.h"                // for crashk_res
#include "linux/mm.h"                   // for PAGE_ALIGN, setup_initial_ini...
#include "linux/notifier.h"             // for atomic_notifier_chain_register
#include "linux/panic.h"                // for panic
#include "linux/pfn.h"                  // for PFN_DOWN, PFN_PHYS
#include "linux/printk.h"               // for printk, pr_info, pr_warn, set...
#include "linux/screen_info.h"          // for screen_info
#include "linux/sizes.h"                // for SZ_16M, SZ_512M, SZ_1M, SZ_64K
#include "linux/stddef.h"               // for false, true
#include "linux/string.h"               // for strscpy
#include "linux/types.h"                // for bool
#include "video/edid.h"                 // for edid_info
---
  ./scripts/check-local-export arch/x86/kernel/setup.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.x86_init.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/x86_init"' -DKBUILD_BASENAME='"x86_init"' -DKBUILD_MODNAME='"x86_init"' -D__KBUILD_MODNAME=kmod_x86_init -c -o arch/x86/kernel/x86_init.o arch/x86/kernel/x86_init.c  
In file included from arch/x86/kernel/x86_init.c:9:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/x86_init.c:9:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/x86_init.c:9:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/x86_init.c:9:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^
In file included from arch/x86/kernel/x86_init.c:25:
In file included from ./arch/x86/include/asm/iommu.h:5:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
9 warnings generated.
In file included from arch/x86/kernel/x86_init.c:9:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/x86_init.c:9:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/x86_init.c:9:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/x86_init.c:9:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^
In file included from arch/x86/kernel/x86_init.c:25:
In file included from ./arch/x86/include/asm/iommu.h:5:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^

arch/x86/kernel/x86_init.c should add these lines:
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm/mc146818rtc.h"         // for mach_get_cmos_time, mach_set_rtc...
#include "asm/pgtable_types.h"       // for native_pagetable_init
#include "asm/x86_init.h"            // for x86_platform_ops, x86_platform
#include "linux/cache.h"             // for __ro_after_init
#include "linux/mod_devicetable.h"   // for of_device_id
#include "linux/of.h"                // for of_device_is_available, of_find_...
#include "linux/stddef.h"            // for false
#include "linux/types.h"             // for bool
struct timespec64;

arch/x86/kernel/x86_init.c should remove these lines:
- #include <asm/bios_ebda.h>  // lines 12-12
- #include <asm/hpet.h>  // lines 22-22
- #include <asm/iommu.h>  // lines 25-25
- #include <asm/memtype.h>  // lines 23-23
- #include <linux/ioport.h>  // lines 7-7
- #include <linux/pci.h>  // lines 9-9

The full include-list for arch/x86/kernel/x86_init.c:
#include <asm/acpi.h>                // for acpi_generic_reduced_hw_init
#include <asm/apic.h>                // for apic_intr_mode_init, apic_intr_m...
#include <asm/e820/api.h>            // for e820__memory_setup_default, is_I...
#include <asm/io_apic.h>             // for native_io_apic_read, native_rest...
#include <asm/irq.h>                 // for init_ISA_irqs, native_init_IRQ
#include <asm/irqdomain.h>           // for native_create_pci_msi_domain
#include <asm/mach_traps.h>          // for default_get_nmi_reason
#include <asm/mpspec.h>              // for default_find_smp_config, default...
#include <asm/paravirt.h>            // for default_banner
#include <asm/pci_x86.h>             // for x86_default_pci_fixup_irqs, x86_...
#include <asm/setup.h>               // for probe_roms, reserve_standard_io_...
#include <asm/time.h>                // for hpet_time_init
#include <asm/tsc.h>                 // for native_calibrate_cpu_early, nati...
#include <linux/export.h>            // for EXPORT_SYMBOL_GPL
#include <linux/init.h>              // for __init, __initconst, __initdata
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm/mc146818rtc.h"         // for mach_get_cmos_time, mach_set_rtc...
#include "asm/pgtable_types.h"       // for native_pagetable_init
#include "asm/x86_init.h"            // for x86_platform_ops, x86_platform
#include "linux/cache.h"             // for __ro_after_init
#include "linux/mod_devicetable.h"   // for of_device_id
#include "linux/of.h"                // for of_device_is_available, of_find_...
#include "linux/stddef.h"            // for false
#include "linux/types.h"             // for bool
struct timespec64;
---
  ./scripts/check-local-export arch/x86/kernel/x86_init.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.i8259.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/i8259"' -DKBUILD_BASENAME='"i8259"' -DKBUILD_MODNAME='"i8259"' -D__KBUILD_MODNAME=kmod_i8259 -c -o arch/x86/kernel/i8259.o arch/x86/kernel/i8259.c  
In file included from arch/x86/kernel/i8259.c:15:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
4 warnings generated.
In file included from arch/x86/kernel/i8259.c:15:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^

arch/x86/kernel/i8259.c should add these lines:
#include "asm-generic/delay.h"                 // for udelay
#include "asm/irq_vectors.h"                   // for ISA_IRQ_VECTOR, NR_IRQ...
#include "asm/shared/io.h"                     // for outb, inb
#include "linux/atomic/atomic-instrumented.h"  // for atomic_inc
#include "linux/compiler_types.h"              // for inline
#include "linux/export.h"                      // for EXPORT_SYMBOL
#include "linux/kern_levels.h"                 // for KERN_DEBUG, KERN_INFO
#include "linux/printk.h"                      // for printk, printk_deferred
#include "linux/spinlock.h"                    // for raw_spin_lock_irqsave
#include "linux/spinlock_types_raw.h"          // for DEFINE_RAW_SPINLOCK
#include "linux/stddef.h"                      // for true

arch/x86/kernel/i8259.c should remove these lines:
- #include <asm/desc.h>  // lines 23-23
- #include <asm/timer.h>  // lines 21-21
- #include <linux/acpi.h>  // lines 15-15
- #include <linux/atomic.h>  // lines 20-20
- #include <linux/bitops.h>  // lines 14-14
- #include <linux/delay.h>  // lines 17-17
- #include <linux/errno.h>  // lines 3-3
- #include <linux/io.h>  // lines 16-16
- #include <linux/ioport.h>  // lines 6-6
- #include <linux/kernel_stat.h>  // lines 12-12
- #include <linux/linkage.h>  // lines 2-2
- #include <linux/pgtable.h>  // lines 18-18
- #include <linux/random.h>  // lines 10-10
- #include <linux/sched.h>  // lines 5-5
- #include <linux/signal.h>  // lines 4-4
- #include <linux/timex.h>  // lines 9-9

The full include-list for arch/x86/kernel/i8259.c:
#include <asm/apic.h>                          // for lapic_assign_legacy_ve...
#include <asm/hw_irq.h>                        // for irq_err_count
#include <asm/i8259.h>                         // for outb_pic, PIC_MASTER_IMR
#include <linux/init.h>                        // for __init, device_initcall
#include <linux/interrupt.h>                   // for disable_irq_nosync
#include <linux/irq.h>                         // for irq_chip, irq_data
#include <linux/syscore_ops.h>                 // for register_syscore_ops
#include "asm-generic/delay.h"                 // for udelay
#include "asm/irq_vectors.h"                   // for ISA_IRQ_VECTOR, NR_IRQ...
#include "asm/shared/io.h"                     // for outb, inb
#include "linux/atomic/atomic-instrumented.h"  // for atomic_inc
#include "linux/compiler_types.h"              // for inline
#include "linux/export.h"                      // for EXPORT_SYMBOL
#include "linux/kern_levels.h"                 // for KERN_DEBUG, KERN_INFO
#include "linux/printk.h"                      // for printk, printk_deferred
#include "linux/spinlock.h"                    // for raw_spin_lock_irqsave
#include "linux/spinlock_types_raw.h"          // for DEFINE_RAW_SPINLOCK
#include "linux/stddef.h"                      // for true
---
  ./scripts/check-local-export arch/x86/kernel/i8259.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.irqinit.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/irqinit"' -DKBUILD_BASENAME='"irqinit"' -DKBUILD_MODNAME='"irqinit"' -D__KBUILD_MODNAME=kmod_irqinit -c -o arch/x86/kernel/irqinit.o arch/x86/kernel/irqinit.c  
In file included from arch/x86/kernel/irqinit.c:14:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/irqinit.c:14:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/irqinit.c:14:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/irqinit.c:16:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
In file included from arch/x86/kernel/irqinit.c:30:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from arch/x86/kernel/irqinit.c:31:
In file included from ./arch/x86/include/asm/prom.h:15:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^
10 warnings generated.
In file included from arch/x86/kernel/irqinit.c:14:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/irqinit.c:14:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/irqinit.c:14:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/irqinit.c:16:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
In file included from arch/x86/kernel/irqinit.c:30:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from arch/x86/kernel/irqinit.c:31:
In file included from ./arch/x86/include/asm/prom.h:15:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^

arch/x86/kernel/irqinit.c should add these lines:
#include <asm-generic/percpu.h>  // for DEFINE_PER_CPU, per_cpu
#include <asm/bug.h>             // for BUG_ON
#include <stddef.h>              // for NULL
#include "asm/irq.h"             // for irq_init_percpu_irqstack, init_IRQ
#include "asm/irq_vectors.h"     // for ISA_IRQ_VECTOR, NR_VECTORS
#include "asm/x86_init.h"        // for x86_init, x86_init_irqs, x86_init_ops
#include "linux/irqnr.h"         // for irq_to_desc
#include "linux/printk.h"        // for pr_err
#include "linux/smp.h"           // for smp_processor_id

arch/x86/kernel/irqinit.c should remove these lines:
- #include <asm/io_apic.h>  // lines 25-25
- #include <asm/setup.h>  // lines 28-28
- #include <asm/timer.h>  // lines 22-22
- #include <asm/traps.h>  // lines 30-30
- #include <linux/acpi.h>  // lines 16-16
- #include <linux/atomic.h>  // lines 21-21
- #include <linux/bitops.h>  // lines 15-15
- #include <linux/delay.h>  // lines 18-18
- #include <linux/device.h>  // lines 14-14
- #include <linux/errno.h>  // lines 3-3
- #include <linux/io.h>  // lines 17-17
- #include <linux/ioport.h>  // lines 6-6
- #include <linux/kernel_stat.h>  // lines 13-13
- #include <linux/kprobes.h>  // lines 11-11
- #include <linux/linkage.h>  // lines 2-2
- #include <linux/pgtable.h>  // lines 19-19
- #include <linux/random.h>  // lines 10-10
- #include <linux/sched.h>  // lines 5-5
- #include <linux/signal.h>  // lines 4-4
- #include <linux/timex.h>  // lines 9-9

The full include-list for arch/x86/kernel/irqinit.c:
#include <asm-generic/percpu.h>  // for DEFINE_PER_CPU, per_cpu
#include <asm/acpi.h>            // for acpi_ioapic
#include <asm/apic.h>            // for init_bsp_APIC, lapic_assign_system_v...
#include <asm/bug.h>             // for BUG_ON
#include <asm/desc.h>            // for idt_setup_apic_and_irq_gates
#include <asm/hw_irq.h>          // for VECTOR_UNUSED, vector_irq_t
#include <asm/i8259.h>           // for nr_legacy_irqs, legacy_pic
#include <asm/prom.h>            // for of_ioapic
#include <linux/init.h>          // for __init
#include <linux/interrupt.h>     // for request_irq, no_action, IRQF_NO_THREAD
#include <linux/irq.h>           // for irq_set_chip_and_handler, handle_lev...
#include <stddef.h>              // for NULL
#include "asm/irq.h"             // for irq_init_percpu_irqstack, init_IRQ
#include "asm/irq_vectors.h"     // for ISA_IRQ_VECTOR, NR_VECTORS
#include "asm/x86_init.h"        // for x86_init, x86_init_irqs, x86_init_ops
#include "linux/irqnr.h"         // for irq_to_desc
#include "linux/printk.h"        // for pr_err
#include "linux/smp.h"           // for smp_processor_id
---
  ./scripts/check-local-export arch/x86/kernel/irqinit.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.irq_work.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/irq_work"' -DKBUILD_BASENAME='"irq_work"' -DKBUILD_MODNAME='"irq_work"' -D__KBUILD_MODNAME=kmod_irq_work -c -o arch/x86/kernel/irq_work.o arch/x86/kernel/irq_work.c  
In file included from arch/x86/kernel/irq_work.c:12:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/irq_work.c:12:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/irq_work.c:12:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/irq_work.c:12:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/kernel/irq_work.c:12:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/irq_work.c:12:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/irq_work.c:12:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/irq_work.c:12:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/irq_work.c should add these lines:

arch/x86/kernel/irq_work.c should remove these lines:
- #include <asm/apic.h>  // lines 11-11
- #include <asm/idtentry.h>  // lines 12-12
- #include <asm/trace/irq_vectors.h>  // lines 13-13
- #include <linux/hardirq.h>  // lines 10-10
- #include <linux/interrupt.h>  // lines 14-14
- #include <linux/irq_work.h>  // lines 9-9
- #include <linux/kernel.h>  // lines 8-8

The full include-list for arch/x86/kernel/irq_work.c:
---
  ./scripts/check-local-export arch/x86/kernel/irq_work.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.probe_roms.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/probe_roms"' -DKBUILD_BASENAME='"probe_roms"' -DKBUILD_MODNAME='"probe_roms"' -D__KBUILD_MODNAME=kmod_probe_roms -c -o arch/x86/kernel/probe_roms.o arch/x86/kernel/probe_roms.c  
In file included from arch/x86/kernel/probe_roms.c:13:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/probe_roms.c:13:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/probe_roms.c:13:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/probe_roms.c:13:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^
5 warnings generated.
In file included from arch/x86/kernel/probe_roms.c:13:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/probe_roms.c:13:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/probe_roms.c:13:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/probe_roms.c:13:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^

arch/x86/kernel/probe_roms.c should add these lines:
#include <stddef.h>                 // for NULL, size_t
#include "asm/sev-common.h"         // for SNP_PAGE_STATE_PRIVATE
#include "linux/compiler_types.h"   // for __iomem
#include "linux/device.h"           // for device
#include "linux/kernel.h"           // for ARRAY_SIZE
#include "linux/mod_devicetable.h"  // for pci_device_id
#include "linux/stddef.h"           // for true
#include "linux/types.h"            // for bool

arch/x86/kernel/probe_roms.c should remove these lines:
- #include <asm/e820/api.h>  // lines 18-18
- #include <asm/mmzone.h>  // lines 19-19
- #include <asm/pci-direct.h>  // lines 17-17
- #include <asm/sections.h>  // lines 21-21
- #include <asm/setup_arch.h>  // lines 23-23
- #include <linux/console.h>  // lines 8-8
- #include <linux/dmi.h>  // lines 11-11
- #include <linux/edd.h>  // lines 10-10
- #include <linux/mm.h>  // lines 3-3
- #include <linux/mmzone.h>  // lines 5-5
- #include <linux/pfn.h>  // lines 12-12
- #include <linux/sched.h>  // lines 2-2
- #include <linux/seq_file.h>  // lines 7-7

The full include-list for arch/x86/kernel/probe_roms.c:
#include <asm/io.h>                 // for isa_bus_to_virt, ioremap, iounmap
#include <asm/probe_roms.h>         // for pci_biosrom_size, pci_map_biosrom
#include <asm/setup.h>              // for probe_roms
#include <asm/sev.h>                // for snp_prep_memory
#include <linux/export.h>           // for EXPORT_SYMBOL
#include <linux/init.h>             // for __init
#include <linux/ioport.h>           // for resource, request_resource, IORES...
#include <linux/pci.h>              // for pci_dev, to_pci_driver, pci_driver
#include <linux/uaccess.h>          // for get_kernel_nofault
#include <stddef.h>                 // for NULL, size_t
#include "asm/sev-common.h"         // for SNP_PAGE_STATE_PRIVATE
#include "linux/compiler_types.h"   // for __iomem
#include "linux/device.h"           // for device
#include "linux/kernel.h"           // for ARRAY_SIZE
#include "linux/mod_devicetable.h"  // for pci_device_id
#include "linux/stddef.h"           // for true
#include "linux/types.h"            // for bool
---
  ./scripts/check-local-export arch/x86/kernel/probe_roms.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.sys_ia32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/sys_ia32"' -DKBUILD_BASENAME='"sys_ia32"' -DKBUILD_MODNAME='"sys_ia32"' -D__KBUILD_MODNAME=kmod_sys_ia32 -c -o arch/x86/kernel/sys_ia32.o arch/x86/kernel/sys_ia32.c  
In file included from arch/x86/kernel/sys_ia32.c:29:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/sys_ia32.c:29:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/sys_ia32.c:29:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/sys_ia32.c:29:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/kernel/sys_ia32.c:29:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/sys_ia32.c:29:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/sys_ia32.c:29:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/sys_ia32.c:29:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/sys_ia32.c should add these lines:
#include <stddef.h>                // for size_t
#include "asm-generic/int-ll64.h"  // for u32, __u32, u64
#include "asm/ptrace.h"            // for pt_regs
#include "linux/compiler_types.h"  // for __user
#include "linux/types.h"           // for loff_t

arch/x86/kernel/sys_ia32.c should remove these lines:
- #include <asm/ia32.h>  // lines 50-50
- #include <asm/mman.h>  // lines 45-45
- #include <asm/types.h>  // lines 46-46
- #include <asm/vgtod.h>  // lines 49-49
- #include <linux/atomic.h>  // lines 48-48
- #include <linux/compat.h>  // lines 38-38
- #include <linux/file.h>  // lines 27-27
- #include <linux/fs.h>  // lines 26-26
- #include <linux/highuid.h>  // lines 41-41
- #include <linux/kernel.h>  // lines 24-24
- #include <linux/mm.h>  // lines 32-32
- #include <linux/personality.h>  // lines 35-35
- #include <linux/poll.h>  // lines 34-34
- #include <linux/ptrace.h>  // lines 40-40
- #include <linux/rwsem.h>  // lines 37-37
- #include <linux/sched.h>  // lines 25-25
- #include <linux/sched/task.h>  // lines 44-44
- #include <linux/signal.h>  // lines 28-28
- #include <linux/slab.h>  // lines 43-43
- #include <linux/stat.h>  // lines 36-36
- #include <linux/sysctl.h>  // lines 42-42
- #include <linux/times.h>  // lines 30-30
- #include <linux/uaccess.h>  // lines 47-47
- #include <linux/uio.h>  // lines 33-33
- #include <linux/utsname.h>  // lines 31-31
- #include <linux/vfs.h>  // lines 39-39

The full include-list for arch/x86/kernel/sys_ia32.c:
#include <linux/syscalls.h>        // for __MAP5, __MAP6, __MAP3, __MAP4
#include <stddef.h>                // for size_t
#include "asm-generic/int-ll64.h"  // for u32, __u32, u64
#include "asm/ptrace.h"            // for pt_regs
#include "linux/compiler_types.h"  // for __user
#include "linux/types.h"           // for loff_t
---
  ./scripts/check-local-export arch/x86/kernel/sys_ia32.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.bootflag.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/bootflag"' -DKBUILD_BASENAME='"bootflag"' -DKBUILD_MODNAME='"bootflag"' -D__KBUILD_MODNAME=kmod_bootflag -c -o arch/x86/kernel/bootflag.o arch/x86/kernel/bootflag.c  
In file included from arch/x86/kernel/bootflag.c:10:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
In file included from arch/x86/kernel/bootflag.c:13:
In file included from ./include/linux/mc146818rtc.h:15:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
5 warnings generated.
In file included from arch/x86/kernel/bootflag.c:10:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
In file included from arch/x86/kernel/bootflag.c:13:
In file included from ./include/linux/mc146818rtc.h:15:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^

arch/x86/kernel/bootflag.c should add these lines:
#include "asm-generic/int-ll64.h"  // for u8
#include "asm/mc146818rtc.h"       // for CMOS_READ, CMOS_WRITE
#include "linux/kern_levels.h"     // for KERN_INFO, KERN_WARNING
#include "linux/printk.h"          // for printk

arch/x86/kernel/bootflag.c should remove these lines:
- #include <asm/io.h>  // lines 11-11
- #include <linux/acpi.h>  // lines 10-10
- #include <linux/kernel.h>  // lines 6-6
- #include <linux/string.h>  // lines 8-8
- #include <linux/types.h>  // lines 5-5

The full include-list for arch/x86/kernel/bootflag.c:
#include <linux/init.h>            // for __init, __initdata, arch_initcall
#include <linux/mc146818rtc.h>     // for rtc_lock
#include <linux/spinlock.h>        // for spin_unlock_irqrestore, spin_lock_...
#include "asm-generic/int-ll64.h"  // for u8
#include "asm/mc146818rtc.h"       // for CMOS_READ, CMOS_WRITE
#include "linux/kern_levels.h"     // for KERN_INFO, KERN_WARNING
#include "linux/printk.h"          // for printk
---
  ./scripts/check-local-export arch/x86/kernel/bootflag.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.e820.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/e820"' -DKBUILD_BASENAME='"e820"' -DKBUILD_MODNAME='"e820"' -D__KBUILD_MODNAME=kmod_e820 -c -o arch/x86/kernel/e820.o arch/x86/kernel/e820.c  
In file included from arch/x86/kernel/e820.c:14:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from arch/x86/kernel/e820.c:14:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/e820.c:14:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/e820.c:14:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/e820.c:15:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
8 warnings generated.
In file included from arch/x86/kernel/e820.c:14:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from arch/x86/kernel/e820.c:14:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/e820.c:14:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/e820.c:14:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/e820.c:15:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^

arch/x86/kernel/e820.c should add these lines:
#include <asm/bug.h>                    // for BUG_ON
#include <linux/build_bug.h>            // for likely
#include <stddef.h>                     // for NULL
#include "asm-generic/early_ioremap.h"  // for early_memremap, early_memunmap
#include "asm-generic/errno-base.h"     // for EINVAL
#include "asm-generic/int-ll64.h"       // for u64, u32
#include "asm/bootparam.h"              // for setup_data, boot_params, boot...
#include "asm/cpufeature.h"             // for setup_clear_cpu_cap
#include "asm/cpufeatures.h"            // for X86_FEATURE_PSE
#include "asm/e820/types.h"             // for e820_entry, e820_table, e820_...
#include "asm/page_types.h"             // for PAGE_SHIFT, PAGE_SIZE
#include "asm/string_32.h"              // for memcpy, strchr, strcmp, strncmp
#include "asm/x86_init.h"               // for x86_init, x86_init_ops, x86_i...
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/cache.h"                // for SMP_CACHE_BYTES
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/init.h"                 // for __init, __initdata, __refdata
#include "linux/ioport.h"               // for resource, insert_resource
#include "linux/kern_levels.h"          // for KERN_DEBUG
#include "linux/kernel.h"               // for memparse, ARRAY_SIZE
#include "linux/kstrtox.h"              // for simple_strtoull
#include "linux/math.h"                 // for round_up
#include "linux/minmax.h"               // for max, min
#include "linux/panic.h"                // for panic
#include "linux/pfn.h"                  // for PFN_UP, PFN_DOWN
#include "linux/printk.h"               // for pr_cont, pr_info, early_printk
#include "linux/screen_info.h"          // for screen_info
#include "linux/stddef.h"               // for true, false, offsetof
#include "linux/string.h"               // for kmemdup
#include "linux/types.h"                // for bool, resource_size_t
#include "vdso/limits.h"                // for ULLONG_MAX

arch/x86/kernel/e820.c should remove these lines:
- #include <linux/acpi.h>  // lines 15-15
- #include <linux/crash_dump.h>  // lines 12-12
- #include <linux/memory_hotplug.h>  // lines 18-18

The full include-list for arch/x86/kernel/e820.c:
#include <asm/bug.h>                    // for BUG_ON
#include <asm/e820/api.h>               // for e820__end_of_low_ram_pfn, e82...
#include <asm/setup.h>                  // for boot_params, LOWMEMSIZE
#include <linux/build_bug.h>            // for likely
#include <linux/firmware-map.h>         // for firmware_map_add_early
#include <linux/memblock.h>             // for memblock_add, memblock_alloc
#include <linux/sort.h>                 // for sort
#include <linux/suspend.h>              // for register_nosave_region
#include <stddef.h>                     // for NULL
#include "asm-generic/early_ioremap.h"  // for early_memremap, early_memunmap
#include "asm-generic/errno-base.h"     // for EINVAL
#include "asm-generic/int-ll64.h"       // for u64, u32
#include "asm/bootparam.h"              // for setup_data, boot_params, boot...
#include "asm/cpufeature.h"             // for setup_clear_cpu_cap
#include "asm/cpufeatures.h"            // for X86_FEATURE_PSE
#include "asm/e820/types.h"             // for e820_entry, e820_table, e820_...
#include "asm/page_types.h"             // for PAGE_SHIFT, PAGE_SIZE
#include "asm/string_32.h"              // for memcpy, strchr, strcmp, strncmp
#include "asm/x86_init.h"               // for x86_init, x86_init_ops, x86_i...
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/cache.h"                // for SMP_CACHE_BYTES
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/init.h"                 // for __init, __initdata, __refdata
#include "linux/ioport.h"               // for resource, insert_resource
#include "linux/kern_levels.h"          // for KERN_DEBUG
#include "linux/kernel.h"               // for memparse, ARRAY_SIZE
#include "linux/kstrtox.h"              // for simple_strtoull
#include "linux/math.h"                 // for round_up
#include "linux/minmax.h"               // for max, min
#include "linux/panic.h"                // for panic
#include "linux/pfn.h"                  // for PFN_UP, PFN_DOWN
#include "linux/printk.h"               // for pr_cont, pr_info, early_printk
#include "linux/screen_info.h"          // for screen_info
#include "linux/stddef.h"               // for true, false, offsetof
#include "linux/string.h"               // for kmemdup
#include "linux/types.h"                // for bool, resource_size_t
#include "vdso/limits.h"                // for ULLONG_MAX
---
  ./scripts/check-local-export arch/x86/kernel/e820.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.pci-dma.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/pci-dma"' -DKBUILD_BASENAME='"pci_dma"' -DKBUILD_MODNAME='"pci_dma"' -D__KBUILD_MODNAME=kmod_pci_dma -c -o arch/x86/kernel/pci-dma.o arch/x86/kernel/pci-dma.c  
In file included from arch/x86/kernel/pci-dma.c:2:
In file included from ./include/linux/dma-map-ops.h:9:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/pci-dma.c:2:
In file included from ./include/linux/dma-map-ops.h:9:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/pci-dma.c:2:
In file included from ./include/linux/dma-map-ops.h:9:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/pci-dma.c:4:
./include/linux/iommu.h:52:49: warning: declaration of 'struct iommu_fault' will not be visible outside of this function [-Wvisibility]
typedef int (*iommu_dev_fault_handler_t)(struct iommu_fault *, void *);
                                                ^
./include/linux/iommu.h:387:18: warning: declaration of 'struct iommu_page_response' will not be visible outside of this function [-Wvisibility]
                                      struct iommu_page_response *msg)
                                             ^
In file included from arch/x86/kernel/pci-dma.c:5:
In file included from ./include/linux/dmar.h:12:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
9 warnings generated.
In file included from arch/x86/kernel/pci-dma.c:2:
In file included from ./include/linux/dma-map-ops.h:9:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/pci-dma.c:2:
In file included from ./include/linux/dma-map-ops.h:9:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/pci-dma.c:2:
In file included from ./include/linux/dma-map-ops.h:9:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/pci-dma.c:4:
./include/linux/iommu.h:52:49: warning: declaration of 'struct iommu_fault' will not be visible outside of this function [-Wvisibility]
typedef int (*iommu_dev_fault_handler_t)(struct iommu_fault *, void *);
                                                ^
./include/linux/iommu.h:387:18: warning: declaration of 'struct iommu_page_response' will not be visible outside of this function [-Wvisibility]
                                      struct iommu_page_response *msg)
                                             ^
In file included from arch/x86/kernel/pci-dma.c:5:
In file included from ./include/linux/dmar.h:12:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^

arch/x86/kernel/pci-dma.c should add these lines:
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm/cache.h"               // for __read_mostly
#include "asm/pci.h"                 // for pci_iommu_alloc
#include "asm/string_32.h"           // for strncmp
#include "linux/compiler_types.h"    // for inline
#include "linux/init.h"              // for __init, early_param, rootfs_init...
#include "linux/printk.h"            // for pr_warn
#include "linux/stddef.h"            // for true
#include "linux/string.h"            // for strcspn
#include "linux/swiotlb.h"           // for swiotlb_init
#include "linux/types.h"             // for bool

arch/x86/kernel/pci-dma.c should remove these lines:
- #include <asm/dma.h>  // lines 13-13
- #include <asm/proto.h>  // lines 12-12
- #include <linux/dma-direct.h>  // lines 3-3
- #include <linux/dma-map-ops.h>  // lines 2-2
- #include <linux/gfp.h>  // lines 8-8
- #include <linux/memblock.h>  // lines 7-7
- #include <linux/pci.h>  // lines 9-9

The full include-list for arch/x86/kernel/pci-dma.c:
#include <asm/gart.h>                // for gart_iommu_hole_init, gart_parse...
#include <asm/iommu.h>               // for x86_swiotlb_enable
#include <asm/x86_init.h>            // for x86_init, x86_init_iommu, x86_in...
#include <linux/amd-iommu.h>         // for amd_iommu_detect
#include <linux/dmar.h>              // for detect_intel_iommu
#include <linux/export.h>            // for EXPORT_SYMBOL
#include <linux/iommu.h>             // for iommu_set_default_passthrough
#include <xen/xen.h>                 // for xen_pv_domain
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm/cache.h"               // for __read_mostly
#include "asm/pci.h"                 // for pci_iommu_alloc
#include "asm/string_32.h"           // for strncmp
#include "linux/compiler_types.h"    // for inline
#include "linux/init.h"              // for __init, early_param, rootfs_init...
#include "linux/printk.h"            // for pr_warn
#include "linux/stddef.h"            // for true
#include "linux/string.h"            // for strcspn
#include "linux/swiotlb.h"           // for swiotlb_init
#include "linux/types.h"             // for bool
---
  ./scripts/check-local-export arch/x86/kernel/pci-dma.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.quirks.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/quirks"' -DKBUILD_BASENAME='"quirks"' -DKBUILD_MODNAME='"quirks"' -D__KBUILD_MODNAME=kmod_quirks -c -o arch/x86/kernel/quirks.o arch/x86/kernel/quirks.c  
In file included from arch/x86/kernel/quirks.c:6:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/quirks.c:6:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/quirks.c:6:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/quirks.c:6:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^
5 warnings generated.
In file included from arch/x86/kernel/quirks.c:6:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/quirks.c:6:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/quirks.c:6:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/quirks.c:6:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^

arch/x86/kernel/quirks.c should add these lines:
#include "linux/export.h"           // for EXPORT_SYMBOL
#include "linux/init.h"             // for __init
#include "linux/mod_devicetable.h"  // for DMI_SYS_VENDOR
#include "linux/types.h"            // for bool

arch/x86/kernel/quirks.c should remove these lines:
- #include <asm/hpet.h>  // lines 9-9
- #include <asm/mce.h>  // lines 11-11
- #include <linux/irq.h>  // lines 7-7
- #include <linux/pci.h>  // lines 6-6

The full include-list for arch/x86/kernel/quirks.c:
#include <asm/setup.h>              // for early_platform_quirks
#include <linux/dmi.h>              // for dmi_match
#include "linux/export.h"           // for EXPORT_SYMBOL
#include "linux/init.h"             // for __init
#include "linux/mod_devicetable.h"  // for DMI_SYS_VENDOR
#include "linux/types.h"            // for bool
---
  ./scripts/check-local-export arch/x86/kernel/quirks.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.topology.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/topology"' -DKBUILD_BASENAME='"topology"' -DKBUILD_MODNAME='"topology"' -D__KBUILD_MODNAME=kmod_topology -c -o arch/x86/kernel/topology.o arch/x86/kernel/topology.c  
In file included from arch/x86/kernel/topology.c:36:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/topology.c:36:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/topology.c:36:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/kernel/topology.c:36:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/topology.c:36:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/topology.c:36:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/kernel/topology.c should add these lines:
#include <asm-generic/percpu.h>  // for DEFINE_PER_CPU, per_cpu
#include "linux/cpu.h"           // for register_cpu
#include "linux/cpumask.h"       // for for_each_present_cpu

arch/x86/kernel/topology.c should remove these lines:
- #include <asm/io_apic.h>  // lines 35-35
- #include <linux/export.h>  // lines 30-30
- #include <linux/interrupt.h>  // lines 28-28
- #include <linux/irq.h>  // lines 34-34
- #include <linux/mmzone.h>  // lines 31-31
- #include <linux/nodemask.h>  // lines 29-29
- #include <linux/smp.h>  // lines 33-33

The full include-list for arch/x86/kernel/topology.c:
#include <asm-generic/percpu.h>  // for DEFINE_PER_CPU, per_cpu
#include <asm/cpu.h>             // for x86_cpu
#include <linux/init.h>          // for __init, subsys_initcall
#include "linux/cpu.h"           // for register_cpu
#include "linux/cpumask.h"       // for for_each_present_cpu
---
  ./scripts/check-local-export arch/x86/kernel/topology.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.kdebugfs.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/kdebugfs"' -DKBUILD_BASENAME='"kdebugfs"' -DKBUILD_MODNAME='"kdebugfs"' -D__KBUILD_MODNAME=kmod_kdebugfs -c -o arch/x86/kernel/kdebugfs.o arch/x86/kernel/kdebugfs.c  

arch/x86/kernel/kdebugfs.c should add these lines:
#include <stddef.h>         // for NULL

arch/x86/kernel/kdebugfs.c should remove these lines:
- #include <asm/setup.h>  // lines 17-17
- #include <linux/io.h>  // lines 14-14
- #include <linux/mm.h>  // lines 15-15
- #include <linux/slab.h>  // lines 11-11
- #include <linux/stat.h>  // lines 13-13
- #include <linux/uaccess.h>  // lines 9-9

The full include-list for arch/x86/kernel/kdebugfs.c:
#include <linux/debugfs.h>  // for debugfs_create_dir
#include <linux/export.h>   // for EXPORT_SYMBOL
#include <linux/init.h>     // for __init, arch_initcall
#include <stddef.h>         // for NULL
---
  ./scripts/check-local-export arch/x86/kernel/kdebugfs.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.alternative.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/alternative"' -DKBUILD_BASENAME='"alternative"' -DKBUILD_MODNAME='"alternative"' -D__KBUILD_MODNAME=kmod_alternative -c -o arch/x86/kernel/alternative.o arch/x86/kernel/alternative.c  
In file included from arch/x86/kernel/alternative.c:6:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/alternative.c:6:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/alternative.c:6:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/alternative.c:6:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/kernel/alternative.c:6:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/alternative.c:6:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/alternative.c:6:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/alternative.c:6:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/alternative.c should add these lines:
#include <asm-generic/percpu.h>                // for this_cpu_read
#include <asm/barrier.h>                       // for smp_mb__before_atomic
#include <asm/bug.h>                           // for BUG_ON, WARN_ON_ONCE
#include <asm/cpufeatures.h>                   // for REQUIRED_MASK0, REQUIR...
#include <asm/percpu.h>                        // for this_cpu_read_8
#include <linux/atomic.h>                      // for arch_atomic_inc_not_zero
#include <linux/linkage.h>                     // for ASM_RET
#include <stddef.h>                            // for size_t, NULL
#include "asm-generic/int-ll64.h"              // for u8, s32, s8, u16
#include "asm-generic/rwonce.h"                // for WRITE_ONCE, __READ_ONCE
#include "asm-generic/sections.h"              // for _stext
#include "asm/asm.h"                           // for ASM_CALL_CONSTRAINT
#include "asm/atomic.h"                        // for arch_atomic_dec
#include "asm/bug.h"                           // for BUG
#include "asm/cache.h"                         // for __read_mostly
#include "asm/cpufeature.h"                    // for boot_cpu_has
#include "asm/cpufeatures.h"                   // for NBUGINTS, NCAPINTS
#include "asm/current.h"                       // for current
#include "asm/debugreg.h"                      // for hw_breakpoint_active
#include "asm/inat_types.h"                    // for insn_byte_t
#include "asm/kdebug.h"                        // for DIE_INT3
#include "asm/mmu.h"                           // for leave_mm
#include "asm/mmu_context.h"                   // for switch_mm_irqs_off
#include "asm/nops.h"                          // for ASM_NOP_MAX, BYTES_NOP1
#include "asm/page.h"                          // for virt_to_page
#include "asm/page_types.h"                    // for PAGE_SIZE, PAGE_SHIFT
#include "asm/percpu.h"                        // for __pcpu_op2_1, __pcpu_o...
#include "asm/pgtable-2level_types.h"          // for pte_t
#include "asm/pgtable.h"                       // for set_pte_at, mk_pte
#include "asm/pgtable_types.h"                 // for PAGE_KERNEL, _PAGE_GLOBAL
#include "asm/ptrace.h"                        // for user_mode, pt_regs
#include "asm/string_32.h"                     // for memcpy, memcmp, memset
#include "asm/sync_core.h"                     // for sync_core
#include "linux/atomic.h"                      // for atomic_cond_read_acquire
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec_and_test
#include "linux/cache.h"                       // for __ro_after_init
#include "linux/compiler.h"                    // for unlikely, OPTIMIZER_HI...
#include "linux/compiler_attributes.h"         // for noinline, __always_inline
#include "linux/compiler_types.h"              // for inline, noinstr
#include "linux/export.h"                      // for EXPORT_SYMBOL_GPL
#include "linux/init.h"                        // for __init, __ref, __setup
#include "linux/irqflags.h"                    // for local_irq_restore, loc...
#include "linux/kasan.h"                       // for kasan_disable_current
#include "linux/kern_levels.h"                 // for KERN_DEBUG, KERN_CONT
#include "linux/kernel.h"                      // for core_kernel_text, SYST...
#include "linux/lockdep.h"                     // for lockdep_assert_held
#include "linux/minmax.h"                      // for min_t
#include "linux/mmdebug.h"                     // for VM_BUG_ON
#include "linux/notifier.h"                    // for NOTIFY_DONE, NOTIFY_STOP
#include "linux/objtool.h"                     // for ANNOTATE_NOENDBR
#include "linux/printk.h"                      // for printk
#include "linux/smp.h"                         // for on_each_cpu, smp_proce...
#include "linux/spinlock_types.h"              // for spinlock_t
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for bool, ATOMIC_INIT, ato...
#include "vdso/limits.h"                       // for INT_MAX
struct mm_struct;
struct page;

arch/x86/kernel/alternative.c should remove these lines:
- #include <asm/asm-prototypes.h>  // lines 32-32
- #include <asm/cacheflush.h>  // lines 26-26
- #include <asm/fixmap.h>  // lines 30-30
- #include <asm/io.h>  // lines 29-29
- #include <asm/mce.h>  // lines 24-24
- #include <asm/sections.h>  // lines 23-23
- #include <linux/highmem.h>  // lines 10-10
- #include <linux/kprobes.h>  // lines 17-17
- #include <linux/list.h>  // lines 8-8
- #include <linux/mmu_context.h>  // lines 18-18
- #include <linux/sched.h>  // lines 5-5
- #include <linux/slab.h>  // lines 15-15
- #include <linux/stop_machine.h>  // lines 14-14
- #include <linux/stringify.h>  // lines 9-9
- #include <linux/sync_core.h>  // lines 20-20
- #include <linux/vmalloc.h>  // lines 12-12

The full include-list for arch/x86/kernel/alternative.c:
#include <asm-generic/percpu.h>                // for this_cpu_read
#include <asm/alternative.h>                   // for alt_instr, ALTINSTR_FL...
#include <asm/barrier.h>                       // for smp_mb__before_atomic
#include <asm/bug.h>                           // for BUG_ON, WARN_ON_ONCE
#include <asm/cpufeatures.h>                   // for REQUIRED_MASK0, REQUIR...
#include <asm/insn.h>                          // for insn, insn_field, insn...
#include <asm/nmi.h>                           // for restart_nmi, stop_nmi
#include <asm/paravirt.h>                      // for paravirt_set_cap
#include <asm/percpu.h>                        // for this_cpu_read_8
#include <asm/text-patching.h>                 // for INT3_INSN_SIZE, int3_e...
#include <asm/tlbflush.h>                      // for cpu_tlbstate, cpu_tlbs...
#include <linux/atomic.h>                      // for arch_atomic_inc_not_zero
#include <linux/bsearch.h>                     // for __inline_bsearch
#include <linux/kdebug.h>                      // for register_die_notifier
#include <linux/linkage.h>                     // for ASM_RET
#include <linux/memory.h>                      // for text_mutex
#include <linux/mm.h>                          // for vmalloc_to_page, offse...
#include <linux/module.h>                      // for __init_or_module, is_m...
#include <linux/mutex.h>                       // for mutex_lock, mutex_unlock
#include <linux/perf_event.h>                  // for perf_event_text_poke
#include <stddef.h>                            // for size_t, NULL
#include "asm-generic/int-ll64.h"              // for u8, s32, s8, u16
#include "asm-generic/rwonce.h"                // for WRITE_ONCE, __READ_ONCE
#include "asm-generic/sections.h"              // for _stext
#include "asm/asm.h"                           // for ASM_CALL_CONSTRAINT
#include "asm/atomic.h"                        // for arch_atomic_dec
#include "asm/bug.h"                           // for BUG
#include "asm/cache.h"                         // for __read_mostly
#include "asm/cpufeature.h"                    // for boot_cpu_has
#include "asm/cpufeatures.h"                   // for NBUGINTS, NCAPINTS
#include "asm/current.h"                       // for current
#include "asm/debugreg.h"                      // for hw_breakpoint_active
#include "asm/inat_types.h"                    // for insn_byte_t
#include "asm/kdebug.h"                        // for DIE_INT3
#include "asm/mmu.h"                           // for leave_mm
#include "asm/mmu_context.h"                   // for switch_mm_irqs_off
#include "asm/nops.h"                          // for ASM_NOP_MAX, BYTES_NOP1
#include "asm/page.h"                          // for virt_to_page
#include "asm/page_types.h"                    // for PAGE_SIZE, PAGE_SHIFT
#include "asm/percpu.h"                        // for __pcpu_op2_1, __pcpu_o...
#include "asm/pgtable-2level_types.h"          // for pte_t
#include "asm/pgtable.h"                       // for set_pte_at, mk_pte
#include "asm/pgtable_types.h"                 // for PAGE_KERNEL, _PAGE_GLOBAL
#include "asm/ptrace.h"                        // for user_mode, pt_regs
#include "asm/string_32.h"                     // for memcpy, memcmp, memset
#include "asm/sync_core.h"                     // for sync_core
#include "linux/atomic.h"                      // for atomic_cond_read_acquire
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec_and_test
#include "linux/cache.h"                       // for __ro_after_init
#include "linux/compiler.h"                    // for unlikely, OPTIMIZER_HI...
#include "linux/compiler_attributes.h"         // for noinline, __always_inline
#include "linux/compiler_types.h"              // for inline, noinstr
#include "linux/export.h"                      // for EXPORT_SYMBOL_GPL
#include "linux/init.h"                        // for __init, __ref, __setup
#include "linux/irqflags.h"                    // for local_irq_restore, loc...
#include "linux/kasan.h"                       // for kasan_disable_current
#include "linux/kern_levels.h"                 // for KERN_DEBUG, KERN_CONT
#include "linux/kernel.h"                      // for core_kernel_text, SYST...
#include "linux/lockdep.h"                     // for lockdep_assert_held
#include "linux/minmax.h"                      // for min_t
#include "linux/mmdebug.h"                     // for VM_BUG_ON
#include "linux/notifier.h"                    // for NOTIFY_DONE, NOTIFY_STOP
#include "linux/objtool.h"                     // for ANNOTATE_NOENDBR
#include "linux/printk.h"                      // for printk
#include "linux/smp.h"                         // for on_each_cpu, smp_proce...
#include "linux/spinlock_types.h"              // for spinlock_t
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for bool, ATOMIC_INIT, ato...
#include "vdso/limits.h"                       // for INT_MAX
struct mm_struct;
struct page;
---
  ./scripts/check-local-export arch/x86/kernel/alternative.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.i8253.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/i8253"' -DKBUILD_BASENAME='"i8253"' -DKBUILD_MODNAME='"i8253"' -D__KBUILD_MODNAME=kmod_i8253 -c -o arch/x86/kernel/i8253.o arch/x86/kernel/i8253.c  

arch/x86/kernel/i8253.c should add these lines:
#include <asm/cpufeatures.h>     // for REQUIRED_MASK0, REQUIRED_MASK1, REQU...
#include "asm/cpufeature.h"      // for boot_cpu_has
#include "asm/cpufeatures.h"     // for X86_FEATURE_TSC
#include "generated/autoconf.h"  // for CONFIG_X86_TSC
#include "linux/clocksource.h"   // for clocksource_i8253_init
#include "linux/cpumask.h"       // for num_possible_cpus
#include "linux/kconfig.h"       // for __ARG_PLACEHOLDER_1, IS_ENABLED
#include "linux/stddef.h"        // for true, false
#include "linux/types.h"         // for bool

arch/x86/kernel/i8253.c should remove these lines:
- #include <asm/smp.h>  // lines 14-14
- #include <linux/timex.h>  // lines 8-8

The full include-list for arch/x86/kernel/i8253.c:
#include <asm/apic.h>            // for apic_needs_pit
#include <asm/cpufeatures.h>     // for REQUIRED_MASK0, REQUIRED_MASK1, REQU...
#include <asm/hpet.h>            // for is_hpet_enabled
#include <asm/time.h>            // for pit_timer_init
#include <linux/clockchips.h>    // for clockevent_state_periodic
#include <linux/i8253.h>         // for clockevent_i8253_init, i8253_clockevent
#include <linux/init.h>          // for __init, arch_initcall
#include "asm/cpufeature.h"      // for boot_cpu_has
#include "asm/cpufeatures.h"     // for X86_FEATURE_TSC
#include "generated/autoconf.h"  // for CONFIG_X86_TSC
#include "linux/clocksource.h"   // for clocksource_i8253_init
#include "linux/cpumask.h"       // for num_possible_cpus
#include "linux/kconfig.h"       // for __ARG_PLACEHOLDER_1, IS_ENABLED
#include "linux/stddef.h"        // for true, false
#include "linux/types.h"         // for bool
---
  ./scripts/check-local-export arch/x86/kernel/i8253.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.hw_breakpoint.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/hw_breakpoint"' -DKBUILD_BASENAME='"hw_breakpoint"' -DKBUILD_MODNAME='"hw_breakpoint"' -D__KBUILD_MODNAME=kmod_hw_breakpoint -c -o arch/x86/kernel/hw_breakpoint.o arch/x86/kernel/hw_breakpoint.c  
In file included from arch/x86/kernel/hw_breakpoint.c:18:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/hw_breakpoint.c:18:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/hw_breakpoint.c:18:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/hw_breakpoint.c:18:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/kernel/hw_breakpoint.c:18:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/hw_breakpoint.c:18:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/hw_breakpoint.c:18:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/hw_breakpoint.c:18:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/hw_breakpoint.c should add these lines:
#include <asm-generic/percpu.h>         // for __this_cpu_read, DEFINE_PER_CPU
#include <asm/bug.h>                    // for WARN_ONCE, WARN_ON_ONCE
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/page_types.h>             // for TASK_SIZE_MAX
#include <asm/percpu.h>                 // for raw_cpu_read_8, this_cpu_read_8
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EINVAL, EBUSY
#include "asm-generic/errno.h"          // for EOPNOTSUPP
#include "asm/cpu_entry_area.h"         // for CPU_ENTRY_AREA_TOTAL_SIZE
#include "asm/cpufeature.h"             // for boot_cpu_has
#include "asm/cpufeatures.h"            // for X86_FEATURE_BPEXT
#include "asm/current.h"                // for current
#include "asm/debugreg.h"               // for DR_TRAP_BITS, DR_CONTROL_SHIFT
#include "asm/kdebug.h"                 // for DIE_DEBUG
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/pgtable_32_areas.h"       // for CPU_ENTRY_AREA_BASE
#include "asm/processor-flags.h"        // for X86_EFLAGS_RF
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/segment.h"                // for GDT_SIZE
#include "linux/compiler.h"             // for barrier, likely
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for inline
#include "linux/cpumask.h"              // for for_each_possible_cpu
#include "linux/err.h"                  // for ERR_PTR
#include "linux/hw_breakpoint.h"        // for HW_BREAKPOINT_W, HW_BREAKPOIN...
#include "linux/lockdep.h"              // for lockdep_assert_irqs_disabled
#include "linux/log2.h"                 // for is_power_of_2
#include "linux/perf_event.h"           // for perf_event_attr, perf_event_a...
#include "linux/stddef.h"               // for true, false
#include "linux/types.h"                // for bool

arch/x86/kernel/hw_breakpoint.c should remove these lines:
- #include <asm/user.h>  // lines 34-34
- #include <linux/irqflags.h>  // lines 20-20
- #include <linux/kallsyms.h>  // lines 22-22
- #include <linux/kernel.h>  // lines 26-26
- #include <linux/smp.h>  // lines 29-29

The full include-list for arch/x86/kernel/hw_breakpoint.c:
#include <asm-generic/percpu.h>         // for __this_cpu_read, DEFINE_PER_CPU
#include <asm/bug.h>                    // for WARN_ONCE, WARN_ON_ONCE
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/debugreg.h>               // for set_debugreg, set_dr_addr_mask
#include <asm/desc.h>                   // for get_cpu_gdt_rw
#include <asm/hw_breakpoint.h>          // for arch_hw_breakpoint, HBP_NUM
#include <asm/page_types.h>             // for TASK_SIZE_MAX
#include <asm/percpu.h>                 // for raw_cpu_read_8, this_cpu_read_8
#include <asm/processor.h>              // for thread_struct, cpu_tss_rw
#include <asm/tlbflush.h>               // for cpu_tlbstate, tlb_state
#include <linux/export.h>               // for EXPORT_SYMBOL_GPL
#include <linux/hw_breakpoint.h>        // for counter_arch_bp, unregister_h...
#include <linux/kdebug.h>               // for die_args
#include <linux/kprobes.h>              // for within_kprobe_blacklist
#include <linux/notifier.h>             // for NOTIFY_DONE, NOTIFY_STOP
#include <linux/percpu.h>               // for pcpu_unit_offsets
#include <linux/perf_event.h>           // for perf_bp_event, hw_perf_event
#include <linux/sched.h>                // for task_struct
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EINVAL, EBUSY
#include "asm-generic/errno.h"          // for EOPNOTSUPP
#include "asm/cpu_entry_area.h"         // for CPU_ENTRY_AREA_TOTAL_SIZE
#include "asm/cpufeature.h"             // for boot_cpu_has
#include "asm/cpufeatures.h"            // for X86_FEATURE_BPEXT
#include "asm/current.h"                // for current
#include "asm/debugreg.h"               // for DR_TRAP_BITS, DR_CONTROL_SHIFT
#include "asm/kdebug.h"                 // for DIE_DEBUG
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/pgtable_32_areas.h"       // for CPU_ENTRY_AREA_BASE
#include "asm/processor-flags.h"        // for X86_EFLAGS_RF
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/segment.h"                // for GDT_SIZE
#include "linux/compiler.h"             // for barrier, likely
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for inline
#include "linux/cpumask.h"              // for for_each_possible_cpu
#include "linux/err.h"                  // for ERR_PTR
#include "linux/hw_breakpoint.h"        // for HW_BREAKPOINT_W, HW_BREAKPOIN...
#include "linux/lockdep.h"              // for lockdep_assert_irqs_disabled
#include "linux/log2.h"                 // for is_power_of_2
#include "linux/perf_event.h"           // for perf_event_attr, perf_event_a...
#include "linux/stddef.h"               // for true, false
#include "linux/types.h"                // for bool
---
  ./scripts/check-local-export arch/x86/kernel/hw_breakpoint.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.tsc.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/tsc"' -DKBUILD_BASENAME='"tsc"' -DKBUILD_MODNAME='"tsc"' -D__KBUILD_MODNAME=kmod_tsc -c -o arch/x86/kernel/tsc.o arch/x86/kernel/tsc.c  

arch/x86/kernel/tsc.c should add these lines:
#include <asm-generic/percpu.h>         // for this_cpu_read, per_cpu, per_c...
#include <asm/bug.h>                    // for WARN_ON
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/percpu.h>                 // for this_cpu_read_8, this_cpu_wri...
#include <linux/ktime.h>                // for system_counterval_t
#include "asm-generic/delay.h"          // for udelay
#include "asm-generic/int-ll64.h"       // for u64, u32
#include "asm-generic/param.h"          // for HZ
#include "asm/cache.h"                  // for __read_mostly
#include "asm/clocksource.h"            // for vclocks_set_used
#include "asm/cpufeature.h"             // for boot_cpu_has, setup_clear_cpu...
#include "asm/cpufeatures.h"            // for X86_FEATURE_TSC, X86_FEATURE_ART
#include "asm/div64.h"                  // for do_div
#include "asm/msr-index.h"              // for MSR_IA32_TSC_ADJUST
#include "asm/msr.h"                    // for rdtsc, rdtsc_ordered, rdmsrl
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/processor.h"              // for cpuid, cpuinfo_x86, boot_cpu_...
#include "asm/shared/io.h"              // for outb, inb
#include "asm/string_32.h"              // for strcmp, strncmp
#include "asm/tsc.h"                    // for get_cycles, cpu_khz_from_msr
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __always_inline
#include "linux/compiler_types.h"       // for inline
#include "linux/cpumask.h"              // for for_each_possible_cpu, num_po...
#include "linux/irqflags.h"             // for local_irq_restore, local_irq_...
#include "linux/jiffies.h"              // for INITIAL_JIFFIES, jiffies_64
#include "linux/jump_label.h"           // for DEFINE_STATIC_KEY_FALSE, stat...
#include "linux/kstrtox.h"              // for kstrtouint
#include "linux/list.h"                 // for LIST_HEAD_INIT
#include "linux/math.h"                 // for abs
#include "linux/math64.h"               // for mul_u64_u32_shr, div64_u64
#include "linux/minmax.h"               // for min
#include "linux/nodemask.h"             // for nr_online_nodes
#include "linux/preempt.h"              // for preempt_disable_notrace, pree...
#include "linux/printk.h"               // for pr_info, pr_warn, pr_notice
#include "linux/seqlock.h"              // for seqcount_latch_t, seqcount_t
#include "linux/smp.h"                  // for smp_processor_id
#include "linux/stddef.h"               // for true, false
#include "linux/types.h"                // for bool
#include "linux/workqueue.h"            // for work_struct, schedule_delayed...
#include "vdso/clocksource.h"           // for VDSO_CLOCKMODE_TSC
#include "vdso/limits.h"                // for ULONG_MAX, ULLONG_MAX
#include "vdso/time64.h"                // for USEC_PER_MSEC, NSEC_PER_MSEC

arch/x86/kernel/tsc.c should remove these lines:
- #include <asm/geode.h>  // lines 27-27
- #include <asm/hypervisor.h>  // lines 24-24
- #include <asm/nmi.h>  // lines 25-25
- #include <asm/time.h>  // lines 22-22
- #include <asm/vgtod.h>  // lines 21-21
- #include <linux/kernel.h>  // lines 4-4
- #include <linux/percpu.h>  // lines 14-14
- #include <linux/sched.h>  // lines 5-5
- #include <linux/static_call.h>  // lines 17-17
- #include <linux/static_key.h>  // lines 16-16
- #include <linux/timer.h>  // lines 9-9

The full include-list for arch/x86/kernel/tsc.c:
#include <asm-generic/percpu.h>         // for this_cpu_read, per_cpu, per_c...
#include <asm/apic.h>                   // for lapic_update_tsc_freq
#include <asm/bug.h>                    // for WARN_ON
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/delay.h>                  // for use_tsc_delay
#include <asm/hpet.h>                   // for is_hpet_enabled, hpet_readl
#include <asm/i8259.h>                  // for has_legacy_pic
#include <asm/intel-family.h>           // for INTEL_FAM6_ATOM_GOLDMONT, INT...
#include <asm/percpu.h>                 // for this_cpu_read_8, this_cpu_wri...
#include <asm/timer.h>                  // for cyc2ns_data, cyc2ns_read_begin
#include <asm/uv/uv.h>                  // for is_early_uv_system
#include <asm/x86_init.h>               // for x86_platform, x86_platform_ops
#include <linux/acpi_pmtmr.h>           // for acpi_pm_read_early, ACPI_PM_O...
#include <linux/clocksource.h>          // for clocksource, clocksource_regi...
#include <linux/cpufreq.h>              // for cpufreq_scale
#include <linux/delay.h>                // for loops_per_jiffy, lpj_fine
#include <linux/export.h>               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/init.h>                 // for __init, __setup, __initdata
#include <linux/ktime.h>                // for system_counterval_t
#include <linux/sched/clock.h>          // for clear_sched_clock_stable, dis...
#include <linux/timex.h>                // for PIT_TICK_RATE
#include "asm-generic/delay.h"          // for udelay
#include "asm-generic/int-ll64.h"       // for u64, u32
#include "asm-generic/param.h"          // for HZ
#include "asm/cache.h"                  // for __read_mostly
#include "asm/clocksource.h"            // for vclocks_set_used
#include "asm/cpufeature.h"             // for boot_cpu_has, setup_clear_cpu...
#include "asm/cpufeatures.h"            // for X86_FEATURE_TSC, X86_FEATURE_ART
#include "asm/div64.h"                  // for do_div
#include "asm/msr-index.h"              // for MSR_IA32_TSC_ADJUST
#include "asm/msr.h"                    // for rdtsc, rdtsc_ordered, rdmsrl
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/processor.h"              // for cpuid, cpuinfo_x86, boot_cpu_...
#include "asm/shared/io.h"              // for outb, inb
#include "asm/string_32.h"              // for strcmp, strncmp
#include "asm/tsc.h"                    // for get_cycles, cpu_khz_from_msr
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __always_inline
#include "linux/compiler_types.h"       // for inline
#include "linux/cpumask.h"              // for for_each_possible_cpu, num_po...
#include "linux/irqflags.h"             // for local_irq_restore, local_irq_...
#include "linux/jiffies.h"              // for INITIAL_JIFFIES, jiffies_64
#include "linux/jump_label.h"           // for DEFINE_STATIC_KEY_FALSE, stat...
#include "linux/kstrtox.h"              // for kstrtouint
#include "linux/list.h"                 // for LIST_HEAD_INIT
#include "linux/math.h"                 // for abs
#include "linux/math64.h"               // for mul_u64_u32_shr, div64_u64
#include "linux/minmax.h"               // for min
#include "linux/nodemask.h"             // for nr_online_nodes
#include "linux/preempt.h"              // for preempt_disable_notrace, pree...
#include "linux/printk.h"               // for pr_info, pr_warn, pr_notice
#include "linux/seqlock.h"              // for seqcount_latch_t, seqcount_t
#include "linux/smp.h"                  // for smp_processor_id
#include "linux/stddef.h"               // for true, false
#include "linux/types.h"                // for bool
#include "linux/workqueue.h"            // for work_struct, schedule_delayed...
#include "vdso/clocksource.h"           // for VDSO_CLOCKMODE_TSC
#include "vdso/limits.h"                // for ULONG_MAX, ULLONG_MAX
#include "vdso/time64.h"                // for USEC_PER_MSEC, NSEC_PER_MSEC
---
  ./scripts/check-local-export arch/x86/kernel/tsc.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.tsc_msr.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/tsc_msr"' -DKBUILD_BASENAME='"tsc_msr"' -DKBUILD_MODNAME='"tsc_msr"' -D__KBUILD_MODNAME=kmod_tsc_msr -c -o arch/x86/kernel/tsc_msr.o arch/x86/kernel/tsc_msr.c  

arch/x86/kernel/tsc_msr.c should add these lines:
#include "asm-generic/int-ll64.h"   // for u32
#include "asm/cpufeature.h"         // for setup_force_cpu_cap
#include "asm/cpufeatures.h"        // for X86_FEATURE_TSC_KNOWN_FREQ, X86_F...
#include "asm/msr-index.h"          // for MSR_FSB_FREQ, MSR_IA32_PERF_STATUS
#include "asm/processor.h"          // for X86_VENDOR_INTEL
#include "linux/math.h"             // for DIV_ROUND_CLOSEST
#include "linux/mod_devicetable.h"  // for x86_cpu_id
#include "linux/printk.h"           // for pr_err
#include "linux/stddef.h"           // for true, false
#include "linux/types.h"            // for bool

arch/x86/kernel/tsc_msr.c should remove these lines:
- #include <asm/apic.h>  // lines 12-12
- #include <asm/param.h>  // lines 16-16
- #include <linux/kernel.h>  // lines 9-9
- #include <linux/thread_info.h>  // lines 10-10

The full include-list for arch/x86/kernel/tsc_msr.c:
#include <asm/cpu_device_id.h>      // for X86_MATCH_INTEL_FAM6_MODEL, x86_m...
#include <asm/intel-family.h>       // for INTEL_FAM6_ATOM_AIRMONT, INTEL_FA...
#include <asm/msr.h>                // for rdmsr
#include <asm/tsc.h>                // for cpu_khz_from_msr
#include "asm-generic/int-ll64.h"   // for u32
#include "asm/cpufeature.h"         // for setup_force_cpu_cap
#include "asm/cpufeatures.h"        // for X86_FEATURE_TSC_KNOWN_FREQ, X86_F...
#include "asm/msr-index.h"          // for MSR_FSB_FREQ, MSR_IA32_PERF_STATUS
#include "asm/processor.h"          // for X86_VENDOR_INTEL
#include "linux/math.h"             // for DIV_ROUND_CLOSEST
#include "linux/mod_devicetable.h"  // for x86_cpu_id
#include "linux/printk.h"           // for pr_err
#include "linux/stddef.h"           // for true, false
#include "linux/types.h"            // for bool
---
  ./scripts/check-local-export arch/x86/kernel/tsc_msr.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.io_delay.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/io_delay"' -DKBUILD_BASENAME='"io_delay"' -DKBUILD_MODNAME='"io_delay"' -D__KBUILD_MODNAME=kmod_io_delay -c -o arch/x86/kernel/io_delay.o arch/x86/kernel/io_delay.c  

arch/x86/kernel/io_delay.c should add these lines:
#include "asm-generic/delay.h"       // for udelay
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm/cache.h"               // for __read_mostly
#include "asm/io.h"                  // for io_delay_init, native_io_delay
#include "asm/string_32.h"           // for strcmp
#include "linux/mod_devicetable.h"   // for DMI_BOARD_NAME, DMI_BOARD_VENDOR
#include "linux/printk.h"            // for pr_notice

arch/x86/kernel/io_delay.c should remove these lines:
- #include <linux/delay.h>  // lines 11-11
- #include <linux/io.h>  // lines 14-14
- #include <linux/kernel.h>  // lines 9-9

The full include-list for arch/x86/kernel/io_delay.c:
#include <linux/dmi.h>               // for dmi_check_system
#include <linux/export.h>            // for EXPORT_SYMBOL
#include <linux/init.h>              // for __init, __initconst, __initdata
#include "asm-generic/delay.h"       // for udelay
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm/cache.h"               // for __read_mostly
#include "asm/io.h"                  // for io_delay_init, native_io_delay
#include "asm/string_32.h"           // for strcmp
#include "linux/mod_devicetable.h"   // for DMI_BOARD_NAME, DMI_BOARD_VENDOR
#include "linux/printk.h"            // for pr_notice
---
  ./scripts/check-local-export arch/x86/kernel/io_delay.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.rtc.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/rtc"' -DKBUILD_BASENAME='"rtc"' -DKBUILD_MODNAME='"rtc"' -D__KBUILD_MODNAME=kmod_rtc -c -o arch/x86/kernel/rtc.o arch/x86/kernel/rtc.c  
In file included from arch/x86/kernel/rtc.c:5:
In file included from ./include/linux/platform_device.h:13:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/rtc.c:5:
In file included from ./include/linux/platform_device.h:13:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/rtc.c:5:
In file included from ./include/linux/platform_device.h:13:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/rtc.c:6:
In file included from ./include/linux/mc146818rtc.h:15:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
In file included from arch/x86/kernel/rtc.c:7:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
In file included from arch/x86/kernel/rtc.c:16:
In file included from ./arch/x86/include/asm/intel-mid.h:10:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^
10 warnings generated.
In file included from arch/x86/kernel/rtc.c:5:
In file included from ./include/linux/platform_device.h:13:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/rtc.c:5:
In file included from ./include/linux/platform_device.h:13:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/rtc.c:5:
In file included from ./include/linux/platform_device.h:13:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/rtc.c:6:
In file included from ./include/linux/mc146818rtc.h:15:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
In file included from arch/x86/kernel/rtc.c:7:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
In file included from arch/x86/kernel/rtc.c:16:
In file included from ./arch/x86/include/asm/intel-mid.h:10:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^

arch/x86/kernel/rtc.c should add these lines:
#include <asm/bug.h>                 // for WARN_ON_ONCE
#include <linux/ktime.h>             // for read_persistent_clock64, update_...
#include "asm-generic/errno-base.h"  // for EINVAL, ENODEV
#include "asm/mc146818rtc.h"         // for CMOS_READ, RTC_PORT, RTC_ALWAYS_BCD
#include "asm/shared/io.h"           // for outb, inb
#include "asm/vdso/processor.h"      // for cpu_relax
#include "linux/dev_printk.h"        // for dev_info
#include "linux/init.h"              // for __init, device_initcall
#include "linux/ioport.h"            // for IORESOURCE_IO, IORESOURCE_IRQ
#include "linux/kern_levels.h"       // for KERN_ERR
#include "linux/kernel.h"            // for ARRAY_SIZE
#include "linux/pm-trace.h"          // for pm_trace_rtc_valid
#include "linux/printk.h"            // for printk
#include "linux/rtc.h"               // for rtc_time64_to_tm, rtc_valid_tm
#include "linux/spinlock.h"          // for spin_unlock_irqrestore, spin_loc...
#include "linux/spinlock_types.h"    // for DEFINE_SPINLOCK
#include "linux/time.h"              // for mktime64
#include "linux/time64.h"            // for timespec64

arch/x86/kernel/rtc.c should remove these lines:
- #include <asm/intel-mid.h>  // lines 16-16
- #include <asm/setup.h>  // lines 17-17
- #include <asm/time.h>  // lines 15-15
- #include <asm/vsyscall.h>  // lines 13-13
- #include <linux/acpi.h>  // lines 7-7
- #include <linux/of.h>  // lines 11-11

The full include-list for arch/x86/kernel/rtc.c:
#include <asm/bug.h>                 // for WARN_ON_ONCE
#include <asm/x86_init.h>            // for x86_platform, x86_platform_ops
#include <linux/bcd.h>               // for bcd2bin
#include <linux/export.h>            // for EXPORT_SYMBOL
#include <linux/ktime.h>             // for read_persistent_clock64, update_...
#include <linux/mc146818rtc.h>       // for mc146818_set_time, RTC_DM_BINARY
#include <linux/platform_device.h>   // for platform_device_register, platfo...
#include "asm-generic/errno-base.h"  // for EINVAL, ENODEV
#include "asm/mc146818rtc.h"         // for CMOS_READ, RTC_PORT, RTC_ALWAYS_BCD
#include "asm/shared/io.h"           // for outb, inb
#include "asm/vdso/processor.h"      // for cpu_relax
#include "linux/dev_printk.h"        // for dev_info
#include "linux/init.h"              // for __init, device_initcall
#include "linux/ioport.h"            // for IORESOURCE_IO, IORESOURCE_IRQ
#include "linux/kern_levels.h"       // for KERN_ERR
#include "linux/kernel.h"            // for ARRAY_SIZE
#include "linux/pm-trace.h"          // for pm_trace_rtc_valid
#include "linux/printk.h"            // for printk
#include "linux/rtc.h"               // for rtc_time64_to_tm, rtc_valid_tm
#include "linux/spinlock.h"          // for spin_unlock_irqrestore, spin_loc...
#include "linux/spinlock_types.h"    // for DEFINE_SPINLOCK
#include "linux/time.h"              // for mktime64
#include "linux/time64.h"            // for timespec64
---
  ./scripts/check-local-export arch/x86/kernel/rtc.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.resource.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/resource"' -DKBUILD_BASENAME='"resource"' -DKBUILD_MODNAME='"resource"' -D__KBUILD_MODNAME=kmod_resource -c -o arch/x86/kernel/resource.o arch/x86/kernel/resource.c  

arch/x86/kernel/resource.c should add these lines:
#include "asm-generic/int-ll64.h"  // for u64
#include "asm/e820/types.h"        // for e820_entry, e820_table, BIOS_ROM_BASE
#include "linux/types.h"           // for resource_size_t

arch/x86/kernel/resource.c should remove these lines:

The full include-list for arch/x86/kernel/resource.c:
#include <asm/e820/api.h>          // for e820_table
#include <asm/pci_x86.h>           // for pci_use_e820
#include <linux/ioport.h>          // for resource, IORESOURCE_MEM, arch_rem...
#include <linux/printk.h>          // for pr_info
#include "asm-generic/int-ll64.h"  // for u64
#include "asm/e820/types.h"        // for e820_entry, e820_table, BIOS_ROM_BASE
#include "linux/types.h"           // for resource_size_t
---
  ./scripts/check-local-export arch/x86/kernel/resource.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.irqflags.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -D__ASSEMBLY__ -fno-PIE --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -m32 -fno-lto    -c -o arch/x86/kernel/irqflags.o arch/x86/kernel/irqflags.S 
  ./scripts/check-local-export arch/x86/kernel/irqflags.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.static_call.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/static_call"' -DKBUILD_BASENAME='"static_call"' -DKBUILD_MODNAME='"static_call"' -D__KBUILD_MODNAME=kmod_static_call -c -o arch/x86/kernel/static_call.o arch/x86/kernel/static_call.c  
In file included from arch/x86/kernel/static_call.c:2:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/static_call.c:2:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/static_call.c:2:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/kernel/static_call.c:2:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/static_call.c:2:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/static_call.c:2:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

include/linux/static_call.h should add these lines:
#include <stddef.h>                   // for NULL
#include "asm-generic/rwonce.h"       // for READ_ONCE, WRITE_ONCE
#include "linux/compiler_types.h"     // for inline
#include "linux/export.h"             // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/stddef.h"             // for false

include/linux/static_call.h should remove these lines:

The full include-list for include/linux/static_call.h:
#include <asm/static_call.h>          // for ARCH_DEFINE_STATIC_CALL_NULL_TRAMP
#include <linux/cpu.h>                // for cpus_read_lock, cpus_read_unlock
#include <linux/static_call_types.h>  // for STATIC_CALL_KEY, static_call_key
#include <linux/types.h>              // for bool
#include <stddef.h>                   // for NULL
#include "asm-generic/rwonce.h"       // for READ_ONCE, WRITE_ONCE
#include "linux/compiler_types.h"     // for inline
#include "linux/export.h"             // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/stddef.h"             // for false
---

arch/x86/kernel/static_call.c should add these lines:
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include "asm-generic/int-ll64.h"  // for u8
#include "asm/bug.h"               // for BUG
#include "asm/cpufeature.h"        // for cpu_feature_enabled
#include "asm/cpufeatures.h"       // for X86_FEATURE_RETHUNK
#include "asm/nops.h"              // for x86_nops
#include "asm/nospec-branch.h"     // for __x86_return_thunk
#include "asm/string_32.h"         // for memcmp
#include "linux/init.h"            // for __ref
#include "linux/kconfig.h"         // for IS_ENABLED
#include "linux/kernel.h"          // for SYSTEM_BOOTING, system_state
#include "linux/mutex.h"           // for mutex_lock, mutex_unlock
#include "linux/printk.h"          // for pr_err
#include "linux/types.h"           // for bool

arch/x86/kernel/static_call.c should remove these lines:
- #include <linux/bug.h>  // lines 4-4

The full include-list for arch/x86/kernel/static_call.c:
#include <linux/static_call.h>
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/text-patching.h>     // for text_gen_insn, JMP32_INSN_OPCODE
#include <linux/memory.h>          // for text_mutex
#include "asm-generic/int-ll64.h"  // for u8
#include "asm/bug.h"               // for BUG
#include "asm/cpufeature.h"        // for cpu_feature_enabled
#include "asm/cpufeatures.h"       // for X86_FEATURE_RETHUNK
#include "asm/nops.h"              // for x86_nops
#include "asm/nospec-branch.h"     // for __x86_return_thunk
#include "asm/string_32.h"         // for memcmp
#include "linux/init.h"            // for __ref
#include "linux/kconfig.h"         // for IS_ENABLED
#include "linux/kernel.h"          // for SYSTEM_BOOTING, system_state
#include "linux/mutex.h"           // for mutex_lock, mutex_unlock
#include "linux/printk.h"          // for pr_err
#include "linux/types.h"           // for bool
---
  ./scripts/check-local-export arch/x86/kernel/static_call.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.process.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/process"' -DKBUILD_BASENAME='"process"' -DKBUILD_MODNAME='"process"' -D__KBUILD_MODNAME=kmod_process -c -o arch/x86/kernel/process.o arch/x86/kernel/process.c  
In file included from arch/x86/kernel/process.c:25:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
In file included from arch/x86/kernel/process.c:27:
In file included from ./include/trace/events/power.h:12:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
5 warnings generated.
In file included from arch/x86/kernel/process.c:25:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
In file included from arch/x86/kernel/process.c:27:
In file included from ./include/trace/events/power.h:12:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/process.h should add these lines:
#include "asm/nospec-branch.h"     // for switch_to_cond_stibp
#include "asm/thread_info.h"       // for _TIF_SPEC_IB, _TIF_WORK_CTXSW_NEXT
#include "linux/compiler.h"        // for unlikely
#include "linux/compiler_types.h"  // for inline
#include "linux/jump_label.h"      // for static_branch_likely
#include "linux/kconfig.h"         // for IS_ENABLED
#include "linux/thread_info.h"     // for read_task_thread_flags
struct task_struct;

arch/x86/kernel/process.h should remove these lines:
- #include <asm/spec-ctrl.h>  // lines 5-5

The full include-list for arch/x86/kernel/process.h:
#include "asm/nospec-branch.h"     // for switch_to_cond_stibp
#include "asm/thread_info.h"       // for _TIF_SPEC_IB, _TIF_WORK_CTXSW_NEXT
#include "linux/compiler.h"        // for unlikely
#include "linux/compiler_types.h"  // for inline
#include "linux/jump_label.h"      // for static_branch_likely
#include "linux/kconfig.h"         // for IS_ENABLED
#include "linux/thread_info.h"     // for read_task_thread_flags
struct task_struct;
---

arch/x86/kernel/process.c should add these lines:
#include <asm-generic/percpu.h>          // for DEFINE_PER_CPU, this_cpu_read
#include <asm/cpufeatures.h>             // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/percpu.h>                  // for this_cpu_read_8, this_cpu_wr...
#include <stddef.h>                      // for NULL
#include "asm-generic/bitsperlong.h"     // for BITS_PER_LONG
#include "asm-generic/errno-base.h"      // for EINVAL, ENODEV
#include "asm-generic/int-ll64.h"        // for u64, u32
#include "asm/barrier.h"                 // for mb
#include "asm/bug.h"                     // for BUG
#include "asm/cpufeature.h"              // for boot_cpu_has_bug, static_cpu...
#include "asm/cpufeatures.h"             // for X86_BUG_AMD_APIC_C1E, X86_BU...
#include "asm/current.h"                 // for current
#include "asm/fpu/types.h"               // for fpu
#include "asm/irqflags.h"                // for native_halt
#include "asm/msr-index.h"               // for MSR_IA32_DEBUGCTLMSR, DEBUGC...
#include "asm/msr.h"                     // for wrmsrl, rdmsr, rdmsrl
#include "asm/percpu.h"                  // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/pkru.h"                    // for pkru_write_default, read_pkru
#include "asm/processor-flags.h"         // for X86_CR4_TSD, X86_EFLAGS_FIXED
#include "asm/processor.h"               // for thread_struct, cpuid_eax
#include "asm/ptrace.h"                  // for pt_regs, do_set_thread_area
#include "asm/segment.h"                 // for __KERNEL_CS, __KERNEL_DS
#include "asm/special_insns.h"           // for __write_cr4, clflush, native...
#include "asm/string_32.h"               // for strcmp, memset, memcpy
#include "asm/tsc.h"                     // for mark_tsc_unstable, tsc_verif...
#include "asm/uaccess.h"                 // for put_user
#include "linux/compiler_attributes.h"   // for __always_inline, __noreturn
#include "linux/container_of.h"          // for container_of
#include "linux/cpu.h"                   // for cpu_idle_poll_ctrl, __cpuidle
#include "linux/cpumask.h"               // for set_cpu_online
#include "linux/irqflags.h"              // for raw_local_irq_enable, local_...
#include "linux/lockdep.h"               // for lockdep_assert_irqs_disabled
#include "linux/mm_types.h"              // for mm_struct, mm_struct::(anony...
#include "linux/personality.h"           // for ADDR_NO_RANDOMIZE
#include "linux/preempt.h"               // for preempt_disable, preempt_enable
#include "linux/printk.h"                // for pr_info
#include "linux/ptrace.h"                // for current_pt_regs
#include "linux/sched.h"                 // for task_struct (ptr only), CLON...
#include "linux/stddef.h"                // for false, true
#include "linux/types.h"                 // for bool
#include "vdso/bits.h"                   // for BIT

arch/x86/kernel/process.c should remove these lines:
- #include <asm/cpu.h>  // lines 29-29
- #include <asm/debugreg.h>  // lines 36-36
- #include <asm/desc.h>  // lines 42-42
- #include <asm/fpu/xstate.h>  // lines 35-35
- #include <linux/acpi.h>  // lines 25-25
- #include <linux/cpuidle.h>  // lines 24-24
- #include <linux/dmi.h>  // lines 21-21
- #include <linux/errno.h>  // lines 4-4
- #include <linux/kernel.h>  // lines 5-5
- #include <linux/pm.h>  // lines 17-17
- #include <linux/slab.h>  // lines 9-9
- #include <linux/stackprotector.h>  // lines 23-23
- #include <linux/uaccess.h>  // lines 31-31
- #include <linux/utsname.h>  // lines 22-22
- #include <trace/events/power.h>  // lines 27-27

The full include-list for arch/x86/kernel/process.c:
#include "process.h"
#include <asm-generic/percpu.h>          // for DEFINE_PER_CPU, this_cpu_read
#include <asm/apic.h>                    // for disable_local_APIC
#include <asm/cpufeatures.h>             // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/fpu/api.h>                 // for fpu_xstate_prctl
#include <asm/fpu/sched.h>               // for fpu__drop, fpu_clone, fpu_fl...
#include <asm/frame.h>                   // for encode_frame_pointer
#include <asm/io_bitmap.h>               // for io_bitmap_exit, io_bitmap_share
#include <asm/mce.h>                     // for mcheck_cpu_clear
#include <asm/mwait.h>                   // for __monitor, __sti_mwait
#include <asm/nmi.h>                     // for local_touch_nmi
#include <asm/percpu.h>                  // for this_cpu_read_8, this_cpu_wr...
#include <asm/prctl.h>                   // for ARCH_GET_CPUID, ARCH_GET_XCO...
#include <asm/proto.h>                   // for do_arch_prctl_common
#include <asm/spec-ctrl.h>               // for ssbd_tif_to_spec_ctrl, ssbd_...
#include <asm/switch_to.h>               // for kthread_frame_init, inactive...
#include <asm/tdx.h>                     // for tdx_safe_halt
#include <asm/tlbflush.h>                // for cpu_tlbstate, tlb_state, cr4...
#include <asm/unwind.h>                  // for unwind_done, unwind_get_retu...
#include <asm/vm86.h>                    // for free_vm86
#include <linux/elf-randomize.h>         // for arch_randomize_brk
#include <linux/export.h>                // for EXPORT_SYMBOL
#include <linux/hw_breakpoint.h>         // for flush_ptrace_hw_breakpoint
#include <linux/init.h>                  // for __init, early_param
#include <linux/mm.h>                    // for randomize_page, randomize_va...
#include <linux/prctl.h>                 // for PR_TSC_ENABLE, PR_TSC_SIGSEGV
#include <linux/random.h>                // for get_random_int
#include <linux/sched.h>                 // for task_struct, clear_tsk_threa...
#include <linux/sched/debug.h>           // for in_sched_functions
#include <linux/sched/idle.h>            // for __current_clr_polling, curre...
#include <linux/sched/task.h>            // for kernel_clone_args, arch_task...
#include <linux/sched/task_stack.h>      // for put_task_stack, try_get_task...
#include <linux/smp.h>                   // for smp_processor_id
#include <linux/tick.h>                  // for tick_broadcast_enter, tick_b...
#include <linux/user-return-notifier.h>  // for propagate_user_return_notify
#include <stddef.h>                      // for NULL
#include "asm-generic/bitsperlong.h"     // for BITS_PER_LONG
#include "asm-generic/errno-base.h"      // for EINVAL, ENODEV
#include "asm-generic/int-ll64.h"        // for u64, u32
#include "asm/barrier.h"                 // for mb
#include "asm/bug.h"                     // for BUG
#include "asm/cpufeature.h"              // for boot_cpu_has_bug, static_cpu...
#include "asm/cpufeatures.h"             // for X86_BUG_AMD_APIC_C1E, X86_BU...
#include "asm/current.h"                 // for current
#include "asm/fpu/types.h"               // for fpu
#include "asm/irqflags.h"                // for native_halt
#include "asm/msr-index.h"               // for MSR_IA32_DEBUGCTLMSR, DEBUGC...
#include "asm/msr.h"                     // for wrmsrl, rdmsr, rdmsrl
#include "asm/percpu.h"                  // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/pkru.h"                    // for pkru_write_default, read_pkru
#include "asm/processor-flags.h"         // for X86_CR4_TSD, X86_EFLAGS_FIXED
#include "asm/processor.h"               // for thread_struct, cpuid_eax
#include "asm/ptrace.h"                  // for pt_regs, do_set_thread_area
#include "asm/segment.h"                 // for __KERNEL_CS, __KERNEL_DS
#include "asm/special_insns.h"           // for __write_cr4, clflush, native...
#include "asm/string_32.h"               // for strcmp, memset, memcpy
#include "asm/tsc.h"                     // for mark_tsc_unstable, tsc_verif...
#include "asm/uaccess.h"                 // for put_user
#include "linux/compiler_attributes.h"   // for __always_inline, __noreturn
#include "linux/container_of.h"          // for container_of
#include "linux/cpu.h"                   // for cpu_idle_poll_ctrl, __cpuidle
#include "linux/cpumask.h"               // for set_cpu_online
#include "linux/irqflags.h"              // for raw_local_irq_enable, local_...
#include "linux/lockdep.h"               // for lockdep_assert_irqs_disabled
#include "linux/mm_types.h"              // for mm_struct, mm_struct::(anony...
#include "linux/personality.h"           // for ADDR_NO_RANDOMIZE
#include "linux/preempt.h"               // for preempt_disable, preempt_enable
#include "linux/printk.h"                // for pr_info
#include "linux/ptrace.h"                // for current_pt_regs
#include "linux/sched.h"                 // for task_struct (ptr only), CLON...
#include "linux/stddef.h"                // for false, true
#include "linux/types.h"                 // for bool
#include "vdso/bits.h"                   // for BIT
---
  ./scripts/check-local-export arch/x86/kernel/process.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.ptrace.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/ptrace"' -DKBUILD_BASENAME='"ptrace"' -DKBUILD_MODNAME='"ptrace"' -D__KBUILD_MODNAME=kmod_ptrace -c -o arch/x86/kernel/ptrace.o arch/x86/kernel/ptrace.c  
In file included from arch/x86/kernel/ptrace.c:22:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/ptrace.c:22:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/ptrace.c:22:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/ptrace.c:22:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/kernel/ptrace.c:22:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/ptrace.c:22:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/ptrace.c:22:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/ptrace.c:22:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/ptrace.c should add these lines:
#include <asm/bug.h>                    // for WARN_ON, WARN_ON_ONCE
#include <asm/signal.h>                 // for SIGTRAP
#include <linux/build_bug.h>            // for unlikely
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EIO, EINVAL, ENXIO
#include "asm-generic/int-ll64.h"       // for u32, u64, u16
#include "asm-generic/siginfo.h"        // for TRAP_BRKPT
#include "asm/current.h"                // for current
#include "asm/debugreg.h"               // for DR6_RESERVED, DR_CONTROL_RESE...
#include "asm/fpu/types.h"              // for fxregs_state
#include "asm/processor-flags.h"        // for X86_EFLAGS_TF, X86_EFLAGS_AC
#include "asm/ptrace-abi.h"             // for PTRACE_GETFPREGS, PTRACE_GETF...
#include "asm/ptrace.h"                 // for pt_regs, do_get_thread_area
#include "asm/segment.h"                // for GDT_ENTRY_TLS_ENTRIES, GDT_EN...
#include "asm/string_32.h"              // for strcmp
#include "asm/thread_info.h"            // for TIF_FORCED_TF
#include "asm/trapnr.h"                 // for X86_TRAP_DB
#include "asm/uaccess.h"                // for __get_user, put_user
#include "asm/user.h"                   // for USER_XSTATE_FX_SW_WORDS, USER...
#include "asm/user_32.h"                // for user_regs_struct, user, user_...
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for __user, inline
#include "linux/elf-em.h"               // for EM_386
#include "linux/elf.h"                  // for NT_386_IOPERM, NT_386_TLS
#include "linux/err.h"                  // for IS_ERR, PTR_ERR, ERR_PTR
#include "linux/init.h"                 // for __init
#include "linux/math.h"                 // for DIV_ROUND_UP
#include "linux/perf_event.h"           // for perf_event (ptr only), perf_e...
#include "linux/ptrace.h"               // for PTRACE_PEEKUSR, PTRACE_POKEUSR
#include "linux/regset.h"               // for copy_regset_from_user, copy_r...
#include "linux/sched/signal.h"         // for force_sig_fault
#include "linux/stddef.h"               // for offsetof, true, false
#include "linux/types.h"                // for bool

arch/x86/kernel/ptrace.c should remove these lines:
- #include <asm/debugreg.h>  // lines 34-34
- #include <asm/desc.h>  // lines 36-36
- #include <asm/fsgsbase.h>  // lines 42-42
- #include <asm/prctl.h>  // lines 37-37
- #include <asm/proto.h>  // lines 38-38
- #include <asm/syscall.h>  // lines 41-41
- #include <asm/traps.h>  // lines 40-40
- #include <linux/audit.h>  // lines 19-19
- #include <linux/context_tracking.h>  // lines 26-26
- #include <linux/elf.h>  // lines 17-17
- #include <linux/errno.h>  // lines 13-13
- #include <linux/export.h>  // lines 25-25
- #include <linux/mm.h>  // lines 11-11
- #include <linux/rcupdate.h>  // lines 24-24
- #include <linux/sched/task_stack.h>  // lines 10-10
- #include <linux/seccomp.h>  // lines 20-20
- #include <linux/security.h>  // lines 18-18
- #include <linux/signal.h>  // lines 21-21
- #include <linux/slab.h>  // lines 14-14
- #include <linux/smp.h>  // lines 12-12
- #include <linux/uaccess.h>  // lines 29-29
- #include <linux/user.h>  // lines 16-16

The full include-list for arch/x86/kernel/ptrace.c:
#include <asm/bug.h>                    // for WARN_ON, WARN_ON_ONCE
#include <asm/fpu/regset.h>             // for fpregs_get, fpregs_set, regse...
#include <asm/fpu/signal.h>             // for user_i387_ia32_struct
#include <asm/fpu/xstate.h>             // for update_regset_xstate_info
#include <asm/hw_breakpoint.h>          // for HBP_NUM, arch_bp_generic_fields
#include <asm/io_bitmap.h>              // for io_bitmap
#include <asm/ldt.h>                    // for user_desc
#include <asm/processor.h>              // for thread_struct, task_pt_regs
#include <asm/signal.h>                 // for SIGTRAP
#include <linux/build_bug.h>            // for unlikely
#include <linux/hw_breakpoint.h>        // for modify_user_hw_breakpoint
#include <linux/kernel.h>               // for ARRAY_SIZE
#include <linux/nospec.h>               // for array_index_nospec
#include <linux/perf_event.h>           // for perf_event, hw_perf_event
#include <linux/ptrace.h>               // for ptrace_request, user_disable_...
#include <linux/sched.h>                // for task_struct, test_tsk_thread_...
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EIO, EINVAL, ENXIO
#include "asm-generic/int-ll64.h"       // for u32, u64, u16
#include "asm-generic/siginfo.h"        // for TRAP_BRKPT
#include "asm/current.h"                // for current
#include "asm/debugreg.h"               // for DR6_RESERVED, DR_CONTROL_RESE...
#include "asm/fpu/types.h"              // for fxregs_state
#include "asm/processor-flags.h"        // for X86_EFLAGS_TF, X86_EFLAGS_AC
#include "asm/ptrace-abi.h"             // for PTRACE_GETFPREGS, PTRACE_GETF...
#include "asm/ptrace.h"                 // for pt_regs, do_get_thread_area
#include "asm/segment.h"                // for GDT_ENTRY_TLS_ENTRIES, GDT_EN...
#include "asm/string_32.h"              // for strcmp
#include "asm/thread_info.h"            // for TIF_FORCED_TF
#include "asm/trapnr.h"                 // for X86_TRAP_DB
#include "asm/uaccess.h"                // for __get_user, put_user
#include "asm/user.h"                   // for USER_XSTATE_FX_SW_WORDS, USER...
#include "asm/user_32.h"                // for user_regs_struct, user, user_...
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for __user, inline
#include "linux/elf-em.h"               // for EM_386
#include "linux/elf.h"                  // for NT_386_IOPERM, NT_386_TLS
#include "linux/err.h"                  // for IS_ERR, PTR_ERR, ERR_PTR
#include "linux/init.h"                 // for __init
#include "linux/math.h"                 // for DIV_ROUND_UP
#include "linux/perf_event.h"           // for perf_event (ptr only), perf_e...
#include "linux/ptrace.h"               // for PTRACE_PEEKUSR, PTRACE_POKEUSR
#include "linux/regset.h"               // for copy_regset_from_user, copy_r...
#include "linux/sched/signal.h"         // for force_sig_fault
#include "linux/stddef.h"               // for offsetof, true, false
#include "linux/types.h"                // for bool
#include "tls.h"                        // for regset_tls_active, regset_tls...
---
  ./scripts/check-local-export arch/x86/kernel/ptrace.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.tls.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/tls"' -DKBUILD_BASENAME='"tls"' -DKBUILD_MODNAME='"tls"' -D__KBUILD_MODNAME=kmod_tls -c -o arch/x86/kernel/tls.o arch/x86/kernel/tls.c  
In file included from arch/x86/kernel/tls.c:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/tls.c:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/tls.c:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/tls.c:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/kernel/tls.c:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/tls.c:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/tls.c:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/tls.c:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

(arch/x86/kernel/tls.h has correct #includes/fwd-decls)

arch/x86/kernel/tls.c should add these lines:
#include "asm-generic/errno-base.h"     // for EFAULT, EINVAL, ESRCH
#include "asm/current.h"                // for current
#include "asm/desc_defs.h"              // for desc_struct
#include "asm/ptrace.h"                 // for pt_regs, do_get_thread_area
#include "asm/segment.h"                // for GDT_ENTRY_TLS_MIN, GDT_ENTRY_...
#include "asm/special_insns.h"          // for load_gs_index
#include "asm/string_32.h"              // for memset
#include "asm/uaccess.h"                // for get_user, put_user
#include "linux/compiler_attributes.h"  // for __maybe_unused
#include "linux/compiler_types.h"       // for __user
#include "linux/smp.h"                  // for get_cpu, put_cpu
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool

arch/x86/kernel/tls.c should remove these lines:
- #include <asm/proto.h>  // lines 14-14
- #include <linux/errno.h>  // lines 3-3
- #include <linux/kernel.h>  // lines 2-2
- #include <linux/user.h>  // lines 5-5

The full include-list for arch/x86/kernel/tls.c:
#include "tls.h"
#include <asm/desc.h>                   // for LDT_zero, desc_empty, fill_ldt
#include <asm/ldt.h>                    // for user_desc
#include <asm/processor.h>              // for thread_struct
#include <linux/nospec.h>               // for array_index_nospec
#include <linux/regset.h>               // for membuf_write, membuf
#include <linux/sched.h>                // for task_struct
#include <linux/syscalls.h>             // for __MAP1, SYSCALL_DEFINE1
#include <linux/uaccess.h>              // for __copy_from_user, copy_from_user
#include "asm-generic/errno-base.h"     // for EFAULT, EINVAL, ESRCH
#include "asm/current.h"                // for current
#include "asm/desc_defs.h"              // for desc_struct
#include "asm/ptrace.h"                 // for pt_regs, do_get_thread_area
#include "asm/segment.h"                // for GDT_ENTRY_TLS_MIN, GDT_ENTRY_...
#include "asm/special_insns.h"          // for load_gs_index
#include "asm/string_32.h"              // for memset
#include "asm/uaccess.h"                // for get_user, put_user
#include "linux/compiler_attributes.h"  // for __maybe_unused
#include "linux/compiler_types.h"       // for __user
#include "linux/smp.h"                  // for get_cpu, put_cpu
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool
---
  ./scripts/check-local-export arch/x86/kernel/tls.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.step.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/step"' -DKBUILD_BASENAME='"step"' -DKBUILD_MODNAME='"step"' -D__KBUILD_MODNAME=kmod_step -c -o arch/x86/kernel/step.o arch/x86/kernel/step.c  
In file included from arch/x86/kernel/step.c:10:
In file included from ./arch/x86/include/asm/mmu_context.h:10:
In file included from ./include/trace/events/tlb.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/step.c:10:
In file included from ./arch/x86/include/asm/mmu_context.h:10:
In file included from ./include/trace/events/tlb.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/step.c:10:
In file included from ./arch/x86/include/asm/mmu_context.h:10:
In file included from ./include/trace/events/tlb.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/kernel/step.c:10:
In file included from ./arch/x86/include/asm/mmu_context.h:10:
In file included from ./include/trace/events/tlb.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/step.c:10:
In file included from ./arch/x86/include/asm/mmu_context.h:10:
In file included from ./include/trace/events/tlb.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/step.c:10:
In file included from ./arch/x86/include/asm/mmu_context.h:10:
In file included from ./include/trace/events/tlb.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/kernel/step.c should add these lines:
#include "asm/current.h"          // for current
#include "asm/msr-index.h"        // for DEBUGCTLMSR_BTF
#include "asm/processor-flags.h"  // for X86_EFLAGS_TF
#include "asm/processor.h"        // for get_debugctlmsr, update_debugctlmsr
#include "asm/ptrace.h"           // for pt_regs, v8086_mode, convert_ip_to_...
#include "asm/thread_info.h"      // for TIF_BLOCKSTEP, TIF_FORCED_TF, TIF_S...
#include "linux/compiler.h"       // for unlikely
#include "linux/irqflags.h"       // for local_irq_disable, local_irq_enable
#include "linux/stddef.h"         // for false, true
#include "linux/thread_info.h"    // for SYSCALL_WORK_BIT_SYSCALL_EXIT_TRAP
#include "linux/types.h"          // for bool

arch/x86/kernel/step.c should remove these lines:
- #include <asm/desc.h>  // lines 9-9
- #include <asm/mmu_context.h>  // lines 10-10
- #include <linux/sched/task_stack.h>  // lines 6-6

The full include-list for arch/x86/kernel/step.c:
#include <linux/mm.h>             // for access_process_vm, FOLL_FORCE
#include <linux/ptrace.h>         // for user_disable_single_step, user_enab...
#include <linux/sched.h>          // for test_tsk_thread_flag, clear_tsk_thr...
#include "asm/current.h"          // for current
#include "asm/msr-index.h"        // for DEBUGCTLMSR_BTF
#include "asm/processor-flags.h"  // for X86_EFLAGS_TF
#include "asm/processor.h"        // for get_debugctlmsr, update_debugctlmsr
#include "asm/ptrace.h"           // for pt_regs, v8086_mode, convert_ip_to_...
#include "asm/thread_info.h"      // for TIF_BLOCKSTEP, TIF_FORCED_TF, TIF_S...
#include "linux/compiler.h"       // for unlikely
#include "linux/irqflags.h"       // for local_irq_disable, local_irq_enable
#include "linux/stddef.h"         // for false, true
#include "linux/thread_info.h"    // for SYSCALL_WORK_BIT_SYSCALL_EXIT_TRAP
#include "linux/types.h"          // for bool
---
  ./scripts/check-local-export arch/x86/kernel/step.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.i8237.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/i8237"' -DKBUILD_BASENAME='"i8237"' -DKBUILD_MODNAME='"i8237"' -D__KBUILD_MODNAME=kmod_i8237 -c -o arch/x86/kernel/i8237.o arch/x86/kernel/i8237.c  

arch/x86/kernel/i8237.c should add these lines:
#include "asm-generic/errno-base.h"  // for ENODEV

arch/x86/kernel/i8237.c should remove these lines:

The full include-list for arch/x86/kernel/i8237.c:
#include <asm/dma.h>                 // for claim_dma_lock, enable_dma, rele...
#include <asm/x86_init.h>            // for x86_pnpbios_disabled
#include <linux/dmi.h>               // for dmi_get_bios_year
#include <linux/init.h>              // for __init, device_initcall
#include <linux/syscore_ops.h>       // for register_syscore_ops, syscore_ops
#include "asm-generic/errno-base.h"  // for ENODEV
---
  ./scripts/check-local-export arch/x86/kernel/i8237.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.stacktrace.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/stacktrace"' -DKBUILD_BASENAME='"stacktrace"' -DKBUILD_MODNAME='"stacktrace"' -D__KBUILD_MODNAME=kmod_stacktrace -c -o arch/x86/kernel/stacktrace.o arch/x86/kernel/stacktrace.c  

arch/x86/kernel/stacktrace.c should add these lines:
#include <asm/uaccess.h>             // for __access_ok
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm/ptrace.h"              // for pt_regs, user_mode
#include "asm/uaccess.h"             // for __get_user
#include "linux/compiler_types.h"    // for __user
#include "linux/kconfig.h"           // for IS_ENABLED
struct task_struct;

arch/x86/kernel/stacktrace.c should remove these lines:
- #include <asm/stacktrace.h>  // lines 12-12
- #include <linux/export.h>  // lines 10-10
- #include <linux/sched.h>  // lines 6-6
- #include <linux/sched/debug.h>  // lines 7-7
- #include <linux/sched/task_stack.h>  // lines 8-8

The full include-list for arch/x86/kernel/stacktrace.c:
#include <asm/uaccess.h>             // for __access_ok
#include <asm/unwind.h>              // for unwind_done, unwind_error, unwin...
#include <linux/stacktrace.h>        // for stack_trace_consume_fn, arch_sta...
#include <linux/uaccess.h>           // for pagefault_disable, pagefault_enable
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm/ptrace.h"              // for pt_regs, user_mode
#include "asm/uaccess.h"             // for __get_user
#include "linux/compiler_types.h"    // for __user
#include "linux/kconfig.h"           // for IS_ENABLED
struct task_struct;
---
  ./scripts/check-local-export arch/x86/kernel/stacktrace.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.reboot.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/reboot"' -DKBUILD_BASENAME='"reboot"' -DKBUILD_MODNAME='"reboot"' -D__KBUILD_MODNAME=kmod_reboot -c -o arch/x86/kernel/reboot.o arch/x86/kernel/reboot.c  
In file included from arch/x86/kernel/reboot.c:8:
In file included from ./include/linux/efi.h:20:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/reboot.c:8:
In file included from ./include/linux/efi.h:20:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/reboot.c:8:
In file included from ./include/linux/efi.h:20:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/reboot.c:8:
In file included from ./include/linux/efi.h:20:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
In file included from arch/x86/kernel/reboot.c:34:
In file included from ./arch/x86/include/asm/efi.h:7:
In file included from ./arch/x86/include/asm/tlb.h:8:
In file included from ./include/asm-generic/tlb.h:15:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
5 warnings generated.
In file included from arch/x86/kernel/reboot.c:8:
In file included from ./include/linux/efi.h:20:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/reboot.c:8:
In file included from ./include/linux/efi.h:20:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/reboot.c:8:
In file included from ./include/linux/efi.h:20:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/reboot.c:8:
In file included from ./include/linux/efi.h:20:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
In file included from arch/x86/kernel/reboot.c:34:
In file included from ./arch/x86/include/asm/efi.h:7:
In file included from ./arch/x86/include/asm/tlb.h:8:
In file included from ./include/asm-generic/tlb.h:15:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/reboot.c should add these lines:
#include <stddef.h>                     // for NULL
#include "asm-generic/delay.h"          // for udelay
#include "asm-generic/int-ll64.h"       // for u8
#include "asm/emergency-restart.h"      // for machine_emergency_restart
#include "asm/mc146818rtc.h"            // for CMOS_WRITE
#include "asm/page.h"                   // for __va
#include "asm/processor.h"              // for stop_this_cpu
#include "asm/shared/io.h"              // for outb, inb
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler.h"             // for unreachable
#include "linux/compiler_attributes.h"  // for __noreturn, fallthrough
#include "linux/compiler_types.h"       // for inline
#include "linux/irqflags.h"             // for local_irq_disable
#include "linux/mod_devicetable.h"      // for DMI_PRODUCT_NAME, DMI_SYS_VENDOR
#include "linux/printk.h"               // for pr_info, pr_notice
#include "linux/spinlock.h"             // for spin_lock, spin_unlock
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool
struct pt_regs;

arch/x86/kernel/reboot.c should remove these lines:
- #include <asm/cpu.h>  // lines 26-26
- #include <asm/hpet.h>  // lines 20-20
- #include <asm/io.h>  // lines 16-16
- #include <asm/nmi.h>  // lines 27-27
- #include <asm/pci_x86.h>  // lines 24-24
- #include <asm/proto.h>  // lines 21-21
- #include <asm/smp.h>  // lines 28-28
- #include <asm/x86_init.h>  // lines 33-33
- #include <linux/ctype.h>  // lines 30-30
- #include <linux/delay.h>  // lines 12-12
- #include <linux/pgtable.h>  // lines 14-14
- #include <linux/pm.h>  // lines 7-7
- #include <linux/sched.h>  // lines 10-10

The full include-list for arch/x86/kernel/reboot.c:
#include <acpi/reboot.h>                // for acpi_reboot
#include <asm/apic.h>                   // for lapic_shutdown
#include <asm/desc.h>                   // for idt_invalidate
#include <asm/efi.h>                    // for efi_reboot_required
#include <asm/io_apic.h>                // for restore_boot_irq_mode
#include <asm/realmode.h>               // for load_trampoline_pgtable, real...
#include <asm/reboot.h>                 // for machine_ops, MRR_BIOS, machin...
#include <asm/reboot_fixups.h>          // for mach_reboot_fixups
#include <asm/virtext.h>                // for __cpu_emergency_vmxoff, cpu_e...
#include <linux/dmi.h>                  // for dmi_check_system
#include <linux/efi.h>                  // for efi_runtime_disabled, efi_cap...
#include <linux/export.h>               // for EXPORT_SYMBOL
#include <linux/init.h>                 // for __init, __initconst, core_ini...
#include <linux/mc146818rtc.h>          // for rtc_lock
#include <linux/objtool.h>              // for STACK_FRAME_NON_STANDARD
#include <linux/reboot.h>               // for reboot_type, BOOT_EFI, BOOT_ACPI
#include <linux/tboot.h>                // for tboot_shutdown
#include <stddef.h>                     // for NULL
#include "asm-generic/delay.h"          // for udelay
#include "asm-generic/int-ll64.h"       // for u8
#include "asm/emergency-restart.h"      // for machine_emergency_restart
#include "asm/mc146818rtc.h"            // for CMOS_WRITE
#include "asm/page.h"                   // for __va
#include "asm/processor.h"              // for stop_this_cpu
#include "asm/shared/io.h"              // for outb, inb
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler.h"             // for unreachable
#include "linux/compiler_attributes.h"  // for __noreturn, fallthrough
#include "linux/compiler_types.h"       // for inline
#include "linux/irqflags.h"             // for local_irq_disable
#include "linux/mod_devicetable.h"      // for DMI_PRODUCT_NAME, DMI_SYS_VENDOR
#include "linux/printk.h"               // for pr_info, pr_notice
#include "linux/spinlock.h"             // for spin_lock, spin_unlock
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool
struct pt_regs;
---
  ./scripts/check-local-export arch/x86/kernel/reboot.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.tsc_sync.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/tsc_sync"' -DKBUILD_BASENAME='"tsc_sync"' -DKBUILD_MODNAME='"tsc_sync"' -D__KBUILD_MODNAME=kmod_tsc_sync -c -o arch/x86/kernel/tsc_sync.o arch/x86/kernel/tsc_sync.c  

arch/x86/kernel/tsc_sync.c should add these lines:
#include <asm-generic/percpu.h>    // for this_cpu_ptr, DEFINE_PER_CPU
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include "asm-generic/int-ll64.h"  // for s64
#include "asm-generic/param.h"     // for HZ
#include "asm/cache.h"             // for __read_mostly
#include "asm/cpufeature.h"        // for boot_cpu_has, cpu_feature_enabled
#include "asm/cpufeatures.h"       // for X86_FEATURE_TSC_ADJUST
#include "asm/msr-index.h"         // for MSR_IA32_TSC_ADJUST
#include "asm/msr.h"               // for wrmsrl, rdmsrl
#include "linux/compiler.h"        // for likely
#include "linux/cpumask.h"         // for cpumask_first, cpumask_next, cpu_o...
#include "linux/init.h"            // for __init, late_initcall
#include "linux/jiffies.h"         // for jiffies, time_before
#include "linux/printk.h"          // for FW_BUG, pr_info, pr_warn
#include "linux/stddef.h"          // for false, true
#include "linux/timer.h"           // for add_timer, add_timer_on, timer_list
#include "linux/types.h"           // for bool

arch/x86/kernel/tsc_sync.c should remove these lines:
- #include <linux/kernel.h>  // lines 20-20
- #include <linux/nmi.h>  // lines 22-22
- #include <linux/spinlock.h>  // lines 19-19
- #include <linux/topology.h>  // lines 18-18

The full include-list for arch/x86/kernel/tsc_sync.c:
#include <asm-generic/percpu.h>    // for this_cpu_ptr, DEFINE_PER_CPU
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/tsc.h>               // for check_tsc_unstable, mark_tsc_async...
#include <linux/smp.h>             // for smp_processor_id, raw_smp_processo...
#include "asm-generic/int-ll64.h"  // for s64
#include "asm-generic/param.h"     // for HZ
#include "asm/cache.h"             // for __read_mostly
#include "asm/cpufeature.h"        // for boot_cpu_has, cpu_feature_enabled
#include "asm/cpufeatures.h"       // for X86_FEATURE_TSC_ADJUST
#include "asm/msr-index.h"         // for MSR_IA32_TSC_ADJUST
#include "asm/msr.h"               // for wrmsrl, rdmsrl
#include "linux/compiler.h"        // for likely
#include "linux/cpumask.h"         // for cpumask_first, cpumask_next, cpu_o...
#include "linux/init.h"            // for __init, late_initcall
#include "linux/jiffies.h"         // for jiffies, time_before
#include "linux/printk.h"          // for FW_BUG, pr_info, pr_warn
#include "linux/stddef.h"          // for false, true
#include "linux/timer.h"           // for add_timer, add_timer_on, timer_list
#include "linux/types.h"           // for bool
---
  ./scripts/check-local-export arch/x86/kernel/tsc_sync.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.trace_clock.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/trace_clock"' -DKBUILD_BASENAME='"trace_clock"' -DKBUILD_MODNAME='"trace_clock"' -D__KBUILD_MODNAME=kmod_trace_clock -c -o arch/x86/kernel/trace_clock.o arch/x86/kernel/trace_clock.c  

arch/x86/include/asm/trace_clock.h should add these lines:
#include "asm-generic/int-ll64.h"  // for u64
#include "linux/compiler_types.h"  // for notrace

arch/x86/include/asm/trace_clock.h should remove these lines:
- #include <linux/compiler.h>  // lines 5-5
- #include <linux/types.h>  // lines 6-6

The full include-list for arch/x86/include/asm/trace_clock.h:
#include "asm-generic/int-ll64.h"  // for u64
#include "linux/compiler_types.h"  // for notrace
---

arch/x86/kernel/trace_clock.c should add these lines:
#include "asm/linkage.h"  // for notrace

arch/x86/kernel/trace_clock.c should remove these lines:
- #include <asm/barrier.h>  // lines 6-6

The full include-list for arch/x86/kernel/trace_clock.c:
#include <asm/trace_clock.h>
#include <asm/msr.h>      // for rdtsc_ordered
#include "asm/linkage.h"  // for notrace
---
  ./scripts/check-local-export arch/x86/kernel/trace_clock.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.doublefault_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/doublefault_32"' -DKBUILD_BASENAME='"doublefault_32"' -DKBUILD_MODNAME='"doublefault_32"' -D__KBUILD_MODNAME=kmod_doublefault_32 -c -o arch/x86/kernel/doublefault_32.o arch/x86/kernel/doublefault_32.c  
In file included from arch/x86/kernel/doublefault_32.c:5:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/doublefault_32.c:5:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/doublefault_32.c:5:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/doublefault_32.c:5:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from arch/x86/kernel/doublefault_32.c:11:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
5 warnings generated.
In file included from arch/x86/kernel/doublefault_32.c:5:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/doublefault_32.c:5:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/doublefault_32.c:5:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/doublefault_32.c:5:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from arch/x86/kernel/doublefault_32.c:11:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/doublefault_32.c should add these lines:
#include <asm-generic/percpu.h>         // for this_cpu_read, DEFINE_PER_CPU...
#include <asm/percpu.h>                 // for this_cpu_read_8, this_cpu_wri...
#include <asm/pgtable.h>                // for swapper_pg_dir
#include <linux/linkage.h>              // for asmlinkage
#include "asm/cpu_entry_area.h"         // for doublefault_stack, cpu_entry_...
#include "asm/idtentry.h"               // for asm_exc_double_fault, exc_dou...
#include "asm/page.h"                   // for __pa_nodebug
#include "asm/page_types.h"             // for PAGE_OFFSET, PAGE_SIZE
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/pgtable_32_areas.h"       // for MAXMEM
#include "asm/processor-flags.h"        // for X86_EFLAGS_FIXED
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/segment.h"                // for __USER_DS, GDT_ENTRY_DOUBLEFA...
#include "asm/special_insns.h"          // for native_read_cr2
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/compiler_attributes.h"  // for __noreturn
#include "linux/compiler_types.h"       // for noinstr
#include "linux/irqflags.h"             // for trace_hardirqs_off
#include "linux/panic.h"                // for panic
#include "linux/smp.h"                  // for smp_processor_id

arch/x86/kernel/doublefault_32.c should remove these lines:
- #include <asm/traps.h>  // lines 11-11
- #include <linux/fs.h>  // lines 6-6
- #include <linux/init_task.h>  // lines 5-5
- #include <linux/mm.h>  // lines 2-2
- #include <linux/sched.h>  // lines 3-3
- #include <linux/sched/debug.h>  // lines 4-4
- #include <linux/uaccess.h>  // lines 8-8

The full include-list for arch/x86/kernel/doublefault_32.c:
#include <asm-generic/percpu.h>         // for this_cpu_read, DEFINE_PER_CPU...
#include <asm/desc.h>                   // for __set_tss_desc, force_reload_TR
#include <asm/percpu.h>                 // for this_cpu_read_8, this_cpu_wri...
#include <asm/pgtable.h>                // for swapper_pg_dir
#include <asm/processor.h>              // for x86_hw_tss, cpu_tss_rw, tss_s...
#include <linux/linkage.h>              // for asmlinkage
#include "asm/cpu_entry_area.h"         // for doublefault_stack, cpu_entry_...
#include "asm/idtentry.h"               // for asm_exc_double_fault, exc_dou...
#include "asm/page.h"                   // for __pa_nodebug
#include "asm/page_types.h"             // for PAGE_OFFSET, PAGE_SIZE
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/pgtable_32_areas.h"       // for MAXMEM
#include "asm/processor-flags.h"        // for X86_EFLAGS_FIXED
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/segment.h"                // for __USER_DS, GDT_ENTRY_DOUBLEFA...
#include "asm/special_insns.h"          // for native_read_cr2
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/compiler_attributes.h"  // for __noreturn
#include "linux/compiler_types.h"       // for noinstr
#include "linux/irqflags.h"             // for trace_hardirqs_off
#include "linux/panic.h"                // for panic
#include "linux/smp.h"                  // for smp_processor_id
---
  ./scripts/check-local-export arch/x86/kernel/doublefault_32.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.perf_regs.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/perf_regs"' -DKBUILD_BASENAME='"perf_regs"' -DKBUILD_MODNAME='"perf_regs"' -D__KBUILD_MODNAME=kmod_perf_regs -c -o arch/x86/kernel/perf_regs.o arch/x86/kernel/perf_regs.c  
In file included from arch/x86/kernel/perf_regs.c:6:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/perf_regs.c:6:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/perf_regs.c:6:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/perf_regs.c:6:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/kernel/perf_regs.c:6:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/kernel/perf_regs.c:6:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/kernel/perf_regs.c:6:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/kernel/perf_regs.c:6:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/kernel/perf_regs.c should add these lines:
#include <asm/bug.h>                 // for WARN_ON_ONCE
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm-generic/int-ll64.h"    // for u64
#include "asm/current.h"             // for current
#include "asm/perf_event.h"          // for x86_perf_regs
#include "asm/processor.h"           // for task_pt_regs
#include "linux/container_of.h"      // for container_of
#include "linux/perf_event.h"        // for PERF_SAMPLE_REGS_ABI_32
#include "linux/perf_regs.h"         // for perf_regs, perf_get_regs_user
struct task_struct;

arch/x86/kernel/perf_regs.c should remove these lines:
- #include <linux/bug.h>  // lines 7-7
- #include <linux/errno.h>  // lines 2-2
- #include <linux/perf_event.h>  // lines 6-6
- #include <linux/sched.h>  // lines 4-4
- #include <linux/sched/task_stack.h>  // lines 5-5

The full include-list for arch/x86/kernel/perf_regs.c:
#include <asm/bug.h>                 // for WARN_ON_ONCE
#include <asm/perf_regs.h>           // for PERF_REG_X86_XMM0, PERF_REG_X86_...
#include <asm/ptrace.h>              // for pt_regs, regs_get_register
#include <linux/kernel.h>            // for ARRAY_SIZE
#include <linux/stddef.h>            // for offsetof
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm-generic/int-ll64.h"    // for u64
#include "asm/current.h"             // for current
#include "asm/perf_event.h"          // for x86_perf_regs
#include "asm/processor.h"           // for task_pt_regs
#include "linux/container_of.h"      // for container_of
#include "linux/perf_event.h"        // for PERF_SAMPLE_REGS_ABI_32
#include "linux/perf_regs.h"         // for perf_regs, perf_get_regs_user
struct task_struct;
---
  ./scripts/check-local-export arch/x86/kernel/perf_regs.o
  iwyu2 -Wp,-MMD,arch/x86/kernel/.unwind_guess.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/kernel/unwind_guess"' -DKBUILD_BASENAME='"unwind_guess"' -DKBUILD_MODNAME='"unwind_guess"' -D__KBUILD_MODNAME=kmod_unwind_guess -c -o arch/x86/kernel/unwind_guess.o arch/x86/kernel/unwind_guess.c  

arch/x86/kernel/unwind_guess.c should add these lines:
#include <stddef.h>              // for NULL
#include "asm-generic/rwonce.h"  // for READ_ONCE_NOCHECK
#include "asm/string_32.h"       // for memset
#include "linux/align.h"         // for PTR_ALIGN
#include "linux/export.h"        // for EXPORT_SYMBOL_GPL
#include "linux/kernel.h"        // for __kernel_text_address
#include "linux/stddef.h"        // for false, true
#include "linux/types.h"         // for bool
struct pt_regs;
struct task_struct;

arch/x86/kernel/unwind_guess.c should remove these lines:
- #include <asm/bitops.h>  // lines 5-5
- #include <asm/ptrace.h>  // lines 4-4
- #include <linux/ftrace.h>  // lines 3-3
- #include <linux/sched.h>  // lines 2-2

The full include-list for arch/x86/kernel/unwind_guess.c:
#include <asm/stacktrace.h>      // for get_stack_info, stack_info, on_stack
#include <asm/unwind.h>          // for unwind_state, unwind_done, unwind_re...
#include <stddef.h>              // for NULL
#include "asm-generic/rwonce.h"  // for READ_ONCE_NOCHECK
#include "asm/string_32.h"       // for memset
#include "linux/align.h"         // for PTR_ALIGN
#include "linux/export.h"        // for EXPORT_SYMBOL_GPL
#include "linux/kernel.h"        // for __kernel_text_address
#include "linux/stddef.h"        // for false, true
#include "linux/types.h"         // for bool
struct pt_regs;
struct task_struct;
---
  ./scripts/check-local-export arch/x86/kernel/unwind_guess.o
  rm -f arch/x86/kernel/built-in.a; echo process_32.o signal.o traps.o idt.o irq.o irq_32.o dumpstack_32.o time.o ioport.o dumpstack.o nmi.o setup.o x86_init.o i8259.o irqinit.o irq_work.o probe_roms.o sys_ia32.o bootflag.o e820.o pci-dma.o quirks.o topology.o kdebugfs.o alternative.o i8253.o hw_breakpoint.o tsc.o tsc_msr.o io_delay.o rtc.o resource.o irqflags.o static_call.o process.o fpu/built-in.a ptrace.o tls.o step.o i8237.o stacktrace.o cpu/built-in.a acpi/built-in.a reboot.o tsc_sync.o apic/built-in.a trace_clock.o kprobes/built-in.a doublefault_32.o perf_regs.o unwind_guess.o | sed -E 's:([^ ]+):arch/x86/kernel/:g' | xargs llvm-ar cDPrST arch/x86/kernel/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/mm \
 \
need-builtin=1 \
need-modorder=1
make -f ./scripts/Makefile.build obj=arch/x86/mm/pat \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,arch/x86/mm/pat/.set_memory.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/mm/pat/set_memory"' -DKBUILD_BASENAME='"set_memory"' -DKBUILD_MODNAME='"set_memory"' -D__KBUILD_MODNAME=kmod_set_memory -c -o arch/x86/mm/pat/set_memory.o arch/x86/mm/pat/set_memory.c  
In file included from arch/x86/mm/pat/set_memory.c:16:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/mm/pat/set_memory.c:16:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/mm/pat/set_memory.c:16:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/mm/pat/set_memory.c:16:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^
5 warnings generated.
In file included from arch/x86/mm/pat/set_memory.c:16:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/mm/pat/set_memory.c:16:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/mm/pat/set_memory.c:16:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/mm/pat/set_memory.c:16:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^

arch/x86/mm/pat/set_memory.c should add these lines:
#include <asm-generic/pgtable-nopmd.h>  // for pud_t, PUD_SIZE, p4d_none
#include <asm-generic/pgtable-nopud.h>  // for p4d_offset, pgd_none, p4d_t
#include <asm/bug.h>                    // for BUG_ON, WARN_ONCE, WARN_ON_ONCE
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EINVAL, EFAULT, EIO, ENOMEM
#include "asm-generic/int-ll64.h"       // for u64
#include "asm-generic/memory_model.h"   // for page_to_pfn
#include "asm-generic/mshyperv.h"       // for hv_is_isolation_supported
#include "asm-generic/pgtable-nopmd.h"  // for pmd_t, pud_none, PMD_SIZE
#include "asm-generic/sections.h"       // for __end_rodata, __start_rodata
#include "asm-generic/set_memory.h"     // for set_memory_nx, set_memory_ro
#include "asm/barrier.h"                // for mb
#include "asm/cacheflush.h"             // for clflush_cache_range
#include "asm/cpufeature.h"             // for boot_cpu_has, static_cpu_has
#include "asm/cpufeatures.h"            // for X86_FEATURE_CLFLUSH, X86_FEAT...
#include "asm/page.h"                   // for __pa, __pa_symbol, __va, virt...
#include "asm/page_types.h"             // for PAGE_SHIFT, PAGE_SIZE, PAGE_MASK
#include "asm/pgtable-2level_types.h"   // for pte_t, pgprotval_t, PTRS_PER_PTE
#include "asm/pgtable.h"                // for pfn_pte, pmd_none, pmd_pfn
#include "asm/pgtable_types.h"          // for pgprot_val, __pgprot, pgprot_t
#include "asm/set_memory.h"             // for __set_memory_prot, _set_memor...
#include "asm/special_insns.h"          // for clflushopt, wbinvd
#include "asm/string_32.h"              // for memset
#include "asm/x86_init.h"               // for x86_guest, x86_platform, x86_...
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_types.h"       // for inline
#include "linux/cpumask.h"              // for num_online_cpus
#include "linux/export.h"               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/highmem-internal.h"     // for kmap_flush_unused
#include "linux/init.h"                 // for __init
#include "linux/irqflags.h"             // for irqs_disabled
#include "linux/kern_levels.h"          // for KERN_WARNING
#include "linux/list.h"                 // for list_for_each_entry
#include "linux/minmax.h"               // for min_t
#include "linux/mm_types.h"             // for page, page::(anonymous union)...
#include "linux/pgtable.h"              // for pgd_index, pte_offset_kernel
#include "linux/printk.h"               // for pr_warn, pr_warn_once
#include "linux/smp.h"                  // for on_each_cpu
#include "linux/spinlock.h"             // for spin_unlock, spin_lock
#include "linux/spinlock_types.h"       // for DEFINE_SPINLOCK
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool, phys_addr_t, list_head

arch/x86/mm/pat/set_memory.c should remove these lines:
- #include <asm/e820/api.h>  // lines 24-24
- #include <asm/hyperv-tlfs.h>  // lines 33-33
- #include <asm/proto.h>  // lines 31-31
- #include <asm/sections.h>  // lines 27-27
- #include <linux/debugfs.h>  // lines 12-12
- #include <linux/highmem.h>  // lines 6-6
- #include <linux/interrupt.h>  // lines 10-10
- #include <linux/memblock.h>  // lines 7-7
- #include <linux/pci.h>  // lines 16-16
- #include <linux/percpu.h>  // lines 14-14
- #include <linux/sched.h>  // lines 8-8
- #include <linux/seq_file.h>  // lines 11-11
- #include <linux/set_memory.h>  // lines 22-22
- #include <linux/uaccess.h>  // lines 29-29
- #include <linux/vmstat.h>  // lines 19-19

The full include-list for arch/x86/mm/pat/set_memory.c:
#include <asm-generic/pgtable-nopmd.h>  // for pud_t, PUD_SIZE, p4d_none
#include <asm-generic/pgtable-nopud.h>  // for p4d_offset, pgd_none, p4d_t
#include <asm/bug.h>                    // for BUG_ON, WARN_ONCE, WARN_ON_ONCE
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/memtype.h>                // for memtype_free, memtype_reserve
#include <asm/mshyperv.h>               // for hv_set_mem_host_visibility
#include <asm/pgalloc.h>                // for paravirt_alloc_pte
#include <asm/processor.h>              // for boot_cpu_data, cpuinfo_x86
#include <asm/setup.h>                  // for _text
#include <asm/tlbflush.h>               // for __flush_tlb_all, flush_tlb_all
#include <linux/cc_platform.h>          // for cc_platform_has, CC_ATTR_MEM_...
#include <linux/gfp.h>                  // for get_zeroed_page, GFP_KERNEL
#include <linux/kernel.h>               // for early_boot_irqs_disabled
#include <linux/mm.h>                   // for PageHighMem, debug_pagealloc_...
#include <linux/pfn.h>                  // for PFN_DOWN
#include <linux/vmalloc.h>              // for vm_unmap_aliases
#include <stddef.h>                     // for NULL
#include "../mm_internal.h"             // for tlb_single_page_flush_ceiling
#include "asm-generic/errno-base.h"     // for EINVAL, EFAULT, EIO, ENOMEM
#include "asm-generic/int-ll64.h"       // for u64
#include "asm-generic/memory_model.h"   // for page_to_pfn
#include "asm-generic/mshyperv.h"       // for hv_is_isolation_supported
#include "asm-generic/pgtable-nopmd.h"  // for pmd_t, pud_none, PMD_SIZE
#include "asm-generic/sections.h"       // for __end_rodata, __start_rodata
#include "asm-generic/set_memory.h"     // for set_memory_nx, set_memory_ro
#include "asm/barrier.h"                // for mb
#include "asm/cacheflush.h"             // for clflush_cache_range
#include "asm/cpufeature.h"             // for boot_cpu_has, static_cpu_has
#include "asm/cpufeatures.h"            // for X86_FEATURE_CLFLUSH, X86_FEAT...
#include "asm/page.h"                   // for __pa, __pa_symbol, __va, virt...
#include "asm/page_types.h"             // for PAGE_SHIFT, PAGE_SIZE, PAGE_MASK
#include "asm/pgtable-2level_types.h"   // for pte_t, pgprotval_t, PTRS_PER_PTE
#include "asm/pgtable.h"                // for pfn_pte, pmd_none, pmd_pfn
#include "asm/pgtable_types.h"          // for pgprot_val, __pgprot, pgprot_t
#include "asm/set_memory.h"             // for __set_memory_prot, _set_memor...
#include "asm/special_insns.h"          // for clflushopt, wbinvd
#include "asm/string_32.h"              // for memset
#include "asm/x86_init.h"               // for x86_guest, x86_platform, x86_...
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_types.h"       // for inline
#include "linux/cpumask.h"              // for num_online_cpus
#include "linux/export.h"               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/highmem-internal.h"     // for kmap_flush_unused
#include "linux/init.h"                 // for __init
#include "linux/irqflags.h"             // for irqs_disabled
#include "linux/kern_levels.h"          // for KERN_WARNING
#include "linux/list.h"                 // for list_for_each_entry
#include "linux/minmax.h"               // for min_t
#include "linux/mm_types.h"             // for page, page::(anonymous union)...
#include "linux/pgtable.h"              // for pgd_index, pte_offset_kernel
#include "linux/printk.h"               // for pr_warn, pr_warn_once
#include "linux/smp.h"                  // for on_each_cpu
#include "linux/spinlock.h"             // for spin_unlock, spin_lock
#include "linux/spinlock_types.h"       // for DEFINE_SPINLOCK
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool, phys_addr_t, list_head
---
  ./scripts/check-local-export arch/x86/mm/pat/set_memory.o
  iwyu2 -Wp,-MMD,arch/x86/mm/pat/.memtype.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/mm/pat/memtype"' -DKBUILD_BASENAME='"memtype"' -DKBUILD_MODNAME='"memtype"' -D__KBUILD_MODNAME=kmod_memtype -c -o arch/x86/mm/pat/memtype.o arch/x86/mm/pat/memtype.c  

arch/x86/mm/pat/memtype.h should add these lines:
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u64
#include "asm/pgtable_types.h"     // for page_cache_mode, _PAGE_CACHE_MODE_UC
#include "linux/compiler_types.h"  // for inline
#include "linux/printk.h"          // for pr_info
#include "linux/rbtree_types.h"    // for rb_node
#include "linux/types.h"           // for loff_t

arch/x86/mm/pat/memtype.h should remove these lines:

The full include-list for arch/x86/mm/pat/memtype.h:
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u64
#include "asm/pgtable_types.h"     // for page_cache_mode, _PAGE_CACHE_MODE_UC
#include "linux/compiler_types.h"  // for inline
#include "linux/printk.h"          // for pr_info
#include "linux/rbtree_types.h"    // for rb_node
#include "linux/types.h"           // for loff_t
---

arch/x86/mm/pat/memtype.c should add these lines:
#include <asm/bug.h>                   // for WARN_ON_ONCE, WARN, WARN_ONCE
#include <asm/cpufeatures.h>           // for REQUIRED_MASK0, REQUIRED_MASK1
#include "asm-generic/errno-base.h"    // for EINVAL, EBUSY, ENOMEM
#include "asm-generic/fcntl.h"         // for O_DSYNC
#include "asm-generic/memory_model.h"  // for pfn_to_page
#include "asm/cache.h"                 // for __read_mostly
#include "asm/cpufeature.h"            // for boot_cpu_has
#include "asm/cpufeatures.h"           // for X86_FEATURE_PAT
#include "asm/current.h"               // for current
#include "asm/e820/types.h"            // for ISA_END_ADDRESS
#include "asm/msr-index.h"             // for MSR_IA32_CR_PAT
#include "asm/mtrr.h"                  // for MTRR_TYPE_WRBACK
#include "asm/page_types.h"            // for PAGE_SHIFT, PAGE_SIZE, __PHYSI...
#include "asm/pgtable.h"               // for is_new_memtype_allowed, pgprot...
#include "asm/string_32.h"             // for memcpy
#include "linux/err.h"                 // for IS_ERR
#include "linux/export.h"              // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                 // for GFP_KERNEL
#include "linux/init.h"                // for __init, __setup, early_param
#include "linux/kconfig.h"             // for IS_ENABLED
#include "linux/mm_types.h"            // for vm_area_struct, page (ptr only)
#include "linux/panic.h"               // for panic
#include "linux/pfn.h"                 // for PFN_PHYS, pfn_t
#include "linux/pgtable.h"             // for phys_mem_access_prot_allowed
#include "linux/sched.h"               // for task_struct
#include "linux/spinlock.h"            // for spin_unlock, spin_lock
#include "linux/spinlock_types.h"      // for DEFINE_SPINLOCK
#include "linux/stddef.h"              // for true

arch/x86/mm/pat/memtype.c should remove these lines:
- #include <asm/cacheflush.h>  // lines 45-45
- #include <asm/e820/api.h>  // lines 50-50
- #include <asm/fcntl.h>  // lines 49-49
- #include <asm/tlbflush.h>  // lines 47-47
- #include <linux/debugfs.h>  // lines 36-36
- #include <linux/kernel.h>  // lines 38-38
- #include <linux/memblock.h>  // lines 35-35
- #include <linux/rbtree.h>  // lines 43-43
- #include <linux/seq_file.h>  // lines 34-34

The full include-list for arch/x86/mm/pat/memtype.c:
#include "memtype.h"
#include <asm/bug.h>                   // for WARN_ON_ONCE, WARN, WARN_ONCE
#include <asm/cpufeatures.h>           // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/io.h>                    // for devmem_is_allowed, ioremap_cha...
#include <asm/memtype.h>               // for pgprot2cachemode, init_cache_m...
#include <asm/msr.h>                   // for wrmsrl, rdmsrl
#include <asm/mtrr.h>                  // for mtrr_type_lookup
#include <asm/page.h>                  // for __pa, __va
#include <asm/processor.h>             // for cpuinfo_x86, X86_VENDOR_INTEL
#include <asm/x86_init.h>              // for x86_platform, x86_platform_ops
#include <linux/fs.h>                  // for file
#include <linux/ioport.h>              // for iomem_map_sanity_check, walk_s...
#include <linux/mm.h>                  // for follow_phys, VM_PAT, high_memory
#include <linux/pfn_t.h>               // for pfn_t_to_phys
#include <linux/slab.h>                // for kfree, kzalloc
#include "../mm_internal.h"            // for update_cache_mode_entry
#include "asm-generic/errno-base.h"    // for EINVAL, EBUSY, ENOMEM
#include "asm-generic/fcntl.h"         // for O_DSYNC
#include "asm-generic/memory_model.h"  // for pfn_to_page
#include "asm/cache.h"                 // for __read_mostly
#include "asm/cpufeature.h"            // for boot_cpu_has
#include "asm/cpufeatures.h"           // for X86_FEATURE_PAT
#include "asm/current.h"               // for current
#include "asm/e820/types.h"            // for ISA_END_ADDRESS
#include "asm/msr-index.h"             // for MSR_IA32_CR_PAT
#include "asm/mtrr.h"                  // for MTRR_TYPE_WRBACK
#include "asm/page_types.h"            // for PAGE_SHIFT, PAGE_SIZE, __PHYSI...
#include "asm/pgtable.h"               // for is_new_memtype_allowed, pgprot...
#include "asm/string_32.h"             // for memcpy
#include "linux/err.h"                 // for IS_ERR
#include "linux/export.h"              // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                 // for GFP_KERNEL
#include "linux/init.h"                // for __init, __setup, early_param
#include "linux/kconfig.h"             // for IS_ENABLED
#include "linux/mm_types.h"            // for vm_area_struct, page (ptr only)
#include "linux/panic.h"               // for panic
#include "linux/pfn.h"                 // for PFN_PHYS, pfn_t
#include "linux/pgtable.h"             // for phys_mem_access_prot_allowed
#include "linux/sched.h"               // for task_struct
#include "linux/spinlock.h"            // for spin_unlock, spin_lock
#include "linux/spinlock_types.h"      // for DEFINE_SPINLOCK
#include "linux/stddef.h"              // for true
---
  ./scripts/check-local-export arch/x86/mm/pat/memtype.o
  rm -f arch/x86/mm/pat/built-in.a; echo set_memory.o memtype.o | sed -E 's:([^ ]+):arch/x86/mm/pat/:g' | xargs llvm-ar cDPrST arch/x86/mm/pat/built-in.a
  iwyu2 -Wp,-MMD,arch/x86/mm/.init.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/mm/init"' -DKBUILD_BASENAME='"init"' -DKBUILD_MODNAME='"init"' -D__KBUILD_MODNAME=kmod_init -c -o arch/x86/mm/init.o arch/x86/mm/init.c  
In file included from arch/x86/mm/init.c:4:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from arch/x86/mm/init.c:4:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/mm/init.c:4:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/mm/init.c:4:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from arch/x86/mm/init.c:4:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from arch/x86/mm/init.c:4:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/mm/init.c:4:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/mm/init.c:4:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/mm/init.c should add these lines:
#include <asm-generic/percpu.h>         // for DEFINE_PER_CPU_ALIGNED
#include <asm/bug.h>                    // for BUG_ON, WARN_ON
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/io.h>                     // for devmem_is_allowed
#include <asm/pgtable.h>                // for swapper_pg_dir
#include <linux/mm.h>                   // for load_cr3, TASK_UNMAPPED_BASE
#include <stddef.h>                     // for NULL
#include <stdint.h>                     // for uint16_t, uint8_t
#include "asm-generic/getorder.h"       // for get_order
#include "asm-generic/int-ll64.h"       // for u64
#include "asm-generic/pgtable-nopmd.h"  // for PMD_SIZE, PMD_MASK, PMD_SHIFT
#include "asm-generic/pgtable-nopud.h"  // for PUD_SIZE
#include "asm-generic/sections.h"       // for _end, __init_begin, __init_end
#include "asm-generic/set_memory.h"     // for set_memory_nx, set_memory_rw
#include "asm/cpufeatures.h"            // for X86_FEATURE_PCID, X86_FEATURE...
#include "asm/e820/types.h"             // for E820_MAX_ENTRIES, ISA_END_ADD...
#include "asm/mem_encrypt.h"            // for mem_encrypt_free_decrypted_mem
#include "asm/page_32.h"                // for clear_page
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable.h"                // for early_alloc_pgt_buf, init_mem...
#include "asm/pgtable_types.h"          // for __pte2cm_idx, _PAGE_CACHE_MOD...
#include "asm/processor-flags.h"        // for X86_CR4_PCIDE, X86_CR4_PGE
#include "asm/string_32.h"              // for memmove, memset
#include "asm/x86_init.h"               // for x86_hyper_init, x86_init, x86...
#include "generated/autoconf.h"         // for CONFIG_X86_32
#include "generated/bounds.h"           // for MAX_NR_ZONES
#include "linux/compiler.h"             // for likely
#include "linux/compiler_attributes.h"  // for __visible
#include "linux/compiler_types.h"       // for inline
#include "linux/export.h"               // for EXPORT_SYMBOL
#include "linux/init.h"                 // for __init, __initdata, __ref
#include "linux/kconfig.h"              // for IS_ENABLED, __ARG_PLACEHOLDER_1
#include "linux/kern_levels.h"          // for KERN_INFO
#include "linux/math.h"                 // for round_up, round_down
#include "linux/minmax.h"               // for max, clamp_val, min
#include "linux/mm.h"                   // for debug_pagealloc_enabled, free...
#include "linux/mm_types.h"             // for init_mm
#include "linux/mmzone.h"               // for ZONE_NORMAL
#include "linux/numa.h"                 // for MAX_NUMNODES
#include "linux/panic.h"                // for panic
#include "linux/pfn.h"                  // for PFN_DOWN, PFN_PHYS
#include "linux/poison.h"               // for POISON_FREE_INITMEM
#include "linux/printk.h"               // for pr_debug, pr_info, printk
#include "linux/range.h"                // for range, add_range_with_merge
#include "linux/spinlock_types.h"       // for spinlock_t
#include "linux/stddef.h"               // for true, false
#include "linux/types.h"                // for bool, phys_addr_t

arch/x86/mm/init.c should remove these lines:
- #include <asm/dma.h>  // lines 20-20
- #include <asm/hypervisor.h>  // lines 23-23
- #include <asm/init.h>  // lines 12-12
- #include <asm/microcode.h>  // lines 21-21
- #include <asm/proto.h>  // lines 19-19
- #include <asm/sections.h>  // lines 15-15
- #include <asm/tlb.h>  // lines 18-18
- #include <linux/swap.h>  // lines 4-4
- #include <linux/swapops.h>  // lines 6-6
- #include <trace/events/tlb.h>  // lines 33-33

The full include-list for arch/x86/mm/init.c:
#include <asm-generic/percpu.h>         // for DEFINE_PER_CPU_ALIGNED
#include <asm/bug.h>                    // for BUG_ON, WARN_ON
#include <asm/cpufeature.h>             // for boot_cpu_has, setup_clear_cpu...
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/e820/api.h>               // for e820__reallocate_tables
#include <asm/io.h>                     // for devmem_is_allowed
#include <asm/kaslr.h>                  // for kaslr_get_random_long
#include <asm/memtype.h>                // for pgprot2cachemode, x86_has_pat_wp
#include <asm/page.h>                   // for __pa, __va, __pa_symbol
#include <asm/page_types.h>             // for PAGE_SHIFT, PAGE_SIZE, max_pf...
#include <asm/pgtable.h>                // for swapper_pg_dir
#include <asm/pti.h>                    // for pti_check_boottime_disable
#include <asm/set_memory.h>             // for set_memory_np, set_memory_np_...
#include <asm/setup.h>                  // for extend_brk, RESERVE_BRK
#include <asm/text-patching.h>          // for poking_addr, poking_mm
#include <asm/tlbflush.h>               // for cr4_set_bits, __flush_tlb_all
#include <linux/gfp.h>                  // for __get_free_pages, GFP_ATOMIC
#include <linux/initrd.h>               // for free_initrd_mem
#include <linux/ioport.h>               // for iomem_is_exclusive, IORESOURC...
#include <linux/kmemleak.h>             // for kmemleak_free_part
#include <linux/memblock.h>             // for memblock_is_region_memory
#include <linux/mm.h>                   // for load_cr3, TASK_UNMAPPED_BASE
#include <linux/sched/task.h>           // for copy_init_mm
#include <stddef.h>                     // for NULL
#include <stdint.h>                     // for uint16_t, uint8_t
#include "asm-generic/getorder.h"       // for get_order
#include "asm-generic/int-ll64.h"       // for u64
#include "asm-generic/pgtable-nopmd.h"  // for PMD_SIZE, PMD_MASK, PMD_SHIFT
#include "asm-generic/pgtable-nopud.h"  // for PUD_SIZE
#include "asm-generic/sections.h"       // for _end, __init_begin, __init_end
#include "asm-generic/set_memory.h"     // for set_memory_nx, set_memory_rw
#include "asm/cpufeatures.h"            // for X86_FEATURE_PCID, X86_FEATURE...
#include "asm/e820/types.h"             // for E820_MAX_ENTRIES, ISA_END_ADD...
#include "asm/mem_encrypt.h"            // for mem_encrypt_free_decrypted_mem
#include "asm/page_32.h"                // for clear_page
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable.h"                // for early_alloc_pgt_buf, init_mem...
#include "asm/pgtable_types.h"          // for __pte2cm_idx, _PAGE_CACHE_MOD...
#include "asm/processor-flags.h"        // for X86_CR4_PCIDE, X86_CR4_PGE
#include "asm/string_32.h"              // for memmove, memset
#include "asm/x86_init.h"               // for x86_hyper_init, x86_init, x86...
#include "generated/autoconf.h"         // for CONFIG_X86_32
#include "generated/bounds.h"           // for MAX_NR_ZONES
#include "linux/compiler.h"             // for likely
#include "linux/compiler_attributes.h"  // for __visible
#include "linux/compiler_types.h"       // for inline
#include "linux/export.h"               // for EXPORT_SYMBOL
#include "linux/init.h"                 // for __init, __initdata, __ref
#include "linux/kconfig.h"              // for IS_ENABLED, __ARG_PLACEHOLDER_1
#include "linux/kern_levels.h"          // for KERN_INFO
#include "linux/math.h"                 // for round_up, round_down
#include "linux/minmax.h"               // for max, clamp_val, min
#include "linux/mm.h"                   // for debug_pagealloc_enabled, free...
#include "linux/mm_types.h"             // for init_mm
#include "linux/mmzone.h"               // for ZONE_NORMAL
#include "linux/numa.h"                 // for MAX_NUMNODES
#include "linux/panic.h"                // for panic
#include "linux/pfn.h"                  // for PFN_DOWN, PFN_PHYS
#include "linux/poison.h"               // for POISON_FREE_INITMEM
#include "linux/printk.h"               // for pr_debug, pr_info, printk
#include "linux/range.h"                // for range, add_range_with_merge
#include "linux/spinlock_types.h"       // for spinlock_t
#include "linux/stddef.h"               // for true, false
#include "linux/types.h"                // for bool, phys_addr_t
#include "mm_internal.h"                // for early_ioremap_page_table_rang...
---
  ./scripts/check-local-export arch/x86/mm/init.o
  iwyu2 -Wp,-MMD,arch/x86/mm/.init_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/mm/init_32"' -DKBUILD_BASENAME='"init_32"' -DKBUILD_MODNAME='"init_32"' -D__KBUILD_MODNAME=kmod_init_32 -c -o arch/x86/mm/init_32.o arch/x86/mm/init_32.c  
In file included from arch/x86/mm/init_32.c:18:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from arch/x86/mm/init_32.c:19:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/mm/init_32.c:19:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/mm/init_32.c:19:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/mm/init_32.c:24:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^
6 warnings generated.
In file included from arch/x86/mm/init_32.c:18:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from arch/x86/mm/init_32.c:19:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/mm/init_32.c:19:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/mm/init_32.c:19:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/mm/init_32.c:24:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^

arch/x86/mm/init_32.c should add these lines:
#include <asm/bug.h>                    // for BUG_ON
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/pgtable.h>                // for swapper_pg_dir, initial_page_...
#include <linux/pgtable.h>              // for pages_to_mb, clone_pgd_range
#include <stddef.h>                     // for NULL
#include "asm-generic/early_ioremap.h"  // for early_ioremap_reset
#include "asm-generic/errno-base.h"     // for EINVAL
#include "asm-generic/pgtable-nop4d.h"  // for p4d_offset, pgd_present, p4d_t
#include "asm-generic/pgtable-nopmd.h"  // for pmd_t, PMD_MASK, PMD_SIZE
#include "asm-generic/pgtable-nopud.h"  // for pud_offset, pud_t
#include "asm-generic/sections.h"       // for __init_end, __end_rodata, _etext
#include "asm-generic/set_memory.h"     // for set_memory_nx
#include "asm/cache.h"                  // for __read_mostly
#include "asm/cpufeature.h"             // for boot_cpu_has
#include "asm/cpufeatures.h"            // for X86_FEATURE_PSE
#include "asm/numa_32.h"                // for set_highmem_pages_init
#include "asm/page.h"                   // for __pa, __pa_symbol, __va, virt...
#include "asm/pci.h"                    // for pci_iommu_alloc
#include "asm/pgtable-2level_types.h"   // for pte_t, PTRS_PER_PTE, PTRS_PER...
#include "asm/pgtable_32_areas.h"       // for VMALLOC_START, VMALLOC_END
#include "asm/pgtable_types.h"          // for pgd_t, update_page_count, _PA...
#include "asm/x86_init.h"               // for x86_hyper_init, x86_init, x86...
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/compiler_types.h"       // for inline
#include "linux/export.h"               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_INFO, KERN_WARNING, KERN...
#include "linux/limits.h"               // for PHYS_ADDR_MAX
#include "linux/minmax.h"               // for min
#include "linux/mm_types.h"             // for init_mm
#include "linux/mmzone.h"               // for mem_map, sparse_init
#include "linux/panic.h"                // for panic
#include "linux/pgtable.h"              // for pgd_index, pmd_index, pte_off...
#include "linux/printk.h"               // for printk, pr_info, pr_warn
#include "linux/stddef.h"               // for false, true

arch/x86/mm/init_32.c should remove these lines:
- #include <asm/apic.h>  // lines 41-41
- #include <asm/asm.h>  // lines 34-34
- #include <asm/bios_ebda.h>  // lines 35-35
- #include <asm/bugs.h>  // lines 42-42
- #include <asm/cpu_entry_area.h>  // lines 52-52
- #include <asm/dma.h>  // lines 38-38
- #include <asm/e820/api.h>  // lines 40-40
- #include <asm/init.h>  // lines 53-53
- #include <asm/numa.h>  // lines 55-55
- #include <asm/paravirt.h>  // lines 48-48
- #include <asm/pgtable_areas.h>  // lines 54-54
- #include <asm/processor.h>  // lines 36-36
- #include <asm/sections.h>  // lines 47-47
- #include <asm/tlb.h>  // lines 43-43
- #include <linux/cpumask.h>  // lines 31-31
- #include <linux/errno.h>  // lines 12-12
- #include <linux/gfp.h>  // lines 32-32
- #include <linux/highmem.h>  // lines 22-22
- #include <linux/hugetlb.h>  // lines 18-18
- #include <linux/initrd.h>  // lines 30-30
- #include <linux/memory_hotplug.h>  // lines 29-29
- #include <linux/mman.h>  // lines 16-16
- #include <linux/pagemap.h>  // lines 23-23
- #include <linux/pci.h>  // lines 24-24
- #include <linux/poison.h>  // lines 26-26
- #include <linux/proc_fs.h>  // lines 28-28
- #include <linux/ptrace.h>  // lines 15-15
- #include <linux/sched.h>  // lines 10-10
- #include <linux/signal.h>  // lines 9-9
- #include <linux/smp.h>  // lines 20-20
- #include <linux/string.h>  // lines 13-13
- #include <linux/swap.h>  // lines 19-19

The full include-list for arch/x86/mm/init_32.c:
#include <asm/bug.h>                    // for BUG_ON
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/fixmap.h>                 // for FIX_WP_TEST, __set_fixmap
#include <asm/olpc_ofw.h>               // for olpc_dt_build_devicetree
#include <asm/page_types.h>             // for PAGE_SHIFT, PAGE_SIZE, PAGE_O...
#include <asm/pgalloc.h>                // for paravirt_alloc_pmd, paravirt_...
#include <asm/pgtable.h>                // for swapper_pg_dir, initial_page_...
#include <asm/set_memory.h>             // for set_pages_ro
#include <asm/setup.h>                  // for MAXMEM_PFN, _text, MAX_NONPAE...
#include <asm/tlbflush.h>               // for __flush_tlb_all
#include <linux/init.h>                 // for __init, early_param, mark_rod...
#include <linux/kernel.h>               // for memparse
#include <linux/memblock.h>             // for max_pfn, max_low_pfn, membloc...
#include <linux/mm.h>                   // for high_memory, max_mapnr, mem_init
#include <linux/pfn.h>                  // for PFN_ALIGN
#include <linux/pgtable.h>              // for pages_to_mb, clone_pgd_range
#include <linux/types.h>                // for bool
#include <linux/uaccess.h>              // for copy_to_kernel_nofault
#include <stddef.h>                     // for NULL
#include "asm-generic/early_ioremap.h"  // for early_ioremap_reset
#include "asm-generic/errno-base.h"     // for EINVAL
#include "asm-generic/pgtable-nop4d.h"  // for p4d_offset, pgd_present, p4d_t
#include "asm-generic/pgtable-nopmd.h"  // for pmd_t, PMD_MASK, PMD_SIZE
#include "asm-generic/pgtable-nopud.h"  // for pud_offset, pud_t
#include "asm-generic/sections.h"       // for __init_end, __end_rodata, _etext
#include "asm-generic/set_memory.h"     // for set_memory_nx
#include "asm/cache.h"                  // for __read_mostly
#include "asm/cpufeature.h"             // for boot_cpu_has
#include "asm/cpufeatures.h"            // for X86_FEATURE_PSE
#include "asm/numa_32.h"                // for set_highmem_pages_init
#include "asm/page.h"                   // for __pa, __pa_symbol, __va, virt...
#include "asm/pci.h"                    // for pci_iommu_alloc
#include "asm/pgtable-2level_types.h"   // for pte_t, PTRS_PER_PTE, PTRS_PER...
#include "asm/pgtable_32_areas.h"       // for VMALLOC_START, VMALLOC_END
#include "asm/pgtable_types.h"          // for pgd_t, update_page_count, _PA...
#include "asm/x86_init.h"               // for x86_hyper_init, x86_init, x86...
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/compiler_types.h"       // for inline
#include "linux/export.h"               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_INFO, KERN_WARNING, KERN...
#include "linux/limits.h"               // for PHYS_ADDR_MAX
#include "linux/minmax.h"               // for min
#include "linux/mm_types.h"             // for init_mm
#include "linux/mmzone.h"               // for mem_map, sparse_init
#include "linux/panic.h"                // for panic
#include "linux/pgtable.h"              // for pgd_index, pmd_index, pte_off...
#include "linux/printk.h"               // for printk, pr_info, pr_warn
#include "linux/stddef.h"               // for false, true
#include "mm_internal.h"                // for alloc_low_page, alloc_low_pages
---
  ./scripts/check-local-export arch/x86/mm/init_32.o
  iwyu2 -Wp,-MMD,arch/x86/mm/.fault.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -I ./arch/x86/mm/../include/asm/trace    -DKBUILD_MODFILE='"arch/x86/mm/fault"' -DKBUILD_BASENAME='"fault"' -DKBUILD_MODNAME='"fault"' -D__KBUILD_MODNAME=kmod_fault -c -o arch/x86/mm/fault.o arch/x86/mm/fault.c  
In file included from arch/x86/mm/fault.c:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/mm/fault.c:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/mm/fault.c:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/mm/fault.c:15:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from arch/x86/mm/fault.c:20:
In file included from ./include/linux/efi.h:20:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
5 warnings generated.
In file included from arch/x86/mm/fault.c:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/mm/fault.c:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/mm/fault.c:15:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/mm/fault.c:15:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from arch/x86/mm/fault.c:20:
In file included from ./include/linux/efi.h:20:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^

arch/x86/mm/fault.c should add these lines:
#include <asm/bug.h>                    // for WARN_ON_ONCE, BUG_ON, WARN_ONCE
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/page_types.h>             // for TASK_SIZE_MAX
#include <asm/signal.h>                 // for SIGSEGV, SIGBUS, SIGKILL
#include <stddef.h>                     // for NULL
#include "asm-generic/int-ll64.h"       // for u32, u16, u64
#include "asm-generic/kprobes.h"        // for NOKPROBE_SYMBOL, nokprobe_inline
#include "asm-generic/pgtable-nop4d.h"  // for p4d_offset, pgd_present, p4d_t
#include "asm-generic/pgtable-nopmd.h"  // for pmd_t, pud_present, pmd_offset
#include "asm-generic/pgtable-nopud.h"  // for p4d_present, pud_offset, pud_t
#include "asm-generic/siginfo.h"        // for BUS_ADRERR, SEGV_MAPERR, SEGV...
#include "asm/bug.h"                    // for BUG
#include "asm/cpufeatures.h"            // for X86_FEATURE_OSPKE, X86_FEATUR...
#include "asm/current.h"                // for current
#include "asm/desc_defs.h"              // for desc_ptr, ldttss_desc, desc_s...
#include "asm/extable.h"                // for fixup_exception
#include "asm/idtentry.h"               // for DEFINE_IDTENTRY_RAW_ERRORCODE
#include "asm/kdebug.h"                 // for __die, oops_begin, oops_end
#include "asm/page.h"                   // for __va
#include "asm/page_types.h"             // for PAGE_MASK, PAGE_SIZE
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable.h"                // for pmd_present, pte_present, pmd...
#include "asm/pgtable_32_areas.h"       // for VMALLOC_END, VMALLOC_START
#include "asm/pgtable_types.h"          // for pgd_t, lookup_address_in_pgd
#include "asm/processor-flags.h"        // for X86_CR4_SMEP, X86_EFLAGS_AC
#include "asm/processor.h"              // for read_cr3_pa, thread_struct
#include "asm/ptrace.h"                 // for user_mode, pt_regs, convert_i...
#include "asm/special_insns.h"          // for __read_cr4, read_cr2
#include "asm/stacktrace.h"             // for show_opcodes
#include "asm/trap_pf.h"                // for X86_PF_INSTR, X86_PF_WRITE
#include "asm/trapnr.h"                 // for X86_TRAP_PF
#include "asm/uaccess.h"                // for get_user
#include "asm/vsyscall.h"               // for VSYSCALL_ADDR
#include "common.h"                     // for trace_pagefault_enabled
#include "generated/autoconf.h"         // for CONFIG_CPU_SUP_AMD
#include "linux/compiler.h"             // for unlikely, likely
#include "linux/compiler_attributes.h"  // for noinline, __always_inline
#include "linux/compiler_types.h"       // for __user, inline
#include "linux/cred.h"                 // for cred, current_uid
#include "linux/entry-common.h"         // for irqentry_enter, irqentry_exit
#include "linux/instrumentation.h"      // for instrumentation_begin, instru...
#include "linux/irqflags.h"             // for local_irq_enable, local_irq_d...
#include "linux/kconfig.h"              // for IS_ENABLED, __ARG_PLACEHOLDER_1
#include "linux/kern_levels.h"          // for KERN_CONT, KERN_EMERG, KERN_A...
#include "linux/kernel.h"               // for might_sleep
#include "linux/list.h"                 // for LIST_HEAD, list_for_each_entry
#include "linux/mm.h"                   // for expand_stack, find_vma, handl...
#include "linux/mmap_lock.h"            // for mmap_read_unlock, mmap_read_lock
#include "linux/panic.h"                // for oops_may_print
#include "linux/perf_event.h"           // for PERF_COUNT_SW_PAGE_FAULTS
#include "linux/pgtable.h"              // for pgd_index, pte_offset_kernel
#include "linux/pkeys.h"                // for ARCH_DEFAULT_PKEY, vma_pkey
#include "linux/preempt.h"              // for in_interrupt
#include "linux/printk.h"               // for pr_alert, printk, printk_rate...
#include "linux/sched/signal.h"         // for force_sig_fault, force_sig_pk...
#include "linux/signal.h"               // for unhandled_signal, show_unhand...
#include "linux/spinlock.h"             // for spin_lock, spin_unlock
#include "linux/spinlock_types.h"       // for DEFINE_SPINLOCK, spinlock_t
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool, list_head
#include "linux/uidgid.h"               // for from_kuid
#include "linux/user_namespace.h"       // for init_user_ns
#include "linux/vmalloc.h"              // for arch_sync_kernel_mappings

arch/x86/mm/fault.c should remove these lines:
- #include <asm/cpu_entry_area.h>  // lines 31-31
- #include <asm/fixmap.h>  // lines 25-25
- #include <asm/irq_stack.h>  // lines 35-35
- #include <asm/pgtable_areas.h>  // lines 32-32
- #include <asm/vm86.h>  // lines 27-27
- #include <asm/vsyscall.h>  // lines 26-26
- #include <linux/context_tracking.h>  // lines 18-18
- #include <linux/efi.h>  // lines 20-20
- #include <linux/hugetlb.h>  // lines 16-16
- #include <linux/kdebug.h>  // lines 9-9

The full include-list for arch/x86/mm/fault.c:
#include <asm/bug.h>                    // for WARN_ON_ONCE, BUG_ON, WARN_ONCE
#include <asm/cpufeature.h>             // for cpu_feature_enabled
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/desc.h>                   // for native_store_gdt, store_idt
#include <asm/efi.h>                    // for efi_crash_gracefully_on_page_...
#include <asm/kvm_para.h>               // for kvm_handle_async_pf
#include <asm/mmu_context.h>            // for arch_vma_access_permitted
#include <asm/page_types.h>             // for TASK_SIZE_MAX
#include <asm/signal.h>                 // for SIGSEGV, SIGBUS, SIGKILL
#include <asm/trace/exceptions.h>       // for trace_page_fault_kernel, trac...
#include <asm/traps.h>                  // for fault_in_kernel_space
#include <asm/vdso.h>                   // for fixup_vdso_exception
#include <linux/extable.h>              // for search_exception_tables
#include <linux/kfence.h>               // for kfence_handle_page_fault
#include <linux/kprobes.h>              // for kprobe_page_fault
#include <linux/memblock.h>             // for max_low_pfn
#include <linux/mm_types.h>             // for page, page::(anonymous union)...
#include <linux/mmiotrace.h>            // for is_kmmio_active, kmmio_handler
#include <linux/perf_event.h>           // for perf_sw_event
#include <linux/sched.h>                // for task_struct, task_pid_nr
#include <linux/sched/task_stack.h>     // for task_stack_end_corrupted
#include <linux/uaccess.h>              // for copy_from_kernel_nofault, pag...
#include <stddef.h>                     // for NULL
#include "asm-generic/int-ll64.h"       // for u32, u16, u64
#include "asm-generic/kprobes.h"        // for NOKPROBE_SYMBOL, nokprobe_inline
#include "asm-generic/pgtable-nop4d.h"  // for p4d_offset, pgd_present, p4d_t
#include "asm-generic/pgtable-nopmd.h"  // for pmd_t, pud_present, pmd_offset
#include "asm-generic/pgtable-nopud.h"  // for p4d_present, pud_offset, pud_t
#include "asm-generic/siginfo.h"        // for BUS_ADRERR, SEGV_MAPERR, SEGV...
#include "asm/bug.h"                    // for BUG
#include "asm/cpufeatures.h"            // for X86_FEATURE_OSPKE, X86_FEATUR...
#include "asm/current.h"                // for current
#include "asm/desc_defs.h"              // for desc_ptr, ldttss_desc, desc_s...
#include "asm/extable.h"                // for fixup_exception
#include "asm/idtentry.h"               // for DEFINE_IDTENTRY_RAW_ERRORCODE
#include "asm/kdebug.h"                 // for __die, oops_begin, oops_end
#include "asm/page.h"                   // for __va
#include "asm/page_types.h"             // for PAGE_MASK, PAGE_SIZE
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable.h"                // for pmd_present, pte_present, pmd...
#include "asm/pgtable_32_areas.h"       // for VMALLOC_END, VMALLOC_START
#include "asm/pgtable_types.h"          // for pgd_t, lookup_address_in_pgd
#include "asm/processor-flags.h"        // for X86_CR4_SMEP, X86_EFLAGS_AC
#include "asm/processor.h"              // for read_cr3_pa, thread_struct
#include "asm/ptrace.h"                 // for user_mode, pt_regs, convert_i...
#include "asm/special_insns.h"          // for __read_cr4, read_cr2
#include "asm/stacktrace.h"             // for show_opcodes
#include "asm/trap_pf.h"                // for X86_PF_INSTR, X86_PF_WRITE
#include "asm/trapnr.h"                 // for X86_TRAP_PF
#include "asm/uaccess.h"                // for get_user
#include "asm/vsyscall.h"               // for VSYSCALL_ADDR
#include "common.h"                     // for trace_pagefault_enabled
#include "generated/autoconf.h"         // for CONFIG_CPU_SUP_AMD
#include "linux/compiler.h"             // for unlikely, likely
#include "linux/compiler_attributes.h"  // for noinline, __always_inline
#include "linux/compiler_types.h"       // for __user, inline
#include "linux/cred.h"                 // for cred, current_uid
#include "linux/entry-common.h"         // for irqentry_enter, irqentry_exit
#include "linux/instrumentation.h"      // for instrumentation_begin, instru...
#include "linux/irqflags.h"             // for local_irq_enable, local_irq_d...
#include "linux/kconfig.h"              // for IS_ENABLED, __ARG_PLACEHOLDER_1
#include "linux/kern_levels.h"          // for KERN_CONT, KERN_EMERG, KERN_A...
#include "linux/kernel.h"               // for might_sleep
#include "linux/list.h"                 // for LIST_HEAD, list_for_each_entry
#include "linux/mm.h"                   // for expand_stack, find_vma, handl...
#include "linux/mmap_lock.h"            // for mmap_read_unlock, mmap_read_lock
#include "linux/panic.h"                // for oops_may_print
#include "linux/perf_event.h"           // for PERF_COUNT_SW_PAGE_FAULTS
#include "linux/pgtable.h"              // for pgd_index, pte_offset_kernel
#include "linux/pkeys.h"                // for ARCH_DEFAULT_PKEY, vma_pkey
#include "linux/preempt.h"              // for in_interrupt
#include "linux/printk.h"               // for pr_alert, printk, printk_rate...
#include "linux/sched/signal.h"         // for force_sig_fault, force_sig_pk...
#include "linux/signal.h"               // for unhandled_signal, show_unhand...
#include "linux/spinlock.h"             // for spin_lock, spin_unlock
#include "linux/spinlock_types.h"       // for DEFINE_SPINLOCK, spinlock_t
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool, list_head
#include "linux/uidgid.h"               // for from_kuid
#include "linux/user_namespace.h"       // for init_user_ns
#include "linux/vmalloc.h"              // for arch_sync_kernel_mappings
---
  ./scripts/check-local-export arch/x86/mm/fault.o
  iwyu2 -Wp,-MMD,arch/x86/mm/.ioremap.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/mm/ioremap"' -DKBUILD_BASENAME='"ioremap"' -DKBUILD_MODNAME='"ioremap"' -D__KBUILD_MODNAME=kmod_ioremap -c -o arch/x86/mm/ioremap.o arch/x86/mm/ioremap.c  
In file included from arch/x86/mm/ioremap.c:18:
In file included from ./include/linux/efi.h:20:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/mm/ioremap.c:18:
In file included from ./include/linux/efi.h:20:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/mm/ioremap.c:18:
In file included from ./include/linux/efi.h:20:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/mm/ioremap.c:18:
In file included from ./include/linux/efi.h:20:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
In file included from arch/x86/mm/ioremap.c:23:
In file included from ./arch/x86/include/asm/efi.h:7:
In file included from ./arch/x86/include/asm/tlb.h:8:
In file included from ./include/asm-generic/tlb.h:15:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
5 warnings generated.
In file included from arch/x86/mm/ioremap.c:18:
In file included from ./include/linux/efi.h:20:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/mm/ioremap.c:18:
In file included from ./include/linux/efi.h:20:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/mm/ioremap.c:18:
In file included from ./include/linux/efi.h:20:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/mm/ioremap.c:18:
In file included from ./include/linux/efi.h:20:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
In file included from arch/x86/mm/ioremap.c:23:
In file included from ./arch/x86/include/asm/efi.h:7:
In file included from ./arch/x86/include/asm/tlb.h:8:
In file included from ./include/asm-generic/tlb.h:15:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

arch/x86/mm/ioremap.c should add these lines:
#include <asm/bug.h>                    // for WARN_ON, BUG_ON, WARN, WARN_ONCE
#include <linux/mm.h>                   // for PageReserved
#include <stddef.h>                     // for NULL
#include "asm-generic/early_ioremap.h"  // for early_ioremap_setup, early_io...
#include "asm-generic/int-ll64.h"       // for u64
#include "asm-generic/memory_model.h"   // for pfn_to_page
#include "asm-generic/pgtable-nop4d.h"  // for p4d_offset, p4d_t
#include "asm-generic/pgtable-nopmd.h"  // for PMD_SHIFT, pmd_t, pmd_offset
#include "asm-generic/pgtable-nopud.h"  // for pud_offset, pud_t
#include "asm/bug.h"                    // for BUG
#include "asm/e820/types.h"             // for ISA_END_ADDRESS, ISA_START_AD...
#include "asm/io.h"                     // for ioremap, ioremap_cache, iorem...
#include "asm/page.h"                   // for __va
#include "asm/page_32.h"                // for pfn_valid
#include "asm/page_types.h"             // for PAGE_SIZE, PAGE_MASK, PAGE_SHIFT
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable.h"                // for is_new_memtype_allowed, pfn_pte
#include "asm/pgtable_types.h"          // for cachemode2protval, pgprot_val
#include "asm/processor.h"              // for read_cr3_pa
#include "asm/string_32.h"              // for memset
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/compiler_types.h"       // for __iomem, __force, inline
#include "linux/export.h"               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_WARNING, KERN_ERR
#include "linux/linkage.h"              // for __page_aligned_bss
#include "linux/mm.h"                   // for PAGE_ALIGN, high_memory
#include "linux/mm_types.h"             // for init_mm
#include "linux/printk.h"               // for printk, dump_stack, pr_warn
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for resource_size_t, phys_addr_t

arch/x86/mm/ioremap.c should remove these lines:
- #include <asm/e820/api.h>  // lines 22-22
- #include <asm/efi.h>  // lines 23-23
- #include <asm/setup.h>  // lines 28-28
- #include <linux/memblock.h>  // lines 10-10

The full include-list for arch/x86/mm/ioremap.c:
#include <asm/bug.h>                    // for WARN_ON, BUG_ON, WARN, WARN_ONCE
#include <asm/fixmap.h>                 // for fix_to_virt, FIX_BTMAP_END
#include <asm/memtype.h>                // for memtype_free, memtype_kernel_...
#include <asm/pgalloc.h>                // for pmd_populate_kernel
#include <asm/set_memory.h>             // for _set_memory_uc, _set_memory_wb
#include <asm/tlbflush.h>               // for flush_tlb_one_kernel
#include <linux/cc_platform.h>          // for cc_platform_has, CC_ATTR_GUES...
#include <linux/efi.h>                  // for efi_mem_type, efi_mem_attributes
#include <linux/init.h>                 // for __init
#include <linux/io.h>                   // for ioremap_page_range, memremap
#include <linux/ioport.h>               // for IORES_MAP_ENCRYPTED, IORES_MA...
#include <linux/mm.h>                   // for PageReserved
#include <linux/mmiotrace.h>            // for mmiotrace_ioremap, mmiotrace_...
#include <linux/pgtable.h>              // for pgd_index, pte_index
#include <linux/slab.h>                 // for kfree
#include <linux/vmalloc.h>              // for vm_struct, find_vm_area, free...
#include <stddef.h>                     // for NULL
#include "asm-generic/early_ioremap.h"  // for early_ioremap_setup, early_io...
#include "asm-generic/int-ll64.h"       // for u64
#include "asm-generic/memory_model.h"   // for pfn_to_page
#include "asm-generic/pgtable-nop4d.h"  // for p4d_offset, p4d_t
#include "asm-generic/pgtable-nopmd.h"  // for PMD_SHIFT, pmd_t, pmd_offset
#include "asm-generic/pgtable-nopud.h"  // for pud_offset, pud_t
#include "asm/bug.h"                    // for BUG
#include "asm/e820/types.h"             // for ISA_END_ADDRESS, ISA_START_AD...
#include "asm/io.h"                     // for ioremap, ioremap_cache, iorem...
#include "asm/page.h"                   // for __va
#include "asm/page_32.h"                // for pfn_valid
#include "asm/page_types.h"             // for PAGE_SIZE, PAGE_MASK, PAGE_SHIFT
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable.h"                // for is_new_memtype_allowed, pfn_pte
#include "asm/pgtable_types.h"          // for cachemode2protval, pgprot_val
#include "asm/processor.h"              // for read_cr3_pa
#include "asm/string_32.h"              // for memset
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/compiler_types.h"       // for __iomem, __force, inline
#include "linux/export.h"               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_WARNING, KERN_ERR
#include "linux/linkage.h"              // for __page_aligned_bss
#include "linux/mm.h"                   // for PAGE_ALIGN, high_memory
#include "linux/mm_types.h"             // for init_mm
#include "linux/printk.h"               // for printk, dump_stack, pr_warn
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for resource_size_t, phys_addr_t
#include "physaddr.h"                   // for phys_addr_valid
---
  ./scripts/check-local-export arch/x86/mm/ioremap.o
  iwyu2 -Wp,-MMD,arch/x86/mm/.extable.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/mm/extable"' -DKBUILD_BASENAME='"extable"' -DKBUILD_MODNAME='"extable"' -D__KBUILD_MODNAME=kmod_extable -c -o arch/x86/mm/extable.o arch/x86/mm/extable.c  
In file included from arch/x86/mm/extable.c:10:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/mm/extable.c:10:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/mm/extable.c:10:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/mm/extable.c:10:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from arch/x86/mm/extable.c:10:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/mm/extable.c:10:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/mm/extable.c:10:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from arch/x86/mm/extable.c:10:
In file included from ./arch/x86/include/asm/traps.h:9:
In file included from ./arch/x86/include/asm/idtentry.h:11:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

include/linux/extable.h should add these lines:
#include <stddef.h>                // for NULL, size_t
#include "linux/compiler_types.h"  // for inline

include/linux/extable.h should remove these lines:
- #include <linux/stddef.h>  // lines 5-5
- #include <linux/types.h>  // lines 6-6

The full include-list for include/linux/extable.h:
#include <stddef.h>                // for NULL, size_t
#include "linux/compiler_types.h"  // for inline
struct exception_table_entry;  // lines 9-9
struct module;  // lines 8-8
---

arch/x86/mm/extable.c should add these lines:
#include <asm/bug.h>                    // for WARN_ONCE, WARN_ON_ONCE
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include "asm-generic/errno-base.h"     // for EIO
#include "asm/bug.h"                    // for BUG, LEN_UD2
#include "asm/cpufeature.h"             // for static_cpu_has
#include "asm/cpufeatures.h"            // for X86_BUG_NULL_SEG
#include "asm/extable.h"                // for exception_table_entry, ex_han...
#include "asm/extable_fixup_types.h"    // for EX_DATA_TYPE_MASK, EX_DATA_IM...
#include "asm/irqflags.h"               // for halt
#include "asm/ptrace.h"                 // for pt_regs, instruction_pointer
#include "asm/segment.h"                // for __KERNEL_CS, __USER_DS
#include "asm/special_insns.h"          // for read_cr2
#include "asm/trapnr.h"                 // for X86_TRAP_GP, X86_TRAP_NMI
#include "linux/bug.h"                  // for report_bug, BUG_TRAP_TYPE_WARN
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/init.h"                 // for __init
#include "linux/printk.h"               // for early_printk, pr_warn_once
#include "linux/stddef.h"               // for true, false
#include "linux/types.h"                // for bool

arch/x86/mm/extable.c should remove these lines:
- #include <asm/sev.h>  // lines 9-9
- #include <asm/traps.h>  // lines 10-10
- #include <linux/uaccess.h>  // lines 3-3

The full include-list for arch/x86/mm/extable.c:
#include <linux/extable.h>
#include <asm/bug.h>                    // for WARN_ONCE, WARN_ON_ONCE
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/fpu/api.h>                // for fpu_reset_from_exception_fixup
#include <asm/insn-eval.h>              // for pt_regs_offset
#include <asm/kdebug.h>                 // for show_stack_regs
#include <asm/sgx.h>                    // for SGX_ENCLS_FAULT_FLAG
#include <linux/bitfield.h>             // for FIELD_GET
#include <linux/sched/debug.h>          // for show_regs
#include <xen/xen.h>                    // for xen_pv_domain
#include "asm-generic/errno-base.h"     // for EIO
#include "asm/bug.h"                    // for BUG, LEN_UD2
#include "asm/cpufeature.h"             // for static_cpu_has
#include "asm/cpufeatures.h"            // for X86_BUG_NULL_SEG
#include "asm/extable.h"                // for exception_table_entry, ex_han...
#include "asm/extable_fixup_types.h"    // for EX_DATA_TYPE_MASK, EX_DATA_IM...
#include "asm/irqflags.h"               // for halt
#include "asm/ptrace.h"                 // for pt_regs, instruction_pointer
#include "asm/segment.h"                // for __KERNEL_CS, __USER_DS
#include "asm/special_insns.h"          // for read_cr2
#include "asm/trapnr.h"                 // for X86_TRAP_GP, X86_TRAP_NMI
#include "linux/bug.h"                  // for report_bug, BUG_TRAP_TYPE_WARN
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/init.h"                 // for __init
#include "linux/printk.h"               // for early_printk, pr_warn_once
#include "linux/stddef.h"               // for true, false
#include "linux/types.h"                // for bool
---
  ./scripts/check-local-export arch/x86/mm/extable.o
  iwyu2 -Wp,-MMD,arch/x86/mm/.mmap.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/mm/mmap"' -DKBUILD_BASENAME='"mmap"' -DKBUILD_MODNAME='"mmap"' -D__KBUILD_MODNAME=kmod_mmap -c -o arch/x86/mm/mmap.o arch/x86/mm/mmap.c  

arch/x86/mm/mmap.c should add these lines:
#include <asm/cpufeatures.h>      // for REQUIRED_MASK0, REQUIRED_MASK1, REQ...
#include <asm/page_types.h>       // for DEFAULT_MAP_WINDOW, IA32_PAGE_OFFSET
#include <stddef.h>               // for size_t, NULL
#include "asm/cache.h"            // for __read_mostly
#include "asm/cpufeature.h"       // for boot_cpu_has_bug
#include "asm/cpufeatures.h"      // for X86_BUG_L1TF
#include "asm/current.h"          // for current
#include "asm/page.h"             // for __pa
#include "asm/page_32.h"          // for pfn_valid
#include "asm/page_types.h"       // for PAGE_SHIFT
#include "asm/pgtable-2level.h"   // for __pte_needs_invert
#include "asm/pgtable.h"          // for pfn_modify_allowed
#include "asm/pgtable_types.h"    // for pgprot_t, pgprot_val
#include "linux/capability.h"     // for capable, CAP_SYS_ADMIN
#include "linux/mm_types.h"       // for mm_struct, mm_struct::(anonymous)
#include "linux/personality.h"    // for ADDR_COMPAT_LAYOUT
#include "linux/resource.h"       // for rlimit
#include "linux/sched.h"          // for task_struct, PF_RANDOMIZE
#include "linux/stddef.h"         // for true, false
#include "linux/types.h"          // for phys_addr_t, bool

arch/x86/mm/mmap.c should remove these lines:
- #include <linux/compat.h>  // lines 20-20
- #include <linux/limits.h>  // lines 17-17
- #include <linux/personality.h>  // lines 14-14
- #include <linux/sched/signal.h>  // lines 18-18

The full include-list for arch/x86/mm/mmap.c:
#include <asm/cpufeatures.h>      // for REQUIRED_MASK0, REQUIRED_MASK1, REQ...
#include <asm/elf.h>              // for mmap_is_ia32, __STACK_RND_MASK, get...
#include <asm/io.h>               // for valid_mmap_phys_addr_range, valid_p...
#include <asm/page_types.h>       // for DEFAULT_MAP_WINDOW, IA32_PAGE_OFFSET
#include <linux/elf-randomize.h>  // for arch_mmap_rnd
#include <linux/mm.h>             // for l1tf_pfn_limit, mmap_rnd_bits, PAGE...
#include <linux/random.h>         // for get_random_long
#include <linux/sched/mm.h>       // for arch_get_unmapped_area, arch_get_un...
#include <stddef.h>               // for size_t, NULL
#include "asm/cache.h"            // for __read_mostly
#include "asm/cpufeature.h"       // for boot_cpu_has_bug
#include "asm/cpufeatures.h"      // for X86_BUG_L1TF
#include "asm/current.h"          // for current
#include "asm/page.h"             // for __pa
#include "asm/page_32.h"          // for pfn_valid
#include "asm/page_types.h"       // for PAGE_SHIFT
#include "asm/pgtable-2level.h"   // for __pte_needs_invert
#include "asm/pgtable.h"          // for pfn_modify_allowed
#include "asm/pgtable_types.h"    // for pgprot_t, pgprot_val
#include "linux/capability.h"     // for capable, CAP_SYS_ADMIN
#include "linux/mm_types.h"       // for mm_struct, mm_struct::(anonymous)
#include "linux/personality.h"    // for ADDR_COMPAT_LAYOUT
#include "linux/resource.h"       // for rlimit
#include "linux/sched.h"          // for task_struct, PF_RANDOMIZE
#include "linux/stddef.h"         // for true, false
#include "linux/types.h"          // for phys_addr_t, bool
#include "physaddr.h"             // for phys_addr_valid
---
  ./scripts/check-local-export arch/x86/mm/mmap.o
  iwyu2 -Wp,-MMD,arch/x86/mm/.pgtable.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/mm/pgtable"' -DKBUILD_BASENAME='"pgtable"' -DKBUILD_MODNAME='"pgtable"' -D__KBUILD_MODNAME=kmod_pgtable -c -o arch/x86/mm/pgtable.o arch/x86/mm/pgtable.c  
In file included from arch/x86/mm/pgtable.c:4:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from arch/x86/mm/pgtable.c:6:
In file included from ./arch/x86/include/asm/tlb.h:8:
In file included from ./include/asm-generic/tlb.h:15:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/mm/pgtable.c:6:
In file included from ./arch/x86/include/asm/tlb.h:8:
In file included from ./include/asm-generic/tlb.h:15:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/mm/pgtable.c:6:
In file included from ./arch/x86/include/asm/tlb.h:8:
In file included from ./include/asm-generic/tlb.h:15:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from arch/x86/mm/pgtable.c:4:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from arch/x86/mm/pgtable.c:6:
In file included from ./arch/x86/include/asm/tlb.h:8:
In file included from ./include/asm-generic/tlb.h:15:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/mm/pgtable.c:6:
In file included from ./arch/x86/include/asm/tlb.h:8:
In file included from ./include/asm-generic/tlb.h:15:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/mm/pgtable.c:6:
In file included from ./arch/x86/include/asm/tlb.h:8:
In file included from ./include/asm-generic/tlb.h:15:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/mm/pgtable.c should add these lines:
#include <asm-generic/pgtable-nopmd.h>               // for pud_offset, pud_t
#include <asm-generic/pgtable-nopud.h>               // for p4d_offset, pgd_...
#include <asm/bug.h>                                 // for BUG_ON
#include <asm/pgtable.h>                             // for swapper_pg_dir
#include <linux/pgtable.h>                           // for KERNEL_PGD_BOUNDARY
#include <stddef.h>                                  // for NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for test_and_clear_bit
#include "asm-generic/errno-base.h"                  // for EINVAL, ENOMEM
#include "asm-generic/memory_model.h"                // for page_to_pfn
#include "asm-generic/pgtable-nopmd.h"               // for pmd_t, pmd_free
#include "asm/bug.h"                                 // for BUG
#include "asm/page.h"                                // for virt_to_page
#include "asm/page_types.h"                          // for PAGE_SHIFT, PAGE...
#include "asm/pgtable-2level_types.h"                // for pte_t, SHARED_KE...
#include "asm/pgtable_types.h"                       // for pgd_t, set_pte_v...
#include "asm/string_32.h"                           // for strcmp, memcpy
#include "generated/autoconf.h"                      // for CONFIG_PGTABLE_L...
#include "linux/compiler_types.h"                    // for inline
#include "linux/init.h"                              // for __init, early_param
#include "linux/kern_levels.h"                       // for KERN_INFO
#include "linux/list.h"                              // for list_add, list_del
#include "linux/math.h"                              // for round_down
#include "linux/minmax.h"                            // for max_t
#include "linux/mm_types.h"                          // for page, page::(ano...
#include "linux/printk.h"                            // for printk
#include "linux/spinlock.h"                          // for spin_lock, spin_...
#include "linux/stddef.h"                            // for true, false
#include "linux/types.h"                             // for gfp_t, bool, phy...

arch/x86/mm/pgtable.c should remove these lines:
- #include <asm/mtrr.h>  // lines 8-8
- #include <linux/hugetlb.h>  // lines 4-4

The full include-list for arch/x86/mm/pgtable.c:
#include <asm-generic/pgtable-nopmd.h>               // for pud_offset, pud_t
#include <asm-generic/pgtable-nopud.h>               // for p4d_offset, pgd_...
#include <asm/bug.h>                                 // for BUG_ON
#include <asm/fixmap.h>                              // for __FIXADDR_TOP
#include <asm/pgalloc.h>                             // for GFP_PGTABLE_USER
#include <asm/pgtable.h>                             // for swapper_pg_dir
#include <asm/tlb.h>                                 // for tlb_remove_page
#include <linux/gfp.h>                               // for __get_free_pages
#include <linux/mm.h>                                // for mm_dec_nr_pmds
#include <linux/pgtable.h>                           // for KERNEL_PGD_BOUNDARY
#include <stddef.h>                                  // for NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for test_and_clear_bit
#include "asm-generic/errno-base.h"                  // for EINVAL, ENOMEM
#include "asm-generic/memory_model.h"                // for page_to_pfn
#include "asm-generic/pgtable-nopmd.h"               // for pmd_t, pmd_free
#include "asm/bug.h"                                 // for BUG
#include "asm/page.h"                                // for virt_to_page
#include "asm/page_types.h"                          // for PAGE_SHIFT, PAGE...
#include "asm/pgtable-2level_types.h"                // for pte_t, SHARED_KE...
#include "asm/pgtable_types.h"                       // for pgd_t, set_pte_v...
#include "asm/string_32.h"                           // for strcmp, memcpy
#include "generated/autoconf.h"                      // for CONFIG_PGTABLE_L...
#include "linux/compiler_types.h"                    // for inline
#include "linux/init.h"                              // for __init, early_param
#include "linux/kern_levels.h"                       // for KERN_INFO
#include "linux/list.h"                              // for list_add, list_del
#include "linux/math.h"                              // for round_down
#include "linux/minmax.h"                            // for max_t
#include "linux/mm_types.h"                          // for page, page::(ano...
#include "linux/printk.h"                            // for printk
#include "linux/spinlock.h"                          // for spin_lock, spin_...
#include "linux/stddef.h"                            // for true, false
#include "linux/types.h"                             // for gfp_t, bool, phy...
---
  ./scripts/check-local-export arch/x86/mm/pgtable.o
  iwyu2 -Wp,-MMD,arch/x86/mm/.physaddr.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -fno-stack-protector    -DKBUILD_MODFILE='"arch/x86/mm/physaddr"' -DKBUILD_BASENAME='"physaddr"' -DKBUILD_MODNAME='"physaddr"' -D__KBUILD_MODNAME=kmod_physaddr -c -o arch/x86/mm/physaddr.o arch/x86/mm/physaddr.c  

arch/x86/mm/physaddr.h should add these lines:
#include "linux/compiler_types.h"  // for inline
#include "linux/types.h"           // for resource_size_t

arch/x86/mm/physaddr.h should remove these lines:
- #include <asm/processor.h>  // lines 2-2

The full include-list for arch/x86/mm/physaddr.h:
#include "linux/compiler_types.h"  // for inline
#include "linux/types.h"           // for resource_size_t
---

arch/x86/mm/physaddr.c should add these lines:
#include "asm/fixmap.h"            // for FIXADDR_START
#include "asm/page_32.h"           // for pfn_valid
#include "asm/page_types.h"        // for PAGE_OFFSET, PAGE_SHIFT
#include "asm/pgtable_32_areas.h"  // for __vmalloc_start_set
#include "linux/stddef.h"          // for false

arch/x86/mm/physaddr.c should remove these lines:
- #include <linux/memblock.h>  // lines 2-2
- #include <linux/mmdebug.h>  // lines 3-3
- #include <linux/vmalloc.h>  // lines 8-8

The full include-list for arch/x86/mm/physaddr.c:
#include "physaddr.h"
#include <asm/page.h>              // for __virt_addr_valid
#include <linux/export.h>          // for EXPORT_SYMBOL
#include <linux/mm.h>              // for is_vmalloc_addr
#include "asm/fixmap.h"            // for FIXADDR_START
#include "asm/page_32.h"           // for pfn_valid
#include "asm/page_types.h"        // for PAGE_OFFSET, PAGE_SHIFT
#include "asm/pgtable_32_areas.h"  // for __vmalloc_start_set
#include "linux/stddef.h"          // for false
---
  ./scripts/check-local-export arch/x86/mm/physaddr.o
  iwyu2 -Wp,-MMD,arch/x86/mm/.tlb.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/mm/tlb"' -DKBUILD_BASENAME='"tlb"' -DKBUILD_MODNAME='"tlb"' -D__KBUILD_MODNAME=kmod_tlb -c -o arch/x86/mm/tlb.o arch/x86/mm/tlb.c  
In file included from arch/x86/mm/tlb.c:9:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/mm/tlb.c:9:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/mm/tlb.c:9:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/mm/tlb.c:9:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/mm/tlb.c:9:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/mm/tlb.c:9:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/mm/tlb.c should add these lines:
#include <asm-generic/percpu.h>                // for this_cpu_read, this_cp...
#include <asm/barrier.h>                       // for smp_mb
#include <asm/bitops.h>                        // for __set_bit
#include <asm/bug.h>                           // for WARN_ON_ONCE, WARN_ON
#include <asm/cpufeatures.h>                   // for REQUIRED_MASK0, REQUIR...
#include <asm/percpu.h>                        // for this_cpu_read_8, this_...
#include <asm/signal.h>                        // for SIGBUS
#include <cstdio>                              // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"            // for EINVAL, EFAULT
#include "asm-generic/int-ll64.h"              // for u16, u64, u32
#include "asm/atomic64_32.h"                   // for ATOMIC64_INIT, atomic64_t
#include "asm/cpufeature.h"                    // for static_cpu_has, boot_c...
#include "asm/cpufeatures.h"                   // for X86_FEATURE_PCID, X86_...
#include "asm/current.h"                       // for current
#include "asm/hardirq.h"                       // for (anonymous), inc_irq_stat
#include "asm/invpcid.h"                       // for invpcid_flush_all, inv...
#include "asm/mem_encrypt.h"                   // for __sme_pa
#include "asm/mmu.h"                           // for mm_context_t, leave_mm
#include "asm/msr-index.h"                     // for L1D_FLUSH, MSR_IA32_FL...
#include "asm/msr.h"                           // for wrmsrl
#include "asm/page.h"                          // for __pa, __va
#include "asm/page_types.h"                    // for PAGE_SHIFT, PAGE_SIZE
#include "asm/percpu.h"                        // for __pcpu_op2_1, __pcpu_o...
#include "asm/pgtable_types.h"                 // for pgd_t
#include "asm/processor-flags.h"               // for X86_CR3_PCID_BITS, X86...
#include "asm/processor.h"                     // for cpuinfo_x86, read_cr3_pa
#include "asm/special_insns.h"                 // for __read_cr3, write_cr3
#include "asm/thread_info.h"                   // for TIF_SPEC_IB, TIF_SPEC_...
#include "asm/tlbbatch.h"                      // for arch_tlbflush_unmap_batch
#include "linux/atomic/atomic-instrumented.h"  // for atomic64_read, atomic_...
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/compiler.h"                    // for unlikely, barrier, likely
#include "linux/compiler_types.h"              // for inline, __user
#include "linux/cpumask.h"                     // for cpumask_test_cpu, cpum...
#include "linux/fs.h"                          // for default_llseek, simple...
#include "linux/irqflags.h"                    // for irqs_disabled, local_i...
#include "linux/jump_label.h"                  // for static_branch_unlikely
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/kernel.h"                      // for sprintf
#include "linux/kstrtox.h"                     // for kstrtoint
#include "linux/lockdep.h"                     // for lockdep_assert_irqs_en...
#include "linux/minmax.h"                      // for min
#include "linux/mm_types.h"                    // for mm_struct, mm_struct::...
#include "linux/mmdebug.h"                     // for VM_WARN_ON_ONCE, VM_WA...
#include "linux/preempt.h"                     // for preemptible, in_nmi
#include "linux/sched.h"                       // for task_struct
#include "linux/sched/signal.h"                // for force_sig
#include "linux/stat.h"                        // for S_IRUSR, S_IWUSR
#include "linux/stddef.h"                      // for true, false
#include "linux/thread_info.h"                 // for clear_ti_thread_flag
#include "linux/types.h"                       // for bool, loff_t, callback...
#include "linux/uaccess.h"                     // for copy_from_user
#include "linux/vmstat.h"                      // for count_vm_tlb_event
#include "trace/events/tlb.h"                  // for trace_tlb_flush

arch/x86/mm/tlb.c should remove these lines:
- #include <asm/apic.h>  // lines 19-19
- #include <asm/cacheflush.h>  // lines 18-18
- #include <linux/cpu.h>  // lines 9-9
- #include <linux/interrupt.h>  // lines 7-7
- #include <linux/mm.h>  // lines 4-4
- #include <linux/sched/smt.h>  // lines 11-11
- #include <linux/spinlock.h>  // lines 5-5
- #include "mm_internal.h"  // lines 22-22

The full include-list for arch/x86/mm/tlb.c:
#include <asm-generic/percpu.h>                // for this_cpu_read, this_cp...
#include <asm/barrier.h>                       // for smp_mb
#include <asm/bitops.h>                        // for __set_bit
#include <asm/bug.h>                           // for WARN_ON_ONCE, WARN_ON
#include <asm/cache.h>                         // for __read_mostly
#include <asm/cpufeatures.h>                   // for REQUIRED_MASK0, REQUIR...
#include <asm/mmu_context.h>                   // for rdpmc_always_available...
#include <asm/nospec-branch.h>                 // for indirect_branch_predic...
#include <asm/percpu.h>                        // for this_cpu_read_8, this_...
#include <asm/perf_event.h>                    // for perf_clear_dirty_counters
#include <asm/signal.h>                        // for SIGBUS
#include <asm/tlbflush.h>                      // for cpu_tlbstate, tlb_state
#include <linux/debugfs.h>                     // for debugfs_create_file
#include <linux/export.h>                      // for EXPORT_SYMBOL_GPL
#include <linux/init.h>                        // for __init, late_initcall
#include <linux/smp.h>                         // for on_each_cpu, on_each_c...
#include <linux/task_work.h>                   // for task_work_add, TWA_RESUME
#include <cstdio>                              // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"            // for EINVAL, EFAULT
#include "asm-generic/int-ll64.h"              // for u16, u64, u32
#include "asm/atomic64_32.h"                   // for ATOMIC64_INIT, atomic64_t
#include "asm/cpufeature.h"                    // for static_cpu_has, boot_c...
#include "asm/cpufeatures.h"                   // for X86_FEATURE_PCID, X86_...
#include "asm/current.h"                       // for current
#include "asm/hardirq.h"                       // for (anonymous), inc_irq_stat
#include "asm/invpcid.h"                       // for invpcid_flush_all, inv...
#include "asm/mem_encrypt.h"                   // for __sme_pa
#include "asm/mmu.h"                           // for mm_context_t, leave_mm
#include "asm/msr-index.h"                     // for L1D_FLUSH, MSR_IA32_FL...
#include "asm/msr.h"                           // for wrmsrl
#include "asm/page.h"                          // for __pa, __va
#include "asm/page_types.h"                    // for PAGE_SHIFT, PAGE_SIZE
#include "asm/percpu.h"                        // for __pcpu_op2_1, __pcpu_o...
#include "asm/pgtable_types.h"                 // for pgd_t
#include "asm/processor-flags.h"               // for X86_CR3_PCID_BITS, X86...
#include "asm/processor.h"                     // for cpuinfo_x86, read_cr3_pa
#include "asm/special_insns.h"                 // for __read_cr3, write_cr3
#include "asm/thread_info.h"                   // for TIF_SPEC_IB, TIF_SPEC_...
#include "asm/tlbbatch.h"                      // for arch_tlbflush_unmap_batch
#include "linux/atomic/atomic-instrumented.h"  // for atomic64_read, atomic_...
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/compiler.h"                    // for unlikely, barrier, likely
#include "linux/compiler_types.h"              // for inline, __user
#include "linux/cpumask.h"                     // for cpumask_test_cpu, cpum...
#include "linux/fs.h"                          // for default_llseek, simple...
#include "linux/irqflags.h"                    // for irqs_disabled, local_i...
#include "linux/jump_label.h"                  // for static_branch_unlikely
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/kernel.h"                      // for sprintf
#include "linux/kstrtox.h"                     // for kstrtoint
#include "linux/lockdep.h"                     // for lockdep_assert_irqs_en...
#include "linux/minmax.h"                      // for min
#include "linux/mm_types.h"                    // for mm_struct, mm_struct::...
#include "linux/mmdebug.h"                     // for VM_WARN_ON_ONCE, VM_WA...
#include "linux/preempt.h"                     // for preemptible, in_nmi
#include "linux/sched.h"                       // for task_struct
#include "linux/sched/signal.h"                // for force_sig
#include "linux/stat.h"                        // for S_IRUSR, S_IWUSR
#include "linux/stddef.h"                      // for true, false
#include "linux/thread_info.h"                 // for clear_ti_thread_flag
#include "linux/types.h"                       // for bool, loff_t, callback...
#include "linux/uaccess.h"                     // for copy_from_user
#include "linux/vmstat.h"                      // for count_vm_tlb_event
#include "trace/events/tlb.h"                  // for trace_tlb_flush
---
  ./scripts/check-local-export arch/x86/mm/tlb.o
  iwyu2 -Wp,-MMD,arch/x86/mm/.cpu_entry_area.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/mm/cpu_entry_area"' -DKBUILD_BASENAME='"cpu_entry_area"' -DKBUILD_MODNAME='"cpu_entry_area"' -D__KBUILD_MODNAME=kmod_cpu_entry_area -c -o arch/x86/mm/cpu_entry_area.o arch/x86/mm/cpu_entry_area.c  

arch/x86/mm/cpu_entry_area.c should add these lines:
#include <asm-generic/percpu.h>         // for per_cpu, DECLARE_PER_CPU_PAGE...
#include <asm/bug.h>                    // for BUG_ON
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/pgtable.h>                // for sync_initial_page_table
#include "asm-generic/pgtable-nopmd.h"  // for PMD_MASK, PMD_SIZE
#include "asm/cpufeature.h"             // for boot_cpu_has
#include "asm/cpufeatures.h"            // for X86_FEATURE_PGE, X86_FEATURE_...
#include "asm/intel_ds.h"               // for cpu_debug_store, debug_store
#include "asm/page_types.h"             // for PAGE_SIZE, PAGE_MASK, PAGE_SHIFT
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable.h"                // for pfn_pte, populate_extra_pte
#include "asm/pgtable_32_areas.h"       // for CPU_ENTRY_AREA_BASE, CPU_ENTR...
#include "asm/pgtable_types.h"          // for PAGE_KERNEL, pgprot_t, set_pt...
#include "asm/processor.h"              // for tss_struct, cpu_tss_rw, x86_h...
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/compiler_types.h"       // for inline, noinstr
#include "linux/cpumask.h"              // for for_each_possible_cpu
#include "linux/export.h"               // for EXPORT_SYMBOL
#include "linux/init.h"                 // for __init
#include "linux/stddef.h"               // for offsetof, offsetofend
#include "linux/types.h"                // for phys_addr_t

arch/x86/mm/cpu_entry_area.c should remove these lines:
- #include <asm/fixmap.h>  // lines 10-10
- #include <linux/kallsyms.h>  // lines 5-5
- #include <linux/pgtable.h>  // lines 7-7
- #include <linux/spinlock.h>  // lines 3-3

The full include-list for arch/x86/mm/cpu_entry_area.c:
#include <asm-generic/percpu.h>         // for per_cpu, DECLARE_PER_CPU_PAGE...
#include <asm/bug.h>                    // for BUG_ON
#include <asm/cpu_entry_area.h>         // for cpu_entry_area, CPU_ENTRY_ARE...
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/desc.h>                   // for get_cpu_gdt_paddr
#include <asm/pgtable.h>                // for sync_initial_page_table
#include <linux/percpu.h>               // for per_cpu_ptr_to_phys
#include "asm-generic/pgtable-nopmd.h"  // for PMD_MASK, PMD_SIZE
#include "asm/cpufeature.h"             // for boot_cpu_has
#include "asm/cpufeatures.h"            // for X86_FEATURE_PGE, X86_FEATURE_...
#include "asm/intel_ds.h"               // for cpu_debug_store, debug_store
#include "asm/page_types.h"             // for PAGE_SIZE, PAGE_MASK, PAGE_SHIFT
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable.h"                // for pfn_pte, populate_extra_pte
#include "asm/pgtable_32_areas.h"       // for CPU_ENTRY_AREA_BASE, CPU_ENTR...
#include "asm/pgtable_types.h"          // for PAGE_KERNEL, pgprot_t, set_pt...
#include "asm/processor.h"              // for tss_struct, cpu_tss_rw, x86_h...
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/compiler_types.h"       // for inline, noinstr
#include "linux/cpumask.h"              // for for_each_possible_cpu
#include "linux/export.h"               // for EXPORT_SYMBOL
#include "linux/init.h"                 // for __init
#include "linux/stddef.h"               // for offsetof, offsetofend
#include "linux/types.h"                // for phys_addr_t
---
  ./scripts/check-local-export arch/x86/mm/cpu_entry_area.o
  iwyu2 -Wp,-MMD,arch/x86/mm/.maccess.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/mm/maccess"' -DKBUILD_BASENAME='"maccess"' -DKBUILD_MODNAME='"maccess"' -D__KBUILD_MODNAME=kmod_maccess -c -o arch/x86/mm/maccess.o arch/x86/mm/maccess.c  

arch/x86/mm/maccess.c should add these lines:
#include <asm/page_types.h>  // for TASK_SIZE_MAX
#include <stddef.h>          // for size_t
#include "linux/types.h"     // for bool

arch/x86/mm/maccess.c should remove these lines:
- #include <linux/kernel.h>  // lines 4-4

The full include-list for arch/x86/mm/maccess.c:
#include <asm/page_types.h>  // for TASK_SIZE_MAX
#include <linux/uaccess.h>   // for copy_from_kernel_nofault_allowed
#include <stddef.h>          // for size_t
#include "linux/types.h"     // for bool
---
  ./scripts/check-local-export arch/x86/mm/maccess.o
  iwyu2 -Wp,-MMD,arch/x86/mm/.pgprot.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/mm/pgprot"' -DKBUILD_BASENAME='"pgprot"' -DKBUILD_MODNAME='"pgprot"' -D__KBUILD_MODNAME=kmod_pgprot -c -o arch/x86/mm/pgprot.o arch/x86/mm/pgprot.c  

arch/x86/mm/pgprot.c should add these lines:
#include "asm/pgtable_types.h"  // for pgprot_t, _PAGE_PRESENT, __pgprot
#include "linux/mem_encrypt.h"  // for __sme_set

arch/x86/mm/pgprot.c should remove these lines:
- #include <asm/pgtable.h>  // lines 5-5

The full include-list for arch/x86/mm/pgprot.c:
#include <linux/export.h>       // for EXPORT_SYMBOL
#include <linux/mm.h>           // for VM_EXEC, VM_READ, VM_SHARED, VM_WRITE
#include "asm/pgtable_types.h"  // for pgprot_t, _PAGE_PRESENT, __pgprot
#include "linux/mem_encrypt.h"  // for __sme_set
---
  ./scripts/check-local-export arch/x86/mm/pgprot.o
  iwyu2 -Wp,-MMD,arch/x86/mm/.pgtable_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/mm/pgtable_32"' -DKBUILD_BASENAME='"pgtable_32"' -DKBUILD_MODNAME='"pgtable_32"' -D__KBUILD_MODNAME=kmod_pgtable_32 -c -o arch/x86/mm/pgtable_32.o arch/x86/mm/pgtable_32.c  
In file included from arch/x86/mm/pgtable_32.c:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from arch/x86/mm/pgtable_32.c:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/mm/pgtable_32.c:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/mm/pgtable_32.c:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from arch/x86/mm/pgtable_32.c:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from arch/x86/mm/pgtable_32.c:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/mm/pgtable_32.c:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/mm/pgtable_32.c:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/mm/pgtable_32.c should add these lines:
#include <asm/pgtable.h>                // for swapper_pg_dir
#include "asm-generic/early_ioremap.h"  // for early_ioremap_init
#include "asm-generic/errno-base.h"     // for EINVAL
#include "asm-generic/pgtable-nop4d.h"  // for p4d_offset, pgd_none, p4d_t
#include "asm-generic/pgtable-nopmd.h"  // for pud_none, pmd_offset, pmd_t
#include "asm-generic/pgtable-nopud.h"  // for p4d_none, pud_offset, pud_t
#include "asm/bug.h"                    // for BUG
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable.h"                // for pmd_none, pte_none, set_pte_at
#include "asm/pgtable_32_areas.h"       // for VMALLOC_OFFSET
#include "asm/pgtable_types.h"          // for pgd_t, set_pte_vaddr
#include "linux/export.h"               // for EXPORT_SYMBOL
#include "linux/init.h"                 // for __init, early_param
#include "linux/mm_types.h"             // for init_mm
#include "linux/pgtable.h"              // for pgd_index, pte_offset_kernel

arch/x86/mm/pgtable_32.c should remove these lines:
- #include <asm/cpu_entry_area.h>  // lines 13-13
- #include <asm/e820/api.h>  // lines 15-15
- #include <asm/io.h>  // lines 18-18
- #include <asm/tlb.h>  // lines 16-16
- #include <linux/errno.h>  // lines 4-4
- #include <linux/highmem.h>  // lines 9-9
- #include <linux/mm.h>  // lines 5-5
- #include <linux/nmi.h>  // lines 6-6
- #include <linux/pagemap.h>  // lines 10-10
- #include <linux/sched.h>  // lines 2-2
- #include <linux/smp.h>  // lines 8-8
- #include <linux/spinlock.h>  // lines 11-11
- #include <linux/swap.h>  // lines 7-7
- #include <linux/vmalloc.h>  // lines 19-19

The full include-list for arch/x86/mm/pgtable_32.c:
#include <asm/fixmap.h>                 // for reserve_top_address
#include <asm/pgtable.h>                // for swapper_pg_dir
#include <asm/tlbflush.h>               // for flush_tlb_one_kernel
#include <linux/kernel.h>               // for memparse
#include "asm-generic/early_ioremap.h"  // for early_ioremap_init
#include "asm-generic/errno-base.h"     // for EINVAL
#include "asm-generic/pgtable-nop4d.h"  // for p4d_offset, pgd_none, p4d_t
#include "asm-generic/pgtable-nopmd.h"  // for pud_none, pmd_offset, pmd_t
#include "asm-generic/pgtable-nopud.h"  // for p4d_none, pud_offset, pud_t
#include "asm/bug.h"                    // for BUG
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable.h"                // for pmd_none, pte_none, set_pte_at
#include "asm/pgtable_32_areas.h"       // for VMALLOC_OFFSET
#include "asm/pgtable_types.h"          // for pgd_t, set_pte_vaddr
#include "linux/export.h"               // for EXPORT_SYMBOL
#include "linux/init.h"                 // for __init, early_param
#include "linux/mm_types.h"             // for init_mm
#include "linux/pgtable.h"              // for pgd_index, pte_offset_kernel
---
  ./scripts/check-local-export arch/x86/mm/pgtable_32.o
  iwyu2 -Wp,-MMD,arch/x86/mm/.iomap_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/mm/iomap_32"' -DKBUILD_BASENAME='"iomap_32"' -DKBUILD_MODNAME='"iomap_32"' -D__KBUILD_MODNAME=kmod_iomap_32 -c -o arch/x86/mm/iomap_32.o arch/x86/mm/iomap_32.c  

arch/x86/mm/iomap_32.c should add these lines:
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm/pgtable_types.h"       // for cachemode2protval, _PAGE_CACHE_M...
#include "linux/compiler_types.h"    // for __iomem, __force
#include "linux/highmem-internal.h"  // for __kmap_local_pfn_prot
#include "linux/types.h"             // for resource_size_t

arch/x86/mm/iomap_32.c should remove these lines:
- #include <linux/highmem.h>  // lines 9-9

The full include-list for arch/x86/mm/iomap_32.c:
#include <asm/iomap.h>               // for __iomap_local_pfn_prot, iomap_cr...
#include <asm/memtype.h>             // for memtype_free_io, memtype_reserve_io
#include <linux/export.h>            // for EXPORT_SYMBOL_GPL
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm/pgtable_types.h"       // for cachemode2protval, _PAGE_CACHE_M...
#include "linux/compiler_types.h"    // for __iomem, __force
#include "linux/highmem-internal.h"  // for __kmap_local_pfn_prot
#include "linux/types.h"             // for resource_size_t
---
  ./scripts/check-local-export arch/x86/mm/iomap_32.o
  rm -f arch/x86/mm/built-in.a; echo init.o init_32.o fault.o ioremap.o extable.o mmap.o pgtable.o physaddr.o tlb.o cpu_entry_area.o maccess.o pgprot.o pat/built-in.a pgtable_32.o iomap_32.o | sed -E 's:([^ ]+):arch/x86/mm/:g' | xargs llvm-ar cDPrST arch/x86/mm/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/crypto \
 \
need-builtin=1 \
need-modorder=1
  rm -f arch/x86/crypto/built-in.a; echo  | sed -E 's:([^ ]+):arch/x86/crypto/:g' | xargs llvm-ar cDPrST arch/x86/crypto/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/platform \
 \
need-builtin=1 \
need-modorder=1
make -f ./scripts/Makefile.build obj=arch/x86/platform/atom \
 \
need-builtin=1 \
need-modorder=1
  rm -f arch/x86/platform/atom/built-in.a; echo  | sed -E 's:([^ ]+):arch/x86/platform/atom/:g' | xargs llvm-ar cDPrST arch/x86/platform/atom/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/platform/ce4100 \
 \
need-builtin=1 \
need-modorder=1
  rm -f arch/x86/platform/ce4100/built-in.a; echo  | sed -E 's:([^ ]+):arch/x86/platform/ce4100/:g' | xargs llvm-ar cDPrST arch/x86/platform/ce4100/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/platform/efi \
 \
need-builtin=1 \
need-modorder=1
  rm -f arch/x86/platform/efi/built-in.a; echo  | sed -E 's:([^ ]+):arch/x86/platform/efi/:g' | xargs llvm-ar cDPrST arch/x86/platform/efi/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/platform/geode \
 \
need-builtin=1 \
need-modorder=1
  rm -f arch/x86/platform/geode/built-in.a; echo  | sed -E 's:([^ ]+):arch/x86/platform/geode/:g' | xargs llvm-ar cDPrST arch/x86/platform/geode/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/platform/iris \
 \
need-builtin=1 \
need-modorder=1
  rm -f arch/x86/platform/iris/built-in.a; echo  | sed -E 's:([^ ]+):arch/x86/platform/iris/:g' | xargs llvm-ar cDPrST arch/x86/platform/iris/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/platform/intel \
 \
need-builtin=1 \
need-modorder=1
  rm -f arch/x86/platform/intel/built-in.a; echo  | sed -E 's:([^ ]+):arch/x86/platform/intel/:g' | xargs llvm-ar cDPrST arch/x86/platform/intel/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/platform/intel-mid \
 \
need-builtin=1 \
need-modorder=1
  rm -f arch/x86/platform/intel-mid/built-in.a; echo  | sed -E 's:([^ ]+):arch/x86/platform/intel-mid/:g' | xargs llvm-ar cDPrST arch/x86/platform/intel-mid/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/platform/intel-quark \
 \
need-builtin=1 \
need-modorder=1
  rm -f arch/x86/platform/intel-quark/built-in.a; echo  | sed -E 's:([^ ]+):arch/x86/platform/intel-quark/:g' | xargs llvm-ar cDPrST arch/x86/platform/intel-quark/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/platform/olpc \
 \
need-builtin=1 \
need-modorder=1
  rm -f arch/x86/platform/olpc/built-in.a; echo  | sed -E 's:([^ ]+):arch/x86/platform/olpc/:g' | xargs llvm-ar cDPrST arch/x86/platform/olpc/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/platform/scx200 \
 \
need-builtin=1 \
need-modorder=1
  rm -f arch/x86/platform/scx200/built-in.a; echo  | sed -E 's:([^ ]+):arch/x86/platform/scx200/:g' | xargs llvm-ar cDPrST arch/x86/platform/scx200/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/platform/ts5500 \
 \
need-builtin=1 \
need-modorder=1
  rm -f arch/x86/platform/ts5500/built-in.a; echo  | sed -E 's:([^ ]+):arch/x86/platform/ts5500/:g' | xargs llvm-ar cDPrST arch/x86/platform/ts5500/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/platform/uv \
 \
need-builtin=1 \
need-modorder=1
  rm -f arch/x86/platform/uv/built-in.a; echo  | sed -E 's:([^ ]+):arch/x86/platform/uv/:g' | xargs llvm-ar cDPrST arch/x86/platform/uv/built-in.a
  rm -f arch/x86/platform/built-in.a; echo atom/built-in.a ce4100/built-in.a efi/built-in.a geode/built-in.a iris/built-in.a intel/built-in.a intel-mid/built-in.a intel-quark/built-in.a olpc/built-in.a scx200/built-in.a ts5500/built-in.a uv/built-in.a | sed -E 's:([^ ]+):arch/x86/platform/:g' | xargs llvm-ar cDPrST arch/x86/platform/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/net \
 \
need-builtin=1 \
need-modorder=1
  rm -f arch/x86/net/built-in.a; echo  | sed -E 's:([^ ]+):arch/x86/net/:g' | xargs llvm-ar cDPrST arch/x86/net/built-in.a
  rm -f arch/x86/built-in.a; echo entry/built-in.a events/built-in.a realmode/built-in.a kernel/built-in.a mm/built-in.a crypto/built-in.a platform/built-in.a net/built-in.a | sed -E 's:([^ ]+):arch/x86/:g' | xargs llvm-ar cDPrST arch/x86/built-in.a
make -f ./scripts/Makefile.build obj=kernel \
single-build= \
need-builtin=1 need-modorder=1
make -f ./scripts/Makefile.build obj=kernel/sched \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,kernel/sched/.core.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -Wno-unused-but-set-variable -fno-omit-frame-pointer    -DKBUILD_MODFILE='"kernel/sched/core"' -DKBUILD_BASENAME='"core"' -DKBUILD_MODNAME='"core"' -D__KBUILD_MODNAME=kmod_core -c -o kernel/sched/core.o kernel/sched/core.c  
In file included from kernel/sched/core.c:40:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from kernel/sched/core.c:43:
./include/linux/delayacct.h:27:44: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline int delayacct_add_tsk(struct taskstats *d,
                                           ^
In file included from kernel/sched/core.c:44:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from kernel/sched/core.c:63:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from kernel/sched/core.c:40:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from kernel/sched/core.c:43:
./include/linux/delayacct.h:27:44: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline int delayacct_add_tsk(struct taskstats *d,
                                           ^
In file included from kernel/sched/core.c:44:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from kernel/sched/core.c:63:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/sched/core.c should add these lines:
#include <asm-generic/percpu.h>                // for DECLARE_PER_CPU, DEFIN...
#include <asm/barrier.h>                       // for smp_rmb, smp_mb__befor...
#include <asm/bug.h>                           // for WARN_ON_ONCE, BUG_ON
#include <linux/linkage.h>                     // for asmlinkage, notrace
#include <linux/preempt.h>                     // for preempt_count, should_...
#include <linux/rcupdate.h>                    // for rcu_all_qs, rcu_note_c...
#include <linux/spinlock.h>                    // for in_lock_functions, rea...
#include <linux/spinlock_types.h>              // for rwlock_t
#include <ctime>                               // for pid_t, NULL
#include "asm-generic/errno-base.h"            // for EINVAL, EPERM, ESRCH
#include "asm-generic/errno.h"                 // for EOPNOTSUPP
#include "asm-generic/int-ll64.h"              // for __u32, u64, s64, u32
#include "asm-generic/resource.h"              // for RLIMIT_NICE, RLIMIT_RT...
#include "asm-generic/rwonce.h"                // for READ_ONCE, WRITE_ONCE
#include "asm/bug.h"                           // for BUG
#include "asm/cache.h"                         // for __read_mostly
#include "asm/current.h"                       // for current
#include "asm/mmu_context.h"                   // for enter_lazy_tlb, switch...
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/processor.h"                     // for prefetch, __get_wchan
#include "asm/ptrace.h"                        // for pt_regs
#include "asm/string_32.h"                     // for memset
#include "asm/topology.h"                      // for arch_scale_freq_tick
#include "asm/uaccess.h"                       // for put_user, access_ok
#include "asm/unistd.h"                        // for __ARCH_WANT_SYS_NICE
#include "asm/vdso/processor.h"                // for cpu_relax
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec, atomic_inc
#include "linux/bits.h"                        // for BITS_PER_BYTE
#include "linux/capability.h"                  // for CAP_SYS_NICE
#include "linux/compiler.h"                    // for unlikely, likely, barrier
#include "linux/compiler_attributes.h"         // for __visible, __always_in...
#include "linux/compiler_types.h"              // for inline, __user, __acqu...
#include "linux/container_of.h"                // for container_of
#include "linux/context_tracking_state.h"      // for CONTEXT_USER, ctx_state
#include "linux/cpumask.h"                     // for cpumask_size, alloc_cp...
#include "linux/cred.h"                        // for cred, __task_cred, cur...
#include "linux/export.h"                      // for EXPORT_SYMBOL, EXPORT_...
#include "linux/ftrace.h"                      // for ftrace_graph_init_idle...
#include "linux/gfp.h"                         // for GFP_KERNEL, GFP_NOWAIT
#include "linux/highmem-internal.h"            // for __kmap_local_sched_in
#include "linux/init.h"                        // for __init
#include "linux/instruction_pointer.h"         // for _THIS_IP_
#include "linux/irqflags.h"                    // for irqs_disabled, local_i...
#include "linux/jump_label.h"                  // for DEFINE_STATIC_KEY_FALSE
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/kern_levels.h"                 // for KERN_INFO, KERN_ERR
#include "linux/kernel_stat.h"                 // for kernel_cpustat, kernel...
#include "linux/kthread.h"                     // for kthread_set_per_cpu
#include "linux/list.h"                        // for INIT_LIST_HEAD
#include "linux/lockdep.h"                     // for print_irqtrace_events
#include "linux/math64.h"                      // for div64_u64
#include "linux/minmax.h"                      // for clamp, min, clamp_val
#include "linux/mm_types.h"                    // for init_mm
#include "linux/module.h"                      // for print_modules
#include "linux/panic.h"                       // for add_taint, panic, LOCK...
#include "linux/perf_event.h"                  // for perf_event_task_sched_in
#include "linux/pgtable.h"                     // for arch_start_context_switch
#include "linux/preempt.h"                     // for preempt_disable, preem...
#include "linux/printk.h"                      // for dump_stack, pr_cont
#include "linux/rbtree.h"                      // for RB_CLEAR_NODE
#include "linux/rcupdate.h"                    // for rcu_read_unlock, rcu_r...
#include "linux/sched.h"                       // for task_struct, task_nice
#include "linux/sched/deadline.h"              // for dl_prio, dl_task, MAX_...
#include "linux/sched/prio.h"                  // for MAX_RT_PRIO, NICE_TO_PRIO
#include "linux/sched/stat.h"                  // for nr_iowait, nr_iowait_cpu
#include "linux/sched/task.h"                  // for put_task_struct, get_t...
#include "linux/sched/task_stack.h"            // for put_task_stack, try_ge...
#include "linux/sched/topology.h"              // for arch_scale_thermal_pre...
#include "linux/security.h"                    // for security_task_getsched...
#include "linux/smp.h"                         // for smp_processor_id, smp_...
#include "linux/spinlock.h"                    // for raw_spin_lock_irqsave
#include "linux/spinlock_types.h"              // for spinlock_t
#include "linux/spinlock_types_raw.h"          // for raw_spinlock_t
#include "linux/stddef.h"                      // for true, false
#include "linux/stop_machine.h"                // for print_stop_info
#include "linux/thread_info.h"                 // for read_task_thread_flags
#include "linux/tick.h"                        // for tick_nohz_task_switch
#include "linux/time.h"                        // for put_timespec64
#include "linux/time64.h"                      // for timespec64
#include "linux/tracepoint.h"                  // for EXPORT_TRACEPOINT_SYMB...
#include "linux/types.h"                       // for list_head, bool, callb...
#include "linux/uaccess.h"                     // for copy_to_user, copy_fro...
#include "linux/uidgid.h"                      // for uid_eq
#include "linux/wait.h"                        // for wait_queue_entry_t
#include "linux/workqueue.h"                   // for print_worker_info
struct __kernel_timespec;

kernel/sched/core.c should remove these lines:
- #include <asm/tlb.h>  // lines 72-72
- #include <linux/hardirq.h>  // lines 23-23
- #include <linux/highmem.h>  // lines 9-9
- #include <linux/init_task.h>  // lines 44-44
- #include <linux/interrupt.h>  // lines 45-45
- #include <linux/ioprio.h>  // lines 46-46
- #include <linux/kprobes.h>  // lines 49-49
- #include <linux/mmu_context.h>  // lines 51-51
- #include <linux/mmzone.h>  // lines 52-52
- #include <linux/nospec.h>  // lines 55-55
- #include <linux/sched/isolation.h>  // lines 33-33
- #include <linux/sched/nohz.h>  // lines 36-36
- #include <linux/scs.h>  // lines 61-61
- #include <linux/topology.h>  // lines 26-26
- #include "../smpboot.h"  // lines 90-90
- #include "autogroup.h"  // lines 81-81
- #include "autogroup.h"  // lines 83-83
- #include "smp.h"  // lines 85-85
- #include "stats.h"  // lines 86-86

The full include-list for kernel/sched/core.c:
#include <asm-generic/percpu.h>                // for DECLARE_PER_CPU, DEFIN...
#include <asm/barrier.h>                       // for smp_rmb, smp_mb__befor...
#include <asm/bug.h>                           // for WARN_ON_ONCE, BUG_ON
#include <asm/switch_to.h>                     // for switch_to
#include <linux/blkdev.h>                      // for blk_flush_plug
#include <linux/capability.h>                  // for capable, ns_capable
#include <linux/context_tracking.h>            // for ct_state, exception_enter
#include <linux/cpuset.h>                      // for cpuset_read_unlock
#include <linux/debug_locks.h>                 // for debug_show_all_locks
#include <linux/delayacct.h>                   // for delayacct_blkio_end
#include <linux/jiffies.h>                     // for jiffies_to_timespec64
#include <linux/kallsyms.h>                    // for print_ip_sym
#include <linux/kcov.h>                        // for kcov_finish_switch
#include <linux/linkage.h>                     // for asmlinkage, notrace
#include <linux/nmi.h>                         // for touch_all_softlockup_w...
#include <linux/preempt.h>                     // for preempt_count, should_...
#include <linux/profile.h>                     // for profile_hit, SCHED_PRO...
#include <linux/psi.h>                         // for psi_init
#include <linux/rcupdate.h>                    // for rcu_all_qs, rcu_note_c...
#include <linux/sched/clock.h>                 // for sched_clock, sched_clo...
#include <linux/sched/cputime.h>               // for task_sched_runtime
#include <linux/sched/debug.h>                 // for __sched, show_stack
#include <linux/sched/init.h>                  // for sched_init, sched_init...
#include <linux/sched/loadavg.h>               // for LOAD_FREQ
#include <linux/sched/mm.h>                    // for mmgrab, membarrier_mm_...
#include <linux/sched/rt.h>                    // for rt_prio, tsk_is_pi_blo...
#include <linux/sched/signal.h>                // for task_rlimit, calculate...
#include <linux/sched/wake_q.h>                // for wake_q_head, WAKE_Q_TAIL
#include <linux/slab.h>                        // for kzalloc
#include <linux/spinlock.h>                    // for in_lock_functions, rea...
#include <linux/spinlock_types.h>              // for rwlock_t
#include <linux/syscalls.h>                    // for __MAP1, __MAP3, __MAP2
#include <linux/vtime.h>                       // for vtime_init_idle, vtime...
#include <linux/wait_bit.h>                    // for wait_bit_init
#include <trace/events/sched.h>                // for trace_sched_wakeup
#include <uapi/linux/sched/types.h>            // for sched_attr, sched_param
#include <ctime>                               // for pid_t, NULL
#include "../../fs/io-wq.h"                    // for io_wq_worker_running
#include "../workqueue_internal.h"             // for wq_worker_running, wq_...
#include "asm-generic/errno-base.h"            // for EINVAL, EPERM, ESRCH
#include "asm-generic/errno.h"                 // for EOPNOTSUPP
#include "asm-generic/int-ll64.h"              // for __u32, u64, s64, u32
#include "asm-generic/resource.h"              // for RLIMIT_NICE, RLIMIT_RT...
#include "asm-generic/rwonce.h"                // for READ_ONCE, WRITE_ONCE
#include "asm/bug.h"                           // for BUG
#include "asm/cache.h"                         // for __read_mostly
#include "asm/current.h"                       // for current
#include "asm/mmu_context.h"                   // for enter_lazy_tlb, switch...
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/processor.h"                     // for prefetch, __get_wchan
#include "asm/ptrace.h"                        // for pt_regs
#include "asm/string_32.h"                     // for memset
#include "asm/topology.h"                      // for arch_scale_freq_tick
#include "asm/uaccess.h"                       // for put_user, access_ok
#include "asm/unistd.h"                        // for __ARCH_WANT_SYS_NICE
#include "asm/vdso/processor.h"                // for cpu_relax
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec, atomic_inc
#include "linux/bits.h"                        // for BITS_PER_BYTE
#include "linux/capability.h"                  // for CAP_SYS_NICE
#include "linux/compiler.h"                    // for unlikely, likely, barrier
#include "linux/compiler_attributes.h"         // for __visible, __always_in...
#include "linux/compiler_types.h"              // for inline, __user, __acqu...
#include "linux/container_of.h"                // for container_of
#include "linux/context_tracking_state.h"      // for CONTEXT_USER, ctx_state
#include "linux/cpumask.h"                     // for cpumask_size, alloc_cp...
#include "linux/cred.h"                        // for cred, __task_cred, cur...
#include "linux/export.h"                      // for EXPORT_SYMBOL, EXPORT_...
#include "linux/ftrace.h"                      // for ftrace_graph_init_idle...
#include "linux/gfp.h"                         // for GFP_KERNEL, GFP_NOWAIT
#include "linux/highmem-internal.h"            // for __kmap_local_sched_in
#include "linux/init.h"                        // for __init
#include "linux/instruction_pointer.h"         // for _THIS_IP_
#include "linux/irqflags.h"                    // for irqs_disabled, local_i...
#include "linux/jump_label.h"                  // for DEFINE_STATIC_KEY_FALSE
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/kern_levels.h"                 // for KERN_INFO, KERN_ERR
#include "linux/kernel_stat.h"                 // for kernel_cpustat, kernel...
#include "linux/kthread.h"                     // for kthread_set_per_cpu
#include "linux/list.h"                        // for INIT_LIST_HEAD
#include "linux/lockdep.h"                     // for print_irqtrace_events
#include "linux/math64.h"                      // for div64_u64
#include "linux/minmax.h"                      // for clamp, min, clamp_val
#include "linux/mm_types.h"                    // for init_mm
#include "linux/module.h"                      // for print_modules
#include "linux/panic.h"                       // for add_taint, panic, LOCK...
#include "linux/perf_event.h"                  // for perf_event_task_sched_in
#include "linux/pgtable.h"                     // for arch_start_context_switch
#include "linux/preempt.h"                     // for preempt_disable, preem...
#include "linux/printk.h"                      // for dump_stack, pr_cont
#include "linux/rbtree.h"                      // for RB_CLEAR_NODE
#include "linux/rcupdate.h"                    // for rcu_read_unlock, rcu_r...
#include "linux/sched.h"                       // for task_struct, task_nice
#include "linux/sched/deadline.h"              // for dl_prio, dl_task, MAX_...
#include "linux/sched/prio.h"                  // for MAX_RT_PRIO, NICE_TO_PRIO
#include "linux/sched/stat.h"                  // for nr_iowait, nr_iowait_cpu
#include "linux/sched/task.h"                  // for put_task_struct, get_t...
#include "linux/sched/task_stack.h"            // for put_task_stack, try_ge...
#include "linux/sched/topology.h"              // for arch_scale_thermal_pre...
#include "linux/security.h"                    // for security_task_getsched...
#include "linux/smp.h"                         // for smp_processor_id, smp_...
#include "linux/spinlock.h"                    // for raw_spin_lock_irqsave
#include "linux/spinlock_types.h"              // for spinlock_t
#include "linux/spinlock_types_raw.h"          // for raw_spinlock_t
#include "linux/stddef.h"                      // for true, false
#include "linux/stop_machine.h"                // for print_stop_info
#include "linux/thread_info.h"                 // for read_task_thread_flags
#include "linux/tick.h"                        // for tick_nohz_task_switch
#include "linux/time.h"                        // for put_timespec64
#include "linux/time64.h"                      // for timespec64
#include "linux/tracepoint.h"                  // for EXPORT_TRACEPOINT_SYMB...
#include "linux/types.h"                       // for list_head, bool, callb...
#include "linux/uaccess.h"                     // for copy_to_user, copy_fro...
#include "linux/uidgid.h"                      // for uid_eq
#include "linux/wait.h"                        // for wait_queue_entry_t
#include "linux/workqueue.h"                   // for print_worker_info
#include "pelt.h"                              // for update_rq_clock_pelt
#include "sched.h"                             // for rq, rq_flags, sched_class
#include "stats.h"                             // for __schedstat_inc, psi_d...
struct __kernel_timespec;
---
  ./scripts/check-local-export kernel/sched/core.o
  iwyu2 -Wp,-MMD,kernel/sched/.fair.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -Wno-unused-but-set-variable    -DKBUILD_MODFILE='"kernel/sched/fair"' -DKBUILD_BASENAME='"fair"' -DKBUILD_MODNAME='"fair"' -D__KBUILD_MODNAME=kmod_fair -c -o kernel/sched/fair.o kernel/sched/fair.c  
In file included from kernel/sched/fair.c:54:
In file included from kernel/sched/sched.h:29:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
1 warning generated.
In file included from kernel/sched/fair.c:54:
In file included from kernel/sched/sched.h:29:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/sched/fair.c should add these lines:
#include <asm/barrier.h>                // for smp_wmb
#include <asm/bug.h>                    // for BUG_ON
#include <linux/bitops.h>               // for fls
#include <stddef.h>                     // for NULL
#include "asm-generic/bitsperlong.h"    // for BITS_PER_LONG
#include "asm-generic/int-ll64.h"       // for u64, s64, u32
#include "asm-generic/rwonce.h"         // for READ_ONCE, WRITE_ONCE
#include "asm/cache.h"                  // for __read_mostly
#include "asm/current.h"                // for current
#include "asm/div64.h"                  // for mul_u32_u32
#include "linux/cgroup.h"               // for cgroup_account_cputime
#include "linux/compiler.h"             // for unlikely, likely
#include "linux/compiler_attributes.h"  // for __always_inline, __maybe_unused
#include "linux/compiler_types.h"       // for inline
#include "linux/cpumask.h"              // for num_online_cpus
#include "linux/init.h"                 // for __init, __setup
#include "linux/jump_label.h"           // for static_branch_unlikely
#include "linux/kstrtox.h"              // for kstrtoint
#include "linux/log2.h"                 // for ilog2
#include "linux/math64.h"               // for mul_u64_u32_shr
#include "linux/minmax.h"               // for min_t, clamp, max_t, swap
#include "linux/printk.h"               // for pr_warn
#include "linux/rbtree.h"               // for rb_entry, rb_add_cached, rb_e...
#include "linux/rbtree_types.h"         // for rb_node (ptr only), RB_ROOT_C...
#include "linux/sched.h"                // for sched_entity, task_struct
#include "linux/sched/cpufreq.h"        // for SCHED_CPUFREQ_IOWAIT
#include "linux/sched/sysctl.h"         // for SCHED_TUNABLESCALING_LOG, SCH...
#include "linux/stddef.h"               // for true, false
#include "linux/types.h"                // for bool
#include "trace/events/sched.h"         // for trace_sched_stat_runtime
struct task_group;

kernel/sched/fair.c should remove these lines:
- #include <asm/switch_to.h>  // lines 50-50
- #include <linux/cpuidle.h>  // lines 41-41
- #include <linux/highmem.h>  // lines 28-28
- #include <linux/hugetlb_inline.h>  // lines 25-25
- #include <linux/interrupt.h>  // lines 42-42
- #include <linux/mempolicy.h>  // lines 43-43
- #include <linux/mmap_lock.h>  // lines 24-24
- #include <linux/profile.h>  // lines 45-45
- #include <linux/psi.h>  // lines 46-46
- #include <linux/ratelimit.h>  // lines 47-47
- #include <linux/sched/clock.h>  // lines 35-35
- #include <linux/sched/isolation.h>  // lines 38-38
- #include <linux/sched/nohz.h>  // lines 39-39
- #include <linux/task_work.h>  // lines 48-48
- #include <linux/topology.h>  // lines 34-34
- #include "autogroup.h"  // lines 56-56

The full include-list for kernel/sched/fair.c:
#include <asm/barrier.h>                // for smp_wmb
#include <asm/bug.h>                    // for BUG_ON
#include <linux/bitops.h>               // for fls
#include <linux/jiffies.h>              // for jiffies
#include <linux/sched/cputime.h>        // for account_group_exec_runtime
#include <stddef.h>                     // for NULL
#include "asm-generic/bitsperlong.h"    // for BITS_PER_LONG
#include "asm-generic/int-ll64.h"       // for u64, s64, u32
#include "asm-generic/rwonce.h"         // for READ_ONCE, WRITE_ONCE
#include "asm/cache.h"                  // for __read_mostly
#include "asm/current.h"                // for current
#include "asm/div64.h"                  // for mul_u32_u32
#include "linux/cgroup.h"               // for cgroup_account_cputime
#include "linux/compiler.h"             // for unlikely, likely
#include "linux/compiler_attributes.h"  // for __always_inline, __maybe_unused
#include "linux/compiler_types.h"       // for inline
#include "linux/cpumask.h"              // for num_online_cpus
#include "linux/init.h"                 // for __init, __setup
#include "linux/jump_label.h"           // for static_branch_unlikely
#include "linux/kstrtox.h"              // for kstrtoint
#include "linux/log2.h"                 // for ilog2
#include "linux/math64.h"               // for mul_u64_u32_shr
#include "linux/minmax.h"               // for min_t, clamp, max_t, swap
#include "linux/printk.h"               // for pr_warn
#include "linux/rbtree.h"               // for rb_entry, rb_add_cached, rb_e...
#include "linux/rbtree_types.h"         // for rb_node (ptr only), RB_ROOT_C...
#include "linux/sched.h"                // for sched_entity, task_struct
#include "linux/sched/cpufreq.h"        // for SCHED_CPUFREQ_IOWAIT
#include "linux/sched/sysctl.h"         // for SCHED_TUNABLESCALING_LOG, SCH...
#include "linux/stddef.h"               // for true, false
#include "linux/types.h"                // for bool
#include "pelt.h"                       // for update_idle_rq_clock_pelt
#include "sched.h"                      // for cfs_rq, cfs_rq_of, rq_of, res...
#include "stats.h"                      // for __schedstats_from_se, schedst...
#include "trace/events/sched.h"         // for trace_sched_stat_runtime
struct task_group;
---
  ./scripts/check-local-export kernel/sched/fair.o
  iwyu2 -Wp,-MMD,kernel/sched/.build_policy.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -Wno-unused-but-set-variable    -DKBUILD_MODFILE='"kernel/sched/build_policy"' -DKBUILD_BASENAME='"build_policy"' -DKBUILD_MODNAME='"build_policy"' -D__KBUILD_MODNAME=kmod_build_policy -c -o kernel/sched/build_policy.o kernel/sched/build_policy.c  
In file included from kernel/sched/build_policy.c:28:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/sched/build_policy.c:28:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/sched/build_policy.c:28:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/sched/build_policy.c:28:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/sched/build_policy.c:29:
./include/linux/tsacct_kern.h:13:13: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
                                 struct taskstats *stats, struct task_struct *tsk)
                                        ^
./include/linux/tsacct_kern.h:16:41: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline void xacct_add_tsk(struct taskstats *stats, struct task_struct *p)
                                        ^
6 warnings generated.
In file included from kernel/sched/build_policy.c:28:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/sched/build_policy.c:28:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/sched/build_policy.c:28:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/sched/build_policy.c:28:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/sched/build_policy.c:29:
./include/linux/tsacct_kern.h:13:13: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
                                 struct taskstats *stats, struct task_struct *tsk)
                                        ^
./include/linux/tsacct_kern.h:16:41: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline void xacct_add_tsk(struct taskstats *stats, struct task_struct *p)
                                        ^

kernel/sched/build_policy.c should add these lines:

kernel/sched/build_policy.c should remove these lines:
- #include <linux/cpuidle.h>  // lines 22-22
- #include <linux/jiffies.h>  // lines 23-23
- #include <linux/livepatch.h>  // lines 24-24
- #include <linux/psi.h>  // lines 25-25
- #include <linux/sched/clock.h>  // lines 16-16
- #include <linux/sched/cputime.h>  // lines 17-17
- #include <linux/sched/rt.h>  // lines 20-20
- #include <linux/slab.h>  // lines 27-27
- #include <linux/suspend.h>  // lines 28-28
- #include <linux/tsacct_kern.h>  // lines 29-29
- #include <linux/vtime.h>  // lines 30-30
- #include <uapi/linux/sched/types.h>  // lines 32-32
- #include "autogroup.h"  // lines 37-37
- #include "pelt.h"  // lines 39-39
- #include "sched.h"  // lines 34-34
- #include "smp.h"  // lines 35-35
- #include "stats.h"  // lines 38-38

The full include-list for kernel/sched/build_policy.c:
#include "cputime.c"
#include "deadline.c"
#include "idle.c"
#include "rt.c"
---
  ./scripts/check-local-export kernel/sched/build_policy.o
  iwyu2 -Wp,-MMD,kernel/sched/.build_utility.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -Wno-unused-but-set-variable    -DKBUILD_MODFILE='"kernel/sched/build_utility"' -DKBUILD_BASENAME='"build_utility"' -DKBUILD_MODNAME='"build_utility"' -D__KBUILD_MODNAME=kmod_build_utility -c -o kernel/sched/build_utility.o kernel/sched/build_utility.c  
In file included from kernel/sched/build_utility.c:53:
In file included from kernel/sched/sched.h:29:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
1 warning generated.
In file included from kernel/sched/build_utility.c:53:
In file included from kernel/sched/sched.h:29:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/sched/build_utility.c should add these lines:

kernel/sched/build_utility.c should remove these lines:
- #include <asm/switch_to.h>  // lines 51-51
- #include <linux/cpufreq.h>  // lines 22-22
- #include <linux/cpuset.h>  // lines 24-24
- #include <linux/ctype.h>  // lines 25-25
- #include <linux/debugfs.h>  // lines 26-26
- #include <linux/irq.h>  // lines 29-29
- #include <linux/membarrier.h>  // lines 31-31
- #include <linux/mempolicy.h>  // lines 32-32
- #include <linux/nmi.h>  // lines 33-33
- #include <linux/nospec.h>  // lines 34-34
- #include <linux/proc_fs.h>  // lines 35-35
- #include <linux/psi.h>  // lines 36-36
- #include <linux/psi.h>  // lines 37-37
- #include <linux/sched/clock.h>  // lines 12-12
- #include <linux/sched/cputime.h>  // lines 13-13
- #include <linux/sched/debug.h>  // lines 14-14
- #include <linux/sched/isolation.h>  // lines 15-15
- #include <linux/sched/loadavg.h>  // lines 16-16
- #include <linux/sched/mm.h>  // lines 18-18
- #include <linux/sched/nohz.h>  // lines 17-17
- #include <linux/sched/task_stack.h>  // lines 20-20
- #include <linux/security.h>  // lines 40-40
- #include <linux/timex.h>  // lines 43-43
- #include <linux/utsname.h>  // lines 44-44
- #include <uapi/linux/prctl.h>  // lines 48-48
- #include <uapi/linux/sched/types.h>  // lines 49-49
- #include "autogroup.h"  // lines 56-56
- #include "sched-pelt.h"  // lines 54-54
- #include "sched.h"  // lines 53-53
- #include "stats.h"  // lines 55-55

The full include-list for kernel/sched/build_utility.c:
#include "clock.c"
#include "completion.c"
#include "loadavg.c"
#include "swait.c"
#include "wait.c"
#include "wait_bit.c"
---
  ./scripts/check-local-export kernel/sched/build_utility.o
  rm -f kernel/sched/built-in.a; echo core.o fair.o build_policy.o build_utility.o | sed -E 's:([^ ]+):kernel/sched/:g' | xargs llvm-ar cDPrST kernel/sched/built-in.a
make -f ./scripts/Makefile.build obj=kernel/locking \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,kernel/locking/.mutex.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/locking/mutex"' -DKBUILD_BASENAME='"mutex"' -DKBUILD_MODNAME='"mutex"' -D__KBUILD_MODNAME=kmod_mutex -c -o kernel/locking/mutex.o kernel/locking/mutex.c  
In file included from kernel/locking/mutex.c:34:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/locking/mutex.c:34:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/locking/mutex.c:34:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/locking/mutex.c:34:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/locking/mutex.c:34:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/locking/mutex.c:34:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

include/linux/mutex.h should add these lines:
#include "linux/compiler_attributes.h"  // for __must_check
#include "linux/compiler_types.h"       // for inline
#include "linux/spinlock_types_raw.h"   // for __RAW_SPIN_LOCK_UNLOCKED, raw...
#include "linux/types.h"                // for atomic_t, bool, list_head
struct lock_class_key;

include/linux/mutex.h should remove these lines:
- #include <asm/current.h>  // lines 14-14
- #include <asm/processor.h>  // lines 19-19
- #include <linux/debug_locks.h>  // lines 21-21
- #include <linux/lockdep.h>  // lines 17-17
- #include <linux/spinlock_types.h>  // lines 16-16

The full include-list for include/linux/mutex.h:
#include <linux/atomic.h>               // for ATOMIC_LONG_INIT, atomic_long_t
#include <linux/list.h>                 // for LIST_HEAD_INIT
#include "linux/compiler_attributes.h"  // for __must_check
#include "linux/compiler_types.h"       // for inline
#include "linux/spinlock_types_raw.h"   // for __RAW_SPIN_LOCK_UNLOCKED, raw...
#include "linux/types.h"                // for atomic_t, bool, list_head
struct lock_class_key;
---

kernel/locking/mutex.h should add these lines:
#include "linux/types.h"  // for list_head

kernel/locking/mutex.h should remove these lines:

The full include-list for kernel/locking/mutex.h:
#include "linux/types.h"  // for list_head
---

kernel/locking/mutex.c should add these lines:
#include <stddef.h>                            // for NULL
#include "asm-generic/errno-base.h"            // for EINTR
#include "asm-generic/errno.h"                 // for EALREADY
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "asm/current.h"                       // for current
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_read, atom...
#include "linux/compiler.h"                    // for likely, unlikely
#include "linux/container_of.h"                // for container_of
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/kernel.h"                      // for might_sleep
#include "linux/list.h"                        // for list_empty, INIT_LIST_...
#include "linux/lockdep.h"                     // for lock_acquired, mutex_a...
#include "linux/preempt.h"                     // for preempt_enable, preemp...
#include "linux/sched.h"                       // for task_struct, io_schedu...
#include "linux/stddef.h"                      // for false, true
struct lock_class_key;
struct lockdep_map;

kernel/locking/mutex.c should remove these lines:
- #include <linux/debug_locks.h>  // lines 30-30
- #include <linux/interrupt.h>  // lines 29-29
- #include <linux/sched/rt.h>  // lines 24-24

The full include-list for kernel/locking/mutex.c:
#include "mutex.h"
#include <linux/mutex.h>
#include <linux/export.h>                      // for EXPORT_SYMBOL, EXPORT_...
#include <linux/sched/debug.h>                 // for __sched
#include <linux/sched/signal.h>                // for signal_pending_state
#include <linux/sched/wake_q.h>                // for wake_q_add, wake_up_q
#include <linux/spinlock.h>                    // for raw_spin_lock, raw_spi...
#include <linux/ww_mutex.h>                    // for ww_mutex, ww_acquire_ctx
#include <stddef.h>                            // for NULL
#include <trace/events/lock.h>                 // for trace_contention_begin
#include "asm-generic/errno-base.h"            // for EINTR
#include "asm-generic/errno.h"                 // for EALREADY
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "asm/current.h"                       // for current
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_read, atom...
#include "linux/compiler.h"                    // for likely, unlikely
#include "linux/container_of.h"                // for container_of
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/kernel.h"                      // for might_sleep
#include "linux/list.h"                        // for list_empty, INIT_LIST_...
#include "linux/lockdep.h"                     // for lock_acquired, mutex_a...
#include "linux/preempt.h"                     // for preempt_enable, preemp...
#include "linux/sched.h"                       // for task_struct, io_schedu...
#include "linux/stddef.h"                      // for false, true
#include "ww_mutex.h"                          // for ww_mutex_set_context_f...
struct lock_class_key;
struct lockdep_map;
---
  ./scripts/check-local-export kernel/locking/mutex.o
  iwyu2 -Wp,-MMD,kernel/locking/.semaphore.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/locking/semaphore"' -DKBUILD_BASENAME='"semaphore"' -DKBUILD_MODNAME='"semaphore"' -D__KBUILD_MODNAME=kmod_semaphore -c -o kernel/locking/semaphore.o kernel/locking/semaphore.c  
In file included from kernel/locking/semaphore.c:35:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/locking/semaphore.c:35:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/locking/semaphore.c:35:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/locking/semaphore.c:35:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/locking/semaphore.c:35:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/locking/semaphore.c:35:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/locking/semaphore.c should add these lines:
#include "asm-generic/errno-base.h"     // for EINTR
#include "asm-generic/errno.h"          // for ETIME
#include "asm/current.h"                // for current
#include "linux/compiler_attributes.h"  // for noinline
#include "linux/compiler_types.h"       // for inline
#include "linux/list.h"                 // for list_del, list_add_tail, list...
#include "linux/sched/signal.h"         // for signal_pending_state
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool, list_head

kernel/locking/semaphore.c should remove these lines:
- #include <linux/ftrace.h>  // lines 34-34

The full include-list for kernel/locking/semaphore.c:
#include <linux/compiler.h>             // for likely, unlikely
#include <linux/export.h>               // for EXPORT_SYMBOL
#include <linux/kernel.h>               // for might_sleep
#include <linux/sched.h>                // for task_struct, MAX_SCHEDULE_TIM...
#include <linux/sched/debug.h>          // for __sched
#include <linux/semaphore.h>            // for semaphore, down, down_interru...
#include <linux/spinlock.h>             // for raw_spin_lock_irqsave, raw_sp...
#include <trace/events/lock.h>          // for trace_contention_begin, trace...
#include "asm-generic/errno-base.h"     // for EINTR
#include "asm-generic/errno.h"          // for ETIME
#include "asm/current.h"                // for current
#include "linux/compiler_attributes.h"  // for noinline
#include "linux/compiler_types.h"       // for inline
#include "linux/list.h"                 // for list_del, list_add_tail, list...
#include "linux/sched/signal.h"         // for signal_pending_state
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool, list_head
---
  ./scripts/check-local-export kernel/locking/semaphore.o
  iwyu2 -Wp,-MMD,kernel/locking/.rwsem.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/locking/rwsem"' -DKBUILD_BASENAME='"rwsem"' -DKBUILD_MODNAME='"rwsem"' -D__KBUILD_MODNAME=kmod_rwsem -c -o kernel/locking/rwsem.o kernel/locking/rwsem.c  
In file included from kernel/locking/rwsem.c:30:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/locking/rwsem.c:30:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/locking/rwsem.c:30:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/locking/rwsem.c:30:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/locking/rwsem.c:30:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/locking/rwsem.c:30:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/locking/rwsem.c should add these lines:
#include <asm/barrier.h>                       // for smp_acquire__after_ctr...
#include <asm/bug.h>                           // for WARN_ON_ONCE
#include <stddef.h>                            // for NULL
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm-generic/errno-base.h"            // for EINTR
#include "asm-generic/param.h"                 // for HZ
#include "asm/current.h"                       // for current
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_read, atom...
#include "linux/compiler.h"                    // for unlikely, likely
#include "linux/compiler_types.h"              // for inline, __releases
#include "linux/err.h"                         // for ERR_PTR, IS_ERR
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/jiffies.h"                     // for jiffies, time_after
#include "linux/list.h"                        // for list_empty, INIT_LIST_...
#include "linux/lockdep.h"                     // for rwsem_release, lockdep...
#include "linux/math.h"                        // for DIV_ROUND_UP
#include "linux/preempt.h"                     // for preempt_disable, preem...
#include "linux/spinlock.h"                    // for raw_spin_unlock_irq
#include "linux/stddef.h"                      // for false, true
struct lock_class_key;

kernel/locking/rwsem.c should remove these lines:
- #include <linux/atomic.h>  // lines 29-29
- #include <linux/sched/clock.h>  // lines 26-26

The full include-list for kernel/locking/rwsem.c:
#include <asm/barrier.h>                       // for smp_acquire__after_ctr...
#include <asm/bug.h>                           // for WARN_ON_ONCE
#include <linux/export.h>                      // for EXPORT_SYMBOL
#include <linux/kernel.h>                      // for might_sleep
#include <linux/rwsem.h>                       // for rw_semaphore, RWSEM_UN...
#include <linux/sched.h>                       // for task_struct, schedule
#include <linux/sched/debug.h>                 // for __sched
#include <linux/sched/rt.h>                    // for rt_task
#include <linux/sched/signal.h>                // for signal_pending_state
#include <linux/sched/task.h>                  // for get_task_struct
#include <linux/sched/wake_q.h>                // for wake_up_q, wake_q_empty
#include <linux/types.h>                       // for list_head, bool
#include <stddef.h>                            // for NULL
#include <trace/events/lock.h>                 // for trace_contention_end
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm-generic/errno-base.h"            // for EINTR
#include "asm-generic/param.h"                 // for HZ
#include "asm/current.h"                       // for current
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_read, atom...
#include "linux/compiler.h"                    // for unlikely, likely
#include "linux/compiler_types.h"              // for inline, __releases
#include "linux/err.h"                         // for ERR_PTR, IS_ERR
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/jiffies.h"                     // for jiffies, time_after
#include "linux/list.h"                        // for list_empty, INIT_LIST_...
#include "linux/lockdep.h"                     // for rwsem_release, lockdep...
#include "linux/math.h"                        // for DIV_ROUND_UP
#include "linux/preempt.h"                     // for preempt_disable, preem...
#include "linux/spinlock.h"                    // for raw_spin_unlock_irq
#include "linux/stddef.h"                      // for false, true
#include "lock_events.h"                       // for lockevent_inc, lockeve...
struct lock_class_key;
---
  ./scripts/check-local-export kernel/locking/rwsem.o
  iwyu2 -Wp,-MMD,kernel/locking/.percpu-rwsem.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/locking/percpu-rwsem"' -DKBUILD_BASENAME='"percpu_rwsem"' -DKBUILD_MODNAME='"percpu_rwsem"' -D__KBUILD_MODNAME=kmod_percpu_rwsem -c -o kernel/locking/percpu-rwsem.o kernel/locking/percpu-rwsem.c  
In file included from kernel/locking/percpu-rwsem.c:12:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/locking/percpu-rwsem.c:12:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/locking/percpu-rwsem.c:12:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/locking/percpu-rwsem.c:12:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/locking/percpu-rwsem.c:12:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/locking/percpu-rwsem.c:12:
In file included from ./include/trace/events/lock.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/locking/percpu-rwsem.c should add these lines:
#include <asm-generic/percpu.h>                // for per_cpu, this_cpu_dec
#include <asm/barrier.h>                       // for smp_mb, smp_load_acquire
#include <asm/percpu.h>                        // for this_cpu_add_8
#include <stddef.h>                            // for NULL
#include "asm-generic/errno-base.h"            // for ENOMEM
#include "asm/percpu.h"                        // for __pcpu_op1_1, __pcpu_o...
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_re...
#include "linux/compiler.h"                    // for likely, unlikely
#include "linux/compiler_types.h"              // for compiletime_assert_ato...
#include "linux/cpumask.h"                     // for for_each_possible_cpu
#include "linux/export.h"                      // for EXPORT_SYMBOL_GPL
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/kernel.h"                      // for might_sleep
#include "linux/list.h"                        // for list_del_init
#include "linux/preempt.h"                     // for preempt_disable, preem...
#include "linux/rcu_sync.h"                    // for rcu_sync_dtor, rcu_syn...
#include "linux/rcuwait.h"                     // for rcuwait_init, rcuwait_...
#include "linux/spinlock.h"                    // for spin_lock_irq, spin_un...
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for bool
struct lock_class_key;

kernel/locking/percpu-rwsem.c should remove these lines:
- #include <linux/atomic.h>  // lines 2-2
- #include <linux/errno.h>  // lines 11-11
- #include <linux/rcupdate.h>  // lines 7-7

The full include-list for kernel/locking/percpu-rwsem.c:
#include <asm-generic/percpu.h>                // for per_cpu, this_cpu_dec
#include <asm/barrier.h>                       // for smp_mb, smp_load_acquire
#include <asm/percpu.h>                        // for this_cpu_add_8
#include <linux/lockdep.h>                     // for rwsem_acquire, rwsem_r...
#include <linux/percpu-rwsem.h>                // for percpu_rw_semaphore
#include <linux/percpu.h>                      // for free_percpu, alloc_percpu
#include <linux/sched.h>                       // for task_struct, schedule
#include <linux/sched/debug.h>                 // for __sched
#include <linux/sched/task.h>                  // for get_task_struct, put_t...
#include <linux/wait.h>                        // for wait_queue_entry, __ad...
#include <stddef.h>                            // for NULL
#include <trace/events/lock.h>                 // for trace_contention_begin
#include "asm-generic/errno-base.h"            // for ENOMEM
#include "asm/percpu.h"                        // for __pcpu_op1_1, __pcpu_o...
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_re...
#include "linux/compiler.h"                    // for likely, unlikely
#include "linux/compiler_types.h"              // for compiletime_assert_ato...
#include "linux/cpumask.h"                     // for for_each_possible_cpu
#include "linux/export.h"                      // for EXPORT_SYMBOL_GPL
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/kernel.h"                      // for might_sleep
#include "linux/list.h"                        // for list_del_init
#include "linux/preempt.h"                     // for preempt_disable, preem...
#include "linux/rcu_sync.h"                    // for rcu_sync_dtor, rcu_syn...
#include "linux/rcuwait.h"                     // for rcuwait_init, rcuwait_...
#include "linux/spinlock.h"                    // for spin_lock_irq, spin_un...
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for bool
struct lock_class_key;
---
  ./scripts/check-local-export kernel/locking/percpu-rwsem.o
  rm -f kernel/locking/built-in.a; echo mutex.o semaphore.o rwsem.o percpu-rwsem.o | sed -E 's:([^ ]+):kernel/locking/:g' | xargs llvm-ar cDPrST kernel/locking/built-in.a
make -f ./scripts/Makefile.build obj=kernel/power \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,kernel/power/.qos.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/power/qos"' -DKBUILD_BASENAME='"qos"' -DKBUILD_MODNAME='"qos"' -D__KBUILD_MODNAME=kmod_qos -c -o kernel/power/qos.o kernel/power/qos.c  
In file included from kernel/power/qos.c:23:
In file included from ./include/linux/pm_qos.h:17:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/power/qos.c:23:
In file included from ./include/linux/pm_qos.h:17:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/power/qos.c:23:
In file included from ./include/linux/pm_qos.h:17:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/power/qos.c:40:
In file included from ./include/trace/events/power.h:12:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from kernel/power/qos.c:23:
In file included from ./include/linux/pm_qos.h:17:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/power/qos.c:23:
In file included from ./include/linux/pm_qos.h:17:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/power/qos.c:23:
In file included from ./include/linux/pm_qos.h:17:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/power/qos.c:40:
In file included from ./include/trace/events/power.h:12:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/power/qos.c should add these lines:
#include <asm/bug.h>                    // for WARN, WARN_ON
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EINVAL
#include "asm-generic/int-ll64.h"       // for s32
#include "asm-generic/rwonce.h"         // for READ_ONCE, WRITE_ONCE
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/err.h"                  // for IS_ERR_OR_NULL
#include "linux/list.h"                 // for list_empty, INIT_LIST_HEAD
#include "linux/notifier.h"             // for blocking_notifier_chain_register
#include "linux/plist.h"                // for plist_del, plist_head_init
#include "linux/spinlock_types.h"       // for DEFINE_SPINLOCK
#include "linux/types.h"                // for list_head, bool

kernel/power/qos.c should remove these lines:
- #include <linux/debugfs.h>  // lines 35-35
- #include <linux/device.h>  // lines 29-29
- #include <linux/fs.h>  // lines 28-28
- #include <linux/init.h>  // lines 33-33
- #include <linux/kernel.h>  // lines 34-34
- #include <linux/miscdevice.h>  // lines 30-30
- #include <linux/platform_device.h>  // lines 32-32
- #include <linux/sched.h>  // lines 24-24
- #include <linux/seq_file.h>  // lines 36-36
- #include <linux/slab.h>  // lines 26-26
- #include <linux/string.h>  // lines 31-31
- #include <linux/time.h>  // lines 27-27
- #include <linux/uaccess.h>  // lines 38-38

The full include-list for kernel/power/qos.c:
#include <asm/bug.h>                    // for WARN, WARN_ON
#include <linux/export.h>               // for EXPORT_SYMBOL_GPL
#include <linux/pm_qos.h>               // for pm_qos_constraints, freq_cons...
#include <linux/spinlock.h>             // for spin_unlock_irqrestore, spin_...
#include <stddef.h>                     // for NULL
#include <trace/events/power.h>         // for trace_pm_qos_update_flags
#include "asm-generic/errno-base.h"     // for EINVAL
#include "asm-generic/int-ll64.h"       // for s32
#include "asm-generic/rwonce.h"         // for READ_ONCE, WRITE_ONCE
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/err.h"                  // for IS_ERR_OR_NULL
#include "linux/list.h"                 // for list_empty, INIT_LIST_HEAD
#include "linux/notifier.h"             // for blocking_notifier_chain_register
#include "linux/plist.h"                // for plist_del, plist_head_init
#include "linux/spinlock_types.h"       // for DEFINE_SPINLOCK
#include "linux/types.h"                // for list_head, bool
---
  ./scripts/check-local-export kernel/power/qos.o
  rm -f kernel/power/built-in.a; echo qos.o | sed -E 's:([^ ]+):kernel/power/:g' | xargs llvm-ar cDPrST kernel/power/built-in.a
make -f ./scripts/Makefile.build obj=kernel/printk \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,kernel/printk/.printk.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/printk/printk"' -DKBUILD_BASENAME='"printk"' -DKBUILD_MODNAME='"printk"' -D__KBUILD_MODNAME=kmod_printk -c -o kernel/printk/printk.o kernel/printk/printk.c  
In file included from kernel/printk/printk.c:24:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/printk/printk.c:24:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/printk/printk.c:24:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/printk/printk.c:36:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from kernel/printk/printk.c:24:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/printk/printk.c:24:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/printk/printk.c:24:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/printk/printk.c:36:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/printk/printk.c should add these lines:
#include <asm/bug.h>                           // for WARN_ON, WARN
#include <cstdio>                              // for NULL, size_t, ssize_t
#include "asm-generic/errno-base.h"            // for EINVAL, ENOENT, E2BIG
#include "asm-generic/int-ll64.h"              // for u64
#include "asm-generic/sections.h"              // for init_section_contains
#include "asm/cache.h"                         // for __read_mostly
#include "asm/string_32.h"                     // for strcmp, strcpy, strncpy
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/compiler.h"                    // for unlikely
#include "linux/compiler_types.h"              // for inline
#include "linux/cpuhotplug.h"                  // for cpuhp_setup_state_nocalls
#include "linux/cpumask.h"                     // for cpu_online
#include "linux/export.h"                      // for EXPORT_SYMBOL, EXPORT_...
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/irqflags.h"                    // for start_critical_timings
#include "linux/kern_levels.h"                 // for KERN_INFO
#include "linux/kstrtox.h"                     // for simple_strtoul
#include "linux/lockdep.h"                     // for mutex_acquire, mutex_r...
#include "linux/mutex.h"                       // for mutex, mutex_lock, mut...
#include "linux/panic.h"                       // for panic_cpu, PANIC_CPU_I...
#include "linux/printk.h"                      // for pr_flush, CONSOLE_EXT_...
#include "linux/sched.h"                       // for cond_resched
#include "linux/semaphore.h"                   // for down, down_trylock, up
#include "linux/stat.h"                        // for S_IRUGO, S_IWUSR
#include "linux/stddef.h"                      // for false, true
#include "linux/string.h"                      // for str_has_prefix, strlcpy
#include "linux/types.h"                       // for bool, ATOMIC_INIT, ato...
#include "vdso/bits.h"                         // for BIT
struct dev_printk_info;

kernel/printk/printk.c should remove these lines:
- #include <asm/sections.h>  // lines 52-52
- #include <linux/crash_core.h>  // lines 37-37
- #include <linux/delay.h>  // lines 32-32
- #include <linux/irq_work.h>  // lines 44-44
- #include <linux/jiffies.h>  // lines 28-28
- #include <linux/kmsg_dump.h>  // lines 39-39
- #include <linux/memblock.h>  // lines 35-35
- #include <linux/mm.h>  // lines 23-23
- #include <linux/module.h>  // lines 30-30
- #include <linux/nmi.h>  // lines 29-29
- #include <linux/poll.h>  // lines 43-43
- #include <linux/ratelimit.h>  // lines 38-38
- #include <linux/rculist.h>  // lines 42-42
- #include <linux/sched/clock.h>  // lines 47-47
- #include <linux/sched/task_stack.h>  // lines 49-49
- #include <linux/security.h>  // lines 34-34
- #include <linux/syscalls.h>  // lines 36-36
- #include <linux/tty_driver.h>  // lines 25-25
- #include <linux/uaccess.h>  // lines 51-51
- #include <linux/uio.h>  // lines 46-46

The full include-list for kernel/printk/printk.c:
#include <asm/bug.h>                           // for WARN_ON, WARN
#include <linux/console.h>                     // for console, CON_CONSDEV
#include <linux/cpu.h>                         // for cpuhp_tasks_frozen
#include <linux/ctype.h>                       // for isdigit
#include <linux/init.h>                        // for __init, __setup, initc...
#include <linux/kernel.h>                      // for might_sleep
#include <linux/moduleparam.h>                 // for kernel_param, param_op...
#include <linux/sched/debug.h>                 // for __sched
#include <linux/smp.h>                         // for raw_smp_processor_id
#include <linux/tty.h>                         // for n_tty_init
#include <trace/events/initcall.h>             // for trace_initcall_finish
#include <cstdio>                              // for NULL, size_t, ssize_t
#include "asm-generic/errno-base.h"            // for EINVAL, ENOENT, E2BIG
#include "asm-generic/int-ll64.h"              // for u64
#include "asm-generic/sections.h"              // for init_section_contains
#include "asm/cache.h"                         // for __read_mostly
#include "asm/string_32.h"                     // for strcmp, strcpy, strncpy
#include "braille.h"                           // for _braille_console_setup
#include "console_cmdline.h"                   // for console_cmdline
#include "internal.h"                          // for printk_safe_enter_irqsave
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/compiler.h"                    // for unlikely
#include "linux/compiler_types.h"              // for inline
#include "linux/cpuhotplug.h"                  // for cpuhp_setup_state_nocalls
#include "linux/cpumask.h"                     // for cpu_online
#include "linux/export.h"                      // for EXPORT_SYMBOL, EXPORT_...
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/irqflags.h"                    // for start_critical_timings
#include "linux/kern_levels.h"                 // for KERN_INFO
#include "linux/kstrtox.h"                     // for simple_strtoul
#include "linux/lockdep.h"                     // for mutex_acquire, mutex_r...
#include "linux/mutex.h"                       // for mutex, mutex_lock, mut...
#include "linux/panic.h"                       // for panic_cpu, PANIC_CPU_I...
#include "linux/printk.h"                      // for pr_flush, CONSOLE_EXT_...
#include "linux/sched.h"                       // for cond_resched
#include "linux/semaphore.h"                   // for down, down_trylock, up
#include "linux/stat.h"                        // for S_IRUGO, S_IWUSR
#include "linux/stddef.h"                      // for false, true
#include "linux/string.h"                      // for str_has_prefix, strlcpy
#include "linux/types.h"                       // for bool, ATOMIC_INIT, ato...
#include "printk_ringbuffer.h"                 // for printk_record, printk_...
#include "vdso/bits.h"                         // for BIT
struct dev_printk_info;
---
  ./scripts/check-local-export kernel/printk/printk.o
  rm -f kernel/printk/built-in.a; echo printk.o | sed -E 's:([^ ]+):kernel/printk/:g' | xargs llvm-ar cDPrST kernel/printk/built-in.a
make -f ./scripts/Makefile.build obj=kernel/irq \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,kernel/irq/.irqdesc.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/irq/irqdesc"' -DKBUILD_BASENAME='"irqdesc"' -DKBUILD_MODNAME='"irqdesc"' -D__KBUILD_MODNAME=kmod_irqdesc -c -o kernel/irq/irqdesc.o kernel/irq/irqdesc.c  

kernel/irq/irqdesc.c should add these lines:
#include <asm-generic/percpu.h>                      // for per_cpu_ptr
#include <asm/bug.h>                                 // for WARN_ON, WARN_ON...
#include <stddef.h>                                  // for NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit
#include "asm-generic/errno-base.h"                  // for EINVAL, ENOMEM
#include "asm-generic/topology.h"                    // for cpu_to_node
#include "asm/irq_vectors.h"                         // for NR_IRQS
#include "linux/compiler.h"                          // for data_race
#include "linux/compiler_types.h"                    // for inline, __releases
#include "linux/container_of.h"                      // for container_of
#include "linux/cpumask.h"                           // for cpumask_copy
#include "linux/gfp.h"                               // for GFP_KERNEL
#include "linux/init.h"                              // for __init, __ref
#include "linux/irqflags.h"                          // for local_irq_restore
#include "linux/irqnr.h"                             // for irq_get_next_irq
#include "linux/kern_levels.h"                       // for KERN_INFO
#include "linux/kobject.h"                           // for kobject_init
#include "linux/lockdep.h"                           // for lockdep_set_class
#include "linux/lockdep_types.h"                     // for lock_class_key
#include "linux/mutex.h"                             // for mutex_lock, mute...
#include "linux/nodemask.h"                          // for first_online_node
#include "linux/percpu.h"                            // for free_percpu, all...
#include "linux/preempt.h"                           // for in_hardirq
#include "linux/printk.h"                            // for printk
#include "linux/rcupdate.h"                          // for call_rcu, init_r...
#include "linux/spinlock.h"                          // for raw_spin_lock_init
#include "linux/types.h"                             // for bool, DECLARE_BI...
#include "linux/wait.h"                              // for init_waitqueue_head
#include "settings.h"                                // for irq_settings_is_...
struct module;

kernel/irq/irqdesc.c should remove these lines:
- #include <linux/irqdomain.h>  // lines 17-17
- #include <linux/sysfs.h>  // lines 18-18

The full include-list for kernel/irq/irqdesc.c:
#include <asm-generic/percpu.h>                      // for per_cpu_ptr
#include <asm/bug.h>                                 // for WARN_ON, WARN_ON...
#include <linux/bitmap.h>                            // for bitmap_clear
#include <linux/export.h>                            // for EXPORT_SYMBOL_GPL
#include <linux/interrupt.h>                         // for irq_affinity_desc
#include <linux/irq.h>                               // for irq_desc, irq_data
#include <linux/kernel_stat.h>                       // for kstat_incr_irq_t...
#include <linux/radix-tree.h>                        // for radix_tree_delete
#include <linux/slab.h>                              // for kfree, kzalloc
#include <stddef.h>                                  // for NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit
#include "asm-generic/errno-base.h"                  // for EINVAL, ENOMEM
#include "asm-generic/topology.h"                    // for cpu_to_node
#include "asm/irq_vectors.h"                         // for NR_IRQS
#include "internals.h"                               // for irqd_set, IRQ_BI...
#include "linux/compiler.h"                          // for data_race
#include "linux/compiler_types.h"                    // for inline, __releases
#include "linux/container_of.h"                      // for container_of
#include "linux/cpumask.h"                           // for cpumask_copy
#include "linux/gfp.h"                               // for GFP_KERNEL
#include "linux/init.h"                              // for __init, __ref
#include "linux/irqflags.h"                          // for local_irq_restore
#include "linux/irqnr.h"                             // for irq_get_next_irq
#include "linux/kern_levels.h"                       // for KERN_INFO
#include "linux/kobject.h"                           // for kobject_init
#include "linux/lockdep.h"                           // for lockdep_set_class
#include "linux/lockdep_types.h"                     // for lock_class_key
#include "linux/mutex.h"                             // for mutex_lock, mute...
#include "linux/nodemask.h"                          // for first_online_node
#include "linux/percpu.h"                            // for free_percpu, all...
#include "linux/preempt.h"                           // for in_hardirq
#include "linux/printk.h"                            // for printk
#include "linux/rcupdate.h"                          // for call_rcu, init_r...
#include "linux/spinlock.h"                          // for raw_spin_lock_init
#include "linux/types.h"                             // for bool, DECLARE_BI...
#include "linux/wait.h"                              // for init_waitqueue_head
#include "settings.h"                                // for irq_settings_is_...
struct module;
---
  ./scripts/check-local-export kernel/irq/irqdesc.o
  iwyu2 -Wp,-MMD,kernel/irq/.handle.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/irq/handle"' -DKBUILD_BASENAME='"handle"' -DKBUILD_MODNAME='"handle"' -D__KBUILD_MODNAME=kmod_handle -c -o kernel/irq/handle.o kernel/irq/handle.c  
In file included from kernel/irq/handle.c:19:
In file included from ./include/trace/events/irq.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/irq/handle.c:19:
In file included from ./include/trace/events/irq.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/irq/handle.c:19:
In file included from ./include/trace/events/irq.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/irq/handle.c:19:
In file included from ./include/trace/events/irq.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/irq/handle.c:19:
In file included from ./include/trace/events/irq.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/irq/handle.c:19:
In file included from ./include/trace/events/irq.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/irq/handle.c should add these lines:
#include <asm/bug.h>                                 // for WARN_ONCE
#include "asm-generic/bitops/instrumented-atomic.h"  // for test_and_set_bit
#include "asm/hardirq.h"                             // for ack_bad_irq
#include "linux/atomic/atomic-instrumented.h"        // for atomic_inc
#include "linux/compiler.h"                          // for unlikely
#include "linux/export.h"                            // for EXPORT_SYMBOL_GPL
#include "linux/irqflags.h"                          // for irqs_disabled
#include "linux/irqreturn.h"                         // for irqreturn_t, IRQ...
#include "linux/kern_levels.h"                       // for KERN_WARNING
#include "linux/printk.h"                            // for printk
#include "linux/spinlock.h"                          // for raw_spin_lock
#include "settings.h"                                // for irq_settings_can...

kernel/irq/handle.c should remove these lines:
- #include <asm/irq_regs.h>  // lines 17-17
- #include <linux/kernel_stat.h>  // lines 15-15

The full include-list for kernel/irq/handle.c:
#include <asm/bug.h>                                 // for WARN_ONCE
#include <linux/interrupt.h>                         // for irqaction, IRQF_...
#include <linux/irq.h>                               // for irq_desc, irq_de...
#include <linux/random.h>                            // for add_interrupt_ra...
#include <linux/sched.h>                             // for wake_up_process
#include <trace/events/irq.h>                        // for trace_irq_handle...
#include "asm-generic/bitops/instrumented-atomic.h"  // for test_and_set_bit
#include "asm/hardirq.h"                             // for ack_bad_irq
#include "internals.h"                               // for irqd_clear, irqd...
#include "linux/atomic/atomic-instrumented.h"        // for atomic_inc
#include "linux/compiler.h"                          // for unlikely
#include "linux/export.h"                            // for EXPORT_SYMBOL_GPL
#include "linux/irqflags.h"                          // for irqs_disabled
#include "linux/irqreturn.h"                         // for irqreturn_t, IRQ...
#include "linux/kern_levels.h"                       // for KERN_WARNING
#include "linux/printk.h"                            // for printk
#include "linux/spinlock.h"                          // for raw_spin_lock
#include "settings.h"                                // for irq_settings_can...
---
  ./scripts/check-local-export kernel/irq/handle.o
  iwyu2 -Wp,-MMD,kernel/irq/.manage.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/irq/manage"' -DKBUILD_BASENAME='"manage"' -DKBUILD_MODNAME='"manage"' -D__KBUILD_MODNAME=kmod_manage -c -o kernel/irq/manage.o kernel/irq/manage.c  

kernel/irq/manage.c should add these lines:
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN, WARN_ON
#include <linux/bitops.h>                            // for ffz
#include <stddef.h>                                  // for NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit, test_an...
#include "asm-generic/errno-base.h"                  // for EINVAL, ENOMEM
#include "asm-generic/errno.h"                       // for ENOTCONN, ENOSYS
#include "asm/current.h"                             // for current
#include "asm/vdso/processor.h"                      // for cpu_relax
#include "linux/atomic/atomic-instrumented.h"        // for atomic_read, ato...
#include "linux/bottom_half.h"                       // for local_bh_disable
#include "linux/compiler.h"                          // for unlikely
#include "linux/compiler_attributes.h"               // for fallthrough
#include "linux/compiler_types.h"                    // for __percpu, inline
#include "linux/cpumask.h"                           // for cpumask_empty
#include "linux/err.h"                               // for IS_ERR, PTR_ERR
#include "linux/export.h"                            // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                               // for GFP_KERNEL
#include "linux/hardirq.h"                           // for synchronize_hardirq
#include "linux/init.h"                              // for __init, early_param
#include "linux/irqflags.h"                          // for local_irq_disable
#include "linux/irqnr.h"                             // for irq_to_desc
#include "linux/irqreturn.h"                         // for irqreturn_t, IRQ...
#include "linux/jump_label.h"                        // for DEFINE_STATIC_KE...
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/kern_levels.h"                       // for KERN_ERR, KERN_W...
#include "linux/mutex.h"                             // for mutex_unlock
#include "linux/preempt.h"                           // for in_interrupt
#include "linux/printk.h"                            // for pr_err, pr_debug
#include "linux/rcupdate.h"                          // for rcu_read_lock
#include "linux/smp.h"                               // for smp_processor_id
#include "linux/spinlock.h"                          // for raw_spin_unlock_...
#include "linux/stddef.h"                            // for false, true
#include "linux/types.h"                             // for bool, callback_head
#include "linux/wait.h"                              // for wait_event, wake_up
#include "settings.h"                                // for irq_settings_is_...

kernel/irq/manage.c should remove these lines:
- #include <linux/irqdomain.h>  // lines 16-16
- #include <linux/random.h>  // lines 14-14
- #include <linux/sched/isolation.h>  // lines 21-21
- #include <linux/sched/rt.h>  // lines 19-19
- #include <uapi/linux/sched/types.h>  // lines 22-22

The full include-list for kernel/irq/manage.c:
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN, WARN_ON
#include <linux/bitops.h>                            // for ffz
#include <linux/interrupt.h>                         // for irqaction, IRQF_...
#include <linux/irq.h>                               // for irq_desc, irq_chip
#include <linux/kthread.h>                           // for kthread_stop
#include <linux/module.h>                            // for module_put, try_...
#include <linux/sched.h>                             // for task_struct, TAS...
#include <linux/sched/task.h>                        // for put_task_struct
#include <linux/slab.h>                              // for kfree, kzalloc
#include <linux/task_work.h>                         // for init_task_work
#include <stddef.h>                                  // for NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit, test_an...
#include "asm-generic/errno-base.h"                  // for EINVAL, ENOMEM
#include "asm-generic/errno.h"                       // for ENOTCONN, ENOSYS
#include "asm/current.h"                             // for current
#include "asm/vdso/processor.h"                      // for cpu_relax
#include "internals.h"                               // for chip_bus_sync_un...
#include "linux/atomic/atomic-instrumented.h"        // for atomic_read, ato...
#include "linux/bottom_half.h"                       // for local_bh_disable
#include "linux/compiler.h"                          // for unlikely
#include "linux/compiler_attributes.h"               // for fallthrough
#include "linux/compiler_types.h"                    // for __percpu, inline
#include "linux/cpumask.h"                           // for cpumask_empty
#include "linux/err.h"                               // for IS_ERR, PTR_ERR
#include "linux/export.h"                            // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                               // for GFP_KERNEL
#include "linux/hardirq.h"                           // for synchronize_hardirq
#include "linux/init.h"                              // for __init, early_param
#include "linux/irqflags.h"                          // for local_irq_disable
#include "linux/irqnr.h"                             // for irq_to_desc
#include "linux/irqreturn.h"                         // for irqreturn_t, IRQ...
#include "linux/jump_label.h"                        // for DEFINE_STATIC_KE...
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/kern_levels.h"                       // for KERN_ERR, KERN_W...
#include "linux/mutex.h"                             // for mutex_unlock
#include "linux/preempt.h"                           // for in_interrupt
#include "linux/printk.h"                            // for pr_err, pr_debug
#include "linux/rcupdate.h"                          // for rcu_read_lock
#include "linux/smp.h"                               // for smp_processor_id
#include "linux/spinlock.h"                          // for raw_spin_unlock_...
#include "linux/stddef.h"                            // for false, true
#include "linux/types.h"                             // for bool, callback_head
#include "linux/wait.h"                              // for wait_event, wake_up
#include "settings.h"                                // for irq_settings_is_...
---
  ./scripts/check-local-export kernel/irq/manage.o
  iwyu2 -Wp,-MMD,kernel/irq/.spurious.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/irq/spurious"' -DKBUILD_BASENAME='"spurious"' -DKBUILD_MODNAME='"spurious"' -D__KBUILD_MODNAME=kmod_spurious -c -o kernel/irq/spurious.o kernel/irq/spurious.c  
In file included from kernel/irq/spurious.c:15:
In file included from kernel/irq/internals.h:11:
In file included from ./include/linux/pm_runtime.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/irq/spurious.c:15:
In file included from kernel/irq/internals.h:11:
In file included from ./include/linux/pm_runtime.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/irq/spurious.c:15:
In file included from kernel/irq/internals.h:11:
In file included from ./include/linux/pm_runtime.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/irq/spurious.c:15:
In file included from kernel/irq/internals.h:11:
In file included from ./include/linux/pm_runtime.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/irq/spurious.c:15:
In file included from kernel/irq/internals.h:11:
In file included from ./include/linux/pm_runtime.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/irq/spurious.c:15:
In file included from kernel/irq/internals.h:11:
In file included from ./include/linux/pm_runtime.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/irq/spurious.c should add these lines:
#include <asm/bug.h>                           // for WARN_ONCE
#include "asm-generic/param.h"                 // for HZ
#include "asm/cache.h"                         // for __read_mostly
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec, atomic_inc...
#include "linux/compiler.h"                    // for likely, unlikely, barrier
#include "linux/compiler_types.h"              // for inline, __must_hold
#include "linux/init.h"                        // for __setup, __init
#include "linux/irqflags.h"                    // for local_irq_disable, loc...
#include "linux/irqnr.h"                       // for for_each_irq_desc
#include "linux/irqreturn.h"                   // for irqreturn_t, IRQ_HANDLED
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/kern_levels.h"                 // for KERN_ERR, KERN_WARNING
#include "linux/printk.h"                      // for printk, dump_stack
#include "linux/smp.h"                         // for smp_processor_id
#include "linux/spinlock.h"                    // for raw_spin_lock, raw_spi...
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for bool, atomic_t
#include "settings.h"                          // for irq_settings_is_polled

kernel/irq/spurious.c should remove these lines:
- #include <linux/module.h>  // lines 10-10

The full include-list for kernel/irq/spurious.c:
#include <asm/bug.h>                           // for WARN_ONCE
#include <linux/interrupt.h>                   // for irqaction, IRQF_IRQPOLL
#include <linux/irq.h>                         // for irq_desc, irq_desc_get...
#include <linux/jiffies.h>                     // for jiffies, time_after
#include <linux/moduleparam.h>                 // for kernel_param, module_p...
#include <linux/timer.h>                       // for mod_timer, DEFINE_TIMER
#include "asm-generic/param.h"                 // for HZ
#include "asm/cache.h"                         // for __read_mostly
#include "internals.h"                         // for istate, IRQS_POLL_INPR...
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec, atomic_inc...
#include "linux/compiler.h"                    // for likely, unlikely, barrier
#include "linux/compiler_types.h"              // for inline, __must_hold
#include "linux/init.h"                        // for __setup, __init
#include "linux/irqflags.h"                    // for local_irq_disable, loc...
#include "linux/irqnr.h"                       // for for_each_irq_desc
#include "linux/irqreturn.h"                   // for irqreturn_t, IRQ_HANDLED
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/kern_levels.h"                 // for KERN_ERR, KERN_WARNING
#include "linux/printk.h"                      // for printk, dump_stack
#include "linux/smp.h"                         // for smp_processor_id
#include "linux/spinlock.h"                    // for raw_spin_lock, raw_spi...
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for bool, atomic_t
#include "settings.h"                          // for irq_settings_is_polled
---
  ./scripts/check-local-export kernel/irq/spurious.o
  iwyu2 -Wp,-MMD,kernel/irq/.resend.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/irq/resend"' -DKBUILD_BASENAME='"resend"' -DKBUILD_MODNAME='"resend"' -D__KBUILD_MODNAME=kmod_resend -c -o kernel/irq/resend.o kernel/irq/resend.c  
In file included from kernel/irq/resend.c:20:
In file included from kernel/irq/internals.h:11:
In file included from ./include/linux/pm_runtime.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/irq/resend.c:20:
In file included from kernel/irq/internals.h:11:
In file included from ./include/linux/pm_runtime.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/irq/resend.c:20:
In file included from kernel/irq/internals.h:11:
In file included from ./include/linux/pm_runtime.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/irq/resend.c:20:
In file included from kernel/irq/internals.h:11:
In file included from ./include/linux/pm_runtime.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/irq/resend.c:20:
In file included from kernel/irq/internals.h:11:
In file included from ./include/linux/pm_runtime.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/irq/resend.c:20:
In file included from kernel/irq/internals.h:11:
In file included from ./include/linux/pm_runtime.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/irq/resend.c should add these lines:
#include <linux/bitmap.h>                            // for find_first_bit
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/errno-base.h"                  // for EINVAL, EBUSY
#include "linux/bitmap.h"                            // for bitmap_empty
#include "linux/irqflags.h"                          // for local_irq_disable
#include "linux/irqnr.h"                             // for irq_to_desc, nr_...
#include "linux/types.h"                             // for DECLARE_BITMAP
#include "settings.h"                                // for irq_settings_is_...

kernel/irq/resend.c should remove these lines:
- #include <linux/module.h>  // lines 16-16
- #include <linux/random.h>  // lines 17-17

The full include-list for kernel/irq/resend.c:
#include <linux/bitmap.h>                            // for find_first_bit
#include <linux/interrupt.h>                         // for tasklet_schedule
#include <linux/irq.h>                               // for irq_desc, irq_de...
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/errno-base.h"                  // for EINVAL, EBUSY
#include "internals.h"                               // for istate, IRQS_PEN...
#include "linux/bitmap.h"                            // for bitmap_empty
#include "linux/irqflags.h"                          // for local_irq_disable
#include "linux/irqnr.h"                             // for irq_to_desc, nr_...
#include "linux/types.h"                             // for DECLARE_BITMAP
#include "settings.h"                                // for irq_settings_is_...
---
  ./scripts/check-local-export kernel/irq/resend.o
  iwyu2 -Wp,-MMD,kernel/irq/.chip.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/irq/chip"' -DKBUILD_BASENAME='"chip"' -DKBUILD_MODNAME='"chip"' -D__KBUILD_MODNAME=kmod_chip -c -o kernel/irq/chip.o kernel/irq/chip.c  

kernel/irq/chip.c should add these lines:
#include <asm-generic/percpu.h>         // for raw_cpu_ptr
#include <asm/bug.h>                    // for WARN_ON, WARN_ON_ONCE, WARN_ONCE
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EINVAL
#include "asm-generic/errno.h"          // for ENOSYS
#include "linux/compiler.h"             // for unlikely, likely
#include "linux/compiler_attributes.h"  // for __always_inline
#include "linux/compiler_types.h"       // for inline
#include "linux/cpumask.h"              // for cpumask_clear_cpu, cpumask_se...
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include "linux/irqhandler.h"           // for irq_flow_handler_t
#include "linux/irqnr.h"                // for irq_to_desc
#include "linux/irqreturn.h"            // for irqreturn_t, IRQ_NONE
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kernel.h"               // for might_sleep
#include "linux/pm_runtime.h"           // for pm_runtime_put, pm_runtime_re...
#include "linux/printk.h"               // for pr_err_once
#include "linux/smp.h"                  // for smp_processor_id
#include "linux/spinlock.h"             // for raw_spin_unlock, raw_spin_lock
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool
#include "settings.h"                   // for irq_settings_can_move_pcntxt

kernel/irq/chip.c should remove these lines:
- #include <linux/kernel_stat.h>  // lines 15-15
- #include <linux/module.h>  // lines 13-13

The full include-list for kernel/irq/chip.c:
#include <asm-generic/percpu.h>         // for raw_cpu_ptr
#include <asm/bug.h>                    // for WARN_ON, WARN_ON_ONCE, WARN_ONCE
#include <linux/interrupt.h>            // for irqaction
#include <linux/irq.h>                  // for irq_desc, irq_chip, irq_data
#include <linux/irqdomain.h>            // for irq_domain
#include <linux/msi.h>                  // for msi_desc
#include <stddef.h>                     // for NULL
#include <trace/events/irq.h>           // for trace_irq_handler_entry, trac...
#include "asm-generic/errno-base.h"     // for EINVAL
#include "asm-generic/errno.h"          // for ENOSYS
#include "internals.h"                  // for irqd_set, istate, irqd_clear
#include "linux/compiler.h"             // for unlikely, likely
#include "linux/compiler_attributes.h"  // for __always_inline
#include "linux/compiler_types.h"       // for inline
#include "linux/cpumask.h"              // for cpumask_clear_cpu, cpumask_se...
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include "linux/irqhandler.h"           // for irq_flow_handler_t
#include "linux/irqnr.h"                // for irq_to_desc
#include "linux/irqreturn.h"            // for irqreturn_t, IRQ_NONE
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kernel.h"               // for might_sleep
#include "linux/pm_runtime.h"           // for pm_runtime_put, pm_runtime_re...
#include "linux/printk.h"               // for pr_err_once
#include "linux/smp.h"                  // for smp_processor_id
#include "linux/spinlock.h"             // for raw_spin_unlock, raw_spin_lock
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool
#include "settings.h"                   // for irq_settings_can_move_pcntxt
---
  ./scripts/check-local-export kernel/irq/chip.o
  iwyu2 -Wp,-MMD,kernel/irq/.dummychip.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/irq/dummychip"' -DKBUILD_BASENAME='"dummychip"' -DKBUILD_MODNAME='"dummychip"' -D__KBUILD_MODNAME=kmod_dummychip -c -o kernel/irq/dummychip.o kernel/irq/dummychip.c  
In file included from kernel/irq/dummychip.c:12:
In file included from kernel/irq/internals.h:11:
In file included from ./include/linux/pm_runtime.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/irq/dummychip.c:12:
In file included from kernel/irq/internals.h:11:
In file included from ./include/linux/pm_runtime.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/irq/dummychip.c:12:
In file included from kernel/irq/internals.h:11:
In file included from ./include/linux/pm_runtime.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/irq/dummychip.c:12:
In file included from kernel/irq/internals.h:11:
In file included from ./include/linux/pm_runtime.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/irq/dummychip.c:12:
In file included from kernel/irq/internals.h:11:
In file included from ./include/linux/pm_runtime.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/irq/dummychip.c:12:
In file included from kernel/irq/internals.h:11:
In file included from ./include/linux/pm_runtime.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/irq/dummychip.c should add these lines:
#include "asm/hardirq.h"   // for ack_bad_irq

kernel/irq/dummychip.c should remove these lines:
- #include <linux/interrupt.h>  // lines 8-8

The full include-list for kernel/irq/dummychip.c:
#include <linux/export.h>  // for EXPORT_SYMBOL_GPL
#include <linux/irq.h>     // for IRQCHIP_SKIP_SET_WAKE, irq_data_to_desc
#include "asm/hardirq.h"   // for ack_bad_irq
#include "internals.h"     // for print_irq_desc
---
  ./scripts/check-local-export kernel/irq/dummychip.o
  iwyu2 -Wp,-MMD,kernel/irq/.devres.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/irq/devres"' -DKBUILD_BASENAME='"devres"' -DKBUILD_MODNAME='"devres"' -D__KBUILD_MODNAME=kmod_devres -c -o kernel/irq/devres.o kernel/irq/devres.c  
In file included from kernel/irq/devres.c:4:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/irq/devres.c:4:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/irq/devres.c:4:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/irq/devres.c:4:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/irq/devres.c:4:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/irq/devres.c:4:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/irq/devres.c should add these lines:
#include <asm/bug.h>                 // for WARN_ON
#include "asm-generic/errno-base.h"  // for ENOMEM
#include "linux/export.h"            // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
struct module;

kernel/irq/devres.c should remove these lines:
- #include <linux/module.h>  // lines 2-2
- #include "internals.h"  // lines 8-8

The full include-list for kernel/irq/devres.c:
#include <asm/bug.h>                 // for WARN_ON
#include <linux/device.h>            // for devres_add, devres_free, dev_name
#include <linux/gfp.h>               // for GFP_KERNEL
#include <linux/interrupt.h>         // for free_irq, irq_handler_t, request...
#include <linux/irq.h>               // for __irq_alloc_descs, irq_free_descs
#include "asm-generic/errno-base.h"  // for ENOMEM
#include "linux/export.h"            // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
struct module;
---
  ./scripts/check-local-export kernel/irq/devres.o
  iwyu2 -Wp,-MMD,kernel/irq/.autoprobe.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/irq/autoprobe"' -DKBUILD_BASENAME='"autoprobe"' -DKBUILD_MODNAME='"autoprobe"' -D__KBUILD_MODNAME=kmod_autoprobe -c -o kernel/irq/autoprobe.o kernel/irq/autoprobe.c  
In file included from kernel/irq/autoprobe.c:12:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/irq/autoprobe.c:12:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/irq/autoprobe.c:12:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/irq/autoprobe.c:12:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/irq/autoprobe.c:12:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/irq/autoprobe.c:12:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/irq/autoprobe.c should add these lines:
#include "linux/export.h"     // for EXPORT_SYMBOL
#include "linux/irqnr.h"      // for for_each_irq_desc, for_each_irq_desc_re...
#include "linux/mutex.h"      // for mutex, mutex_unlock, mutex_lock, DEFINE...
#include "linux/spinlock.h"   // for raw_spin_lock_irq, raw_spin_unlock_irq
#include "settings.h"         // for irq_settings_can_probe

kernel/irq/autoprobe.c should remove these lines:
- #include <linux/module.h>  // lines 9-9

The full include-list for kernel/irq/autoprobe.c:
#include <linux/async.h>      // for async_synchronize_full
#include <linux/delay.h>      // for msleep
#include <linux/interrupt.h>  // for probe_irq_mask, probe_irq_off, probe_ir...
#include <linux/irq.h>        // for irq_desc, irq_chip, irq_data, IRQ_TYPE_...
#include "internals.h"        // for istate, irq_shutdown_and_deactivate
#include "linux/export.h"     // for EXPORT_SYMBOL
#include "linux/irqnr.h"      // for for_each_irq_desc, for_each_irq_desc_re...
#include "linux/mutex.h"      // for mutex, mutex_unlock, mutex_lock, DEFINE...
#include "linux/spinlock.h"   // for raw_spin_lock_irq, raw_spin_unlock_irq
#include "settings.h"         // for irq_settings_can_probe
---
  ./scripts/check-local-export kernel/irq/autoprobe.o
  rm -f kernel/irq/built-in.a; echo irqdesc.o handle.o manage.o spurious.o resend.o chip.o dummychip.o devres.o autoprobe.o | sed -E 's:([^ ]+):kernel/irq/:g' | xargs llvm-ar cDPrST kernel/irq/built-in.a
make -f ./scripts/Makefile.build obj=kernel/rcu \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,kernel/rcu/.update.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/rcu/update"' -DKBUILD_BASENAME='"update"' -DKBUILD_MODNAME='"update"' -D__KBUILD_MODNAME=kmod_update -c -o kernel/rcu/update.o kernel/rcu/update.c  
In file included from kernel/rcu/update.c:32:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/rcu/update.c:32:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/rcu/update.c:32:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/rcu/update.c:32:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/rcu/update.c:32:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/rcu/update.c:32:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/rcu/update.c should add these lines:
#include <linux/rcupdate.h>       // for kfree_rcu_scheduler_running, synchr...
#include <stddef.h>               // for NULL
#include "asm/cache.h"            // for __read_mostly
#include "linux/completion.h"     // for complete, init_completion, wait_for...
#include "linux/container_of.h"   // for container_of
#include "linux/kconfig.h"        // for IS_ENABLED, IS_MODULE
#include "linux/rcupdate.h"       // for call_rcu, destroy_rcu_head_on_stack
#include "linux/rcuwait.h"        // for rcuwait, finish_rcuwait
#include "linux/sched.h"          // for task_struct, TASK_RUNNING, __set_cu...

kernel/rcu/update.c should remove these lines:
- #include <linux/atomic.h>  // lines 28-28
- #include <linux/bitops.h>  // lines 29-29
- #include <linux/cpu.h>  // lines 32-32
- #include <linux/delay.h>  // lines 36-36
- #include <linux/hardirq.h>  // lines 35-35
- #include <linux/interrupt.h>  // lines 25-25
- #include <linux/irq_work.h>  // lines 44-44
- #include <linux/kprobes.h>  // lines 42-42
- #include <linux/kthread.h>  // lines 38-38
- #include <linux/mutex.h>  // lines 33-33
- #include <linux/notifier.h>  // lines 31-31
- #include <linux/percpu.h>  // lines 30-30
- #include <linux/sched/debug.h>  // lines 27-27
- #include <linux/sched/isolation.h>  // lines 41-41
- #include <linux/sched/signal.h>  // lines 26-26
- #include <linux/slab.h>  // lines 43-43
- #include <linux/smp.h>  // lines 24-24
- #include <linux/spinlock.h>  // lines 23-23
- #include <linux/tick.h>  // lines 39-39
- #include "tasks.h"  // lines 185-185

The full include-list for kernel/rcu/update.c:
#include <linux/export.h>         // for EXPORT_SYMBOL_GPL
#include <linux/init.h>           // for __init, core_initcall
#include <linux/kernel.h>         // for might_sleep
#include <linux/moduleparam.h>    // for kernel_param, param_ops_int, MODULE...
#include <linux/rcupdate.h>       // for kfree_rcu_scheduler_running, synchr...
#include <linux/rcupdate_wait.h>  // for rcu_synchronize, __wait_rcu_gp, wak...
#include <linux/types.h>          // for call_rcu_func_t, bool, rcu_head
#include <stddef.h>               // for NULL
#include "asm/cache.h"            // for __read_mostly
#include "linux/completion.h"     // for complete, init_completion, wait_for...
#include "linux/container_of.h"   // for container_of
#include "linux/kconfig.h"        // for IS_ENABLED, IS_MODULE
#include "linux/rcupdate.h"       // for call_rcu, destroy_rcu_head_on_stack
#include "linux/rcuwait.h"        // for rcuwait, finish_rcuwait
#include "linux/sched.h"          // for task_struct, TASK_RUNNING, __set_cu...
#include "rcu.h"                  // for RCU_SCHEDULER_RUNNING, rcu_early_bo...
---
  ./scripts/check-local-export kernel/rcu/update.o
  iwyu2 -Wp,-MMD,kernel/rcu/.sync.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/rcu/sync"' -DKBUILD_BASENAME='"sync"' -DKBUILD_MODNAME='"sync"' -D__KBUILD_MODNAME=kmod_sync -c -o kernel/rcu/sync.o kernel/rcu/sync.c  

kernel/rcu/sync.c should add these lines:
#include <asm/bug.h>             // for WARN_ON_ONCE
#include <linux/rcupdate.h>      // for rcu_barrier
#include "asm-generic/rwonce.h"  // for READ_ONCE, WRITE_ONCE
#include "asm/string_32.h"       // for memset
#include "linux/container_of.h"  // for container_of
#include "linux/rcupdate.h"      // for call_rcu, synchronize_rcu
#include "linux/spinlock.h"      // for spin_lock_irq, spin_unlock_irq, spin...
#include "linux/types.h"         // for rcu_head
#include "linux/wait.h"          // for wait_queue_head_t, init_waitqueue_head

kernel/rcu/sync.c should remove these lines:
- #include <linux/sched.h>  // lines 11-11

The full include-list for kernel/rcu/sync.c:
#include <asm/bug.h>             // for WARN_ON_ONCE
#include <linux/rcu_sync.h>      // for rcu_sync, rcu_sync_dtor, rcu_sync_enter
#include <linux/rcupdate.h>      // for rcu_barrier
#include "asm-generic/rwonce.h"  // for READ_ONCE, WRITE_ONCE
#include "asm/string_32.h"       // for memset
#include "linux/container_of.h"  // for container_of
#include "linux/rcupdate.h"      // for call_rcu, synchronize_rcu
#include "linux/spinlock.h"      // for spin_lock_irq, spin_unlock_irq, spin...
#include "linux/types.h"         // for rcu_head
#include "linux/wait.h"          // for wait_queue_head_t, init_waitqueue_head
---
  ./scripts/check-local-export kernel/rcu/sync.o
  iwyu2 -Wp,-MMD,kernel/rcu/.srcutiny.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/rcu/srcutiny"' -DKBUILD_BASENAME='"srcutiny"' -DKBUILD_MODNAME='"srcutiny"' -D__KBUILD_MODNAME=kmod_srcutiny -c -o kernel/rcu/srcutiny.o kernel/rcu/srcutiny.c  
In file included from kernel/rcu/srcutiny.c:21:
In file included from kernel/rcu/rcu.h:13:
In file included from ./include/trace/events/rcu.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/rcu/srcutiny.c:21:
In file included from kernel/rcu/rcu.h:13:
In file included from ./include/trace/events/rcu.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/rcu/srcutiny.c:21:
In file included from kernel/rcu/rcu.h:13:
In file included from ./include/trace/events/rcu.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/rcu/srcutiny.c:21:
In file included from kernel/rcu/rcu.h:13:
In file included from ./include/trace/events/rcu.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/rcu/srcutiny.c:21:
In file included from kernel/rcu/rcu.h:13:
In file included from ./include/trace/events/rcu.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/rcu/srcutiny.c:21:
In file included from kernel/rcu/rcu.h:13:
In file included from ./include/trace/events/rcu.h:8:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/rcu/srcutiny.c should add these lines:
#include <asm/bug.h>               // for WARN_ON
#include <linux/rcupdate.h>        // for rcu_scheduler_starting
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u8
#include "asm-generic/rwonce.h"    // for READ_ONCE, WRITE_ONCE
#include "asm/cache.h"             // for __read_mostly
#include "linux/bottom_half.h"     // for local_bh_disable, local_bh_enable
#include "linux/compiler.h"        // for barrier, likely
#include "linux/completion.h"      // for init_completion, wait_for_completion
#include "linux/container_of.h"    // for container_of
#include "linux/init.h"            // for __init
#include "linux/irqflags.h"        // for local_irq_disable, local_irq_enable
#include "linux/list.h"            // for list_empty, INIT_LIST_HEAD, list_add
#include "linux/rcupdate.h"        // for USHORT_CMP_GE, destroy_rcu_head_on...
#include "linux/stddef.h"          // for false, true
#include "linux/swait.h"           // for swake_up_one, init_swait_queue_head
#include "linux/types.h"           // for callback_head, bool, rcu_head, rcu...
#include "linux/workqueue.h"       // for schedule_work, work_struct, flush_...
#include "vdso/limits.h"           // for USHRT_MAX

kernel/rcu/srcutiny.c should remove these lines:
- #include <linux/delay.h>  // lines 16-16
- #include <linux/mutex.h>  // lines 12-12
- #include <linux/rcu_node_tree.h>  // lines 19-19
- #include <linux/sched.h>  // lines 15-15
- #include "rcu_segcblist.h"  // lines 20-20

The full include-list for kernel/rcu/srcutiny.c:
#include <asm/bug.h>               // for WARN_ON
#include <linux/export.h>          // for EXPORT_SYMBOL_GPL
#include <linux/preempt.h>         // for in_task
#include <linux/rcupdate.h>        // for rcu_scheduler_starting
#include <linux/rcupdate_wait.h>   // for rcu_synchronize, wakeme_after_rcu
#include <linux/srcu.h>            // for srcu_struct, synchronize_srcu, __s...
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u8
#include "asm-generic/rwonce.h"    // for READ_ONCE, WRITE_ONCE
#include "asm/cache.h"             // for __read_mostly
#include "linux/bottom_half.h"     // for local_bh_disable, local_bh_enable
#include "linux/compiler.h"        // for barrier, likely
#include "linux/completion.h"      // for init_completion, wait_for_completion
#include "linux/container_of.h"    // for container_of
#include "linux/init.h"            // for __init
#include "linux/irqflags.h"        // for local_irq_disable, local_irq_enable
#include "linux/list.h"            // for list_empty, INIT_LIST_HEAD, list_add
#include "linux/rcupdate.h"        // for USHORT_CMP_GE, destroy_rcu_head_on...
#include "linux/stddef.h"          // for false, true
#include "linux/swait.h"           // for swake_up_one, init_swait_queue_head
#include "linux/types.h"           // for callback_head, bool, rcu_head, rcu...
#include "linux/workqueue.h"       // for schedule_work, work_struct, flush_...
#include "rcu.h"                   // for RCU_SCHEDULER_RUNNING
#include "vdso/limits.h"           // for USHRT_MAX
---
  ./scripts/check-local-export kernel/rcu/srcutiny.o
  iwyu2 -Wp,-MMD,kernel/rcu/.tiny.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/rcu/tiny"' -DKBUILD_BASENAME='"tiny"' -DKBUILD_MODNAME='"tiny"' -D__KBUILD_MODNAME=kmod_tiny -c -o kernel/rcu/tiny.o kernel/rcu/tiny.c  
In file included from kernel/rcu/tiny.c:23:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/rcu/tiny.c:23:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/rcu/tiny.c:23:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/rcu/tiny.c:23:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/rcu/tiny.c:23:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/rcu/tiny.c:23:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/rcu/tiny.c should add these lines:
#include <linux/build_bug.h>       // for unlikely
#include <linux/preempt.h>         // for set_preempt_need_resched
#include <linux/rcupdate.h>        // for get_state_synchronize_rcu, poll_st...
#include <stddef.h>                // for NULL
#include "asm-generic/rwonce.h"    // for READ_ONCE, WRITE_ONCE
#include "asm/current.h"           // for current
#include "asm/processor.h"         // for prefetch
#include "linux/bottom_half.h"     // for local_bh_disable, local_bh_enable
#include "linux/compiler_types.h"  // for __latent_entropy, inline
#include "linux/irqflags.h"        // for local_irq_restore, local_irq_save
#include "linux/lockdep.h"         // for lock_is_held
#include "linux/rcupdate.h"        // for rcu_lock_release, RCU_LOCKDEP_WARN
#include "linux/stddef.h"          // for false, true
#include "trace/events/rcu.h"      // for trace_rcu_invoke_callback, trace_r...

kernel/rcu/tiny.c should remove these lines:
- #include <linux/completion.h>  // lines 12-12
- #include <linux/cpu.h>  // lines 23-23
- #include <linux/kernel.h>  // lines 16-16
- #include <linux/mm.h>  // lines 26-26
- #include <linux/mutex.h>  // lines 18-18
- #include <linux/notifier.h>  // lines 14-14
- #include <linux/time.h>  // lines 22-22

The full include-list for kernel/rcu/tiny.c:
#include <linux/build_bug.h>       // for unlikely
#include <linux/export.h>          // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include <linux/init.h>            // for __init
#include <linux/interrupt.h>       // for open_softirq, raise_softirq_irqoff
#include <linux/preempt.h>         // for set_preempt_need_resched
#include <linux/rcupdate.h>        // for get_state_synchronize_rcu, poll_st...
#include <linux/rcupdate_wait.h>   // for wait_rcu_gp
#include <linux/sched.h>           // for is_idle_task, set_tsk_need_resched
#include <linux/slab.h>            // for kvfree
#include <linux/types.h>           // for callback_head, rcu_head, rcu_callb...
#include <stddef.h>                // for NULL
#include "asm-generic/rwonce.h"    // for READ_ONCE, WRITE_ONCE
#include "asm/current.h"           // for current
#include "asm/processor.h"         // for prefetch
#include "linux/bottom_half.h"     // for local_bh_disable, local_bh_enable
#include "linux/compiler_types.h"  // for __latent_entropy, inline
#include "linux/irqflags.h"        // for local_irq_restore, local_irq_save
#include "linux/lockdep.h"         // for lock_is_held
#include "linux/rcupdate.h"        // for rcu_lock_release, RCU_LOCKDEP_WARN
#include "linux/stddef.h"          // for false, true
#include "rcu.h"                   // for resched_cpu, debug_rcu_head_queue
#include "trace/events/rcu.h"      // for trace_rcu_invoke_callback, trace_r...
---
  ./scripts/check-local-export kernel/rcu/tiny.o
  rm -f kernel/rcu/built-in.a; echo update.o sync.o srcutiny.o tiny.o | sed -E 's:([^ ]+):kernel/rcu/:g' | xargs llvm-ar cDPrST kernel/rcu/built-in.a
make -f ./scripts/Makefile.build obj=kernel/dma \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,kernel/dma/.mapping.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/dma/mapping"' -DKBUILD_BASENAME='"mapping"' -DKBUILD_MODNAME='"mapping"' -D__KBUILD_MODNAME=kmod_mapping -c -o kernel/dma/mapping.o kernel/dma/mapping.c  
In file included from kernel/dma/mapping.c:9:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
4 warnings generated.
In file included from kernel/dma/mapping.c:9:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^

kernel/dma/mapping.c should add these lines:
#include <asm/bug.h>                   // for BUG_ON, WARN_ON_ONCE, WARN_ON
#include <stddef.h>                    // for size_t, NULL
#include "asm-generic/errno-base.h"    // for EIO, ENXIO, EINVAL, ENOMEM
#include "asm-generic/int-ll64.h"      // for u64
#include "asm-generic/memory_model.h"  // for page_to_pfn
#include "asm/page_types.h"            // for PAGE_SHIFT
#include "asm/pgtable_types.h"         // for pgprot_t, PAGE_KERNEL
#include "linux/compiler.h"            // for likely
#include "linux/compiler_types.h"      // for inline
#include "linux/device.h"              // for device, devres_add, devres_des...
#include "linux/dma-direct.h"          // for dma_direct_alloc, dma_direct_a...
#include "linux/dma-direction.h"       // for valid_dma_direction, dma_data_...
#include "linux/dma-mapping.h"         // for DMA_MAPPING_ERROR, dma_free_co...
#include "linux/irqflags.h"            // for irqs_disabled
#include "linux/limits.h"              // for SIZE_MAX
#include "linux/mm.h"                  // for vma_pages, PAGE_ALIGN, remap_p...
#include "linux/mm_types.h"            // for vm_area_struct, page (ptr only)
#include "linux/scatterlist.h"         // for sg_table, sg_page, sg_free_table
#include "linux/stddef.h"              // for false, true
#include "linux/types.h"               // for dma_addr_t, bool, gfp_t, phys_...

kernel/dma/mapping.c should remove these lines:
- #include <linux/acpi.h>  // lines 9-9
- #include <linux/memblock.h>  // lines 8-8
- #include <linux/of_device.h>  // lines 13-13

The full include-list for kernel/dma/mapping.c:
#include <asm/bug.h>                   // for BUG_ON, WARN_ON_ONCE, WARN_ON
#include <linux/dma-map-ops.h>         // for get_dma_ops, dma_map_ops, dma_...
#include <linux/export.h>              // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/gfp.h>                 // for __GFP_DMA, __GFP_DMA32, __GFP_...
#include <linux/slab.h>                // for kfree, kmalloc
#include <linux/vmalloc.h>             // for vmap, vunmap, VM_MAP
#include <stddef.h>                    // for size_t, NULL
#include "asm-generic/errno-base.h"    // for EIO, ENXIO, EINVAL, ENOMEM
#include "asm-generic/int-ll64.h"      // for u64
#include "asm-generic/memory_model.h"  // for page_to_pfn
#include "asm/page_types.h"            // for PAGE_SHIFT
#include "asm/pgtable_types.h"         // for pgprot_t, PAGE_KERNEL
#include "debug.h"                     // for debug_dma_map_page, debug_dma_...
#include "direct.h"                    // for dma_direct_can_mmap, dma_direc...
#include "linux/compiler.h"            // for likely
#include "linux/compiler_types.h"      // for inline
#include "linux/device.h"              // for device, devres_add, devres_des...
#include "linux/dma-direct.h"          // for dma_direct_alloc, dma_direct_a...
#include "linux/dma-direction.h"       // for valid_dma_direction, dma_data_...
#include "linux/dma-mapping.h"         // for DMA_MAPPING_ERROR, dma_free_co...
#include "linux/irqflags.h"            // for irqs_disabled
#include "linux/limits.h"              // for SIZE_MAX
#include "linux/mm.h"                  // for vma_pages, PAGE_ALIGN, remap_p...
#include "linux/mm_types.h"            // for vm_area_struct, page (ptr only)
#include "linux/scatterlist.h"         // for sg_table, sg_page, sg_free_table
#include "linux/stddef.h"              // for false, true
#include "linux/types.h"               // for dma_addr_t, bool, gfp_t, phys_...
---
  ./scripts/check-local-export kernel/dma/mapping.o
  iwyu2 -Wp,-MMD,kernel/dma/.direct.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/dma/direct"' -DKBUILD_BASENAME='"direct"' -DKBUILD_MODNAME='"direct"' -D__KBUILD_MODNAME=kmod_direct -c -o kernel/dma/direct.o kernel/dma/direct.c  
In file included from kernel/dma/direct.c:10:
In file included from ./include/linux/dma-map-ops.h:9:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/dma/direct.c:10:
In file included from ./include/linux/dma-map-ops.h:9:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/dma/direct.c:10:
In file included from ./include/linux/dma-map-ops.h:9:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/dma/direct.c:10:
In file included from ./include/linux/dma-map-ops.h:9:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/dma/direct.c:10:
In file included from ./include/linux/dma-map-ops.h:9:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/dma/direct.c:10:
In file included from ./include/linux/dma-map-ops.h:9:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/dma/direct.h should add these lines:
#include <stddef.h>                // for size_t
#include "asm/io.h"                // for page_to_phys
#include "linux/compiler.h"        // for unlikely
#include "linux/compiler_types.h"  // for inline
#include "linux/dev_printk.h"      // for dev_WARN_ONCE
#include "linux/device.h"          // for device
#include "linux/dma-direction.h"   // for dma_data_direction, DMA_FROM_DEVICE
#include "linux/dma-map-ops.h"     // for dev_is_dma_coherent, arch_sync_dma...
#include "linux/dma-mapping.h"     // for DMA_ATTR_SKIP_CPU_SYNC, DMA_MAPPIN...
#include "linux/stddef.h"          // for true
#include "linux/swiotlb.h"         // for is_swiotlb_buffer, swiotlb_map
#include "linux/types.h"           // for dma_addr_t, phys_addr_t, bool
struct page;
struct scatterlist;
struct sg_table;
struct vm_area_struct;

kernel/dma/direct.h should remove these lines:

The full include-list for kernel/dma/direct.h:
#include <linux/dma-direct.h>      // for dma_to_phys, dma_capable, phys_to_dma
#include <stddef.h>                // for size_t
#include "asm/io.h"                // for page_to_phys
#include "linux/compiler.h"        // for unlikely
#include "linux/compiler_types.h"  // for inline
#include "linux/dev_printk.h"      // for dev_WARN_ONCE
#include "linux/device.h"          // for device
#include "linux/dma-direction.h"   // for dma_data_direction, DMA_FROM_DEVICE
#include "linux/dma-map-ops.h"     // for dev_is_dma_coherent, arch_sync_dma...
#include "linux/dma-mapping.h"     // for DMA_ATTR_SKIP_CPU_SYNC, DMA_MAPPIN...
#include "linux/stddef.h"          // for true
#include "linux/swiotlb.h"         // for is_swiotlb_buffer, swiotlb_map
#include "linux/types.h"           // for dma_addr_t, phys_addr_t, bool
struct page;
struct scatterlist;
struct sg_table;
struct vm_area_struct;
---

kernel/dma/direct.c should add these lines:
#include <asm/bug.h>                   // for WARN_ON_ONCE
#include "asm-generic/bitops/fls64.h"  // for fls64
#include "asm-generic/errno-base.h"    // for ENXIO, EINVAL, EIO, ENOMEM
#include "asm-generic/getorder.h"      // for get_order
#include "asm-generic/int-ll64.h"      // for u64
#include "asm-generic/memory_model.h"  // for pfn_to_page
#include "asm/page_types.h"            // for PAGE_SHIFT
#include "asm/pgtable.h"               // for pgprot_decrypted
#include "asm/pgtable_types.h"         // for PAGE_KERNEL, pgprot_t
#include "asm/set_memory.h"            // for set_memory_decrypted, set_memo...
#include "asm/string_32.h"             // for memset
#include "linux/cache.h"               // for __ro_after_init
#include "linux/dma-direct.h"          // for force_dma_unencrypted, dma_to_...
#include "linux/err.h"                 // for IS_ERR
#include "linux/gfp.h"                 // for GFP_DMA, GFP_DMA32, alloc_page...
#include "linux/kconfig.h"             // for IS_ENABLED
#include "linux/limits.h"              // for SIZE_MAX
#include "linux/minmax.h"              // for min_not_zero, min_t
#include "linux/mm_types.h"            // for vm_area_struct, page (ptr only)
#include "linux/printk.h"              // for pr_warn_ratelimited

kernel/dma/direct.c should remove these lines:
- #include <linux/export.h>  // lines 8-8
- #include <linux/set_memory.h>  // lines 14-14

The full include-list for kernel/dma/direct.c:
#include "direct.h"
#include <asm/bug.h>                   // for WARN_ON_ONCE
#include <linux/dma-map-ops.h>         // for dev_is_dma_coherent, dma_free_...
#include <linux/memblock.h>            // for max_pfn
#include <linux/mm.h>                  // for PageHighMem, PAGE_ALIGN, page_...
#include <linux/pfn.h>                 // for PFN_UP, PHYS_PFN
#include <linux/scatterlist.h>         // for scatterlist, sg_alloc_table
#include <linux/slab.h>                // for kcalloc
#include <linux/vmalloc.h>             // for vunmap
#include "asm-generic/bitops/fls64.h"  // for fls64
#include "asm-generic/errno-base.h"    // for ENXIO, EINVAL, EIO, ENOMEM
#include "asm-generic/getorder.h"      // for get_order
#include "asm-generic/int-ll64.h"      // for u64
#include "asm-generic/memory_model.h"  // for pfn_to_page
#include "asm/page_types.h"            // for PAGE_SHIFT
#include "asm/pgtable.h"               // for pgprot_decrypted
#include "asm/pgtable_types.h"         // for PAGE_KERNEL, pgprot_t
#include "asm/set_memory.h"            // for set_memory_decrypted, set_memo...
#include "asm/string_32.h"             // for memset
#include "linux/cache.h"               // for __ro_after_init
#include "linux/dma-direct.h"          // for force_dma_unencrypted, dma_to_...
#include "linux/err.h"                 // for IS_ERR
#include "linux/gfp.h"                 // for GFP_DMA, GFP_DMA32, alloc_page...
#include "linux/kconfig.h"             // for IS_ENABLED
#include "linux/limits.h"              // for SIZE_MAX
#include "linux/minmax.h"              // for min_not_zero, min_t
#include "linux/mm_types.h"            // for vm_area_struct, page (ptr only)
#include "linux/printk.h"              // for pr_warn_ratelimited
---
  ./scripts/check-local-export kernel/dma/direct.o
  iwyu2 -Wp,-MMD,kernel/dma/.remap.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/dma/remap"' -DKBUILD_BASENAME='"remap"' -DKBUILD_MODNAME='"remap"' -D__KBUILD_MODNAME=kmod_remap -c -o kernel/dma/remap.o kernel/dma/remap.c  
In file included from kernel/dma/remap.c:5:
In file included from ./include/linux/dma-map-ops.h:9:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/dma/remap.c:5:
In file included from ./include/linux/dma-map-ops.h:9:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/dma/remap.c:5:
In file included from ./include/linux/dma-map-ops.h:9:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/dma/remap.c:5:
In file included from ./include/linux/dma-map-ops.h:9:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/dma/remap.c:5:
In file included from ./include/linux/dma-map-ops.h:9:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/dma/remap.c:5:
In file included from ./include/linux/dma-map-ops.h:9:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/dma/remap.c should add these lines:
#include <asm/bug.h>            // for WARN
#include <stddef.h>             // for size_t, NULL
#include "asm/page_types.h"     // for PAGE_SHIFT
#include "asm/pgtable_types.h"  // for pgprot_t
#include "linux/gfp.h"          // for GFP_KERNEL
#include "linux/mm.h"           // for PAGE_ALIGN, nth_page
struct page;

kernel/dma/remap.c should remove these lines:

The full include-list for kernel/dma/remap.c:
#include <asm/bug.h>            // for WARN
#include <linux/dma-map-ops.h>  // for dma_common_contiguous_remap, dma_comm...
#include <linux/slab.h>         // for kfree, kmalloc_array
#include <linux/vmalloc.h>      // for find_vm_area, vmap, VM_DMA_COHERENT
#include <stddef.h>             // for size_t, NULL
#include "asm/page_types.h"     // for PAGE_SHIFT
#include "asm/pgtable_types.h"  // for pgprot_t
#include "linux/gfp.h"          // for GFP_KERNEL
#include "linux/mm.h"           // for PAGE_ALIGN, nth_page
struct page;
---
  ./scripts/check-local-export kernel/dma/remap.o
  rm -f kernel/dma/built-in.a; echo mapping.o direct.o remap.o | sed -E 's:([^ ]+):kernel/dma/:g' | xargs llvm-ar cDPrST kernel/dma/built-in.a
make -f ./scripts/Makefile.build obj=kernel/entry \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,kernel/entry/.common.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -fno-stack-protector    -DKBUILD_MODFILE='"kernel/entry/common"' -DKBUILD_BASENAME='"common"' -DKBUILD_MODNAME='"common"' -D__KBUILD_MODNAME=kmod_common -c -o kernel/entry/common.o kernel/entry/common.c  
In file included from kernel/entry/common.c:4:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/entry/common.c:4:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/entry/common.c:4:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/entry/common.c:4:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from kernel/entry/common.c:4:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/entry/common.c:4:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/entry/common.c:4:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/entry/common.c:4:
In file included from ./include/linux/entry-common.h:7:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/entry/common.h should add these lines:
#include "linux/types.h"  // for bool
struct pt_regs;

kernel/entry/common.h should remove these lines:

The full include-list for kernel/entry/common.h:
#include "linux/types.h"  // for bool
struct pt_regs;
---

kernel/entry/common.c should add these lines:
#include <asm/bug.h>                       // for WARN, WARN_ON_ONCE
#include <linux/preempt.h>                 // for preempt_count
#include <linux/rcupdate.h>                // for rcu_irq_exit, rcu_irq_enter
#include <stddef.h>                        // for NULL
#include "asm-generic/rwonce.h"            // for READ_ONCE
#include "asm/current.h"                   // for current
#include "asm/entry-common.h"              // for arch_enter_from_user_mode
#include "asm/processor.h"                 // for on_thread_stack
#include "asm/ptrace.h"                    // for pt_regs (ptr only), user_mode
#include "asm/syscall.h"                   // for syscall_get_nr, syscall_ge...
#include "asm/thread_info.h"               // for thread_info, _TIF_NEED_RES...
#include "generated/autoconf.h"            // for CONFIG_TINY_RCU
#include "linux/compiler.h"                // for unlikely
#include "linux/compiler_attributes.h"     // for __always_inline, __visible
#include "linux/compiler_types.h"          // for noinstr, inline
#include "linux/context_tracking_state.h"  // for CONTEXT_KERNEL, CONTEXT_USER
#include "linux/ftrace.h"                  // for CALLER_ADDR0
#include "linux/ftrace_irq.h"              // for ftrace_nmi_enter, ftrace_n...
#include "linux/hardirq.h"                 // for rcu_irq_enter_check_tick
#include "linux/highmem-internal.h"        // for kmap_assert_nomap
#include "linux/instrumentation.h"         // for instrumentation_begin, ins...
#include "linux/irqflags.h"                // for lockdep_hardirqs_off, lock...
#include "linux/kconfig.h"                 // for IS_ENABLED, __ARG_PLACEHOL...
#include "linux/lockdep.h"                 // for lockdep_assert_irqs_disabled
#include "linux/ptrace.h"                  // for ptrace_report_syscall_entry
#include "linux/sched.h"                   // for is_idle_task, need_resched
#include "linux/seccomp.h"                 // for __secure_computing
#include "linux/stddef.h"                  // for false, true
#include "linux/syscall_user_dispatch.h"   // for syscall_user_dispatch
#include "linux/syscalls.h"                // for addr_limit_user_check
#include "linux/thread_info.h"             // for SYSCALL_WORK_SYSCALL_EMU
#include "linux/uprobes.h"                 // for uprobe_notify_resume

kernel/entry/common.c should remove these lines:
- #include <linux/highmem.h>  // lines 6-6
- #include <linux/jump_label.h>  // lines 7-7

The full include-list for kernel/entry/common.c:
#include "common.h"
#include <asm/bug.h>                       // for WARN, WARN_ON_ONCE
#include <linux/audit.h>                   // for audit_context, audit_sysca...
#include <linux/context_tracking.h>        // for ct_state, user_enter_irqoff
#include <linux/entry-common.h>            // for irqentry_state_t, irqentry...
#include <linux/livepatch.h>               // for klp_update_patch_state
#include <linux/preempt.h>                 // for preempt_count
#include <linux/rcupdate.h>                // for rcu_irq_exit, rcu_irq_enter
#include <linux/resume_user_mode.h>        // for resume_user_mode_work
#include <linux/tick.h>                    // for tick_nohz_user_enter_prepare
#include <stddef.h>                        // for NULL
#include <trace/events/syscalls.h>         // for trace_sys_enter, trace_sys...
#include "asm-generic/rwonce.h"            // for READ_ONCE
#include "asm/current.h"                   // for current
#include "asm/entry-common.h"              // for arch_enter_from_user_mode
#include "asm/processor.h"                 // for on_thread_stack
#include "asm/ptrace.h"                    // for pt_regs (ptr only), user_mode
#include "asm/syscall.h"                   // for syscall_get_nr, syscall_ge...
#include "asm/thread_info.h"               // for thread_info, _TIF_NEED_RES...
#include "generated/autoconf.h"            // for CONFIG_TINY_RCU
#include "linux/compiler.h"                // for unlikely
#include "linux/compiler_attributes.h"     // for __always_inline, __visible
#include "linux/compiler_types.h"          // for noinstr, inline
#include "linux/context_tracking_state.h"  // for CONTEXT_KERNEL, CONTEXT_USER
#include "linux/ftrace.h"                  // for CALLER_ADDR0
#include "linux/ftrace_irq.h"              // for ftrace_nmi_enter, ftrace_n...
#include "linux/hardirq.h"                 // for rcu_irq_enter_check_tick
#include "linux/highmem-internal.h"        // for kmap_assert_nomap
#include "linux/instrumentation.h"         // for instrumentation_begin, ins...
#include "linux/irqflags.h"                // for lockdep_hardirqs_off, lock...
#include "linux/kconfig.h"                 // for IS_ENABLED, __ARG_PLACEHOL...
#include "linux/lockdep.h"                 // for lockdep_assert_irqs_disabled
#include "linux/ptrace.h"                  // for ptrace_report_syscall_entry
#include "linux/sched.h"                   // for is_idle_task, need_resched
#include "linux/seccomp.h"                 // for __secure_computing
#include "linux/stddef.h"                  // for false, true
#include "linux/syscall_user_dispatch.h"   // for syscall_user_dispatch
#include "linux/syscalls.h"                // for addr_limit_user_check
#include "linux/thread_info.h"             // for SYSCALL_WORK_SYSCALL_EMU
#include "linux/uprobes.h"                 // for uprobe_notify_resume
---
  ./scripts/check-local-export kernel/entry/common.o
  iwyu2 -Wp,-MMD,kernel/entry/.syscall_user_dispatch.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/entry/syscall_user_dispatch"' -DKBUILD_BASENAME='"syscall_user_dispatch"' -DKBUILD_MODNAME='"syscall_user_dispatch"' -D__KBUILD_MODNAME=kmod_syscall_user_dispatch -c -o kernel/entry/syscall_user_dispatch.o kernel/entry/syscall_user_dispatch.c  

kernel/entry/syscall_user_dispatch.c should add these lines:
#include <asm/signal.h>                   // for SIGSYS, SIGSEGV
#include "asm-generic/errno-base.h"       // for EINVAL, EFAULT
#include "asm-generic/siginfo.h"          // for SYS_USER_DISPATCH, si_arch
#include "asm/current.h"                  // for current
#include "asm/elf.h"                      // for arch_syscall_is_vdso_sigreturn
#include "asm/processor.h"                // for KSTK_EIP
#include "asm/ptrace.h"                   // for instruction_pointer, pt_regs
#include "asm/thread_info.h"              // for thread_info
#include "asm/uaccess.h"                  // for __get_user, access_ok
#include "linux/compiler.h"               // for likely, unlikely
#include "linux/compiler_types.h"         // for __user
#include "linux/signal_types.h"           // for kernel_siginfo, kernel_sigi...
#include "linux/stddef.h"                 // for false, true
#include "linux/thread_info.h"            // for SYSCALL_WORK_BIT_SYSCALL_US...
#include "linux/types.h"                  // for bool

kernel/entry/syscall_user_dispatch.c should remove these lines:
- #include <linux/elf.h>  // lines 10-10
- #include <linux/sched/task_stack.h>  // lines 13-13
- #include <linux/uaccess.h>  // lines 8-8

The full include-list for kernel/entry/syscall_user_dispatch.c:
#include <asm/signal.h>                   // for SIGSYS, SIGSEGV
#include <asm/syscall.h>                  // for syscall_get_arch, syscall_g...
#include <linux/prctl.h>                  // for PR_SYS_DISPATCH_ON, PR_SYS_...
#include <linux/sched.h>                  // for task_struct
#include <linux/sched/signal.h>           // for force_exit_sig, force_sig_info
#include <linux/signal.h>                 // for clear_siginfo
#include <linux/syscall_user_dispatch.h>  // for syscall_user_dispatch, set_...
#include "asm-generic/errno-base.h"       // for EINVAL, EFAULT
#include "asm-generic/siginfo.h"          // for SYS_USER_DISPATCH, si_arch
#include "asm/current.h"                  // for current
#include "asm/elf.h"                      // for arch_syscall_is_vdso_sigreturn
#include "asm/processor.h"                // for KSTK_EIP
#include "asm/ptrace.h"                   // for instruction_pointer, pt_regs
#include "asm/thread_info.h"              // for thread_info
#include "asm/uaccess.h"                  // for __get_user, access_ok
#include "common.h"                       // for syscall_user_dispatch
#include "linux/compiler.h"               // for likely, unlikely
#include "linux/compiler_types.h"         // for __user
#include "linux/signal_types.h"           // for kernel_siginfo, kernel_sigi...
#include "linux/stddef.h"                 // for false, true
#include "linux/thread_info.h"            // for SYSCALL_WORK_BIT_SYSCALL_US...
#include "linux/types.h"                  // for bool
---
  ./scripts/check-local-export kernel/entry/syscall_user_dispatch.o
  rm -f kernel/entry/built-in.a; echo common.o syscall_user_dispatch.o | sed -E 's:([^ ]+):kernel/entry/:g' | xargs llvm-ar cDPrST kernel/entry/built-in.a
make -f ./scripts/Makefile.build obj=kernel/time \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,kernel/time/.time.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/time/time"' -DKBUILD_BASENAME='"time"' -DKBUILD_MODNAME='"time"' -D__KBUILD_MODNAME=kmod_time -c -o kernel/time/time.o kernel/time/time.c  
In file included from kernel/time/time.c:33:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
1 warning generated.
In file included from kernel/time/time.c:33:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/time/time.c should add these lines:
#include <asm/posix_types.h>            // for __kernel_long_t
#include <linux/ktime.h>                // for do_settimeofday64, ktime_get_...
#include <sys/types.h>                  // for suseconds_t
#include <ctime>                        // for NULL, clock_t
#include "asm-generic/errno-base.h"     // for EFAULT, EINVAL
#include "asm-generic/int-ll64.h"       // for u64, s64, s32, u32
#include "asm-generic/param.h"          // for HZ, USER_HZ
#include "asm/div64.h"                  // for div_u64_rem
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/uaccess.h"                // for get_user, put_user
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/compiler.h"             // for likely, unlikely
#include "linux/compiler_types.h"       // for __user
#include "linux/jiffies.h"              // for MAX_JIFFY_OFFSET, _msecs_to_j...
#include "linux/time.h"                 // for timezone, get_itimerspec64
#include "linux/time32.h"               // for old_itimerspec32, get_old_iti...
#include "linux/time64.h"               // for timespec64, itimerspec64, tim...
#include "linux/time_types.h"           // for __kernel_old_timeval, __kerne...
#include "vdso/jiffies.h"               // for TICK_NSEC
#include "vdso/time32.h"                // for old_timespec32
#include "vdso/time64.h"                // for NSEC_PER_SEC, MSEC_PER_SEC

kernel/time/time.c should remove these lines:
- #include <asm/unistd.h>  // lines 41-41
- #include <generated/timeconst.h>  // lines 43-43
- #include <linux/capability.h>  // lines 30-30
- #include <linux/errno.h>  // lines 32-32
- #include <linux/fs.h>  // lines 35-35
- #include <linux/kernel.h>  // lines 28-28
- #include <linux/ptrace.h>  // lines 37-37
- #include <linux/timex.h>  // lines 29-29

The full include-list for kernel/time/time.c:
#include <asm/posix_types.h>            // for __kernel_long_t
#include <linux/compat.h>               // for COMPAT_USE_64BIT_TIME, in_com...
#include <linux/export.h>               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/ktime.h>                // for do_settimeofday64, ktime_get_...
#include <linux/math64.h>               // for div_u64
#include <linux/security.h>             // for security_settime64
#include <linux/syscalls.h>             // for __MAP2, SYSCALL_DEFINE2
#include <linux/timekeeper_internal.h>  // for update_vsyscall_tz
#include <linux/uaccess.h>              // for copy_from_user, copy_to_user
#include <sys/types.h>                  // for suseconds_t
#include <ctime>                        // for NULL, clock_t
#include "asm-generic/errno-base.h"     // for EFAULT, EINVAL
#include "asm-generic/int-ll64.h"       // for u64, s64, s32, u32
#include "asm-generic/param.h"          // for HZ, USER_HZ
#include "asm/div64.h"                  // for div_u64_rem
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/uaccess.h"                // for get_user, put_user
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/compiler.h"             // for likely, unlikely
#include "linux/compiler_types.h"       // for __user
#include "linux/jiffies.h"              // for MAX_JIFFY_OFFSET, _msecs_to_j...
#include "linux/time.h"                 // for timezone, get_itimerspec64
#include "linux/time32.h"               // for old_itimerspec32, get_old_iti...
#include "linux/time64.h"               // for timespec64, itimerspec64, tim...
#include "linux/time_types.h"           // for __kernel_old_timeval, __kerne...
#include "timekeeping.h"                // for timekeeping_warp_clock
#include "vdso/jiffies.h"               // for TICK_NSEC
#include "vdso/time32.h"                // for old_timespec32
#include "vdso/time64.h"                // for NSEC_PER_SEC, MSEC_PER_SEC
---
  ./scripts/check-local-export kernel/time/time.o
  iwyu2 -Wp,-MMD,kernel/time/.timer.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/time/timer"' -DKBUILD_BASENAME='"timer"' -DKBUILD_MODNAME='"timer"' -D__KBUILD_MODNAME=kmod_timer -c -o kernel/time/timer.o kernel/time/timer.c  
In file included from kernel/time/timer.c:27:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/time/timer.c:27:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/time/timer.c:27:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/time/timer.c:27:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from kernel/time/timer.c:27:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/time/timer.c:27:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/time/timer.c:27:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/time/timer.c:27:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/time/timer.c should add these lines:
#include <asm-generic/percpu.h>         // for this_cpu_ptr, per_cpu_ptr
#include <asm/bitops.h>                 // for __clear_bit, __set_bit, __tes...
#include <asm/bug.h>                    // for BUG_ON, WARN_ON_ONCE, WARN_ONCE
#include <linux/bitmap.h>               // for find_next_bit
#include <linux/ktime.h>                // for ktime_get
#include <linux/preempt.h>              // for preempt_count, preempt_count_set
#include <stddef.h>                     // for NULL
#include "asm-generic/int-ll64.h"       // for u32, u64
#include "asm-generic/param.h"          // for HZ
#include "asm-generic/rwonce.h"         // for READ_ONCE, WRITE_ONCE
#include "asm/current.h"                // for current
#include "asm/vdso/processor.h"         // for cpu_relax
#include "linux/cache.h"                // for ____cacheline_aligned, __cach...
#include "linux/compiler.h"             // for likely
#include "linux/compiler_attributes.h"  // for __visible
#include "linux/compiler_types.h"       // for inline, __acquires, __latent_...
#include "linux/cpumask.h"              // for for_each_possible_cpu
#include "linux/hrtimer.h"              // for hrtimer_run_queues, schedule_...
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_ERR
#include "linux/ktime.h"                // for ktime_add_us, ktime_t
#include "linux/list.h"                 // for __hlist_del, hlist_add_head
#include "linux/lockdep.h"              // for lock_map_acquire, lock_map_re...
#include "linux/poison.h"               // for LIST_POISON2
#include "linux/preempt.h"              // for in_irq
#include "linux/printk.h"               // for dump_stack, printk
#include "linux/rcupdate.h"             // for rcu_sched_clock_irq
#include "linux/sched.h"                // for task_struct, __set_current_state
#include "linux/smp.h"                  // for raw_smp_processor_id
#include "linux/spinlock.h"             // for raw_spin_unlock_irqrestore
#include "linux/spinlock_types_raw.h"   // for raw_spinlock_t
#include "linux/stddef.h"               // for true, false
#include "linux/timer.h"                // for timer_list, timer_pending
#include "linux/types.h"                // for hlist_head, bool, hlist_node
#include "timekeeping.h"                // for update_process_times
#include "vdso/limits.h"                // for UINT_MAX
#include "vdso/time64.h"                // for NSEC_PER_USEC
struct lock_class_key;

kernel/time/timer.c should remove these lines:
- #include <asm/div64.h>  // lines 51-51
- #include <asm/io.h>  // lines 53-53
- #include <asm/timex.h>  // lines 52-52
- #include <asm/unistd.h>  // lines 50-50
- #include <linux/compat.h>  // lines 45-45
- #include <linux/cpu.h>  // lines 34-34
- #include <linux/kallsyms.h>  // lines 38-38
- #include <linux/mm.h>  // lines 26-26
- #include <linux/notifier.h>  // lines 29-29
- #include <linux/percpu.h>  // lines 24-24
- #include <linux/pid_namespace.h>  // lines 28-28
- #include <linux/random.h>  // lines 46-46
- #include <linux/sched/sysctl.h>  // lines 41-41
- #include <linux/slab.h>  // lines 44-44
- #include <linux/swap.h>  // lines 27-27
- #include <linux/syscalls.h>  // lines 35-35
- #include <linux/sysctl.h>  // lines 47-47
- #include <linux/thread_info.h>  // lines 30-30
- #include <linux/time.h>  // lines 31-31
- #include <linux/uaccess.h>  // lines 49-49
- #include "tick-internal.h"  // lines 55-55

The full include-list for kernel/time/timer.c:
#include <asm-generic/percpu.h>         // for this_cpu_ptr, per_cpu_ptr
#include <asm/bitops.h>                 // for __clear_bit, __set_bit, __tes...
#include <asm/bug.h>                    // for BUG_ON, WARN_ON_ONCE, WARN_ONCE
#include <linux/bitmap.h>               // for find_next_bit
#include <linux/delay.h>                // for msleep, msleep_interruptible
#include <linux/export.h>               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/init.h>                 // for __init
#include <linux/interrupt.h>            // for open_softirq, raise_softirq
#include <linux/irq_work.h>             // for irq_work_tick
#include <linux/jiffies.h>              // for jiffies, msecs_to_jiffies
#include <linux/kernel_stat.h>          // for account_process_tick
#include <linux/ktime.h>                // for ktime_get
#include <linux/posix-timers.h>         // for posix_cputimers_init_work
#include <linux/preempt.h>              // for preempt_count, preempt_count_set
#include <linux/sched/debug.h>          // for __sched
#include <linux/sched/nohz.h>           // for wake_up_nohz_cpu
#include <linux/sched/signal.h>         // for signal_pending
#include <linux/tick.h>                 // for tick_nohz_full_cpu
#include <stddef.h>                     // for NULL
#include <trace/events/timer.h>         // for trace_timer_cancel, trace_tim...
#include "asm-generic/int-ll64.h"       // for u32, u64
#include "asm-generic/param.h"          // for HZ
#include "asm-generic/rwonce.h"         // for READ_ONCE, WRITE_ONCE
#include "asm/current.h"                // for current
#include "asm/vdso/processor.h"         // for cpu_relax
#include "linux/cache.h"                // for ____cacheline_aligned, __cach...
#include "linux/compiler.h"             // for likely
#include "linux/compiler_attributes.h"  // for __visible
#include "linux/compiler_types.h"       // for inline, __acquires, __latent_...
#include "linux/cpumask.h"              // for for_each_possible_cpu
#include "linux/hrtimer.h"              // for hrtimer_run_queues, schedule_...
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_ERR
#include "linux/ktime.h"                // for ktime_add_us, ktime_t
#include "linux/list.h"                 // for __hlist_del, hlist_add_head
#include "linux/lockdep.h"              // for lock_map_acquire, lock_map_re...
#include "linux/poison.h"               // for LIST_POISON2
#include "linux/preempt.h"              // for in_irq
#include "linux/printk.h"               // for dump_stack, printk
#include "linux/rcupdate.h"             // for rcu_sched_clock_irq
#include "linux/sched.h"                // for task_struct, __set_current_state
#include "linux/smp.h"                  // for raw_smp_processor_id
#include "linux/spinlock.h"             // for raw_spin_unlock_irqrestore
#include "linux/spinlock_types_raw.h"   // for raw_spinlock_t
#include "linux/stddef.h"               // for true, false
#include "linux/timer.h"                // for timer_list, timer_pending
#include "linux/types.h"                // for hlist_head, bool, hlist_node
#include "timekeeping.h"                // for update_process_times
#include "vdso/limits.h"                // for UINT_MAX
#include "vdso/time64.h"                // for NSEC_PER_USEC
struct lock_class_key;
---
  ./scripts/check-local-export kernel/time/timer.o
  iwyu2 -Wp,-MMD,kernel/time/.hrtimer.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/time/hrtimer"' -DKBUILD_BASENAME='"hrtimer"' -DKBUILD_MODNAME='"hrtimer"' -D__KBUILD_MODNAME=kmod_hrtimer -c -o kernel/time/hrtimer.o kernel/time/hrtimer.c  
In file included from kernel/time/hrtimer.c:25:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/time/hrtimer.c:25:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/time/hrtimer.c:25:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/time/hrtimer.c:30:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
kernel/time/hrtimer.c:120:21: warning: initializer overrides prior initialization of this subobject [-Winitializer-overrides]
        [CLOCK_REALTIME]        = HRTIMER_BASE_REALTIME,
                                  ^~~~~~~~~~~~~~~~~~~~~
kernel/time/hrtimer.c:118:27: note: previous initialization is here
        [0 ... MAX_CLOCKS - 1]  = HRTIMER_MAX_CLOCK_BASES,
                                  ^~~~~~~~~~~~~~~~~~~~~~~
kernel/time/hrtimer.c:121:22: warning: initializer overrides prior initialization of this subobject [-Winitializer-overrides]
        [CLOCK_MONOTONIC]       = HRTIMER_BASE_MONOTONIC,
                                  ^~~~~~~~~~~~~~~~~~~~~~
kernel/time/hrtimer.c:118:27: note: previous initialization is here
        [0 ... MAX_CLOCKS - 1]  = HRTIMER_MAX_CLOCK_BASES,
                                  ^~~~~~~~~~~~~~~~~~~~~~~
kernel/time/hrtimer.c:122:21: warning: initializer overrides prior initialization of this subobject [-Winitializer-overrides]
        [CLOCK_BOOTTIME]        = HRTIMER_BASE_BOOTTIME,
                                  ^~~~~~~~~~~~~~~~~~~~~
kernel/time/hrtimer.c:118:27: note: previous initialization is here
        [0 ... MAX_CLOCKS - 1]  = HRTIMER_MAX_CLOCK_BASES,
                                  ^~~~~~~~~~~~~~~~~~~~~~~
kernel/time/hrtimer.c:123:17: warning: initializer overrides prior initialization of this subobject [-Winitializer-overrides]
        [CLOCK_TAI]             = HRTIMER_BASE_TAI,
                                  ^~~~~~~~~~~~~~~~
kernel/time/hrtimer.c:118:27: note: previous initialization is here
        [0 ... MAX_CLOCKS - 1]  = HRTIMER_MAX_CLOCK_BASES,
                                  ^~~~~~~~~~~~~~~~~~~~~~~
8 warnings generated.
In file included from kernel/time/hrtimer.c:25:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/time/hrtimer.c:25:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/time/hrtimer.c:25:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/time/hrtimer.c:30:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
kernel/time/hrtimer.c:120:21: warning: initializer overrides prior initialization of this subobject [-Winitializer-overrides]
        [CLOCK_REALTIME]        = HRTIMER_BASE_REALTIME,
                                  ^~~~~~~~~~~~~~~~~~~~~
kernel/time/hrtimer.c:118:27: note: previous initialization is here
        [0 ... MAX_CLOCKS - 1]  = HRTIMER_MAX_CLOCK_BASES,
                                  ^~~~~~~~~~~~~~~~~~~~~~~
kernel/time/hrtimer.c:121:22: warning: initializer overrides prior initialization of this subobject [-Winitializer-overrides]
        [CLOCK_MONOTONIC]       = HRTIMER_BASE_MONOTONIC,
                                  ^~~~~~~~~~~~~~~~~~~~~~
kernel/time/hrtimer.c:118:27: note: previous initialization is here
        [0 ... MAX_CLOCKS - 1]  = HRTIMER_MAX_CLOCK_BASES,
                                  ^~~~~~~~~~~~~~~~~~~~~~~
kernel/time/hrtimer.c:122:21: warning: initializer overrides prior initialization of this subobject [-Winitializer-overrides]
        [CLOCK_BOOTTIME]        = HRTIMER_BASE_BOOTTIME,
                                  ^~~~~~~~~~~~~~~~~~~~~
kernel/time/hrtimer.c:118:27: note: previous initialization is here
        [0 ... MAX_CLOCKS - 1]  = HRTIMER_MAX_CLOCK_BASES,
                                  ^~~~~~~~~~~~~~~~~~~~~~~
kernel/time/hrtimer.c:123:17: warning: initializer overrides prior initialization of this subobject [-Winitializer-overrides]
        [CLOCK_TAI]             = HRTIMER_BASE_TAI,
                                  ^~~~~~~~~~~~~~~~
kernel/time/hrtimer.c:118:27: note: previous initialization is here
        [0 ... MAX_CLOCKS - 1]  = HRTIMER_MAX_CLOCK_BASES,
                                  ^~~~~~~~~~~~~~~~~~~~~~~

kernel/time/hrtimer.c should add these lines:
#include <asm-generic/percpu.h>        // for this_cpu_ptr, per_cpu, raw_cpu...
#include <asm/bug.h>                   // for WARN_ON_ONCE, WARN, WARN_ON
#include <linux/bitops.h>              // for __ffs
#include <linux/ktime.h>               // for ktime_get, ktime_get_boottime
#include <ctime>                       // for NULL, clockid_t
#include "asm-generic/bitsperlong.h"   // for BITS_PER_LONG
#include "asm-generic/errno-base.h"    // for EINTR, EFAULT
#include "asm-generic/int-ll64.h"      // for u8, u64, s64, u32
#include "asm-generic/rwonce.h"        // for READ_ONCE, WRITE_ONCE
#include "asm/bug.h"                   // for BUG
#include "asm/current.h"               // for current
#include "asm/div64.h"                 // for do_div
#include "asm/string_32.h"             // for memset
#include "linux/compiler.h"            // for likely, unlikely
#include "linux/compiler_types.h"      // for inline, __latent_entropy, __mu...
#include "linux/container_of.h"        // for container_of
#include "linux/cpumask.h"             // for cpumask_set_cpu, free_cpumask_var
#include "linux/errno.h"               // for ERESTART_RESTARTBLOCK, ERESTAR...
#include "linux/gfp.h"                 // for GFP_KERNEL
#include "linux/init.h"                // for __init
#include "linux/irqflags.h"            // for lockdep_hrtimer_enter, lockdep...
#include "linux/kconfig.h"             // for IS_ENABLED
#include "linux/ktime.h"               // for ktime_t, ktime_before, ktime_t...
#include "linux/lockdep.h"             // for lockdep_assert_held, lockdep_a...
#include "linux/preempt.h"             // for preempt_disable, preempt_enable
#include "linux/restart_block.h"       // for restart_block, restart_block::...
#include "linux/sched.h"               // for task_struct, schedule, TASK_RU...
#include "linux/seqlock.h"             // for __seqprop_mutex_ptr, __seqprop...
#include "linux/smp.h"                 // for on_each_cpu, smp_call_function...
#include "linux/spinlock.h"            // for raw_spin_unlock_irqrestore
#include "linux/spinlock_types_raw.h"  // for __RAW_SPIN_LOCK_UNLOCKED
#include "linux/stddef.h"              // for false, true
#include "linux/thread_info.h"         // for set_restart_fn
#include "linux/time.h"                // for CLOCK_MONOTONIC, CLOCK_REALTIME
#include "linux/time64.h"              // for KTIME_MAX, KTIME_SEC_MAX, time...
#include "linux/timerqueue.h"          // for timerqueue_getnext, timerqueue...
#include "linux/types.h"               // for bool
#include "linux/workqueue.h"           // for work_struct, schedule_work
#include "timekeeping.h"               // for ktime_get_update_offsets_now

kernel/time/hrtimer.c should remove these lines:
- #include <linux/compat.h>  // lines 43-43
- #include <linux/debugobjects.h>  // lines 34-34
- #include <linux/err.h>  // lines 33-33
- #include <linux/notifier.h>  // lines 29-29
- #include <linux/percpu.h>  // lines 27-27
- #include <linux/sched/nohz.h>  // lines 39-39
- #include <linux/sched/sysctl.h>  // lines 36-36
- #include <linux/syscalls.h>  // lines 30-30
- #include <linux/tick.h>  // lines 32-32
- #include <linux/timer.h>  // lines 41-41
- #include <linux/uaccess.h>  // lines 45-45

The full include-list for kernel/time/hrtimer.c:
#include <asm-generic/percpu.h>        // for this_cpu_ptr, per_cpu, raw_cpu...
#include <asm/bug.h>                   // for WARN_ON_ONCE, WARN, WARN_ON
#include <linux/bitops.h>              // for __ffs
#include <linux/cpu.h>                 // for cpus_read_lock, cpus_read_unlock
#include <linux/export.h>              // for EXPORT_SYMBOL_GPL
#include <linux/freezer.h>             // for freezable_schedule
#include <linux/hrtimer.h>             // for hrtimer_cpu_base, hrtimer_cloc...
#include <linux/interrupt.h>           // for open_softirq, raise_softirq_ir...
#include <linux/ktime.h>               // for ktime_get, ktime_get_boottime
#include <linux/sched/deadline.h>      // for dl_task
#include <linux/sched/debug.h>         // for __sched
#include <linux/sched/rt.h>            // for rt_task, task_is_realtime
#include <linux/sched/signal.h>        // for signal_pending
#include <trace/events/timer.h>        // for trace_hrtimer_cancel, trace_hr...
#include <ctime>                       // for NULL, clockid_t
#include "asm-generic/bitsperlong.h"   // for BITS_PER_LONG
#include "asm-generic/errno-base.h"    // for EINTR, EFAULT
#include "asm-generic/int-ll64.h"      // for u8, u64, s64, u32
#include "asm-generic/rwonce.h"        // for READ_ONCE, WRITE_ONCE
#include "asm/bug.h"                   // for BUG
#include "asm/current.h"               // for current
#include "asm/div64.h"                 // for do_div
#include "asm/string_32.h"             // for memset
#include "linux/compiler.h"            // for likely, unlikely
#include "linux/compiler_types.h"      // for inline, __latent_entropy, __mu...
#include "linux/container_of.h"        // for container_of
#include "linux/cpumask.h"             // for cpumask_set_cpu, free_cpumask_var
#include "linux/errno.h"               // for ERESTART_RESTARTBLOCK, ERESTAR...
#include "linux/gfp.h"                 // for GFP_KERNEL
#include "linux/init.h"                // for __init
#include "linux/irqflags.h"            // for lockdep_hrtimer_enter, lockdep...
#include "linux/kconfig.h"             // for IS_ENABLED
#include "linux/ktime.h"               // for ktime_t, ktime_before, ktime_t...
#include "linux/lockdep.h"             // for lockdep_assert_held, lockdep_a...
#include "linux/preempt.h"             // for preempt_disable, preempt_enable
#include "linux/restart_block.h"       // for restart_block, restart_block::...
#include "linux/sched.h"               // for task_struct, schedule, TASK_RU...
#include "linux/seqlock.h"             // for __seqprop_mutex_ptr, __seqprop...
#include "linux/smp.h"                 // for on_each_cpu, smp_call_function...
#include "linux/spinlock.h"            // for raw_spin_unlock_irqrestore
#include "linux/spinlock_types_raw.h"  // for __RAW_SPIN_LOCK_UNLOCKED
#include "linux/stddef.h"              // for false, true
#include "linux/thread_info.h"         // for set_restart_fn
#include "linux/time.h"                // for CLOCK_MONOTONIC, CLOCK_REALTIME
#include "linux/time64.h"              // for KTIME_MAX, KTIME_SEC_MAX, time...
#include "linux/timerqueue.h"          // for timerqueue_getnext, timerqueue...
#include "linux/types.h"               // for bool
#include "linux/workqueue.h"           // for work_struct, schedule_work
#include "tick-internal.h"             // for tick_check_oneshot_change, tic...
#include "timekeeping.h"               // for ktime_get_update_offsets_now
---
  ./scripts/check-local-export kernel/time/hrtimer.o
  iwyu2 -Wp,-MMD,kernel/time/.timekeeping.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/time/timekeeping"' -DKBUILD_BASENAME='"timekeeping"' -DKBUILD_MODNAME='"timekeeping"' -D__KBUILD_MODNAME=kmod_timekeeping -c -o kernel/time/timekeeping.o kernel/time/timekeeping.c  
In file included from kernel/time/timekeeping.c:25:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^
1 warning generated.
In file included from kernel/time/timekeeping.c:25:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^

kernel/time/timekeeping.h should add these lines:
#include "asm-generic/int-ll64.h"      // for u64
#include "linux/compiler_types.h"      // for inline
#include "linux/ktime.h"               // for ktime_t
#include "linux/seqlock.h"             // for seqcount_raw_spinlock_t
#include "linux/spinlock_types_raw.h"  // for raw_spinlock_t

kernel/time/timekeeping.h should remove these lines:

The full include-list for kernel/time/timekeeping.h:
#include "asm-generic/int-ll64.h"      // for u64
#include "linux/compiler_types.h"      // for inline
#include "linux/ktime.h"               // for ktime_t
#include "linux/seqlock.h"             // for seqcount_raw_spinlock_t
#include "linux/spinlock_types_raw.h"  // for raw_spinlock_t
---

kernel/time/timekeeping.c should add these lines:
#include <asm/bug.h>                    // for WARN_ON, WARN_ON_ONCE
#include <linux/ktime.h>                // for system_time_snapshot, system_...
#include <linux/linkage.h>              // for notrace
#include <stddef.h>                     // for NULL
#include "asm-generic/bitops/fls64.h"   // for fls64
#include "asm-generic/bitsperlong.h"    // for BITS_PER_LONG
#include "asm-generic/errno-base.h"     // for EINVAL, EPERM, ENODEV
#include "asm-generic/errno.h"          // for EOVERFLOW
#include "asm-generic/int-ll64.h"       // for u64, u32, s32, s64, u8
#include "asm-generic/param.h"          // for USER_HZ
#include "asm-generic/rwonce.h"         // for READ_ONCE
#include "asm/cache.h"                  // for __read_mostly
#include "asm/div64.h"                  // for do_div
#include "asm/string_32.h"              // for memcpy
#include "linux/cache.h"                // for ____cacheline_aligned
#include "linux/capability.h"           // for capable, CAP_SYS_TIME
#include "linux/clockchips.h"           // for clockevents_resume, clockeven...
#include "linux/compiler_attributes.h"  // for __always_inline, __weak
#include "linux/compiler_types.h"       // for inline, noinstr
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include "linux/hrtimer.h"              // for timerfd_resume
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_WARNING
#include "linux/ktime.h"                // for ktime_t, ktime_to_ns, ktime_a...
#include "linux/log2.h"                 // for ilog2
#include "linux/math.h"                 // for abs
#include "linux/math64.h"               // for div64_u64, div64_u64_rem, mul...
#include "linux/minmax.h"               // for max, min
#include "linux/notifier.h"             // for raw_notifier_call_chain, raw_...
#include "linux/printk.h"               // for pr_warn, printk_deferred, pri...
#include "linux/seqlock.h"              // for __seqprop_mutex_ptr, __seqpro...
#include "linux/spinlock.h"             // for raw_spin_lock_irqsave, raw_sp...
#include "linux/spinlock_types_raw.h"   // for DEFINE_RAW_SPINLOCK
#include "linux/stddef.h"               // for true, false
#include "linux/time.h"                 // for timezone, CLOCK_REALTIME
#include "linux/time64.h"               // for timespec64, timespec64_sub
#include "linux/timex.h"                // for __kernel_timex, __kernel_time...
#include "linux/types.h"                // for bool
#include "timekeeping.h"                // for do_timer, ktime_get_update_of...
#include "vdso/limits.h"                // for LLONG_MAX, LLONG_MIN
#include "vdso/time64.h"                // for NSEC_PER_SEC, USEC_PER_SEC

kernel/time/timekeeping.c should remove these lines:
- #include <linux/interrupt.h>  // lines 8-8
- #include <linux/mm.h>  // lines 11-11
- #include <linux/percpu.h>  // lines 9-9
- #include <linux/sched.h>  // lines 13-13
- #include <linux/tick.h>  // lines 21-21

The full include-list for kernel/time/timekeeping.c:
#include <asm/bug.h>                    // for WARN_ON, WARN_ON_ONCE
#include <linux/audit.h>                // for audit_tk_injoffset, audit_ntp...
#include <linux/clocksource.h>          // for clocksource, CLOCKSOURCE_MASK
#include <linux/compiler.h>             // for unlikely, data_race, likely
#include <linux/init.h>                 // for __init, device_initcall
#include <linux/jiffies.h>              // for jiffies_64
#include <linux/ktime.h>                // for system_time_snapshot, system_...
#include <linux/linkage.h>              // for notrace
#include <linux/module.h>               // for module_put, try_module_get
#include <linux/nmi.h>                  // for touch_softlockup_watchdog
#include <linux/sched/clock.h>          // for local_clock
#include <linux/sched/loadavg.h>        // for calc_global_load
#include <linux/stop_machine.h>         // for stop_machine
#include <linux/syscore_ops.h>          // for register_syscore_ops, syscore...
#include <linux/time.h>                 // for sys_tz
#include <linux/timekeeper_internal.h>  // for timekeeper, tk_read_base, upd...
#include <linux/timex.h>                // for PPM_SCALE, ADJ_ADJTIME, ADJ_O...
#include <stddef.h>                     // for NULL
#include "asm-generic/bitops/fls64.h"   // for fls64
#include "asm-generic/bitsperlong.h"    // for BITS_PER_LONG
#include "asm-generic/errno-base.h"     // for EINVAL, EPERM, ENODEV
#include "asm-generic/errno.h"          // for EOVERFLOW
#include "asm-generic/int-ll64.h"       // for u64, u32, s32, s64, u8
#include "asm-generic/param.h"          // for USER_HZ
#include "asm-generic/rwonce.h"         // for READ_ONCE
#include "asm/cache.h"                  // for __read_mostly
#include "asm/div64.h"                  // for do_div
#include "asm/string_32.h"              // for memcpy
#include "linux/cache.h"                // for ____cacheline_aligned
#include "linux/capability.h"           // for capable, CAP_SYS_TIME
#include "linux/clockchips.h"           // for clockevents_resume, clockeven...
#include "linux/compiler_attributes.h"  // for __always_inline, __weak
#include "linux/compiler_types.h"       // for inline, noinstr
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include "linux/hrtimer.h"              // for timerfd_resume
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_WARNING
#include "linux/ktime.h"                // for ktime_t, ktime_to_ns, ktime_a...
#include "linux/log2.h"                 // for ilog2
#include "linux/math.h"                 // for abs
#include "linux/math64.h"               // for div64_u64, div64_u64_rem, mul...
#include "linux/minmax.h"               // for max, min
#include "linux/notifier.h"             // for raw_notifier_call_chain, raw_...
#include "linux/printk.h"               // for pr_warn, printk_deferred, pri...
#include "linux/seqlock.h"              // for __seqprop_mutex_ptr, __seqpro...
#include "linux/spinlock.h"             // for raw_spin_lock_irqsave, raw_sp...
#include "linux/spinlock_types_raw.h"   // for DEFINE_RAW_SPINLOCK
#include "linux/stddef.h"               // for true, false
#include "linux/time.h"                 // for timezone, CLOCK_REALTIME
#include "linux/time64.h"               // for timespec64, timespec64_sub
#include "linux/timex.h"                // for __kernel_timex, __kernel_time...
#include "linux/types.h"                // for bool
#include "ntp_internal.h"               // for ntp_tick_length, __do_adjtimex
#include "tick-internal.h"              // for clock_was_set, clock_was_set_...
#include "timekeeping.h"                // for do_timer, ktime_get_update_of...
#include "timekeeping_internal.h"       // for clocksource_delta, tk_debug_a...
#include "vdso/limits.h"                // for LLONG_MAX, LLONG_MIN
#include "vdso/time64.h"                // for NSEC_PER_SEC, USEC_PER_SEC
---
  ./scripts/check-local-export kernel/time/timekeeping.o
  iwyu2 -Wp,-MMD,kernel/time/.ntp.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/time/ntp"' -DKBUILD_BASENAME='"ntp"' -DKBUILD_MODNAME='"ntp"' -D__KBUILD_MODNAME=kmod_ntp -c -o kernel/time/ntp.o kernel/time/ntp.c  
In file included from kernel/time/ntp.c:19:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
In file included from kernel/time/ntp.c:20:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^
2 warnings generated.
In file included from kernel/time/ntp.c:19:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
In file included from kernel/time/ntp.c:20:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^

kernel/time/ntp.c should add these lines:
#include <linux/ktime.h>                // for __ktime_get_real_seconds, kti...
#include "asm-generic/errno-base.h"     // for ENODEV, EAGAIN
#include "asm-generic/int-ll64.h"       // for s64, u64, s32, u32
#include "asm-generic/param.h"          // for HZ, USER_HZ
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/compiler_types.h"       // for inline
#include "linux/init.h"                 // for __init, __setup
#include "linux/kern_levels.h"          // for KERN_NOTICE
#include "linux/kstrtox.h"              // for kstrtos64
#include "linux/ktime.h"                // for ktime_set, ktime_t, ktime_add_ns
#include "linux/minmax.h"               // for max, min, clamp
#include "linux/printk.h"               // for printk
#include "linux/stddef.h"               // for true, false
#include "linux/time.h"                 // for CLOCK_REALTIME, timezone
#include "linux/time64.h"               // for timespec64, TIME64_MAX, time64_t
#include "linux/timex.h"                // for __kernel_timex, STA_NANO, STA...
#include "linux/types.h"                // for bool
#include "vdso/jiffies.h"               // for TICK_NSEC
#include "vdso/time64.h"                // for NSEC_PER_USEC, NSEC_PER_SEC

kernel/time/ntp.c should remove these lines:
- #include <linux/capability.h>  // lines 9-9
- #include <linux/clocksource.h>  // lines 10-10
- #include <linux/mm.h>  // lines 17-17
- #include <linux/module.h>  // lines 18-18
- #include <linux/rtc.h>  // lines 19-19
- #include "timekeeping_internal.h"  // lines 23-23

The full include-list for kernel/time/ntp.c:
#include <linux/audit.h>                // for audit_ntp_set_new, audit_ntp_...
#include <linux/hrtimer.h>              // for hrtimer_is_queued, hrtimer_init
#include <linux/jiffies.h>              // for USER_TICK_USEC
#include <linux/ktime.h>                // for __ktime_get_real_seconds, kti...
#include <linux/math64.h>               // for div_s64_rem, div_u64, div_s64
#include <linux/time.h>                 // for sys_tz
#include <linux/timex.h>                // for NTP_SCALE_SHIFT, NTP_INTERVAL...
#include <linux/workqueue.h>            // for work_struct, queue_work, syst...
#include "asm-generic/errno-base.h"     // for ENODEV, EAGAIN
#include "asm-generic/int-ll64.h"       // for s64, u64, s32, u32
#include "asm-generic/param.h"          // for HZ, USER_HZ
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/compiler_types.h"       // for inline
#include "linux/init.h"                 // for __init, __setup
#include "linux/kern_levels.h"          // for KERN_NOTICE
#include "linux/kstrtox.h"              // for kstrtos64
#include "linux/ktime.h"                // for ktime_set, ktime_t, ktime_add_ns
#include "linux/minmax.h"               // for max, min, clamp
#include "linux/printk.h"               // for printk
#include "linux/stddef.h"               // for true, false
#include "linux/time.h"                 // for CLOCK_REALTIME, timezone
#include "linux/time64.h"               // for timespec64, TIME64_MAX, time64_t
#include "linux/timex.h"                // for __kernel_timex, STA_NANO, STA...
#include "linux/types.h"                // for bool
#include "ntp_internal.h"               // for __do_adjtimex, ntp_clear, ntp...
#include "vdso/jiffies.h"               // for TICK_NSEC
#include "vdso/time64.h"                // for NSEC_PER_USEC, NSEC_PER_SEC
---
  ./scripts/check-local-export kernel/time/ntp.o
  iwyu2 -Wp,-MMD,kernel/time/.clocksource.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/time/clocksource"' -DKBUILD_BASENAME='"clocksource"' -DKBUILD_MODNAME='"clocksource"' -D__KBUILD_MODNAME=kmod_clocksource -c -o kernel/time/clocksource.o kernel/time/clocksource.c  
In file included from kernel/time/clocksource.c:10:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/time/clocksource.c:10:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/time/clocksource.c:10:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/time/clocksource.c:10:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/time/clocksource.c:10:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/time/clocksource.c:10:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/time/clocksource.c should add these lines:
#include <asm/bug.h>                           // for WARN_ON_ONCE, WARN_ONCE
#include <stddef.h>                            // for NULL
#include <stdint.h>                            // for int64_t
#include "asm-generic/errno-base.h"            // for EBUSY
#include "asm-generic/int-ll64.h"              // for u64, u32, s64
#include "asm-generic/param.h"                 // for HZ
#include "asm/div64.h"                         // for do_div
#include "asm/string_32.h"                     // for strcmp, strlen
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_dec
#include "linux/clocksource_ids.h"             // for CSID_GENERIC, CSID_MAX
#include "linux/compiler_types.h"              // for inline
#include "linux/cpumask.h"                     // for cpumask_empty, cpumask...
#include "linux/export.h"                      // for EXPORT_SYMBOL_GPL, EXP...
#include "linux/irqflags.h"                    // for local_irq_disable, loc...
#include "linux/jiffies.h"                     // for jiffies
#include "linux/list.h"                        // for list_empty, list_add
#include "linux/math.h"                        // for abs
#include "linux/math64.h"                      // for mul_u64_u32_shr
#include "linux/minmax.h"                      // for min
#include "linux/moduleparam.h"                 // for kernel_param, module_p...
#include "linux/mutex.h"                       // for mutex_lock, mutex_unlock
#include "linux/preempt.h"                     // for preempt_enable, preemp...
#include "linux/printk.h"                      // for pr_warn, pr_info, pr_w...
#include "linux/smp.h"                         // for smp_processor_id, smp_...
#include "linux/spinlock.h"                    // for spin_unlock_irqrestore
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK
#include "linux/stddef.h"                      // for false, true
#include "linux/string.h"                      // for strlcpy
#include "linux/timer.h"                       // for add_timer_on, del_timer
#include "linux/types.h"                       // for list_head, bool, atomic_t
#include "linux/workqueue.h"                   // for schedule_work, work_st...
#include "timekeeping.h"                       // for CS_NAME_LEN
#include "vdso/clocksource.h"                  // for VDSO_CLOCKMODE_MAX
#include "vdso/limits.h"                       // for LLONG_MAX, UINT_MAX
#include "vdso/time64.h"                       // for NSEC_PER_USEC, NSEC_PE...

kernel/time/clocksource.c should remove these lines:
- #include <linux/device.h>  // lines 10-10
- #include <linux/module.h>  // lines 13-13
- #include <linux/sched.h>  // lines 14-14
- #include <linux/tick.h>  // lines 15-15

The full include-list for kernel/time/clocksource.c:
#include <asm/bug.h>                           // for WARN_ON_ONCE, WARN_ONCE
#include <linux/clocksource.h>                 // for clocksource, clocksour...
#include <linux/cpu.h>                         // for cpus_read_unlock, cpus...
#include <linux/init.h>                        // for __init, __setup, fs_in...
#include <linux/kthread.h>                     // for kthread_run
#include <linux/prandom.h>                     // for prandom_u32
#include <stddef.h>                            // for NULL
#include <stdint.h>                            // for int64_t
#include "asm-generic/errno-base.h"            // for EBUSY
#include "asm-generic/int-ll64.h"              // for u64, u32, s64
#include "asm-generic/param.h"                 // for HZ
#include "asm/div64.h"                         // for do_div
#include "asm/string_32.h"                     // for strcmp, strlen
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_dec
#include "linux/clocksource_ids.h"             // for CSID_GENERIC, CSID_MAX
#include "linux/compiler_types.h"              // for inline
#include "linux/cpumask.h"                     // for cpumask_empty, cpumask...
#include "linux/export.h"                      // for EXPORT_SYMBOL_GPL, EXP...
#include "linux/irqflags.h"                    // for local_irq_disable, loc...
#include "linux/jiffies.h"                     // for jiffies
#include "linux/list.h"                        // for list_empty, list_add
#include "linux/math.h"                        // for abs
#include "linux/math64.h"                      // for mul_u64_u32_shr
#include "linux/minmax.h"                      // for min
#include "linux/moduleparam.h"                 // for kernel_param, module_p...
#include "linux/mutex.h"                       // for mutex_lock, mutex_unlock
#include "linux/preempt.h"                     // for preempt_enable, preemp...
#include "linux/printk.h"                      // for pr_warn, pr_info, pr_w...
#include "linux/smp.h"                         // for smp_processor_id, smp_...
#include "linux/spinlock.h"                    // for spin_unlock_irqrestore
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK
#include "linux/stddef.h"                      // for false, true
#include "linux/string.h"                      // for strlcpy
#include "linux/timer.h"                       // for add_timer_on, del_timer
#include "linux/types.h"                       // for list_head, bool, atomic_t
#include "linux/workqueue.h"                   // for schedule_work, work_st...
#include "tick-internal.h"                     // for tick_clock_notify, tic...
#include "timekeeping.h"                       // for CS_NAME_LEN
#include "timekeeping_internal.h"              // for clocksource_delta
#include "vdso/clocksource.h"                  // for VDSO_CLOCKMODE_MAX
#include "vdso/limits.h"                       // for LLONG_MAX, UINT_MAX
#include "vdso/time64.h"                       // for NSEC_PER_USEC, NSEC_PE...
---
  ./scripts/check-local-export kernel/time/clocksource.o
  iwyu2 -Wp,-MMD,kernel/time/.jiffies.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/time/jiffies"' -DKBUILD_BASENAME='"jiffies"' -DKBUILD_MODNAME='"jiffies"' -D__KBUILD_MODNAME=kmod_jiffies -c -o kernel/time/jiffies.o kernel/time/jiffies.c  

kernel/time/jiffies.c should add these lines:
#include "asm-generic/bitsperlong.h"    // for BITS_PER_LONG
#include "asm-generic/int-ll64.h"       // for u64, u32
#include "asm-generic/param.h"          // for HZ
#include "asm/div64.h"                  // for do_div
#include "linux/cache.h"                // for __cacheline_aligned_in_smp
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/export.h"               // for EXPORT_SYMBOL
#include "linux/seqlock.h"              // for __seqprop_mutex_ptr, __seqpro...
#include "linux/spinlock_types_raw.h"   // for DEFINE_RAW_SPINLOCK
#include "vdso/jiffies.h"               // for TICK_NSEC
#include "vdso/time64.h"                // for NSEC_PER_MSEC, NSEC_PER_SEC

kernel/time/jiffies.c should remove these lines:
- #include <linux/module.h>  // lines 9-9
- #include "timekeeping.h"  // lines 12-12

The full include-list for kernel/time/jiffies.c:
#include <linux/clocksource.h>          // for __clocksource_register, clock...
#include <linux/init.h>                 // for __init, core_initcall
#include <linux/jiffies.h>              // for get_jiffies_64, jiffies, jiff...
#include "asm-generic/bitsperlong.h"    // for BITS_PER_LONG
#include "asm-generic/int-ll64.h"       // for u64, u32
#include "asm-generic/param.h"          // for HZ
#include "asm/div64.h"                  // for do_div
#include "linux/cache.h"                // for __cacheline_aligned_in_smp
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/export.h"               // for EXPORT_SYMBOL
#include "linux/seqlock.h"              // for __seqprop_mutex_ptr, __seqpro...
#include "linux/spinlock_types_raw.h"   // for DEFINE_RAW_SPINLOCK
#include "tick-internal.h"              // for JIFFIES_SHIFT
#include "vdso/jiffies.h"               // for TICK_NSEC
#include "vdso/time64.h"                // for NSEC_PER_MSEC, NSEC_PER_SEC
---
  ./scripts/check-local-export kernel/time/jiffies.o
  iwyu2 -Wp,-MMD,kernel/time/.timer_list.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/time/timer_list"' -DKBUILD_BASENAME='"timer_list"' -DKBUILD_MODNAME='"timer_list"' -D__KBUILD_MODNAME=kmod_timer_list -c -o kernel/time/timer_list.o kernel/time/timer_list.c  

kernel/time/timer_list.c should add these lines:
#include <asm-generic/percpu.h>         // for per_cpu
#include <linux/ktime.h>                // for ktime_get
#include <cstdio>                       // for NULL, va_list
#include "asm-generic/int-ll64.h"       // for u64
#include "linux/clockchips.h"           // for clock_event_device
#include "linux/compiler_attributes.h"  // for __printf
#include "linux/compiler_types.h"       // for inline
#include "linux/container_of.h"         // for container_of
#include "linux/cpumask.h"              // for for_each_online_cpu
#include "linux/hrtimer.h"              // for hrtimer_clock_base, hrtimer_g...
#include "linux/ktime.h"                // for ktime_to_ns
#include "linux/printk.h"               // for vprintk
#include "linux/stdarg.h"               // for va_end, va_start
#include "linux/timerqueue.h"           // for timerqueue_getnext, timerqueu...
#include "linux/types.h"                // for bool
#include "tick-sched.h"                 // for tick_device

kernel/time/timer_list.c should remove these lines:
- #include <linux/kallsyms.h>  // lines 13-13
- #include <linux/module.h>  // lines 9-9
- #include <linux/proc_fs.h>  // lines 8-8
- #include <linux/sched.h>  // lines 11-11
- #include <linux/uaccess.h>  // lines 16-16

The full include-list for kernel/time/timer_list.c:
#include <asm-generic/percpu.h>         // for per_cpu
#include <linux/ktime.h>                // for ktime_get
#include <linux/nmi.h>                  // for touch_nmi_watchdog
#include <linux/seq_file.h>             // for seq_vprintf
#include <linux/spinlock.h>             // for raw_spin_unlock_irqrestore
#include <cstdio>                       // for NULL, va_list
#include "asm-generic/int-ll64.h"       // for u64
#include "linux/clockchips.h"           // for clock_event_device
#include "linux/compiler_attributes.h"  // for __printf
#include "linux/compiler_types.h"       // for inline
#include "linux/container_of.h"         // for container_of
#include "linux/cpumask.h"              // for for_each_online_cpu
#include "linux/hrtimer.h"              // for hrtimer_clock_base, hrtimer_g...
#include "linux/ktime.h"                // for ktime_to_ns
#include "linux/printk.h"               // for vprintk
#include "linux/stdarg.h"               // for va_end, va_start
#include "linux/timerqueue.h"           // for timerqueue_getnext, timerqueu...
#include "linux/types.h"                // for bool
#include "tick-internal.h"              // for clockevent_get_state, hrtimer...
#include "tick-sched.h"                 // for tick_device
---
  ./scripts/check-local-export kernel/time/timer_list.o
  iwyu2 -Wp,-MMD,kernel/time/.timeconv.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/time/timeconv"' -DKBUILD_BASENAME='"timeconv"' -DKBUILD_MODNAME='"timeconv"' -D__KBUILD_MODNAME=kmod_timeconv -c -o kernel/time/timeconv.o kernel/time/timeconv.c  

kernel/time/timeconv.c should add these lines:
#include "asm-generic/int-ll64.h"  // for u32, u64, u16
#include "linux/export.h"          // for EXPORT_SYMBOL
#include "linux/math64.h"          // for div64_u64_rem, div_s64_rem
#include "linux/time64.h"          // for time64_t
#include "linux/types.h"           // for bool

kernel/time/timeconv.c should remove these lines:
- #include <linux/module.h>  // lines 33-33

The full include-list for kernel/time/timeconv.c:
#include <linux/kernel.h>          // for lower_32_bits, upper_32_bits
#include <linux/time.h>            // for tm, time64_to_tm
#include "asm-generic/int-ll64.h"  // for u32, u64, u16
#include "linux/export.h"          // for EXPORT_SYMBOL
#include "linux/math64.h"          // for div64_u64_rem, div_s64_rem
#include "linux/time64.h"          // for time64_t
#include "linux/types.h"           // for bool
---
  ./scripts/check-local-export kernel/time/timeconv.o
  iwyu2 -Wp,-MMD,kernel/time/.timecounter.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/time/timecounter"' -DKBUILD_BASENAME='"timecounter"' -DKBUILD_MODNAME='"timecounter"' -D__KBUILD_MODNAME=kmod_timecounter -c -o kernel/time/timecounter.o kernel/time/timecounter.c  

kernel/time/timecounter.c should add these lines:
#include "asm-generic/int-ll64.h"  // for u64

kernel/time/timecounter.c should remove these lines:

The full include-list for kernel/time/timecounter.c:
#include <linux/export.h>          // for EXPORT_SYMBOL_GPL
#include <linux/timecounter.h>     // for timecounter, cyclecounter, cycleco...
#include "asm-generic/int-ll64.h"  // for u64
---
  ./scripts/check-local-export kernel/time/timecounter.o
  iwyu2 -Wp,-MMD,kernel/time/.alarmtimer.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/time/alarmtimer"' -DKBUILD_BASENAME='"alarmtimer"' -DKBUILD_MODNAME='"alarmtimer"' -D__KBUILD_MODNAME=kmod_alarmtimer -c -o kernel/time/alarmtimer.o kernel/time/alarmtimer.c  
In file included from kernel/time/alarmtimer.c:18:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/time/alarmtimer.c:18:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/time/alarmtimer.c:18:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/time/alarmtimer.c:18:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
4 warnings generated.
In file included from kernel/time/alarmtimer.c:18:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/time/alarmtimer.c:18:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/time/alarmtimer.c:18:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/time/alarmtimer.c:18:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^

kernel/time/alarmtimer.c should add these lines:
#include <linux/ktime.h>              // for ktime_get_boottime_ts64, ktime_...
#include <sys/types.h>                // for clockid_t
#include "asm-generic/int-ll64.h"     // for u64, s64
#include "linux/compiler.h"           // for unlikely
#include "linux/compiler_types.h"     // for inline
#include "linux/container_of.h"       // for container_of
#include "linux/export.h"             // for EXPORT_SYMBOL_GPL
#include "linux/init.h"               // for __init, device_initcall
#include "linux/ktime.h"              // for ktime_t, ktime_add_safe, ktime_...
#include "linux/pm.h"                 // for dev_pm_ops
#include "linux/spinlock.h"           // for spin_unlock_irqrestore, spin_lo...
#include "linux/spinlock_types.h"     // for spinlock_t
#include "linux/time.h"               // for CLOCK_BOOTTIME, CLOCK_REALTIME
struct device;
struct timespec64;

kernel/time/alarmtimer.c should remove these lines:
- #include <linux/compat.h>  // lines 27-27
- #include <linux/freezer.h>  // lines 26-26
- #include <linux/module.h>  // lines 28-28
- #include <linux/mutex.h>  // lines 22-22
- #include <linux/posix-timers.h>  // lines 24-24
- #include <linux/rtc.h>  // lines 18-18
- #include <linux/sched/debug.h>  // lines 20-20
- #include <linux/sched/signal.h>  // lines 19-19
- #include <linux/time.h>  // lines 15-15
- #include <linux/workqueue.h>  // lines 25-25
- #include "posix-timers.h"  // lines 31-31

The full include-list for kernel/time/alarmtimer.c:
#include <linux/alarmtimer.h>         // for alarm, ALARMTIMER_STATE_ENQUEUED
#include <linux/hrtimer.h>            // for hrtimer_set_expires, hrtimer_re...
#include <linux/ktime.h>              // for ktime_get_boottime_ts64, ktime_...
#include <linux/platform_device.h>    // for platform_driver, platform_drive...
#include <linux/time_namespace.h>     // for timens_add_boottime
#include <linux/timerqueue.h>         // for timerqueue_node, timerqueue_del
#include <sys/types.h>                // for clockid_t
#include <trace/events/alarmtimer.h>  // for trace_alarmtimer_cancel, trace_...
#include "asm-generic/int-ll64.h"     // for u64, s64
#include "linux/compiler.h"           // for unlikely
#include "linux/compiler_types.h"     // for inline
#include "linux/container_of.h"       // for container_of
#include "linux/export.h"             // for EXPORT_SYMBOL_GPL
#include "linux/init.h"               // for __init, device_initcall
#include "linux/ktime.h"              // for ktime_t, ktime_add_safe, ktime_...
#include "linux/pm.h"                 // for dev_pm_ops
#include "linux/spinlock.h"           // for spin_unlock_irqrestore, spin_lo...
#include "linux/spinlock_types.h"     // for spinlock_t
#include "linux/time.h"               // for CLOCK_BOOTTIME, CLOCK_REALTIME
struct device;
struct timespec64;
---
  ./scripts/check-local-export kernel/time/alarmtimer.o
  iwyu2 -Wp,-MMD,kernel/time/.posix-stubs.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/time/posix-stubs"' -DKBUILD_BASENAME='"posix_stubs"' -DKBUILD_MODNAME='"posix_stubs"' -D__KBUILD_MODNAME=kmod_posix_stubs -c -o kernel/time/posix-stubs.o kernel/time/posix-stubs.c  
In file included from kernel/time/posix-stubs.c:13:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/time/posix-stubs.c:13:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/time/posix-stubs.c:13:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/time/posix-stubs.c:13:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from kernel/time/posix-stubs.c:13:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/time/posix-stubs.c:13:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/time/posix-stubs.c:13:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/time/posix-stubs.c:13:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/time/posix-stubs.c should add these lines:
#include <ctime>                     // for clockid_t, NULL
#include "asm-generic/errno-base.h"  // for EINVAL, EFAULT
#include "asm-generic/errno.h"       // for ENOSYS
#include "asm/current.h"             // for current
#include "asm/ptrace.h"              // for pt_regs
#include "asm/unistd.h"              // for __ARCH_WANT_SYS_ALARM
#include "linux/compiler_types.h"    // for __user
#include "linux/hrtimer.h"           // for hrtimer_nanosleep, HRTIMER_MODE_ABS
#include "linux/printk.h"            // for pr_err_once
#include "linux/restart_block.h"     // for restart_block, restart_block::(a...
#include "linux/time.h"              // for get_timespec64, put_timespec64
#include "linux/time64.h"            // for timespec64, timespec64_valid
struct __kernel_timespec;

kernel/time/posix-stubs.c should remove these lines:
- #include <asm/syscall_wrapper.h>  // lines 21-21
- #include <linux/compat.h>  // lines 18-18
- #include <linux/errno.h>  // lines 12-12
- #include <linux/kernel.h>  // lines 10-10
- #include <linux/posix-timers.h>  // lines 16-16
- #include <linux/timekeeping.h>  // lines 15-15

The full include-list for kernel/time/posix-stubs.c:
#include <linux/ktime.h>             // for do_sys_settimeofday64, ktime_get...
#include <linux/linkage.h>           // for SYSCALL_ALIAS, asmlinkage
#include <linux/sched.h>             // for task_struct
#include <linux/syscalls.h>          // for __MAP2, SYS_NI, __MAP4, SYSCALL_...
#include <linux/time_namespace.h>    // for timens_add_boottime, timens_add_...
#include <ctime>                     // for clockid_t, NULL
#include "asm-generic/errno-base.h"  // for EINVAL, EFAULT
#include "asm-generic/errno.h"       // for ENOSYS
#include "asm/current.h"             // for current
#include "asm/ptrace.h"              // for pt_regs
#include "asm/unistd.h"              // for __ARCH_WANT_SYS_ALARM
#include "linux/compiler_types.h"    // for __user
#include "linux/hrtimer.h"           // for hrtimer_nanosleep, HRTIMER_MODE_ABS
#include "linux/printk.h"            // for pr_err_once
#include "linux/restart_block.h"     // for restart_block, restart_block::(a...
#include "linux/time.h"              // for get_timespec64, put_timespec64
#include "linux/time64.h"            // for timespec64, timespec64_valid
struct __kernel_timespec;
---
  ./scripts/check-local-export kernel/time/posix-stubs.o
  iwyu2 -Wp,-MMD,kernel/time/.clockevents.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/time/clockevents"' -DKBUILD_BASENAME='"clockevents"' -DKBUILD_MODNAME='"clockevents"' -D__KBUILD_MODNAME=kmod_clockevents -c -o kernel/time/clockevents.o kernel/time/clockevents.c  

kernel/time/clockevents.c should add these lines:
#include <asm-generic/percpu.h>        // for per_cpu
#include <asm/bug.h>                   // for WARN_ON, WARN_ONCE, BUG_ON, WARN
#include <linux/ktime.h>               // for ktime_get
#include <stddef.h>                    // for NULL
#include <stdint.h>                    // for int64_t
#include "asm-generic/errno-base.h"    // for EAGAIN, EBUSY, ENODEV, EINVAL
#include "asm-generic/errno.h"         // for ENOSYS, ETIME
#include "asm-generic/int-ll64.h"      // for u64, u32
#include "asm-generic/param.h"         // for HZ
#include "asm/div64.h"                 // for do_div
#include "linux/cpumask.h"             // for cpu_all_mask, cpu_possible_mask
#include "linux/export.h"              // for EXPORT_SYMBOL_GPL
#include "linux/irqflags.h"            // for local_irq_restore, local_irq_save
#include "linux/kern_levels.h"         // for KERN_WARNING
#include "linux/ktime.h"               // for ktime_to_ns, ktime_add_ns, kti...
#include "linux/list.h"                // for list_del_init, list_move, list...
#include "linux/minmax.h"              // for max, min
#include "linux/mutex.h"               // for mutex, mutex_lock, mutex_unlock
#include "linux/printk.h"              // for printk_deferred
#include "linux/spinlock.h"            // for raw_spin_lock, raw_spin_lock_i...
#include "linux/spinlock_types_raw.h"  // for DEFINE_RAW_SPINLOCK
#include "linux/stddef.h"              // for false, true
#include "linux/time64.h"              // for KTIME_MAX
#include "linux/types.h"               // for list_head, bool
#include "tick-sched.h"                // for tick_device
#include "vdso/limits.h"               // for UINT_MAX
#include "vdso/time64.h"               // for NSEC_PER_SEC

kernel/time/clockevents.c should remove these lines:
- #include <linux/device.h>  // lines 15-15
- #include <linux/hrtimer.h>  // lines 11-11
- #include <linux/init.h>  // lines 12-12

The full include-list for kernel/time/clockevents.c:
#include <asm-generic/percpu.h>        // for per_cpu
#include <asm/bug.h>                   // for WARN_ON, WARN_ONCE, BUG_ON, WARN
#include <linux/clockchips.h>          // for clock_event_device, clockevent...
#include <linux/ktime.h>               // for ktime_get
#include <linux/module.h>              // for module_put, try_module_get
#include <linux/smp.h>                 // for smp_call_function_single, smp_...
#include <stddef.h>                    // for NULL
#include <stdint.h>                    // for int64_t
#include "asm-generic/errno-base.h"    // for EAGAIN, EBUSY, ENODEV, EINVAL
#include "asm-generic/errno.h"         // for ENOSYS, ETIME
#include "asm-generic/int-ll64.h"      // for u64, u32
#include "asm-generic/param.h"         // for HZ
#include "asm/div64.h"                 // for do_div
#include "linux/cpumask.h"             // for cpu_all_mask, cpu_possible_mask
#include "linux/export.h"              // for EXPORT_SYMBOL_GPL
#include "linux/irqflags.h"            // for local_irq_restore, local_irq_save
#include "linux/kern_levels.h"         // for KERN_WARNING
#include "linux/ktime.h"               // for ktime_to_ns, ktime_add_ns, kti...
#include "linux/list.h"                // for list_del_init, list_move, list...
#include "linux/minmax.h"              // for max, min
#include "linux/mutex.h"               // for mutex, mutex_lock, mutex_unlock
#include "linux/printk.h"              // for printk_deferred
#include "linux/spinlock.h"            // for raw_spin_lock, raw_spin_lock_i...
#include "linux/spinlock_types_raw.h"  // for DEFINE_RAW_SPINLOCK
#include "linux/stddef.h"              // for false, true
#include "linux/time64.h"              // for KTIME_MAX
#include "linux/types.h"               // for list_head, bool
#include "tick-internal.h"             // for clockevent_get_state, clockeve...
#include "tick-sched.h"                // for tick_device
#include "vdso/limits.h"               // for UINT_MAX
#include "vdso/time64.h"               // for NSEC_PER_SEC
---
  ./scripts/check-local-export kernel/time/clockevents.o
  iwyu2 -Wp,-MMD,kernel/time/.tick-common.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/time/tick-common"' -DKBUILD_BASENAME='"tick_common"' -DKBUILD_MODNAME='"tick_common"' -D__KBUILD_MODNAME=kmod_tick_common -c -o kernel/time/tick-common.o kernel/time/tick-common.c  
In file included from kernel/time/tick-common.c:10:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/time/tick-common.c:10:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/time/tick-common.c:10:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/time/tick-common.c:19:
In file included from ./include/trace/events/power.h:12:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from kernel/time/tick-common.c:10:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/time/tick-common.c:10:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/time/tick-common.c:10:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/time/tick-common.c:19:
In file included from ./include/trace/events/power.h:12:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/time/tick-common.c should add these lines:
#include <asm-generic/percpu.h>    // for this_cpu_ptr, per_cpu, DEFINE_PER_CPU
#include <asm/percpu.h>            // for raw_cpu_read_8
#include <linux/ktime.h>           // for ktime_get
#include <stddef.h>                // for NULL
#include "asm-generic/irq_regs.h"  // for get_irq_regs
#include "asm/cache.h"             // for __read_mostly
#include "asm/percpu.h"            // for __pcpu_op2_1, __pcpu_op2_2, __pcpu...
#include "asm/ptrace.h"            // for user_mode
#include "linux/clockchips.h"      // for clock_event_device, CLOCK_EVT_FEAT...
#include "linux/cpumask.h"         // for cpumask_equal, cpumask_of, cpumask...
#include "linux/export.h"          // for EXPORT_SYMBOL_GPL
#include "linux/init.h"            // for __init
#include "linux/ktime.h"           // for ktime_t, ktime_add_ns
#include "linux/seqlock.h"         // for __seqprop_mutex_ptr, __seqprop_ptr
#include "linux/smp.h"             // for smp_processor_id
#include "linux/spinlock.h"        // for raw_spin_lock, raw_spin_unlock
#include "linux/stddef.h"          // for false, true
#include "linux/tick.h"            // for tick_broadcast_oneshot_control
#include "linux/types.h"           // for bool
#include "tick-sched.h"            // for tick_device, TICKDEV_MODE_PERIODIC
#include "timekeeping.h"           // for jiffies_seq, do_timer, timekeeping...
#include "vdso/jiffies.h"          // for TICK_NSEC

kernel/time/tick-common.c should remove these lines:
- #include <asm/irq_regs.h>  // lines 21-21
- #include <linux/cpu.h>  // lines 10-10
- #include <linux/err.h>  // lines 11-11
- #include <linux/hrtimer.h>  // lines 12-12
- #include <linux/nmi.h>  // lines 14-14
- #include <linux/percpu.h>  // lines 15-15
- #include <linux/sched.h>  // lines 17-17
- #include <trace/events/power.h>  // lines 19-19

The full include-list for kernel/time/tick-common.c:
#include <asm-generic/percpu.h>    // for this_cpu_ptr, per_cpu, DEFINE_PER_CPU
#include <asm/percpu.h>            // for raw_cpu_read_8
#include <linux/interrupt.h>       // for irq_can_set_affinity, irq_set_affi...
#include <linux/ktime.h>           // for ktime_get
#include <linux/module.h>          // for try_module_get
#include <linux/profile.h>         // for profile_tick, CPU_PROFILING
#include <stddef.h>                // for NULL
#include "asm-generic/irq_regs.h"  // for get_irq_regs
#include "asm/cache.h"             // for __read_mostly
#include "asm/percpu.h"            // for __pcpu_op2_1, __pcpu_op2_2, __pcpu...
#include "asm/ptrace.h"            // for user_mode
#include "linux/clockchips.h"      // for clock_event_device, CLOCK_EVT_FEAT...
#include "linux/cpumask.h"         // for cpumask_equal, cpumask_of, cpumask...
#include "linux/export.h"          // for EXPORT_SYMBOL_GPL
#include "linux/init.h"            // for __init
#include "linux/ktime.h"           // for ktime_t, ktime_add_ns
#include "linux/seqlock.h"         // for __seqprop_mutex_ptr, __seqprop_ptr
#include "linux/smp.h"             // for smp_processor_id
#include "linux/spinlock.h"        // for raw_spin_lock, raw_spin_unlock
#include "linux/stddef.h"          // for false, true
#include "linux/tick.h"            // for tick_broadcast_oneshot_control
#include "linux/types.h"           // for bool
#include "tick-internal.h"         // for clockevents_exchange_device, clock...
#include "tick-sched.h"            // for tick_device, TICKDEV_MODE_PERIODIC
#include "timekeeping.h"           // for jiffies_seq, do_timer, timekeeping...
#include "vdso/jiffies.h"          // for TICK_NSEC
---
  ./scripts/check-local-export kernel/time/tick-common.o
  iwyu2 -Wp,-MMD,kernel/time/.vsyscall.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/time/vsyscall"' -DKBUILD_BASENAME='"vsyscall"' -DKBUILD_MODNAME='"vsyscall"' -D__KBUILD_MODNAME=kmod_vsyscall -c -o kernel/time/vsyscall.o kernel/time/vsyscall.c  

kernel/time/vsyscall.c should add these lines:
#include <asm/vdso/vsyscall.h>          // for __arch_sync_vdso_data, __arch...
#include "asm-generic/int-ll64.h"       // for u64, u32, s32, s64
#include "asm-generic/rwonce.h"         // for WRITE_ONCE
#include "asm/vdso/vsyscall.h"          // for __arch_get_k_vdso_data
#include "linux/clocksource.h"          // for clocksource
#include "linux/compiler_types.h"       // for inline
#include "linux/spinlock.h"             // for raw_spin_lock_irqsave, raw_sp...
#include "linux/time.h"                 // for sys_tz, timezone, CLOCK_BOOTTIME
#include "linux/time64.h"               // for timespec64
#include "vdso/clocksource.h"           // for VDSO_CLOCKMODE_NONE
#include "vdso/math64.h"                // for __iter_div_u64_rem
#include "vdso/time64.h"                // for NSEC_PER_SEC

kernel/time/vsyscall.c should remove these lines:

The full include-list for kernel/time/vsyscall.c:
#include <asm/vdso/vsyscall.h>          // for __arch_sync_vdso_data, __arch...
#include <linux/hrtimer.h>              // for hrtimer_resolution
#include <linux/timekeeper_internal.h>  // for timekeeper, tk_read_base, upd...
#include <vdso/datapage.h>              // for vdso_data, vdso_timestamp
#include <vdso/helpers.h>               // for vdso_write_begin, vdso_write_end
#include <vdso/vsyscall.h>              // for vdso_update_begin, vdso_updat...
#include "asm-generic/int-ll64.h"       // for u64, u32, s32, s64
#include "asm-generic/rwonce.h"         // for WRITE_ONCE
#include "asm/vdso/vsyscall.h"          // for __arch_get_k_vdso_data
#include "linux/clocksource.h"          // for clocksource
#include "linux/compiler_types.h"       // for inline
#include "linux/spinlock.h"             // for raw_spin_lock_irqsave, raw_sp...
#include "linux/time.h"                 // for sys_tz, timezone, CLOCK_BOOTTIME
#include "linux/time64.h"               // for timespec64
#include "timekeeping_internal.h"       // for timekeeper_lock
#include "vdso/clocksource.h"           // for VDSO_CLOCKMODE_NONE
#include "vdso/math64.h"                // for __iter_div_u64_rem
#include "vdso/time64.h"                // for NSEC_PER_SEC
---
  ./scripts/check-local-export kernel/time/vsyscall.o
  rm -f kernel/time/built-in.a; echo time.o timer.o hrtimer.o timekeeping.o ntp.o clocksource.o jiffies.o timer_list.o timeconv.o timecounter.o alarmtimer.o posix-stubs.o clockevents.o tick-common.o vsyscall.o | sed -E 's:([^ ]+):kernel/time/:g' | xargs llvm-ar cDPrST kernel/time/built-in.a
make -f ./scripts/Makefile.build obj=kernel/events \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,kernel/events/.core.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/events/core"' -DKBUILD_BASENAME='"core"' -DKBUILD_MODNAME='"core"' -D__KBUILD_MODNAME=kmod_core -c -o kernel/events/core.o kernel/events/core.c  
In file included from kernel/events/core.c:13:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/events/core.c:13:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/events/core.c:13:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/events/core.c:31:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/events/core.c:46:
In file included from ./include/linux/filter.h:12:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from kernel/events/core.c:46:
In file included from ./include/linux/filter.h:20:
In file included from ./include/linux/if_vlan.h:10:
./include/linux/netdevice.h:1243:17: warning: declaration of 'struct rtnl_link_stats64' will not be visible outside of this function [-Wvisibility]
                                                   struct rtnl_link_stats64 *storage);
                                                          ^
./include/linux/netdevice.h:1268:19: warning: declaration of 'struct ifla_vf_info' will not be visible outside of this function [-Wvisibility]
                                                     struct ifla_vf_info *ivf);
                                                            ^
./include/linux/netdevice.h:1273:18: warning: declaration of 'struct ifla_vf_stats' will not be visible outside of this function [-Wvisibility]
                                                    struct ifla_vf_stats
                                                           ^
./include/linux/netdevice.h:1282:17: warning: declaration of 'struct ifla_vf_guid' will not be visible outside of this function [-Wvisibility]
                                                   struct ifla_vf_guid *node_guid,
                                                          ^
9 warnings generated.
In file included from kernel/events/core.c:13:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/events/core.c:13:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/events/core.c:13:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/events/core.c:31:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/events/core.c:46:
In file included from ./include/linux/filter.h:12:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from kernel/events/core.c:46:
In file included from ./include/linux/filter.h:20:
In file included from ./include/linux/if_vlan.h:10:
./include/linux/netdevice.h:1243:17: warning: declaration of 'struct rtnl_link_stats64' will not be visible outside of this function [-Wvisibility]
                                                   struct rtnl_link_stats64 *storage);
                                                          ^
./include/linux/netdevice.h:1268:19: warning: declaration of 'struct ifla_vf_info' will not be visible outside of this function [-Wvisibility]
                                                     struct ifla_vf_info *ivf);
                                                            ^
./include/linux/netdevice.h:1273:18: warning: declaration of 'struct ifla_vf_stats' will not be visible outside of this function [-Wvisibility]
                                                    struct ifla_vf_stats
                                                           ^
./include/linux/netdevice.h:1282:17: warning: declaration of 'struct ifla_vf_guid' will not be visible outside of this function [-Wvisibility]
                                                   struct ifla_vf_guid *node_guid,
                                                          ^

kernel/events/core.c should add these lines:
#include <asm-generic/percpu.h>                // for this_cpu_ptr, DEFINE_P...
#include <asm/barrier.h>                       // for smp_rmb, smp_store_rel...
#include <asm/bug.h>                           // for WARN_ON_ONCE, WARN_ON
#include <asm/page_types.h>                    // for TASK_SIZE
#include <asm/percpu.h>                        // for raw_cpu_read_8, raw_cp...
#include <asm/signal.h>                        // for SIGIO
#include <linux/bitmap.h>                      // for for_each_set_bit
#include <linux/build_bug.h>                   // for barrier, unlikely, likely
#include <linux/ktime.h>                       // for ktime_get_boottime_ns
#include <linux/rcupdate.h>                    // for cond_synchronize_rcu
#include <linux/srcu.h>                        // for srcu_struct
#include <stdint.h>                            // for uintptr_t
#include <sys/types.h>                         // for ssize_t, dev_t
#include <ctime>                               // for NULL, size_t, pid_t
#include "asm-generic/bitops/const_hweight.h"  // for hweight64
#include "asm-generic/bitops/fls64.h"          // for fls64
#include "asm-generic/errno-base.h"            // for EINVAL, ENOMEM, ENOENT
#include "asm-generic/errno.h"                 // for EOPNOTSUPP, ENOSYS
#include "asm-generic/fcntl.h"                 // for O_CLOEXEC, O_RDWR
#include "asm-generic/int-ll64.h"              // for u64, u32, u16, __u64, s64
#include "asm-generic/irq_regs.h"              // for get_irq_regs
#include "asm-generic/local64.h"               // for local64_set, local64_read
#include "asm-generic/mman-common.h"           // for MAP_HUGETLB, PROT_EXEC
#include "asm-generic/mman.h"                  // for MAP_LOCKED
#include "asm-generic/param.h"                 // for HZ
#include "asm-generic/pgtable-nop4d.h"         // for p4d_t, pgd_none
#include "asm-generic/pgtable-nopmd.h"         // for pmd_t, pud_present
#include "asm-generic/pgtable-nopud.h"         // for pud_t, p4d_present
#include "asm-generic/resource.h"              // for RLIMIT_MEMLOCK
#include "asm-generic/rwonce.h"                // for READ_ONCE, WRITE_ONCE
#include "asm-generic/siginfo.h"               // for POLL_HUP, POLL_IN
#include "asm-generic/topology.h"              // for cpu_to_node
#include "asm/atomic64_32.h"                   // for atomic64_t
#include "asm/cache.h"                         // for __read_mostly
#include "asm/current.h"                       // for current
#include "asm/io.h"                            // for page_to_phys, virt_to_...
#include "asm/local.h"                         // for local_inc, local_sub
#include "asm/page.h"                          // for virt_addr_valid
#include "asm/page_types.h"                    // for PAGE_SIZE, PAGE_SHIFT
#include "asm/percpu.h"                        // for __pcpu_op2_1, __pcpu_o...
#include "asm/perf_event.h"                    // for perf_instruction_pointer
#include "asm/perf_regs.h"                     // for PERF_REG_EXTENDED_MASK
#include "asm/pgtable-2level_types.h"          // for pte_t
#include "asm/pgtable.h"                       // for pmd_present, pte_present
#include "asm/pgtable_32_areas.h"              // for VMALLOC_END, VMALLOC_S...
#include "asm/pgtable_types.h"                 // for pgd_t
#include "asm/processor.h"                     // for cpuinfo_x86
#include "asm/ptrace.h"                        // for user_mode, pt_regs
#include "asm/string_32.h"                     // for strlen, memset, memcpy
#include "asm/topology.h"                      // for topology_physical_pack...
#include "asm/uaccess.h"                       // for get_user, put_user
#include "linux/align.h"                       // for ALIGN, IS_ALIGNED
#include "linux/atomic/atomic-instrumented.h"  // for atomic_inc, atomic_read
#include "linux/bitmap.h"                      // for bitmap_from_u64
#include "linux/bits.h"                        // for BITS_PER_BYTE
#include "linux/bpf.h"                         // for BPF_TAG_SIZE
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/capability.h"                  // for perfmon_capable, capable
#include "linux/compiler_attributes.h"         // for __always_inline, __weak
#include "linux/compiler_types.h"              // for inline, __user, __unqu...
#include "linux/container_of.h"                // for container_of
#include "linux/cpumask.h"                     // for cpumask_test_cpu, for_...
#include "linux/cred.h"                        // for cred, __task_cred, cur...
#include "linux/device/bus.h"                  // for bus_register, bus_type
#include "linux/err.h"                         // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/eventpoll.h"                   // for EPOLLHUP
#include "linux/gfp.h"                         // for GFP_KERNEL, __GFP_ZERO
#include "linux/hrtimer.h"                     // for hrtimer_forward_now
#include "linux/hugetlb_inline.h"              // for is_vm_hugetlb_page
#include "linux/init.h"                        // for __init, device_initcall
#include "linux/irq_work.h"                    // for irq_work_queue, init_i...
#include "linux/irqflags.h"                    // for local_irq_restore, loc...
#include "linux/jump_label.h"                  // for static_key, static_key...
#include "linux/kallsyms.h"                    // for KSYM_NAME_LEN
#include "linux/kdev_t.h"                      // for new_encode_dev, MAJOR
#include "linux/kern_levels.h"                 // for KERN_INFO, KERN_WARNING
#include "linux/kernel.h"                      // for snprintf, sprintf, ARR...
#include "linux/kstrtox.h"                     // for kstrtoul, kstrtoint
#include "linux/ktime.h"                       // for ns_to_ktime, ktime_to_ns
#include "linux/limits.h"                      // for PATH_MAX, U16_MAX
#include "linux/list.h"                        // for INIT_LIST_HEAD, list_d...
#include "linux/lockdep.h"                     // for lockdep_assert_held
#include "linux/lockdep_types.h"               // for lock_class_key
#include "linux/log2.h"                        // for is_power_of_2
#include "linux/math.h"                        // for DIV_ROUND_UP, round_up
#include "linux/math64.h"                      // for div64_u64, div_u64
#include "linux/minmax.h"                      // for swap, min, max_t, min_t
#include "linux/mman.h"                        // for MAP_PRIVATE, MAP_SHARED
#include "linux/mmap_lock.h"                   // for mmap_read_lock, mmap_r...
#include "linux/mutex.h"                       // for mutex_unlock, mutex_lock
#include "linux/notifier.h"                    // for NOTIFY_OK, notifier_block
#include "linux/path.h"                        // for path, path_put
#include "linux/perf_event.h"                  // for perf_event (ptr only)
#include "linux/perf_regs.h"                   // for perf_regs, perf_reg_abi
#include "linux/pid.h"                         // for PIDTYPE_PID, PIDTYPE_TGID
#include "linux/pid_namespace.h"               // for put_pid_ns, get_pid_ns
#include "linux/preempt.h"                     // for preempt_disable, preem...
#include "linux/printk.h"                      // for early_printk, printk
#include "linux/rbtree.h"                      // for rb_first, rb_next, rb_...
#include "linux/rbtree_types.h"                // for rb_node (ptr only)
#include "linux/rcupdate.h"                    // for rcu_read_unlock, rcu_r...
#include "linux/refcount.h"                    // for refcount_inc_not_zero
#include "linux/rwsem.h"                       // for up_read, down_read_int...
#include "linux/sched.h"                       // for task_struct, perf_sw_c...
#include "linux/sched/signal.h"                // for rlimit, send_sig_perf
#include "linux/sched/task.h"                  // for put_task_struct, get_t...
#include "linux/sched/user.h"                  // for user_struct, free_uid
#include "linux/security.h"                    // for security_perf_event_read
#include "linux/spinlock.h"                    // for raw_spin_unlock_irq
#include "linux/srcu.h"                        // for init_srcu_struct, srcu...
#include "linux/stat.h"                        // for S_ISREG
#include "linux/static_call.h"                 // for DEFINE_STATIC_CALL_RET0
#include "linux/stddef.h"                      // for true, false, offsetof
#include "linux/string.h"                      // for strlcpy, kstrdup, strn...
#include "linux/sysctl.h"                      // for proc_dointvec_minmax
#include "linux/time.h"                        // for CLOCK_MONOTONIC, CLOCK...
#include "linux/types.h"                       // for list_head, bool, atomic_t
#include "linux/wait.h"                        // for wake_up_all, init_wait...
#include "linux/wait_bit.h"                    // for wake_up_var, wait_var_...
#include "linux/workqueue.h"                   // for work_struct, schedule_...
#include "vdso/jiffies.h"                      // for TICK_NSEC
#include "vdso/limits.h"                       // for USHRT_MAX, INT_MIN
#include "vdso/time64.h"                       // for NSEC_PER_SEC, NSEC_PER...
struct cgroup;

kernel/events/core.c should remove these lines:
- #include <asm/irq_regs.h>  // lines 60-60
- #include <linux/cgroup.h>  // lines 37-37
- #include <linux/compat.h>  // lines 44-44
- #include <linux/hardirq.h>  // lines 30-30
- #include <linux/highmem.h>  // lines 54-54
- #include <linux/hugetlb.h>  // lines 31-31
- #include <linux/kernel_stat.h>  // lines 36-36
- #include <linux/mman.h>  // lines 43-43
- #include <linux/mount.h>  // lines 52-52
- #include <linux/vmalloc.h>  // lines 29-29
- #include <linux/vmstat.h>  // lines 26-26

The full include-list for kernel/events/core.c:
#include <asm-generic/percpu.h>                // for this_cpu_ptr, DEFINE_P...
#include <asm/barrier.h>                       // for smp_rmb, smp_store_rel...
#include <asm/bug.h>                           // for WARN_ON_ONCE, WARN_ON
#include <asm/page_types.h>                    // for TASK_SIZE
#include <asm/percpu.h>                        // for raw_cpu_read_8, raw_cp...
#include <asm/signal.h>                        // for SIGIO
#include <linux/anon_inodes.h>                 // for anon_inode_getfile
#include <linux/bitmap.h>                      // for for_each_set_bit
#include <linux/bpf.h>                         // for bpf_prog_aux, bpf_prog...
#include <linux/build_bug.h>                   // for barrier, unlikely, likely
#include <linux/buildid.h>                     // for build_id_parse, BUILD_...
#include <linux/cpu.h>                         // for cpus_read_lock, cpus_r...
#include <linux/dcache.h>                      // for d_inode, dentry
#include <linux/device.h>                      // for dev_get_drvdata, devic...
#include <linux/export.h>                      // for EXPORT_SYMBOL_GPL
#include <linux/file.h>                        // for fdput, fd, fput, fd_in...
#include <linux/filter.h>                      // for bpf_prog
#include <linux/fs.h>                          // for file, file_inode, inode
#include <linux/hash.h>                        // for hash_64
#include <linux/hw_breakpoint.h>               // for init_hw_breakpoint
#include <linux/idr.h>                         // for idr_remove, idr_alloc
#include <linux/ktime.h>                       // for ktime_get_boottime_ns
#include <linux/min_heap.h>                    // for min_heap, min_heap_pop
#include <linux/mm.h>                          // for vm_fault, vm_fault::(a...
#include <linux/mm_types.h>                    // for vm_area_struct, mm_struct
#include <linux/module.h>                      // for module_put, try_module...
#include <linux/namei.h>                       // for kern_path, LOOKUP_FOLLOW
#include <linux/parser.h>                      // for substring_t, match_strdup
#include <linux/percpu.h>                      // for free_percpu, alloc_percpu
#include <linux/perf_event.h>                  // for perf_event, perf_event...
#include <linux/pgtable.h>                     // for ptep_get_lockless, p4d...
#include <linux/poll.h>                        // for poll_wait, poll_table
#include <linux/proc_ns.h>                     // for ns_get_path, mntns_ope...
#include <linux/ptrace.h>                      // for ptrace_may_access, PTR...
#include <linux/rculist.h>                     // for list_add_rcu, list_del...
#include <linux/rcupdate.h>                    // for cond_synchronize_rcu
#include <linux/reboot.h>                      // for register_reboot_notifier
#include <linux/sched/clock.h>                 // for local_clock
#include <linux/sched/mm.h>                    // for get_task_mm, mmput
#include <linux/slab.h>                        // for kfree, kzalloc, kmem_c...
#include <linux/smp.h>                         // for smp_processor_id, smp_...
#include <linux/srcu.h>                        // for srcu_struct
#include <linux/syscalls.h>                    // for __MAP5, SYSCALL_DEFINE5
#include <linux/sysfs.h>                       // for sysfs_update_groups
#include <linux/tick.h>                        // for tick_nohz_full_enabled
#include <linux/trace_events.h>                // for perf_event_query_prog_...
#include <linux/uaccess.h>                     // for copy_to_user, copy_fro...
#include <stdint.h>                            // for uintptr_t
#include <sys/types.h>                         // for ssize_t, dev_t
#include <ctime>                               // for NULL, size_t, pid_t
#include "asm-generic/bitops/const_hweight.h"  // for hweight64
#include "asm-generic/bitops/fls64.h"          // for fls64
#include "asm-generic/errno-base.h"            // for EINVAL, ENOMEM, ENOENT
#include "asm-generic/errno.h"                 // for EOPNOTSUPP, ENOSYS
#include "asm-generic/fcntl.h"                 // for O_CLOEXEC, O_RDWR
#include "asm-generic/int-ll64.h"              // for u64, u32, u16, __u64, s64
#include "asm-generic/irq_regs.h"              // for get_irq_regs
#include "asm-generic/local64.h"               // for local64_set, local64_read
#include "asm-generic/mman-common.h"           // for MAP_HUGETLB, PROT_EXEC
#include "asm-generic/mman.h"                  // for MAP_LOCKED
#include "asm-generic/param.h"                 // for HZ
#include "asm-generic/pgtable-nop4d.h"         // for p4d_t, pgd_none
#include "asm-generic/pgtable-nopmd.h"         // for pmd_t, pud_present
#include "asm-generic/pgtable-nopud.h"         // for pud_t, p4d_present
#include "asm-generic/resource.h"              // for RLIMIT_MEMLOCK
#include "asm-generic/rwonce.h"                // for READ_ONCE, WRITE_ONCE
#include "asm-generic/siginfo.h"               // for POLL_HUP, POLL_IN
#include "asm-generic/topology.h"              // for cpu_to_node
#include "asm/atomic64_32.h"                   // for atomic64_t
#include "asm/cache.h"                         // for __read_mostly
#include "asm/current.h"                       // for current
#include "asm/io.h"                            // for page_to_phys, virt_to_...
#include "asm/local.h"                         // for local_inc, local_sub
#include "asm/page.h"                          // for virt_addr_valid
#include "asm/page_types.h"                    // for PAGE_SIZE, PAGE_SHIFT
#include "asm/percpu.h"                        // for __pcpu_op2_1, __pcpu_o...
#include "asm/perf_event.h"                    // for perf_instruction_pointer
#include "asm/perf_regs.h"                     // for PERF_REG_EXTENDED_MASK
#include "asm/pgtable-2level_types.h"          // for pte_t
#include "asm/pgtable.h"                       // for pmd_present, pte_present
#include "asm/pgtable_32_areas.h"              // for VMALLOC_END, VMALLOC_S...
#include "asm/pgtable_types.h"                 // for pgd_t
#include "asm/processor.h"                     // for cpuinfo_x86
#include "asm/ptrace.h"                        // for user_mode, pt_regs
#include "asm/string_32.h"                     // for strlen, memset, memcpy
#include "asm/topology.h"                      // for topology_physical_pack...
#include "asm/uaccess.h"                       // for get_user, put_user
#include "internal.h"                          // for perf_buffer, __output_...
#include "linux/align.h"                       // for ALIGN, IS_ALIGNED
#include "linux/atomic/atomic-instrumented.h"  // for atomic_inc, atomic_read
#include "linux/bitmap.h"                      // for bitmap_from_u64
#include "linux/bits.h"                        // for BITS_PER_BYTE
#include "linux/bpf.h"                         // for BPF_TAG_SIZE
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/capability.h"                  // for perfmon_capable, capable
#include "linux/compiler_attributes.h"         // for __always_inline, __weak
#include "linux/compiler_types.h"              // for inline, __user, __unqu...
#include "linux/container_of.h"                // for container_of
#include "linux/cpumask.h"                     // for cpumask_test_cpu, for_...
#include "linux/cred.h"                        // for cred, __task_cred, cur...
#include "linux/device/bus.h"                  // for bus_register, bus_type
#include "linux/err.h"                         // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/eventpoll.h"                   // for EPOLLHUP
#include "linux/gfp.h"                         // for GFP_KERNEL, __GFP_ZERO
#include "linux/hrtimer.h"                     // for hrtimer_forward_now
#include "linux/hugetlb_inline.h"              // for is_vm_hugetlb_page
#include "linux/init.h"                        // for __init, device_initcall
#include "linux/irq_work.h"                    // for irq_work_queue, init_i...
#include "linux/irqflags.h"                    // for local_irq_restore, loc...
#include "linux/jump_label.h"                  // for static_key, static_key...
#include "linux/kallsyms.h"                    // for KSYM_NAME_LEN
#include "linux/kdev_t.h"                      // for new_encode_dev, MAJOR
#include "linux/kern_levels.h"                 // for KERN_INFO, KERN_WARNING
#include "linux/kernel.h"                      // for snprintf, sprintf, ARR...
#include "linux/kstrtox.h"                     // for kstrtoul, kstrtoint
#include "linux/ktime.h"                       // for ns_to_ktime, ktime_to_ns
#include "linux/limits.h"                      // for PATH_MAX, U16_MAX
#include "linux/list.h"                        // for INIT_LIST_HEAD, list_d...
#include "linux/lockdep.h"                     // for lockdep_assert_held
#include "linux/lockdep_types.h"               // for lock_class_key
#include "linux/log2.h"                        // for is_power_of_2
#include "linux/math.h"                        // for DIV_ROUND_UP, round_up
#include "linux/math64.h"                      // for div64_u64, div_u64
#include "linux/minmax.h"                      // for swap, min, max_t, min_t
#include "linux/mman.h"                        // for MAP_PRIVATE, MAP_SHARED
#include "linux/mmap_lock.h"                   // for mmap_read_lock, mmap_r...
#include "linux/mutex.h"                       // for mutex_unlock, mutex_lock
#include "linux/notifier.h"                    // for NOTIFY_OK, notifier_block
#include "linux/path.h"                        // for path, path_put
#include "linux/perf_event.h"                  // for perf_event (ptr only)
#include "linux/perf_regs.h"                   // for perf_regs, perf_reg_abi
#include "linux/pid.h"                         // for PIDTYPE_PID, PIDTYPE_TGID
#include "linux/pid_namespace.h"               // for put_pid_ns, get_pid_ns
#include "linux/preempt.h"                     // for preempt_disable, preem...
#include "linux/printk.h"                      // for early_printk, printk
#include "linux/rbtree.h"                      // for rb_first, rb_next, rb_...
#include "linux/rbtree_types.h"                // for rb_node (ptr only)
#include "linux/rcupdate.h"                    // for rcu_read_unlock, rcu_r...
#include "linux/refcount.h"                    // for refcount_inc_not_zero
#include "linux/rwsem.h"                       // for up_read, down_read_int...
#include "linux/sched.h"                       // for task_struct, perf_sw_c...
#include "linux/sched/signal.h"                // for rlimit, send_sig_perf
#include "linux/sched/task.h"                  // for put_task_struct, get_t...
#include "linux/sched/user.h"                  // for user_struct, free_uid
#include "linux/security.h"                    // for security_perf_event_read
#include "linux/spinlock.h"                    // for raw_spin_unlock_irq
#include "linux/srcu.h"                        // for init_srcu_struct, srcu...
#include "linux/stat.h"                        // for S_ISREG
#include "linux/static_call.h"                 // for DEFINE_STATIC_CALL_RET0
#include "linux/stddef.h"                      // for true, false, offsetof
#include "linux/string.h"                      // for strlcpy, kstrdup, strn...
#include "linux/sysctl.h"                      // for proc_dointvec_minmax
#include "linux/time.h"                        // for CLOCK_MONOTONIC, CLOCK...
#include "linux/types.h"                       // for list_head, bool, atomic_t
#include "linux/wait.h"                        // for wake_up_all, init_wait...
#include "linux/wait_bit.h"                    // for wake_up_var, wait_var_...
#include "linux/workqueue.h"                   // for work_struct, schedule_...
#include "vdso/jiffies.h"                      // for TICK_NSEC
#include "vdso/limits.h"                       // for USHRT_MAX, INT_MIN
#include "vdso/time64.h"                       // for NSEC_PER_SEC, NSEC_PER...
struct cgroup;
---
  ./scripts/check-local-export kernel/events/core.o
  iwyu2 -Wp,-MMD,kernel/events/.ring_buffer.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/events/ring_buffer"' -DKBUILD_BASENAME='"ring_buffer"' -DKBUILD_MODNAME='"ring_buffer"' -D__KBUILD_MODNAME=kmod_ring_buffer -c -o kernel/events/ring_buffer.o kernel/events/ring_buffer.c  
In file included from kernel/events/ring_buffer.c:11:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/events/ring_buffer.c:11:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/events/ring_buffer.c:11:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/events/ring_buffer.c:11:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from kernel/events/ring_buffer.c:11:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/events/ring_buffer.c:11:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/events/ring_buffer.c:11:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/events/ring_buffer.c:11:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/events/ring_buffer.c should add these lines:
#include <asm/barrier.h>                       // for smp_wmb
#include <asm/bug.h>                           // for WARN_ON_ONCE
#include <linux/mm.h>                          // for ClearPagePrivate, SetP...
#include <stddef.h>                            // for NULL
#include "asm-generic/errno-base.h"            // for ENOMEM, ENOSPC, EFAULT
#include "asm-generic/errno.h"                 // for EOPNOTSUPP
#include "asm-generic/getorder.h"              // for get_order
#include "asm-generic/int-ll64.h"              // for __u64, u64
#include "asm-generic/rwonce.h"                // for WRITE_ONCE, READ_ONCE
#include "asm-generic/topology.h"              // for cpu_to_node
#include "asm/cmpxchg.h"                       // for __xchg_wrong_size
#include "asm/local.h"                         // for local_read, local_inc
#include "asm/page.h"                          // for virt_to_page
#include "asm/page_types.h"                    // for PAGE_SHIFT, PAGE_SIZE
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_set
#include "linux/compiler.h"                    // for unlikely, barrier
#include "linux/compiler_attributes.h"         // for __always_inline
#include "linux/eventpoll.h"                   // for EPOLLIN
#include "linux/export.h"                      // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                         // for alloc_pages_node, GFP_...
#include "linux/irq_work.h"                    // for irq_work_queue
#include "linux/list.h"                        // for INIT_LIST_HEAD
#include "linux/log2.h"                        // for ilog2, order_base_2
#include "linux/math.h"                        // for rounddown
#include "linux/minmax.h"                      // for min
#include "linux/mm.h"                          // for split_page, offset_in_...
#include "linux/mm_types.h"                    // for set_page_private, page
#include "linux/mmzone.h"                      // for MAX_ORDER
#include "linux/perf_event.h"                  // for perf_event_mmap_page
#include "linux/preempt.h"                     // for in_atomic, preempt_dis...
#include "linux/rcupdate.h"                    // for rcu_read_unlock, rcu_r...
#include "linux/refcount.h"                    // for refcount_set, refcount...
#include "linux/smp.h"                         // for smp_processor_id
#include "linux/spinlock.h"                    // for spin_lock_init
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for bool, pgoff_t

kernel/events/ring_buffer.c should remove these lines:
- #include <linux/poll.h>  // lines 15-15
- #include <linux/vmalloc.h>  // lines 12-12

The full include-list for kernel/events/ring_buffer.c:
#include <asm/barrier.h>                       // for smp_wmb
#include <asm/bug.h>                           // for WARN_ON_ONCE
#include <linux/circ_buf.h>                    // for CIRC_SPACE
#include <linux/mm.h>                          // for ClearPagePrivate, SetP...
#include <linux/nospec.h>                      // for array_index_nospec
#include <linux/perf_event.h>                  // for perf_output_handle
#include <linux/slab.h>                        // for kfree, kcalloc_node
#include <stddef.h>                            // for NULL
#include "asm-generic/errno-base.h"            // for ENOMEM, ENOSPC, EFAULT
#include "asm-generic/errno.h"                 // for EOPNOTSUPP
#include "asm-generic/getorder.h"              // for get_order
#include "asm-generic/int-ll64.h"              // for __u64, u64
#include "asm-generic/rwonce.h"                // for WRITE_ONCE, READ_ONCE
#include "asm-generic/topology.h"              // for cpu_to_node
#include "asm/cmpxchg.h"                       // for __xchg_wrong_size
#include "asm/local.h"                         // for local_read, local_inc
#include "asm/page.h"                          // for virt_to_page
#include "asm/page_types.h"                    // for PAGE_SHIFT, PAGE_SIZE
#include "internal.h"                          // for perf_buffer, perf_aux_...
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_set
#include "linux/compiler.h"                    // for unlikely, barrier
#include "linux/compiler_attributes.h"         // for __always_inline
#include "linux/eventpoll.h"                   // for EPOLLIN
#include "linux/export.h"                      // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                         // for alloc_pages_node, GFP_...
#include "linux/irq_work.h"                    // for irq_work_queue
#include "linux/list.h"                        // for INIT_LIST_HEAD
#include "linux/log2.h"                        // for ilog2, order_base_2
#include "linux/math.h"                        // for rounddown
#include "linux/minmax.h"                      // for min
#include "linux/mm.h"                          // for split_page, offset_in_...
#include "linux/mm_types.h"                    // for set_page_private, page
#include "linux/mmzone.h"                      // for MAX_ORDER
#include "linux/perf_event.h"                  // for perf_event_mmap_page
#include "linux/preempt.h"                     // for in_atomic, preempt_dis...
#include "linux/rcupdate.h"                    // for rcu_read_unlock, rcu_r...
#include "linux/refcount.h"                    // for refcount_set, refcount...
#include "linux/smp.h"                         // for smp_processor_id
#include "linux/spinlock.h"                    // for spin_lock_init
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for bool, pgoff_t
---
  ./scripts/check-local-export kernel/events/ring_buffer.o
  iwyu2 -Wp,-MMD,kernel/events/.callchain.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/events/callchain"' -DKBUILD_BASENAME='"callchain"' -DKBUILD_MODNAME='"callchain"' -D__KBUILD_MODNAME=kmod_callchain -c -o kernel/events/callchain.o kernel/events/callchain.c  
In file included from kernel/events/callchain.c:11:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/events/callchain.c:11:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/events/callchain.c:11:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/events/callchain.c:11:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from kernel/events/callchain.c:11:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/events/callchain.c:11:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/events/callchain.c:11:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/events/callchain.c:11:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/events/callchain.c should add these lines:
#include <asm-generic/percpu.h>                // for this_cpu_ptr, DEFINE_P...
#include <asm/bug.h>                           // for WARN_ON_ONCE
#include <stddef.h>                            // for NULL, size_t
#include "asm-generic/errno-base.h"            // for ENOMEM, EBUSY, EINVAL
#include "asm-generic/errno.h"                 // for EOVERFLOW
#include "asm-generic/int-ll64.h"              // for u32, __u64
#include "asm-generic/topology.h"              // for cpu_to_node
#include "asm/cache.h"                         // for __read_mostly
#include "asm/current.h"                       // for current
#include "asm/processor.h"                     // for task_pt_regs
#include "asm/ptrace.h"                        // for user_mode, pt_regs (pt...
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec, atomic_inc...
#include "linux/compiler_attributes.h"         // for __weak
#include "linux/compiler_types.h"              // for inline
#include "linux/container_of.h"                // for container_of
#include "linux/cpumask.h"                     // for for_each_possible_cpu
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/mutex.h"                       // for mutex_unlock, mutex
#include "linux/perf_event.h"                  // for perf_callchain_entry (...
#include "linux/rcupdate.h"                    // for call_rcu, RCU_INIT_POI...
#include "linux/sched.h"                       // for task_struct
#include "linux/smp.h"                         // for smp_processor_id
#include "linux/stddef.h"                      // for false, offsetof
#include "linux/sysctl.h"                      // for ctl_table, proc_dointv...
#include "linux/types.h"                       // for rcu_head, bool, atomic_t

kernel/events/callchain.c should remove these lines:
- #include <linux/sched/task_stack.h>  // lines 13-13

The full include-list for kernel/events/callchain.c:
#include <asm-generic/percpu.h>                // for this_cpu_ptr, DEFINE_P...
#include <asm/bug.h>                           // for WARN_ON_ONCE
#include <linux/perf_event.h>                  // for perf_callchain_entry_ctx
#include <linux/slab.h>                        // for kfree, kmalloc_node
#include <stddef.h>                            // for NULL, size_t
#include "asm-generic/errno-base.h"            // for ENOMEM, EBUSY, EINVAL
#include "asm-generic/errno.h"                 // for EOVERFLOW
#include "asm-generic/int-ll64.h"              // for u32, __u64
#include "asm-generic/topology.h"              // for cpu_to_node
#include "asm/cache.h"                         // for __read_mostly
#include "asm/current.h"                       // for current
#include "asm/processor.h"                     // for task_pt_regs
#include "asm/ptrace.h"                        // for user_mode, pt_regs (pt...
#include "internal.h"                          // for put_recursion_context
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec, atomic_inc...
#include "linux/compiler_attributes.h"         // for __weak
#include "linux/compiler_types.h"              // for inline
#include "linux/container_of.h"                // for container_of
#include "linux/cpumask.h"                     // for for_each_possible_cpu
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/mutex.h"                       // for mutex_unlock, mutex
#include "linux/perf_event.h"                  // for perf_callchain_entry (...
#include "linux/rcupdate.h"                    // for call_rcu, RCU_INIT_POI...
#include "linux/sched.h"                       // for task_struct
#include "linux/smp.h"                         // for smp_processor_id
#include "linux/stddef.h"                      // for false, offsetof
#include "linux/sysctl.h"                      // for ctl_table, proc_dointv...
#include "linux/types.h"                       // for rcu_head, bool, atomic_t
---
  ./scripts/check-local-export kernel/events/callchain.o
  iwyu2 -Wp,-MMD,kernel/events/.hw_breakpoint.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/events/hw_breakpoint"' -DKBUILD_BASENAME='"hw_breakpoint"' -DKBUILD_MODNAME='"hw_breakpoint"' -D__KBUILD_MODNAME=kmod_hw_breakpoint -c -o kernel/events/hw_breakpoint.o kernel/events/hw_breakpoint.c  
In file included from kernel/events/hw_breakpoint.c:32:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/events/hw_breakpoint.c:32:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/events/hw_breakpoint.c:32:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/events/hw_breakpoint.c:36:
In file included from ./include/linux/hw_breakpoint.h:5:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from kernel/events/hw_breakpoint.c:32:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/events/hw_breakpoint.c:32:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/events/hw_breakpoint.c:32:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/events/hw_breakpoint.c:36:
In file included from ./include/linux/hw_breakpoint.h:5:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/events/hw_breakpoint.c should add these lines:
#include <asm-generic/percpu.h>         // for per_cpu, DEFINE_PER_CPU, per_...
#include <asm/bug.h>                    // for WARN_ON
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EINVAL, ENOMEM, ENOENT, ENOSPC
#include "asm-generic/errno.h"          // for EOPNOTSUPP
#include "asm-generic/int-ll64.h"       // for u64
#include "asm/current.h"                // for current
#include "asm/hw_breakpoint.h"          // for hw_breakpoint_exceptions_notify
#include "asm/string_32.h"              // for memcmp
#include "linux/capability.h"           // for capable, CAP_SYS_ADMIN
#include "linux/compiler.h"             // for likely
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/compiler_types.h"       // for __percpu, __force, inline
#include "linux/cpumask.h"              // for for_each_possible_cpu, for_ea...
#include "linux/err.h"                  // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/hw_breakpoint.h"        // for bp_type_idx, TYPE_MAX, HW_BRE...
#include "linux/mutex.h"                // for mutex_lock, mutex_unlock, mutex
#include "linux/perf_event.h"           // for perf_event, perf_event_attr
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for list_head, bool

kernel/events/hw_breakpoint.c should remove these lines:
- #include <linux/bug.h>  // lines 34-34
- #include <linux/kallsyms.h>  // lines 21-21
- #include <linux/kernel.h>  // lines 25-25
- #include <linux/kprobes.h>  // lines 23-23
- #include <linux/module.h>  // lines 26-26
- #include <linux/smp.h>  // lines 33-33

The full include-list for kernel/events/hw_breakpoint.c:
#include <asm-generic/percpu.h>         // for per_cpu, DEFINE_PER_CPU, per_...
#include <asm/bug.h>                    // for WARN_ON
#include <linux/cpu.h>                  // for cpus_read_lock, cpus_read_unlock
#include <linux/hw_breakpoint.h>        // for arch_release_bp_slot, arch_re...
#include <linux/init.h>                 // for __init
#include <linux/irqflags.h>             // for irqs_disabled
#include <linux/kdebug.h>               // for register_die_notifier
#include <linux/list.h>                 // for list_add_tail, list_del, LIST...
#include <linux/notifier.h>             // for notifier_block
#include <linux/percpu.h>               // for free_percpu, alloc_percpu
#include <linux/sched.h>                // for perf_sw_context
#include <linux/slab.h>                 // for kcalloc, kfree
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EINVAL, ENOMEM, ENOENT, ENOSPC
#include "asm-generic/errno.h"          // for EOPNOTSUPP
#include "asm-generic/int-ll64.h"       // for u64
#include "asm/current.h"                // for current
#include "asm/hw_breakpoint.h"          // for hw_breakpoint_exceptions_notify
#include "asm/string_32.h"              // for memcmp
#include "linux/capability.h"           // for capable, CAP_SYS_ADMIN
#include "linux/compiler.h"             // for likely
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/compiler_types.h"       // for __percpu, __force, inline
#include "linux/cpumask.h"              // for for_each_possible_cpu, for_ea...
#include "linux/err.h"                  // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/hw_breakpoint.h"        // for bp_type_idx, TYPE_MAX, HW_BRE...
#include "linux/mutex.h"                // for mutex_lock, mutex_unlock, mutex
#include "linux/perf_event.h"           // for perf_event, perf_event_attr
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for list_head, bool
---
  ./scripts/check-local-export kernel/events/hw_breakpoint.o
  rm -f kernel/events/built-in.a; echo core.o ring_buffer.o callchain.o hw_breakpoint.o | sed -E 's:([^ ]+):kernel/events/:g' | xargs llvm-ar cDPrST kernel/events/built-in.a
  iwyu2 -Wp,-MMD,kernel/.fork.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/fork"' -DKBUILD_BASENAME='"fork"' -DKBUILD_MODNAME='"fork"' -D__KBUILD_MODNAME=kmod_fork -c -o kernel/fork.o kernel/fork.c  
In file included from kernel/fork.c:45:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/fork.c:45:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/fork.c:45:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/fork.c:45:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/fork.c:73:
./include/linux/tsacct_kern.h:13:13: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
                                 struct taskstats *stats, struct task_struct *tsk)
                                        ^
./include/linux/tsacct_kern.h:16:41: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline void xacct_add_tsk(struct taskstats *stats, struct task_struct *p)
                                        ^
In file included from kernel/fork.c:76:
./include/linux/delayacct.h:27:44: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline int delayacct_add_tsk(struct taskstats *d,
                                           ^
In file included from kernel/fork.c:848:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
8 warnings generated.
In file included from kernel/fork.c:45:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/fork.c:45:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/fork.c:45:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/fork.c:45:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/fork.c:73:
./include/linux/tsacct_kern.h:13:13: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
                                 struct taskstats *stats, struct task_struct *tsk)
                                        ^
./include/linux/tsacct_kern.h:16:41: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline void xacct_add_tsk(struct taskstats *stats, struct task_struct *p)
                                        ^
In file included from kernel/fork.c:76:
./include/linux/delayacct.h:27:44: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline int delayacct_add_tsk(struct taskstats *d,
                                           ^
In file included from kernel/fork.c:848:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^

kernel/fork.c should add these lines:
#include <asm-generic/percpu.h>                      // for DEFINE_PER_CPU
#include <asm/bug.h>                                 // for WARN_ON, WARN_ON...
#include <asm/page_types.h>                          // for THREAD_SIZE, THR...
#include <asm/percpu.h>                              // for raw_cpu_add_8
#include <asm/posix_types.h>                         // for __kernel_ulong_t
#include <asm/signal.h>                              // for SIGKILL, SIGSTOP
#include <linux/atomic.h>                            // for atomic_long_t
#include <linux/build_bug.h>                         // for unlikely, likely
#include <linux/ktime.h>                             // for ktime_get_bootti...
#include <linux/spinlock.h>                          // for write_unlock_irq
#include <linux/spinlock_types.h>                    // for DEFINE_RWLOCK
#include <signal.h>                                  // for SIGCHLD
#include <ctime>                                     // for NULL, size_t, pid_t
#include "asm-generic/bitops/fls64.h"                // for fls64
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit
#include "asm-generic/cacheflush.h"                  // for flush_cache_dup_mm
#include "asm-generic/errno-base.h"                  // for EINVAL, ENOMEM
#include "asm-generic/fcntl.h"                       // for O_CLOEXEC, O_RDWR
#include "asm-generic/int-ll64.h"                    // for u64, __u64
#include "asm-generic/resource.h"                    // for RLIMIT_NPROC
#include "asm-generic/rwonce.h"                      // for READ_ONCE, WRITE...
#include "asm-generic/topology.h"                    // for cpu_to_node
#include "asm/cache.h"                               // for L1_CACHE_BYTES
#include "asm/cmpxchg.h"                             // for __xchg_wrong_size
#include "asm/current.h"                             // for current
#include "asm/page.h"                                // for virt_to_page
#include "asm/page_types.h"                          // for PAGE_SIZE, PAGE_...
#include "asm/percpu.h"                              // for __pcpu_op1_1
#include "asm/processor.h"                           // for arch_thread_stru...
#include "asm/ptrace.h"                              // for pt_regs
#include "asm/segment.h"                             // for __loadsegment_gs
#include "asm/string_32.h"                           // for memcpy, memset
#include "asm/thread_info.h"                         // for thread_info, arc...
#include "asm/uaccess.h"                             // for put_user, access_ok
#include "asm/unistd.h"                              // for __ARCH_WANT_SYS_...
#include "linux/atomic/atomic-instrumented.h"        // for atomic_dec_and_test
#include "linux/build_bug.h"                         // for BUILD_BUG_ON
#include "linux/cache.h"                             // for __cacheline_aligned
#include "linux/capability.h"                        // for CAP_SYS_ADMIN
#include "linux/compiler_attributes.h"               // for __weak, __always...
#include "linux/compiler_types.h"                    // for inline, __user
#include "linux/container_of.h"                      // for container_of
#include "linux/cpumask.h"                           // for cpumask_size
#include "linux/cred.h"                              // for exit_creds, cred
#include "linux/err.h"                               // for ERR_PTR, IS_ERR
#include "linux/errno.h"                             // for ERESTARTNOINTR
#include "linux/eventpoll.h"                         // for EPOLLIN, EPOLLRD...
#include "linux/export.h"                            // for EXPORT_SYMBOL_GPL
#include "linux/futex.h"                             // for FUTEX_TID_MASK
#include "linux/gfp.h"                               // for GFP_KERNEL, __fr...
#include "linux/highmem-internal.h"                  // for kmap_local_fork
#include "linux/huge_mm.h"                           // for mm_put_huge_zero...
#include "linux/hugetlb_inline.h"                    // for is_vm_hugetlb_page
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/kcsan-checks.h"                      // for ASSERT_EXCLUSIVE...
#include "linux/kernel.h"                            // for lower_32_bits
#include "linux/kstrtox.h"                           // for simple_strtoul
#include "linux/latencytop.h"                        // for clear_tsk_latenc...
#include "linux/list.h"                              // for INIT_LIST_HEAD
#include "linux/lockdep.h"                           // for lockdep_free_task
#include "linux/math64.h"                            // for div64_u64
#include "linux/minmax.h"                            // for clamp_t, max_t
#include "linux/mm_types.h"                          // for mm_struct, mm_st...
#include "linux/mm_types_task.h"                     // for NR_MM_COUNTERS
#include "linux/mmap_lock.h"                         // for mmap_read_lock
#include "linux/mmdebug.h"                           // for VM_BUG_ON
#include "linux/mmzone.h"                            // for NR_KERNEL_STACK_KB
#include "linux/mutex.h"                             // for mutex_lock, mute...
#include "linux/numa.h"                              // for NUMA_NO_NODE
#include "linux/path.h"                              // for path_equal
#include "linux/pid.h"                               // for attach_pid, PIDT...
#include "linux/pid_namespace.h"                     // for task_active_pid_ns
#include "linux/poll.h"                              // for poll_wait, poll_...
#include "linux/printk.h"                            // for pr_alert, pr_war...
#include "linux/ptrace.h"                            // for PTRACE_EVENT_CLONE
#include "linux/rbtree_types.h"                      // for RB_ROOT, rb_node
#include "linux/rculist.h"                           // for list_add_tail_rcu
#include "linux/refcount.h"                          // for refcount_set
#include "linux/resource.h"                          // for rlimit
#include "linux/rwsem.h"                             // for down_read_killable
#include "linux/sched.h"                             // for task_struct, clo...
#include "linux/sched/signal.h"                      // for signal_struct
#include "linux/seqlock.h"                           // for seqcount_init
#include "linux/shm.h"                               // for shm_init_task
#include "linux/signal.h"                            // for init_sigpending
#include "linux/signal_types.h"                      // for sigpending
#include "linux/spinlock.h"                          // for spin_unlock, spi...
#include "linux/spinlock_types.h"                    // for DEFINE_SPINLOCK
#include "linux/stddef.h"                            // for false, offsetofend
#include "linux/stringify.h"                         // for __stringify
#include "linux/syscall_user_dispatch.h"             // for clear_syscall_wo...
#include "linux/types.h"                             // for list_head, rcu_head
#include "linux/user_namespace.h"                    // for set_rlimit_ucoun...
#include "linux/vmstat.h"                            // for mod_lruvec_page_...
#include "linux/wait.h"                              // for init_waitqueue_head
#include "linux/workqueue.h"                         // for schedule_work
#include "trace/syscall.h"                           // for syscall_tracepoi...
#include "vdso/limits.h"                             // for INT_MAX

kernel/fork.c should remove these lines:
- #include <asm/cacheflush.h>  // lines 105-105
- #include <linux/acct.h>  // lines 71-71
- #include <linux/compat.h>  // lines 58-58
- #include <linux/compiler.h>  // lines 90-90
- #include <linux/cpu.h>  // lines 49-49
- #include <linux/init_task.h>  // lines 848-848
- #include <linux/jiffies.h>  // lines 56-56
- #include <linux/key.h>  // lines 39-39
- #include <linux/mount.h>  // lines 63-63
- #include <linux/personality.h>  // lines 33-33
- #include <linux/proc_fs.h>  // lines 67-67
- #include <linux/profile.h>  // lines 68-68
- #include <linux/sched/mm.h>  // lines 100-100
- #include <linux/seccomp.h>  // lines 53-53
- #include <linux/seq_file.h>  // lines 26-26
- #include <linux/swap.h>  // lines 54-54
- #include <linux/unistd.h>  // lines 29-29

The full include-list for kernel/fork.c:
#include <asm-generic/percpu.h>                      // for DEFINE_PER_CPU
#include <asm/bug.h>                                 // for WARN_ON, WARN_ON...
#include <asm/mmu_context.h>                         // for arch_dup_mmap
#include <asm/page_types.h>                          // for THREAD_SIZE, THR...
#include <asm/percpu.h>                              // for raw_cpu_add_8
#include <asm/pgalloc.h>                             // for pgd_alloc, pgd_free
#include <asm/posix_types.h>                         // for __kernel_ulong_t
#include <asm/signal.h>                              // for SIGKILL, SIGSTOP
#include <asm/tlbflush.h>                            // for flush_tlb_mm
#include <linux/aio.h>                               // for exit_aio
#include <linux/anon_inodes.h>                       // for anon_inode_getfile
#include <linux/atomic.h>                            // for atomic_long_t
#include <linux/audit.h>                             // for audit_alloc, aud...
#include <linux/binfmts.h>                           // for linux_binfmt
#include <linux/bpf.h>                               // for bpf_task_storage...
#include <linux/build_bug.h>                         // for unlikely, likely
#include <linux/capability.h>                        // for capable
#include <linux/cgroup.h>                            // for cgroup_can_fork
#include <linux/cn_proc.h>                           // for proc_fork_connector
#include <linux/completion.h>                        // for complete, init_c...
#include <linux/delayacct.h>                         // for delayacct_tsk_free
#include <linux/fdtable.h>                           // for dup_fd, put_file...
#include <linux/file.h>                              // for fput, put_unused_fd
#include <linux/freezer.h>                           // for freezer_count
#include <linux/fs.h>                                // for deny_write_access
#include <linux/fs_struct.h>                         // for fs_struct, copy_...
#include <linux/ftrace.h>                            // for ftrace_graph_exi...
#include <linux/futex.h>                             // for do_futex, futex_...
#include <linux/hugetlb.h>                           // for hugetlb_count_init
#include <linux/init.h>                              // for __init, __setup
#include <linux/io_uring.h>                          // for io_uring_free
#include <linux/iocontext.h>                         // for copy_io, exit_io...
#include <linux/kasan.h>                             // for kasan_reset_tag
#include <linux/kcov.h>                              // for kcov_task_init
#include <linux/khugepaged.h>                        // for khugepaged_exit
#include <linux/ksm.h>                               // for ksm_exit, ksm_fork
#include <linux/kthread.h>                           // for free_kthread_struct
#include <linux/ktime.h>                             // for ktime_get_bootti...
#include <linux/livepatch.h>                         // for klp_copy_process
#include <linux/magic.h>                             // for STACK_END_MAGIC
#include <linux/memcontrol.h>                        // for memcg_kmem_uncha...
#include <linux/mempolicy.h>                         // for mpol_put, vma_du...
#include <linux/mm.h>                                // for mm_pgtables_bytes
#include <linux/mm_inline.h>                         // for dup_anon_vma_name
#include <linux/mman.h>                              // for vm_unacct_memory
#include <linux/mmu_notifier.h>                      // for mmu_notifier_sub...
#include <linux/module.h>                            // for module_put, try_...
#include <linux/nsproxy.h>                           // for nsproxy, copy_na...
#include <linux/oom.h>                               // for oom_adj_mutex
#include <linux/perf_event.h>                        // for perf_event_fork
#include <linux/posix-timers.h>                      // for clear_posix_cput...
#include <linux/ptrace.h>                            // for ptrace_event_pid
#include <linux/random.h>                            // for add_latent_entropy
#include <linux/rcupdate.h>                          // for call_rcu, RCU_IN...
#include <linux/rmap.h>                              // for anon_vma_fork
#include <linux/rtmutex.h>                           // for rt_mutex_debug_t...
#include <linux/sched/autogroup.h>                   // for sched_autogroup_...
#include <linux/sched/coredump.h>                    // for MMF_DUMP_FILTER_...
#include <linux/sched/cputime.h>                     // for prev_cputime_init
#include <linux/sched/mm.h>                          // for mmget, mm_pasid_...
#include <linux/sched/numa_balancing.h>              // for task_numa_free
#include <linux/sched/stat.h>                        // for nr_processes
#include <linux/sched/task.h>                        // for kernel_clone_args
#include <linux/sched/task_stack.h>                  // for end_of_stack
#include <linux/sched/user.h>                        // for INIT_USER
#include <linux/scs.h>                               // for scs_init, scs_pr...
#include <linux/security.h>                          // for security_task_free
#include <linux/sem.h>                               // for exit_sem, copy_s...
#include <linux/signalfd.h>                          // for signalfd_cleanup
#include <linux/slab.h>                              // for kmem_cache_free
#include <linux/spinlock.h>                          // for write_unlock_irq
#include <linux/spinlock_types.h>                    // for DEFINE_RWLOCK
#include <linux/stackleak.h>                         // for stackleak_task_init
#include <linux/syscalls.h>                          // for __MAP1, __MAP2
#include <linux/sysctl.h>                            // for ctl_table, proc_...
#include <linux/task_io_accounting_ops.h>            // for task_io_accounti...
#include <linux/taskstats_kern.h>                    // for taskstats_tgid_free
#include <linux/thread_info.h>                       // for clear_task_sysca...
#include <linux/tsacct_kern.h>                       // for acct_clear_integ...
#include <linux/tty.h>                               // for tty_audit_fork
#include <linux/uaccess.h>                           // for copy_from_user
#include <linux/uprobes.h>                           // for uprobe_clear_state
#include <linux/user-return-notifier.h>              // for clear_user_retur...
#include <linux/userfaultfd_k.h>                     // for dup_userfaultfd
#include <linux/vmacache.h>                          // for vmacache_flush
#include <linux/vmalloc.h>                           // for vm_struct
#include <signal.h>                                  // for SIGCHLD
#include <trace/events/sched.h>                      // for trace_sched_proc...
#include <trace/events/task.h>                       // for trace_task_newtask
#include <ctime>                                     // for NULL, size_t, pid_t
#include "asm-generic/bitops/fls64.h"                // for fls64
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit
#include "asm-generic/cacheflush.h"                  // for flush_cache_dup_mm
#include "asm-generic/errno-base.h"                  // for EINVAL, ENOMEM
#include "asm-generic/fcntl.h"                       // for O_CLOEXEC, O_RDWR
#include "asm-generic/int-ll64.h"                    // for u64, __u64
#include "asm-generic/resource.h"                    // for RLIMIT_NPROC
#include "asm-generic/rwonce.h"                      // for READ_ONCE, WRITE...
#include "asm-generic/topology.h"                    // for cpu_to_node
#include "asm/cache.h"                               // for L1_CACHE_BYTES
#include "asm/cmpxchg.h"                             // for __xchg_wrong_size
#include "asm/current.h"                             // for current
#include "asm/page.h"                                // for virt_to_page
#include "asm/page_types.h"                          // for PAGE_SIZE, PAGE_...
#include "asm/percpu.h"                              // for __pcpu_op1_1
#include "asm/processor.h"                           // for arch_thread_stru...
#include "asm/ptrace.h"                              // for pt_regs
#include "asm/segment.h"                             // for __loadsegment_gs
#include "asm/string_32.h"                           // for memcpy, memset
#include "asm/thread_info.h"                         // for thread_info, arc...
#include "asm/uaccess.h"                             // for put_user, access_ok
#include "asm/unistd.h"                              // for __ARCH_WANT_SYS_...
#include "linux/atomic/atomic-instrumented.h"        // for atomic_dec_and_test
#include "linux/build_bug.h"                         // for BUILD_BUG_ON
#include "linux/cache.h"                             // for __cacheline_aligned
#include "linux/capability.h"                        // for CAP_SYS_ADMIN
#include "linux/compiler_attributes.h"               // for __weak, __always...
#include "linux/compiler_types.h"                    // for inline, __user
#include "linux/container_of.h"                      // for container_of
#include "linux/cpumask.h"                           // for cpumask_size
#include "linux/cred.h"                              // for exit_creds, cred
#include "linux/err.h"                               // for ERR_PTR, IS_ERR
#include "linux/errno.h"                             // for ERESTARTNOINTR
#include "linux/eventpoll.h"                         // for EPOLLIN, EPOLLRD...
#include "linux/export.h"                            // for EXPORT_SYMBOL_GPL
#include "linux/futex.h"                             // for FUTEX_TID_MASK
#include "linux/gfp.h"                               // for GFP_KERNEL, __fr...
#include "linux/highmem-internal.h"                  // for kmap_local_fork
#include "linux/huge_mm.h"                           // for mm_put_huge_zero...
#include "linux/hugetlb_inline.h"                    // for is_vm_hugetlb_page
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/kcsan-checks.h"                      // for ASSERT_EXCLUSIVE...
#include "linux/kernel.h"                            // for lower_32_bits
#include "linux/kstrtox.h"                           // for simple_strtoul
#include "linux/latencytop.h"                        // for clear_tsk_latenc...
#include "linux/list.h"                              // for INIT_LIST_HEAD
#include "linux/lockdep.h"                           // for lockdep_free_task
#include "linux/math64.h"                            // for div64_u64
#include "linux/minmax.h"                            // for clamp_t, max_t
#include "linux/mm_types.h"                          // for mm_struct, mm_st...
#include "linux/mm_types_task.h"                     // for NR_MM_COUNTERS
#include "linux/mmap_lock.h"                         // for mmap_read_lock
#include "linux/mmdebug.h"                           // for VM_BUG_ON
#include "linux/mmzone.h"                            // for NR_KERNEL_STACK_KB
#include "linux/mutex.h"                             // for mutex_lock, mute...
#include "linux/numa.h"                              // for NUMA_NO_NODE
#include "linux/path.h"                              // for path_equal
#include "linux/pid.h"                               // for attach_pid, PIDT...
#include "linux/pid_namespace.h"                     // for task_active_pid_ns
#include "linux/poll.h"                              // for poll_wait, poll_...
#include "linux/printk.h"                            // for pr_alert, pr_war...
#include "linux/ptrace.h"                            // for PTRACE_EVENT_CLONE
#include "linux/rbtree_types.h"                      // for RB_ROOT, rb_node
#include "linux/rculist.h"                           // for list_add_tail_rcu
#include "linux/refcount.h"                          // for refcount_set
#include "linux/resource.h"                          // for rlimit
#include "linux/rwsem.h"                             // for down_read_killable
#include "linux/sched.h"                             // for task_struct, clo...
#include "linux/sched/signal.h"                      // for signal_struct
#include "linux/seqlock.h"                           // for seqcount_init
#include "linux/shm.h"                               // for shm_init_task
#include "linux/signal.h"                            // for init_sigpending
#include "linux/signal_types.h"                      // for sigpending
#include "linux/spinlock.h"                          // for spin_unlock, spi...
#include "linux/spinlock_types.h"                    // for DEFINE_SPINLOCK
#include "linux/stddef.h"                            // for false, offsetofend
#include "linux/stringify.h"                         // for __stringify
#include "linux/syscall_user_dispatch.h"             // for clear_syscall_wo...
#include "linux/types.h"                             // for list_head, rcu_head
#include "linux/user_namespace.h"                    // for set_rlimit_ucoun...
#include "linux/vmstat.h"                            // for mod_lruvec_page_...
#include "linux/wait.h"                              // for init_waitqueue_head
#include "linux/workqueue.h"                         // for schedule_work
#include "trace/syscall.h"                           // for syscall_tracepoi...
#include "vdso/limits.h"                             // for INT_MAX
---
  ./scripts/check-local-export kernel/fork.o
  iwyu2 -Wp,-MMD,kernel/.exec_domain.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/exec_domain"' -DKBUILD_BASENAME='"exec_domain"' -DKBUILD_MODNAME='"exec_domain"' -D__KBUILD_MODNAME=kmod_exec_domain -c -o kernel/exec_domain.o kernel/exec_domain.c  
In file included from kernel/exec_domain.c:19:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/exec_domain.c:19:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/exec_domain.c:19:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/exec_domain.c:19:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from kernel/exec_domain.c:19:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/exec_domain.c:19:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/exec_domain.c:19:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/exec_domain.c:19:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/exec_domain.c should add these lines:
#include "asm/current.h"        // for current
#include "asm/ptrace.h"         // for pt_regs

kernel/exec_domain.c should remove these lines:
- #include <linux/init.h>  // lines 11-11
- #include <linux/kernel.h>  // lines 12-12
- #include <linux/kmod.h>  // lines 13-13
- #include <linux/module.h>  // lines 14-14
- #include <linux/proc_fs.h>  // lines 16-16
- #include <linux/seq_file.h>  // lines 18-18
- #include <linux/sysctl.h>  // lines 20-20
- #include <linux/types.h>  // lines 21-21

The full include-list for kernel/exec_domain.c:
#include <linux/personality.h>  // for set_personality
#include <linux/sched.h>        // for task_struct
#include <linux/syscalls.h>     // for __MAP1, SYSCALL_DEFINE1
#include "asm/current.h"        // for current
#include "asm/ptrace.h"         // for pt_regs
---
  ./scripts/check-local-export kernel/exec_domain.o
  iwyu2 -Wp,-MMD,kernel/.panic.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/panic"' -DKBUILD_BASENAME='"panic"' -DKBUILD_MODNAME='"panic"' -D__KBUILD_MODNAME=kmod_panic -c -o kernel/panic.o kernel/panic.c  
In file included from kernel/panic.c:19:
In file included from ./include/linux/vt_kern.h:12:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/panic.c:19:
In file included from ./include/linux/vt_kern.h:12:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/panic.c:19:
In file included from ./include/linux/vt_kern.h:12:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/panic.c:19:
In file included from ./include/linux/vt_kern.h:12:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/panic.c:19:
In file included from ./include/linux/vt_kern.h:12:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/panic.c:19:
In file included from ./include/linux/vt_kern.h:12:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/panic.c should add these lines:
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for CUT_HERE, __warn
#include <cstdio>                                    // for NULL, va_list
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit
#include "asm-generic/errno-base.h"                  // for EINVAL
#include "asm/bug.h"                                 // for __WARN_FLAGS
#include "asm/cache.h"                               // for __read_mostly
#include "asm/current.h"                             // for current
#include "asm/string_32.h"                           // for strcmp
#include "asm/vdso/processor.h"                      // for cpu_relax
#include "generated/autoconf.h"                      // for CONFIG_PANIC_ON_...
#include "linux/atomic/atomic-instrumented.h"        // for atomic_cmpxchg
#include "linux/build_bug.h"                         // for BUILD_BUG_ON
#include "linux/compiler_attributes.h"               // for __weak
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/hrtimer.h"                           // for sysrq_timer_list...
#include "linux/irqflags.h"                          // for local_irq_disable
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/kernel.h"                            // for bust_spinlocks
#include "linux/kstrtox.h"                           // for kstrtoul
#include "linux/lockdep.h"                           // for print_irqtrace_e...
#include "linux/mm.h"                                // for show_mem
#include "linux/moduleparam.h"                       // for kernel_param
#include "linux/panic.h"                             // for PANIC_CPU_INVALID
#include "linux/preempt.h"                           // for preempt_disable_...
#include "linux/printk.h"                            // for vprintk, pr_warn
#include "linux/smp.h"                               // for smp_send_stop
#include "linux/spinlock.h"                          // for spin_lock, spin_...
#include "linux/spinlock_types.h"                    // for DEFINE_SPINLOCK
#include "linux/stdarg.h"                            // for va_end, va_start
#include "linux/stddef.h"                            // for false, true
#include "linux/string.h"                            // for strsep
#include "linux/types.h"                             // for bool, ATOMIC_INIT
#include "vdso/time64.h"                             // for MSEC_PER_SEC
struct pt_regs;

kernel/panic.c should remove these lines:
- #include <asm/sections.h>  // lines 36-36
- #include <linux/bug.h>  // lines 32-32
- #include <linux/debugfs.h>  // lines 34-34
- #include <linux/interrupt.h>  // lines 14-14
- #include <linux/kallsyms.h>  // lines 17-17
- #include <linux/panic_notifier.h>  // lines 26-26
- #include <linux/random.h>  // lines 21-21
- #include <linux/ratelimit.h>  // lines 33-33

The full include-list for kernel/panic.c:
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for CUT_HERE, __warn
#include <linux/console.h>                           // for console_flush_on...
#include <linux/debug_locks.h>                       // for debug_locks_off
#include <linux/delay.h>                             // for mdelay
#include <linux/ftrace.h>                            // for disable_trace_on...
#include <linux/init.h>                              // for __init, early_param
#include <linux/kexec.h>                             // for __crash_kexec
#include <linux/kgdb.h>                              // for kgdb_panic
#include <linux/kmsg_dump.h>                         // for kmsg_dump, KMSG_...
#include <linux/module.h>                            // for print_modules
#include <linux/nmi.h>                               // for touch_nmi_watchdog
#include <linux/notifier.h>                          // for atomic_notifier_...
#include <linux/reboot.h>                            // for emergency_restart
#include <linux/sched.h>                             // for task_struct
#include <linux/sched/debug.h>                       // for show_regs, show_...
#include <linux/vt_kern.h>                           // for unblank_screen
#include <trace/events/error_report.h>               // for trace_error_repo...
#include <cstdio>                                    // for NULL, va_list
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit
#include "asm-generic/errno-base.h"                  // for EINVAL
#include "asm/bug.h"                                 // for __WARN_FLAGS
#include "asm/cache.h"                               // for __read_mostly
#include "asm/current.h"                             // for current
#include "asm/string_32.h"                           // for strcmp
#include "asm/vdso/processor.h"                      // for cpu_relax
#include "generated/autoconf.h"                      // for CONFIG_PANIC_ON_...
#include "linux/atomic/atomic-instrumented.h"        // for atomic_cmpxchg
#include "linux/build_bug.h"                         // for BUILD_BUG_ON
#include "linux/compiler_attributes.h"               // for __weak
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/hrtimer.h"                           // for sysrq_timer_list...
#include "linux/irqflags.h"                          // for local_irq_disable
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/kernel.h"                            // for bust_spinlocks
#include "linux/kstrtox.h"                           // for kstrtoul
#include "linux/lockdep.h"                           // for print_irqtrace_e...
#include "linux/mm.h"                                // for show_mem
#include "linux/moduleparam.h"                       // for kernel_param
#include "linux/panic.h"                             // for PANIC_CPU_INVALID
#include "linux/preempt.h"                           // for preempt_disable_...
#include "linux/printk.h"                            // for vprintk, pr_warn
#include "linux/smp.h"                               // for smp_send_stop
#include "linux/spinlock.h"                          // for spin_lock, spin_...
#include "linux/spinlock_types.h"                    // for DEFINE_SPINLOCK
#include "linux/stdarg.h"                            // for va_end, va_start
#include "linux/stddef.h"                            // for false, true
#include "linux/string.h"                            // for strsep
#include "linux/types.h"                             // for bool, ATOMIC_INIT
#include "vdso/time64.h"                             // for MSEC_PER_SEC
struct pt_regs;
---
  ./scripts/check-local-export kernel/panic.o
  iwyu2 -Wp,-MMD,kernel/.cpu.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/cpu"' -DKBUILD_BASENAME='"cpu"' -DKBUILD_MODNAME='"cpu"' -D__KBUILD_MODNAME=kmod_cpu -c -o kernel/cpu.o kernel/cpu.c  
In file included from kernel/cpu.c:26:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
1 warning generated.
In file included from kernel/cpu.c:26:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/cpu.c should add these lines:
#include <asm-generic/percpu.h>                // for per_cpu_ptr, DEFINE_PE...
#include <asm/bug.h>                           // for WARN_ON_ONCE, BUG_ON
#include <asm/percpu.h>                        // for this_cpu_write_8
#include <stddef.h>                            // for NULL
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm-generic/errno-base.h"            // for EINVAL, EAGAIN, EBUSY
#include "asm/cache.h"                         // for __read_mostly
#include "asm/percpu.h"                        // for __pcpu_cast_1, __pcpu_...
#include "asm/string_32.h"                     // for strcmp
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec, atomic_inc
#include "linux/bitops.h"                      // for BITS_TO_LONGS
#include "linux/cache.h"                       // for __ro_after_init
#include "linux/compiler_types.h"              // for inline
#include "linux/cpuhotplug.h"                  // for cpuhp_state, CPUHP_ONLINE
#include "linux/cpumask.h"                     // for cpumask_copy, cpumask
#include "linux/list.h"                        // for hlist_add_head, hlist_del
#include "linux/printk.h"                      // for pr_crit
#include "linux/stddef.h"                      // for false, true
#include "linux/threads.h"                     // for NR_CPUS
#include "linux/types.h"                       // for bool, hlist_node, DECL...

kernel/cpu.c should remove these lines:
- #include <linux/bug.h>  // lines 21-21
- #include <linux/cc_platform.h>  // lines 38-38
- #include <linux/cpuset.h>  // lines 36-36
- #include <linux/gfp.h>  // lines 25-25
- #include <linux/irq.h>  // lines 29-29
- #include <linux/kthread.h>  // lines 22-22
- #include <linux/lockdep.h>  // lines 27-27
- #include <linux/nmi.h>  // lines 30-30
- #include <linux/notifier.h>  // lines 10-10
- #include <linux/oom.h>  // lines 18-18
- #include <linux/percpu-rwsem.h>  // lines 35-35
- #include <linux/proc_fs.h>  // lines 7-7
- #include <linux/random.h>  // lines 37-37
- #include <linux/rcupdate.h>  // lines 19-19
- #include <linux/sched/isolation.h>  // lines 13-13
- #include <linux/sched/mm.h>  // lines 6-6
- #include <linux/sched/signal.h>  // lines 11-11
- #include <linux/sched/smt.h>  // lines 15-15
- #include <linux/sched/task.h>  // lines 14-14
- #include <linux/scs.h>  // lines 34-34
- #include <linux/slab.h>  // lines 33-33
- #include <linux/smpboot.h>  // lines 31-31
- #include <linux/stop_machine.h>  // lines 23-23
- #include <linux/suspend.h>  // lines 26-26
- #include <linux/tick.h>  // lines 28-28
- #include <linux/unistd.h>  // lines 16-16
- #include <trace/events/power.h>  // lines 40-40
- #include "smpboot.h"  // lines 44-44

The full include-list for kernel/cpu.c:
#include <asm-generic/percpu.h>                // for per_cpu_ptr, DEFINE_PE...
#include <asm/bug.h>                           // for WARN_ON_ONCE, BUG_ON
#include <asm/percpu.h>                        // for this_cpu_write_8
#include <linux/cpu.h>                         // for cpus_read_lock, cpus_r...
#include <linux/export.h>                      // for EXPORT_SYMBOL, EXPORT_...
#include <linux/init.h>                        // for __init, early_param
#include <linux/mutex.h>                       // for mutex_lock, mutex_unlock
#include <linux/smp.h>                         // for smp_processor_id
#include <stddef.h>                            // for NULL
#include <trace/events/cpuhp.h>                // for trace_cpuhp_exit, trac...
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm-generic/errno-base.h"            // for EINVAL, EAGAIN, EBUSY
#include "asm/cache.h"                         // for __read_mostly
#include "asm/percpu.h"                        // for __pcpu_cast_1, __pcpu_...
#include "asm/string_32.h"                     // for strcmp
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec, atomic_inc
#include "linux/bitops.h"                      // for BITS_TO_LONGS
#include "linux/cache.h"                       // for __ro_after_init
#include "linux/compiler_types.h"              // for inline
#include "linux/cpuhotplug.h"                  // for cpuhp_state, CPUHP_ONLINE
#include "linux/cpumask.h"                     // for cpumask_copy, cpumask
#include "linux/list.h"                        // for hlist_add_head, hlist_del
#include "linux/printk.h"                      // for pr_crit
#include "linux/stddef.h"                      // for false, true
#include "linux/threads.h"                     // for NR_CPUS
#include "linux/types.h"                       // for bool, hlist_node, DECL...
---
  ./scripts/check-local-export kernel/cpu.o
  iwyu2 -Wp,-MMD,kernel/.exit.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/exit"' -DKBUILD_BASENAME='"exit"' -DKBUILD_MODNAME='"exit"' -D__KBUILD_MODNAME=kmod_exit -c -o kernel/exit.o kernel/exit.c  
In file included from kernel/exit.c:21:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/exit.c:21:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/exit.c:21:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/exit.c:26:
./include/linux/tsacct_kern.h:13:13: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
                                 struct taskstats *stats, struct task_struct *tsk)
                                        ^
./include/linux/tsacct_kern.h:16:41: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline void xacct_add_tsk(struct taskstats *stats, struct task_struct *p)
                                        ^
In file included from kernel/exit.c:40:
./include/linux/delayacct.h:27:44: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline int delayacct_add_tsk(struct taskstats *d,
                                           ^
In file included from kernel/exit.c:41:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/exit.c:52:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from kernel/exit.c:55:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
9 warnings generated.
In file included from kernel/exit.c:21:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/exit.c:21:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/exit.c:21:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/exit.c:26:
./include/linux/tsacct_kern.h:13:13: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
                                 struct taskstats *stats, struct task_struct *tsk)
                                        ^
./include/linux/tsacct_kern.h:16:41: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline void xacct_add_tsk(struct taskstats *stats, struct task_struct *p)
                                        ^
In file included from kernel/exit.c:40:
./include/linux/delayacct.h:27:44: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline int delayacct_add_tsk(struct taskstats *d,
                                           ^
In file included from kernel/exit.c:41:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/exit.c:52:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from kernel/exit.c:55:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^

kernel/exit.c should add these lines:
#include <asm-generic/percpu.h>                // for __this_cpu_add, __this...
#include <asm/barrier.h>                       // for smp_mb
#include <asm/bug.h>                           // for BUG_ON, WARN_ON
#include <asm/percpu.h>                        // for raw_cpu_add_8
#include <asm/posix_types.h>                   // for __kernel_pid_t, __kern...
#include <asm/signal.h>                        // for SIGCONT, SIGHUP
#include <linux/preempt.h>                     // for preempt_count, preempt...
#include <linux/rcupdate.h>                    // for exit_rcu
#include <linux/spinlock.h>                    // for read_unlock, write_loc...
#include <sys/types.h>                         // for uid_t
#include <ctime>                               // for pid_t, NULL
#include "asm-generic/errno-base.h"            // for EINVAL, EFAULT, EAGAIN
#include "asm-generic/fcntl.h"                 // for O_NONBLOCK
#include "asm-generic/int-ll64.h"              // for u64
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "asm-generic/siginfo.h"               // for siginfo, siginfo::(ano...
#include "asm/bug.h"                           // for BUG
#include "asm/cmpxchg.h"                       // for __xchg_wrong_size
#include "asm/current.h"                       // for current
#include "asm/percpu.h"                        // for __pcpu_op1_1, __pcpu_o...
#include "asm/processor.h"                     // for release_thread
#include "asm/ptrace.h"                        // for pt_regs
#include "asm/thread_info.h"                   // for TIF_MEMDIE, TIF_SIGPEN...
#include "asm/uaccess.h"                       // for unsafe_put_user, put_user
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec_and_test
#include "linux/compiler.h"                    // for unlikely, likely
#include "linux/compiler_attributes.h"         // for __noreturn, __weak
#include "linux/compiler_types.h"              // for __user, __acquires
#include "linux/container_of.h"                // for container_of
#include "linux/cred.h"                        // for current_user_ns, cred
#include "linux/debug_locks.h"                 // for debug_check_no_locks_held
#include "linux/err.h"                         // for IS_ERR, PTR_ERR
#include "linux/errno.h"                       // for ERESTARTSYS
#include "linux/export.h"                      // for EXPORT_SYMBOL, EXPORT_...
#include "linux/irqflags.h"                    // for local_irq_disable, loc...
#include "linux/kernel.h"                      // for sched_annotate_sleep
#include "linux/list.h"                        // for list_del_init, list_add
#include "linux/lockdep.h"                     // for lockdep_free_task
#include "linux/minmax.h"                      // for max
#include "linux/mm_types_task.h"               // for page_frag
#include "linux/mmap_lock.h"                   // for mmap_read_lock, mmap_r...
#include "linux/panic.h"                       // for panic
#include "linux/pid.h"                         // for PIDTYPE_PGID, find_get...
#include "linux/preempt.h"                     // for in_atomic, in_interrupt
#include "linux/printk.h"                      // for pr_alert, pr_info
#include "linux/ptrace.h"                      // for PTRACE_EVENT_EXIT
#include "linux/rculist.h"                     // for list_del_rcu
#include "linux/rcupdate.h"                    // for rcu_read_lock, rcu_rea...
#include "linux/refcount.h"                    // for refcount_dec_and_test
#include "linux/resource.h"                    // for RUSAGE_BOTH, rusage
#include "linux/sched.h"                       // for task_struct, EXIT_DEAD
#include "linux/sched/jobctl.h"                // for JOBCTL_LISTENING
#include "linux/sched/signal.h"                // for signal_struct, thread_...
#include "linux/seccomp.h"                     // for seccomp_filter_release
#include "linux/sem.h"                         // for exit_sem
#include "linux/seqlock.h"                     // for write_seqlock, write_s...
#include "linux/spinlock.h"                    // for spin_unlock_irq, spin_...
#include "linux/stddef.h"                      // for true, false
#include "linux/thread_info.h"                 // for test_thread_flag
#include "linux/types.h"                       // for list_head, bool, rcu_head
#include "linux/uidgid.h"                      // for from_kuid_munged
#include "linux/user_namespace.h"              // for dec_rlimit_ucounts
#include "linux/wait.h"                        // for WEXITED, WCONTINUED
#include "vdso/limits.h"                       // for INT_MIN

kernel/exit.c should remove these lines:
- #include <linux/binfmts.h>  // lines 30-30
- #include <linux/blkdev.h>  // lines 52-52
- #include <linux/capability.h>  // lines 18-18
- #include <linux/compat.h>  // lines 65-65
- #include <linux/cpu.h>  // lines 24-24
- #include <linux/delayacct.h>  // lines 40-40
- #include <linux/fdtable.h>  // lines 28-28
- #include <linux/file.h>  // lines 27-27
- #include <linux/init_task.h>  // lines 55-55
- #include <linux/interrupt.h>  // lines 16-16
- #include <linux/key.h>  // lines 23-23
- #include <linux/kthread.h>  // lines 37-37
- #include <linux/module.h>  // lines 17-17
- #include <linux/mount.h>  // lines 35-35
- #include <linux/mutex.h>  // lines 46-46
- #include <linux/personality.h>  // lines 20-20
- #include <linux/posix-timers.h>  // lines 44-44
- #include <linux/profile.h>  // lines 34-34
- #include <linux/slab.h>  // lines 9-9

The full include-list for kernel/exit.c:
#include <asm-generic/percpu.h>                // for __this_cpu_add, __this...
#include <asm/barrier.h>                       // for smp_mb
#include <asm/bug.h>                           // for BUG_ON, WARN_ON
#include <asm/mmu_context.h>                   // for enter_lazy_tlb
#include <asm/percpu.h>                        // for raw_cpu_add_8
#include <asm/posix_types.h>                   // for __kernel_pid_t, __kern...
#include <asm/signal.h>                        // for SIGCONT, SIGHUP
#include <asm/unistd.h>                        // for __ARCH_WANT_SYS_WAITPID
#include <linux/acct.h>                        // for acct_collect, acct_pro...
#include <linux/audit.h>                       // for audit_free
#include <linux/cgroup.h>                      // for cgroup_exit, cgroup_re...
#include <linux/cn_proc.h>                     // for proc_exit_connector
#include <linux/completion.h>                  // for complete
#include <linux/freezer.h>                     // for freezable_schedule
#include <linux/fs_struct.h>                   // for exit_fs
#include <linux/futex.h>                       // for futex_exit_recursive
#include <linux/hw_breakpoint.h>               // for flush_ptrace_hw_breakp...
#include <linux/io_uring.h>                    // for io_uring_files_cancel
#include <linux/iocontext.h>                   // for exit_io_context
#include <linux/kcov.h>                        // for kcov_task_exit
#include <linux/kprobes.h>                     // for kprobe_flush_task
#include <linux/mempolicy.h>                   // for mpol_put_task_policy
#include <linux/mm.h>                          // for sync_mm_rss, put_page
#include <linux/nsproxy.h>                     // for exit_task_namespaces
#include <linux/oom.h>                         // for exit_oom_victim
#include <linux/perf_event.h>                  // for perf_event_delayed_put
#include <linux/pid_namespace.h>               // for task_active_pid_ns
#include <linux/pipe_fs_i.h>                   // for free_pipe_info
#include <linux/preempt.h>                     // for preempt_count, preempt...
#include <linux/proc_fs.h>                     // for proc_flush_pid
#include <linux/ptrace.h>                      // for ptrace_reparented, exi...
#include <linux/random.h>                      // for add_device_randomness
#include <linux/rcupdate.h>                    // for exit_rcu
#include <linux/rcuwait.h>                     // for rcuwait, rcuwait_wake_up
#include <linux/resource.h>                    // for getrusage
#include <linux/rethook.h>                     // for rethook_flush_task
#include <linux/sched/autogroup.h>             // for sched_autogroup_exit_task
#include <linux/sched/cputime.h>               // for task_gtime, task_cputime
#include <linux/sched/mm.h>                    // for exit_mm_release, memba...
#include <linux/sched/stat.h>                  // for process_counts, nr_thr...
#include <linux/sched/task.h>                  // for tasklist_lock, put_tas...
#include <linux/sched/task_stack.h>            // for exit_task_stack_account
#include <linux/shm.h>                         // for exit_shm
#include <linux/signal.h>                      // for flush_sigqueue, SIGCHLD
#include <linux/spinlock.h>                    // for read_unlock, write_loc...
#include <linux/syscalls.h>                    // for __MAP1, __MAP3, __MAP4
#include <linux/task_io_accounting_ops.h>      // for task_io_accounting_add
#include <linux/task_work.h>                   // for exit_task_work
#include <linux/taskstats_kern.h>              // for taskstats_exit
#include <linux/tsacct_kern.h>                 // for acct_update_integrals
#include <linux/tty.h>                         // for disassociate_ctty, tty...
#include <linux/uaccess.h>                     // for copy_to_user, user_wri...
#include <linux/writeback.h>                   // for dirty_throttle_leaks
#include <sys/types.h>                         // for uid_t
#include <trace/events/sched.h>                // for trace_sched_process_exit
#include <ctime>                               // for pid_t, NULL
#include "asm-generic/errno-base.h"            // for EINVAL, EFAULT, EAGAIN
#include "asm-generic/fcntl.h"                 // for O_NONBLOCK
#include "asm-generic/int-ll64.h"              // for u64
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "asm-generic/siginfo.h"               // for siginfo, siginfo::(ano...
#include "asm/bug.h"                           // for BUG
#include "asm/cmpxchg.h"                       // for __xchg_wrong_size
#include "asm/current.h"                       // for current
#include "asm/percpu.h"                        // for __pcpu_op1_1, __pcpu_o...
#include "asm/processor.h"                     // for release_thread
#include "asm/ptrace.h"                        // for pt_regs
#include "asm/thread_info.h"                   // for TIF_MEMDIE, TIF_SIGPEN...
#include "asm/uaccess.h"                       // for unsafe_put_user, put_user
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec_and_test
#include "linux/compiler.h"                    // for unlikely, likely
#include "linux/compiler_attributes.h"         // for __noreturn, __weak
#include "linux/compiler_types.h"              // for __user, __acquires
#include "linux/container_of.h"                // for container_of
#include "linux/cred.h"                        // for current_user_ns, cred
#include "linux/debug_locks.h"                 // for debug_check_no_locks_held
#include "linux/err.h"                         // for IS_ERR, PTR_ERR
#include "linux/errno.h"                       // for ERESTARTSYS
#include "linux/export.h"                      // for EXPORT_SYMBOL, EXPORT_...
#include "linux/irqflags.h"                    // for local_irq_disable, loc...
#include "linux/kernel.h"                      // for sched_annotate_sleep
#include "linux/list.h"                        // for list_del_init, list_add
#include "linux/lockdep.h"                     // for lockdep_free_task
#include "linux/minmax.h"                      // for max
#include "linux/mm_types_task.h"               // for page_frag
#include "linux/mmap_lock.h"                   // for mmap_read_lock, mmap_r...
#include "linux/panic.h"                       // for panic
#include "linux/pid.h"                         // for PIDTYPE_PGID, find_get...
#include "linux/preempt.h"                     // for in_atomic, in_interrupt
#include "linux/printk.h"                      // for pr_alert, pr_info
#include "linux/ptrace.h"                      // for PTRACE_EVENT_EXIT
#include "linux/rculist.h"                     // for list_del_rcu
#include "linux/rcupdate.h"                    // for rcu_read_lock, rcu_rea...
#include "linux/refcount.h"                    // for refcount_dec_and_test
#include "linux/resource.h"                    // for RUSAGE_BOTH, rusage
#include "linux/sched.h"                       // for task_struct, EXIT_DEAD
#include "linux/sched/jobctl.h"                // for JOBCTL_LISTENING
#include "linux/sched/signal.h"                // for signal_struct, thread_...
#include "linux/seccomp.h"                     // for seccomp_filter_release
#include "linux/sem.h"                         // for exit_sem
#include "linux/seqlock.h"                     // for write_seqlock, write_s...
#include "linux/spinlock.h"                    // for spin_unlock_irq, spin_...
#include "linux/stddef.h"                      // for true, false
#include "linux/thread_info.h"                 // for test_thread_flag
#include "linux/types.h"                       // for list_head, bool, rcu_head
#include "linux/uidgid.h"                      // for from_kuid_munged
#include "linux/user_namespace.h"              // for dec_rlimit_ucounts
#include "linux/wait.h"                        // for WEXITED, WCONTINUED
#include "vdso/limits.h"                       // for INT_MIN
---
  ./scripts/check-local-export kernel/exit.o
  iwyu2 -Wp,-MMD,kernel/.softirq.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/softirq"' -DKBUILD_BASENAME='"softirq"' -DKBUILD_MODNAME='"softirq"' -D__KBUILD_MODNAME=kmod_softirq -c -o kernel/softirq.o kernel/softirq.c  
In file included from kernel/softirq.c:20:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/softirq.c:20:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/softirq.c:20:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/softirq.c:20:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/softirq.c:20:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/softirq.c:20:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/softirq.c should add these lines:
#include <asm-generic/percpu.h>                      // for __this_cpu_read
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON_ONCE
#include <asm/percpu.h>                              // for raw_cpu_read_8
#include <linux/bitops.h>                            // for ffs
#include <linux/linkage.h>                           // for asmlinkage
#include <linux/preempt.h>                           // for preempt_count
#include <stddef.h>                                  // for NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for test_and_clear_bit
#include "asm-generic/int-ll64.h"                    // for __u32
#include "asm-generic/softirq_stack.h"               // for do_softirq_own_s...
#include "asm/current.h"                             // for current
#include "asm/hardirq.h"                             // for __ARCH_IRQ_STAT
#include "asm/irq_vectors.h"                         // for NR_IRQS_LEGACY
#include "asm/percpu.h"                              // for __pcpu_op2_1
#include "linux/atomic/atomic-instrumented.h"        // for atomic_set, atom...
#include "linux/bottom_half.h"                       // for __local_bh_disab...
#include "linux/cache.h"                             // for __cacheline_alig...
#include "linux/compiler.h"                          // for unlikely
#include "linux/compiler_attributes.h"               // for __weak, __visible
#include "linux/compiler_types.h"                    // for inline, __latent...
#include "linux/cpuhotplug.h"                        // for cpuhp_setup_stat...
#include "linux/cpumask.h"                           // for for_each_possibl...
#include "linux/hardirq.h"                           // for __irq_enter_raw
#include "linux/instruction_pointer.h"               // for _RET_IP_
#include "linux/irqflags.h"                          // for lockdep_softirqs_on
#include "linux/jiffies.h"                           // for jiffies, msecs_t...
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/lockdep.h"                           // for lockdep_assert_i...
#include "linux/preempt.h"                           // for in_interrupt
#include "linux/printk.h"                            // for pr_err, pr_notice
#include "linux/sched.h"                             // for current_restore_...
#include "linux/stddef.h"                            // for false, true
#include "linux/types.h"                             // for bool
#include "linux/vtime.h"                             // for account_hardirq_...

kernel/softirq.c should remove these lines:
- #include <asm/softirq_stack.h>  // lines 31-31
- #include <linux/cpu.h>  // lines 20-20
- #include <linux/freezer.h>  // lines 21-21
- #include <linux/local_lock.h>  // lines 16-16
- #include <linux/mm.h>  // lines 17-17
- #include <linux/notifier.h>  // lines 18-18
- #include <linux/percpu.h>  // lines 19-19

The full include-list for kernel/softirq.c:
#include <asm-generic/percpu.h>                      // for __this_cpu_read
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON_ONCE
#include <asm/percpu.h>                              // for raw_cpu_read_8
#include <linux/bitops.h>                            // for ffs
#include <linux/export.h>                            // for EXPORT_SYMBOL
#include <linux/ftrace.h>                            // for trace_preempt_on
#include <linux/init.h>                              // for __init, early_in...
#include <linux/interrupt.h>                         // for tasklet_struct
#include <linux/irq.h>                               // for arch_dynirq_lowe...
#include <linux/kernel_stat.h>                       // for kstat_incr_softi...
#include <linux/kthread.h>                           // for __kthread_should...
#include <linux/linkage.h>                           // for asmlinkage
#include <linux/preempt.h>                           // for preempt_count
#include <linux/rcupdate.h>                          // for rcu_irq_enter
#include <linux/smp.h>                               // for smp_processor_id
#include <linux/smpboot.h>                           // for smpboot_register...
#include <linux/tick.h>                              // for tick_irq_enter
#include <linux/wait_bit.h>                          // for wake_up_var, wai...
#include <stddef.h>                                  // for NULL
#include <trace/events/irq.h>                        // for trace_softirq_entry
#include "asm-generic/bitops/instrumented-atomic.h"  // for test_and_clear_bit
#include "asm-generic/int-ll64.h"                    // for __u32
#include "asm-generic/softirq_stack.h"               // for do_softirq_own_s...
#include "asm/current.h"                             // for current
#include "asm/hardirq.h"                             // for __ARCH_IRQ_STAT
#include "asm/irq_vectors.h"                         // for NR_IRQS_LEGACY
#include "asm/percpu.h"                              // for __pcpu_op2_1
#include "linux/atomic/atomic-instrumented.h"        // for atomic_set, atom...
#include "linux/bottom_half.h"                       // for __local_bh_disab...
#include "linux/cache.h"                             // for __cacheline_alig...
#include "linux/compiler.h"                          // for unlikely
#include "linux/compiler_attributes.h"               // for __weak, __visible
#include "linux/compiler_types.h"                    // for inline, __latent...
#include "linux/cpuhotplug.h"                        // for cpuhp_setup_stat...
#include "linux/cpumask.h"                           // for for_each_possibl...
#include "linux/hardirq.h"                           // for __irq_enter_raw
#include "linux/instruction_pointer.h"               // for _RET_IP_
#include "linux/irqflags.h"                          // for lockdep_softirqs_on
#include "linux/jiffies.h"                           // for jiffies, msecs_t...
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/lockdep.h"                           // for lockdep_assert_i...
#include "linux/preempt.h"                           // for in_interrupt
#include "linux/printk.h"                            // for pr_err, pr_notice
#include "linux/sched.h"                             // for current_restore_...
#include "linux/stddef.h"                            // for false, true
#include "linux/types.h"                             // for bool
#include "linux/vtime.h"                             // for account_hardirq_...
---
  ./scripts/check-local-export kernel/softirq.o
  iwyu2 -Wp,-MMD,kernel/.resource.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/resource"' -DKBUILD_BASENAME='"resource"' -DKBUILD_MODNAME='"resource"' -D__KBUILD_MODNAME=kmod_resource -c -o kernel/resource.o kernel/resource.c  
In file included from kernel/resource.c:24:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/resource.c:24:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/resource.c:24:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/resource.c:24:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/resource.c:24:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/resource.c:24:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/resource.c should add these lines:
#include <asm/barrier.h>                // for smp_load_acquire, smp_store_r...
#include <asm/bug.h>                    // for WARN_ON, BUG_ON
#include <linux/spinlock_types.h>       // for DEFINE_RWLOCK
#include <stddef.h>                     // for NULL, size_t
#include "asm-generic/errno-base.h"     // for EBUSY, EINVAL, ENOMEM, ENODEV
#include "asm-generic/int-ll64.h"       // for u64
#include "asm/current.h"                // for current
#include "asm/page_types.h"             // for PAGE_SHIFT, PAGE_MASK, PAGE_SIZE
#include "asm/string_32.h"              // for strstr
#include "linux/align.h"                // for ALIGN
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/dev_printk.h"           // for dev_err
#include "linux/err.h"                  // for IS_ERR, PTR_ERR
#include "linux/gfp.h"                  // for GFP_KERNEL, GFP_ATOMIC
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_WARNING, KERN_DEBUG
#include "linux/kernel.h"               // for get_option
#include "linux/list.h"                 // for INIT_LIST_HEAD, list_for_each...
#include "linux/minmax.h"               // for max, min
#include "linux/printk.h"               // for pr_err, printk, dump_stack
#include "linux/stddef.h"               // for true, false
#include "linux/types.h"                // for resource_size_t, list_head, bool
#include "linux/wait.h"                 // for wait_queue_head, add_wait_queue
struct fs_context;
struct seq_file;

kernel/resource.c should remove these lines:
- #include <linux/errno.h>  // lines 14-14
- #include <linux/proc_fs.h>  // lines 20-20
- #include <linux/seq_file.h>  // lines 23-23

The full include-list for kernel/resource.c:
#include <asm/barrier.h>                // for smp_load_acquire, smp_store_r...
#include <asm/bug.h>                    // for WARN_ON, BUG_ON
#include <asm/io.h>                     // for IO_SPACE_LIMIT
#include <linux/device.h>               // for devres_add, devres_free, devr...
#include <linux/export.h>               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/fs.h>                   // for kill_anon_super, alloc_anon_i...
#include <linux/init.h>                 // for __init, __setup, fs_initcall
#include <linux/ioport.h>               // for resource, IORESOURCE_BUSY
#include <linux/mm.h>                   // for PageSlab, virt_to_head_page
#include <linux/mount.h>                // for vfsmount
#include <linux/pfn.h>                  // for PFN_DOWN, PFN_UP
#include <linux/pseudo_fs.h>            // for init_pseudo
#include <linux/resource_ext.h>         // for resource_entry, resource_list...
#include <linux/sched.h>                // for task_struct, schedule, TASK_U...
#include <linux/slab.h>                 // for kzalloc, kfree
#include <linux/spinlock.h>             // for write_unlock, write_lock, rea...
#include <linux/spinlock_types.h>       // for DEFINE_RWLOCK
#include <stddef.h>                     // for NULL, size_t
#include <uapi/linux/magic.h>           // for DEVMEM_MAGIC
#include "asm-generic/errno-base.h"     // for EBUSY, EINVAL, ENOMEM, ENODEV
#include "asm-generic/int-ll64.h"       // for u64
#include "asm/current.h"                // for current
#include "asm/page_types.h"             // for PAGE_SHIFT, PAGE_MASK, PAGE_SIZE
#include "asm/string_32.h"              // for strstr
#include "linux/align.h"                // for ALIGN
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/dev_printk.h"           // for dev_err
#include "linux/err.h"                  // for IS_ERR, PTR_ERR
#include "linux/gfp.h"                  // for GFP_KERNEL, GFP_ATOMIC
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_WARNING, KERN_DEBUG
#include "linux/kernel.h"               // for get_option
#include "linux/list.h"                 // for INIT_LIST_HEAD, list_for_each...
#include "linux/minmax.h"               // for max, min
#include "linux/printk.h"               // for pr_err, printk, dump_stack
#include "linux/stddef.h"               // for true, false
#include "linux/types.h"                // for resource_size_t, list_head, bool
#include "linux/wait.h"                 // for wait_queue_head, add_wait_queue
struct fs_context;
struct seq_file;
---
  ./scripts/check-local-export kernel/resource.o
  iwyu2 -Wp,-MMD,kernel/.sysctl.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/sysctl"' -DKBUILD_BASENAME='"sysctl"' -DKBUILD_MODNAME='"sysctl"' -D__KBUILD_MODNAME=kmod_sysctl -c -o kernel/sysctl.o kernel/sysctl.c  
In file included from kernel/sysctl.c:24:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/sysctl.c:24:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/sysctl.c:24:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/sysctl.c:24:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/sysctl.c:35:
In file included from ./include/linux/filter.h:12:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from kernel/sysctl.c:35:
In file included from ./include/linux/filter.h:20:
In file included from ./include/linux/if_vlan.h:10:
./include/linux/netdevice.h:1243:17: warning: declaration of 'struct rtnl_link_stats64' will not be visible outside of this function [-Wvisibility]
                                                   struct rtnl_link_stats64 *storage);
                                                          ^
./include/linux/netdevice.h:1268:19: warning: declaration of 'struct ifla_vf_info' will not be visible outside of this function [-Wvisibility]
                                                     struct ifla_vf_info *ivf);
                                                            ^
./include/linux/netdevice.h:1273:18: warning: declaration of 'struct ifla_vf_stats' will not be visible outside of this function [-Wvisibility]
                                                    struct ifla_vf_stats
                                                           ^
./include/linux/netdevice.h:1282:17: warning: declaration of 'struct ifla_vf_guid' will not be visible outside of this function [-Wvisibility]
                                                   struct ifla_vf_guid *node_guid,
                                                          ^
In file included from kernel/sysctl.c:54:
In file included from ./include/linux/nfs_fs.h:28:
./include/linux/sunrpc/auth.h:132:18: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                             struct xdr_stream *xdr);
                                                    ^
./include/linux/sunrpc/auth.h:135:19: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                              struct xdr_stream *xdr);
                                                     ^
./include/linux/sunrpc/auth.h:137:19: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                              struct xdr_stream *xdr);
                                                     ^
./include/linux/sunrpc/auth.h:139:15: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                                 struct xdr_stream *xdr);
                                                        ^
./include/linux/sunrpc/auth.h:167:15: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                          struct xdr_stream *xdr);
                                                 ^
./include/linux/sunrpc/auth.h:169:15: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                          struct xdr_stream *xdr);
                                                 ^
./include/linux/sunrpc/auth.h:171:14: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                                struct xdr_stream *xdr);
                                                       ^
./include/linux/sunrpc/auth.h:173:14: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                         struct xdr_stream *xdr);
                                                ^
./include/linux/sunrpc/auth.h:175:17: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                                   struct xdr_stream *xdr);
                                                          ^
./include/linux/sunrpc/auth.h:177:17: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                            struct xdr_stream *xdr);
                                                   ^
In file included from kernel/sysctl.c:55:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
23 warnings generated.
In file included from kernel/sysctl.c:24:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/sysctl.c:24:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/sysctl.c:24:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/sysctl.c:24:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/sysctl.c:35:
In file included from ./include/linux/filter.h:12:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from kernel/sysctl.c:35:
In file included from ./include/linux/filter.h:20:
In file included from ./include/linux/if_vlan.h:10:
./include/linux/netdevice.h:1243:17: warning: declaration of 'struct rtnl_link_stats64' will not be visible outside of this function [-Wvisibility]
                                                   struct rtnl_link_stats64 *storage);
                                                          ^
./include/linux/netdevice.h:1268:19: warning: declaration of 'struct ifla_vf_info' will not be visible outside of this function [-Wvisibility]
                                                     struct ifla_vf_info *ivf);
                                                            ^
./include/linux/netdevice.h:1273:18: warning: declaration of 'struct ifla_vf_stats' will not be visible outside of this function [-Wvisibility]
                                                    struct ifla_vf_stats
                                                           ^
./include/linux/netdevice.h:1282:17: warning: declaration of 'struct ifla_vf_guid' will not be visible outside of this function [-Wvisibility]
                                                   struct ifla_vf_guid *node_guid,
                                                          ^
In file included from kernel/sysctl.c:54:
In file included from ./include/linux/nfs_fs.h:28:
./include/linux/sunrpc/auth.h:132:18: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                             struct xdr_stream *xdr);
                                                    ^
./include/linux/sunrpc/auth.h:135:19: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                              struct xdr_stream *xdr);
                                                     ^
./include/linux/sunrpc/auth.h:137:19: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                              struct xdr_stream *xdr);
                                                     ^
./include/linux/sunrpc/auth.h:139:15: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                                 struct xdr_stream *xdr);
                                                        ^
./include/linux/sunrpc/auth.h:167:15: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                          struct xdr_stream *xdr);
                                                 ^
./include/linux/sunrpc/auth.h:169:15: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                          struct xdr_stream *xdr);
                                                 ^
./include/linux/sunrpc/auth.h:171:14: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                                struct xdr_stream *xdr);
                                                       ^
./include/linux/sunrpc/auth.h:173:14: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                         struct xdr_stream *xdr);
                                                ^
./include/linux/sunrpc/auth.h:175:17: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                                   struct xdr_stream *xdr);
                                                          ^
./include/linux/sunrpc/auth.h:177:17: warning: declaration of 'struct xdr_stream' will not be visible outside of this function [-Wvisibility]
                                            struct xdr_stream *xdr);
                                                   ^
In file included from kernel/sysctl.c:55:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^

kernel/sysctl.c should add these lines:
#include <stddef.h>             // for size_t
#include "asm-generic/errno.h"  // for ENOSYS
#include "linux/export.h"       // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/types.h"        // for loff_t

kernel/sysctl.c should remove these lines:
- #include <asm/io.h>  // lines 75-75
- #include <asm/nmi.h>  // lines 73-73
- #include <asm/processor.h>  // lines 71-71
- #include <asm/stacktrace.h>  // lines 74-74
- #include <linux/acpi.h>  // lines 55-55
- #include <linux/binfmts.h>  // lines 62-62
- #include <linux/bitmap.h>  // lines 27-27
- #include <linux/capability.h>  // lines 61-61
- #include <linux/compaction.h>  // lines 45-45
- #include <linux/ctype.h>  // lines 33-33
- #include <linux/dcache.h>  // lines 51-51
- #include <linux/filter.h>  // lines 35-35
- #include <linux/fs.h>  // lines 36-36
- #include <linux/ftrace.h>  // lines 57-57
- #include <linux/highuid.h>  // lines 42-42
- #include <linux/hugetlb.h>  // lines 46-46
- #include <linux/init.h>  // lines 37-37
- #include <linux/initrd.h>  // lines 47-47
- #include <linux/kernel.h>  // lines 38-38
- #include <linux/key.h>  // lines 48-48
- #include <linux/kmemleak.h>  // lines 34-34
- #include <linux/kmod.h>  // lines 60-60
- #include <linux/kobject.h>  // lines 39-39
- #include <linux/limits.h>  // lines 50-50
- #include <linux/mm.h>  // lines 23-23
- #include <linux/module.h>  // lines 22-22
- #include <linux/mount.h>  // lines 64-64
- #include <linux/net.h>  // lines 40-40
- #include <linux/nfs_fs.h>  // lines 54-54
- #include <linux/oom.h>  // lines 59-59
- #include <linux/panic.h>  // lines 29-29
- #include <linux/perf_event.h>  // lines 58-58
- #include <linux/pid.h>  // lines 66-66
- #include <linux/printk.h>  // lines 30-30
- #include <linux/proc_fs.h>  // lines 31-31
- #include <linux/ratelimit.h>  // lines 44-44
- #include <linux/reboot.h>  // lines 56-56
- #include <linux/sched/sysctl.h>  // lines 63-63
- #include <linux/security.h>  // lines 32-32
- #include <linux/signal.h>  // lines 28-28
- #include <linux/slab.h>  // lines 25-25
- #include <linux/swap.h>  // lines 24-24
- #include <linux/syscalls.h>  // lines 52-52
- #include <linux/times.h>  // lines 49-49
- #include <linux/uaccess.h>  // lines 70-70
- #include <linux/userfaultfd_k.h>  // lines 65-65
- #include <linux/vmstat.h>  // lines 53-53
- #include <linux/writeback.h>  // lines 43-43
- #include "../lib/kstrtox.h"  // lines 68-68

The full include-list for kernel/sysctl.c:
#include <linux/sysctl.h>       // for proc_do_large_bitmap, proc_dobool
#include <stddef.h>             // for size_t
#include "asm-generic/errno.h"  // for ENOSYS
#include "linux/export.h"       // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/types.h"        // for loff_t
---
  ./scripts/check-local-export kernel/sysctl.o
  iwyu2 -Wp,-MMD,kernel/.capability.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/capability"' -DKBUILD_BASENAME='"capability"' -DKBUILD_MODNAME='"capability"' -D__KBUILD_MODNAME=kmod_capability -c -o kernel/capability.o kernel/capability.c  
In file included from kernel/capability.c:13:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^
In file included from kernel/capability.c:18:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/capability.c:18:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/capability.c:18:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/capability.c:18:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
5 warnings generated.
In file included from kernel/capability.c:13:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^
In file included from kernel/capability.c:18:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/capability.c:18:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/capability.c:18:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/capability.c:18:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/capability.c should add these lines:
#include <asm/bug.h>           // for WARN_ON_ONCE
#include "linux/capability.h"  // for CAP_SYS_PTRACE, cap_valid
#include "linux/cred.h"        // for cred (ptr only), current_user_ns
#include "linux/fs.h"          // for i_gid_into_mnt, i_uid_into_mnt, inode ...
#include "linux/init.h"        // for __init, __setup
#include "linux/rcupdate.h"    // for rcu_read_lock, rcu_read_unlock, rcu_de...
#include "linux/sched.h"       // for task_struct
#include "linux/stddef.h"      // for false, true
#include "linux/types.h"       // for bool
#include "linux/uidgid.h"      // for kgid_has_mapping, kuid_has_mapping
struct user_namespace;

kernel/capability.c should remove these lines:
- #include <linux/audit.h>  // lines 13-13
- #include <linux/mm.h>  // lines 15-15
- #include <linux/pid_namespace.h>  // lines 19-19
- #include <linux/syscalls.h>  // lines 18-18
- #include <linux/uaccess.h>  // lines 21-21
- #include <linux/user_namespace.h>  // lines 20-20

The full include-list for kernel/capability.c:
#include <asm/bug.h>           // for WARN_ON_ONCE
#include <linux/capability.h>  // for ns_capable, CAP_EMPTY_SET, capable_wrt...
#include <linux/export.h>      // for EXPORT_SYMBOL
#include <linux/security.h>    // for security_capable, CAP_OPT_NOAUDIT, CAP...
#include "linux/capability.h"  // for CAP_SYS_PTRACE, cap_valid
#include "linux/cred.h"        // for cred (ptr only), current_user_ns
#include "linux/fs.h"          // for i_gid_into_mnt, i_uid_into_mnt, inode ...
#include "linux/init.h"        // for __init, __setup
#include "linux/rcupdate.h"    // for rcu_read_lock, rcu_read_unlock, rcu_de...
#include "linux/sched.h"       // for task_struct
#include "linux/stddef.h"      // for false, true
#include "linux/types.h"       // for bool
#include "linux/uidgid.h"      // for kgid_has_mapping, kuid_has_mapping
struct user_namespace;
---
  ./scripts/check-local-export kernel/capability.o
  iwyu2 -Wp,-MMD,kernel/.ptrace.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/ptrace"' -DKBUILD_BASENAME='"ptrace"' -DKBUILD_MODNAME='"ptrace"' -D__KBUILD_MODNAME=kmod_ptrace -c -o kernel/ptrace.o kernel/ptrace.c  
In file included from kernel/ptrace.c:27:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/ptrace.c:27:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/ptrace.c:27:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/ptrace.c:27:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from kernel/ptrace.c:27:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/ptrace.c:27:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/ptrace.c:27:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/ptrace.c:27:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/ptrace.c should add these lines:
#include <asm/barrier.h>              // for smp_rmb
#include <asm/bug.h>                  // for BUG_ON, WARN, WARN_ON, WARN_ON_...
#include <asm/posix_types.h>          // for __kernel_size_t
#include <asm/signal.h>               // for SIGKILL, SIGSTOP, SIGTRAP
#include <linux/build_bug.h>          // for unlikely, likely
#include <linux/spinlock.h>           // for write_lock_irq, write_unlock_irq
#include <signal.h>                   // for sigset_t, siginfo_t
#include <stddef.h>                   // for NULL
#include "asm-generic/errno-base.h"   // for EIO, EFAULT, EINVAL, EPERM, ESRCH
#include "asm-generic/int-ll64.h"     // for __u32, __u64, __u8
#include "asm-generic/signal-defs.h"  // for SA_NOCLDWAIT, SIG_IGN
#include "asm/current.h"              // for current
#include "asm/processor.h"            // for task_pt_regs
#include "asm/ptrace-abi.h"           // for PTRACE_SINGLEBLOCK, PTRACE_SYSEMU
#include "asm/ptrace.h"               // for instruction_pointer, user_stack...
#include "asm/thread_info.h"          // for thread_info
#include "asm/uaccess.h"              // for __get_user, put_user, __put_user
#include "linux/capability.h"         // for CAP_SYS_PTRACE, CAP_SYS_ADMIN
#include "linux/compiler_types.h"     // for __user
#include "linux/cred.h"               // for cred, get_cred, put_cred, curre...
#include "linux/kconfig.h"            // for IS_ENABLED
#include "linux/kernel.h"             // for ARRAY_SIZE
#include "linux/list.h"               // for list_add, list_del_init, list_e...
#include "linux/mm_types.h"           // for mm_struct, mm_struct::(anonymous)
#include "linux/mutex.h"              // for mutex_lock_interruptible, mutex...
#include "linux/ptrace.h"             // for ptrace_syscall_info, ptrace_sys...
#include "linux/rcupdate.h"           // for rcu_read_unlock, rcu_read_lock
#include "linux/sched/jobctl.h"       // for task_set_jobctl_pending, JOBCTL...
#include "linux/seccomp.h"            // for seccomp_get_filter, seccomp_get...
#include "linux/signal_types.h"       // for kernel_siginfo_t, sigqueue, k_s...
#include "linux/spinlock.h"           // for spin_lock_irq, spin_unlock_irq
#include "linux/stddef.h"             // for true, false, offsetofend, offsetof
#include "linux/thread_info.h"        // for clear_task_syscall_work, SYSCAL...
#include "linux/types.h"              // for bool, list_head
#include "linux/uidgid.h"             // for gid_eq, uid_eq, kgid_t, kuid_t
#include "linux/uio.h"                // for iovec
#include "linux/wait_bit.h"           // for wait_on_bit
#include "vdso/limits.h"              // for ULONG_MAX
struct user_namespace;

kernel/ptrace.c should remove these lines:
- #include <linux/compat.h>  // lines 32-32
- #include <linux/highmem.h>  // lines 19-19
- #include <linux/hw_breakpoint.h>  // lines 30-30
- #include <linux/pagemap.h>  // lines 20-20
- #include <linux/pid_namespace.h>  // lines 26-26
- #include <linux/uio.h>  // lines 24-24

The full include-list for kernel/ptrace.c:
#include <asm/barrier.h>              // for smp_rmb
#include <asm/bug.h>                  // for BUG_ON, WARN, WARN_ON, WARN_ON_...
#include <asm/posix_types.h>          // for __kernel_size_t
#include <asm/signal.h>               // for SIGKILL, SIGSTOP, SIGTRAP
#include <asm/syscall.h>              // for syscall_get_arch, syscall_get_a...
#include <linux/audit.h>              // for audit_ptrace
#include <linux/build_bug.h>          // for unlikely, likely
#include <linux/capability.h>         // for capable, ns_capable, ns_capable...
#include <linux/cn_proc.h>            // for proc_ptrace_connector
#include <linux/errno.h>              // for ERESTARTNOINTR
#include <linux/export.h>             // for EXPORT_SYMBOL_GPL
#include <linux/minmax.h>             // for min
#include <linux/mm.h>                 // for FOLL_FORCE, __access_remote_vm
#include <linux/ptrace.h>             // for PT_OPT_FLAG_SHIFT, PT_PTRACED
#include <linux/regset.h>             // for user_regset, copy_regset_from_user
#include <linux/sched.h>              // for task_struct, wake_up_state, __T...
#include <linux/sched/coredump.h>     // for get_dumpable, SUID_DUMP_USER
#include <linux/sched/mm.h>           // for mmput, get_task_mm
#include <linux/sched/signal.h>       // for sighand_struct, lock_task_sighand
#include <linux/sched/task.h>         // for tasklist_lock, task_lock, task_...
#include <linux/security.h>           // for security_ptrace_access_check
#include <linux/signal.h>             // for copy_siginfo, copy_siginfo_to_user
#include <linux/spinlock.h>           // for write_lock_irq, write_unlock_irq
#include <linux/syscalls.h>           // for __MAP4, SYSCALL_DEFINE4
#include <linux/uaccess.h>            // for copy_from_user, copy_to_user
#include <signal.h>                   // for sigset_t, siginfo_t
#include <stddef.h>                   // for NULL
#include "asm-generic/errno-base.h"   // for EIO, EFAULT, EINVAL, EPERM, ESRCH
#include "asm-generic/int-ll64.h"     // for __u32, __u64, __u8
#include "asm-generic/signal-defs.h"  // for SA_NOCLDWAIT, SIG_IGN
#include "asm/current.h"              // for current
#include "asm/processor.h"            // for task_pt_regs
#include "asm/ptrace-abi.h"           // for PTRACE_SINGLEBLOCK, PTRACE_SYSEMU
#include "asm/ptrace.h"               // for instruction_pointer, user_stack...
#include "asm/thread_info.h"          // for thread_info
#include "asm/uaccess.h"              // for __get_user, put_user, __put_user
#include "linux/capability.h"         // for CAP_SYS_PTRACE, CAP_SYS_ADMIN
#include "linux/compiler_types.h"     // for __user
#include "linux/cred.h"               // for cred, get_cred, put_cred, curre...
#include "linux/kconfig.h"            // for IS_ENABLED
#include "linux/kernel.h"             // for ARRAY_SIZE
#include "linux/list.h"               // for list_add, list_del_init, list_e...
#include "linux/mm_types.h"           // for mm_struct, mm_struct::(anonymous)
#include "linux/mutex.h"              // for mutex_lock_interruptible, mutex...
#include "linux/ptrace.h"             // for ptrace_syscall_info, ptrace_sys...
#include "linux/rcupdate.h"           // for rcu_read_unlock, rcu_read_lock
#include "linux/sched/jobctl.h"       // for task_set_jobctl_pending, JOBCTL...
#include "linux/seccomp.h"            // for seccomp_get_filter, seccomp_get...
#include "linux/signal_types.h"       // for kernel_siginfo_t, sigqueue, k_s...
#include "linux/spinlock.h"           // for spin_lock_irq, spin_unlock_irq
#include "linux/stddef.h"             // for true, false, offsetofend, offsetof
#include "linux/thread_info.h"        // for clear_task_syscall_work, SYSCAL...
#include "linux/types.h"              // for bool, list_head
#include "linux/uidgid.h"             // for gid_eq, uid_eq, kgid_t, kuid_t
#include "linux/uio.h"                // for iovec
#include "linux/wait_bit.h"           // for wait_on_bit
#include "vdso/limits.h"              // for ULONG_MAX
struct user_namespace;
---
  ./scripts/check-local-export kernel/ptrace.o
  iwyu2 -Wp,-MMD,kernel/.user.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/user"' -DKBUILD_BASENAME='"user"' -DKBUILD_MODNAME='"user"' -D__KBUILD_MODNAME=kmod_user -c -o kernel/user.o kernel/user.c  

kernel/user.c should add these lines:
#include <stddef.h>                 // for NULL
#include "asm-generic/param.h"      // for HZ
#include "generated/autoconf.h"     // for CONFIG_BASE_SMALL
#include "linux/compiler_types.h"   // for __releases
#include "linux/gfp.h"              // for GFP_KERNEL
#include "linux/list.h"             // for hlist_add_head, hlist_del_init
#include "linux/panic.h"            // for panic
#include "linux/ratelimit.h"        // for ratelimit_set_flags, ratelimit_st...
#include "linux/ratelimit_types.h"  // for RATELIMIT_MSG_ON_RELEASE, RATELIM...
#include "linux/refcount.h"         // for refcount_dec_and_lock_irqsave
#include "linux/spinlock.h"         // for spin_lock_irq, spin_unlock_irq
#include "linux/spinlock_types.h"   // for DEFINE_SPINLOCK
#include "linux/types.h"            // for hlist_head, hlist_node
#include "linux/uidgid.h"           // for __kuid_val, GLOBAL_ROOT_UID, kuid_t

kernel/user.c should remove these lines:
- #include <linux/bitops.h>  // lines 15-15
- #include <linux/interrupt.h>  // lines 18-18
- #include <linux/key.h>  // lines 16-16
- #include <linux/sched.h>  // lines 13-13

The full include-list for kernel/user.c:
#include <linux/export.h>           // for EXPORT_SYMBOL_GPL
#include <linux/init.h>             // for __init, subsys_initcall
#include <linux/proc_ns.h>          // for PROC_USER_INIT_INO
#include <linux/sched/user.h>       // for user_struct, alloc_uid, find_user
#include <linux/slab.h>             // for kmem_cache_free, kmem_cache_create
#include <linux/user_namespace.h>   // for USERNS_INIT_FLAGS, user_namespace
#include <stddef.h>                 // for NULL
#include "asm-generic/param.h"      // for HZ
#include "generated/autoconf.h"     // for CONFIG_BASE_SMALL
#include "linux/compiler_types.h"   // for __releases
#include "linux/gfp.h"              // for GFP_KERNEL
#include "linux/list.h"             // for hlist_add_head, hlist_del_init
#include "linux/panic.h"            // for panic
#include "linux/ratelimit.h"        // for ratelimit_set_flags, ratelimit_st...
#include "linux/ratelimit_types.h"  // for RATELIMIT_MSG_ON_RELEASE, RATELIM...
#include "linux/refcount.h"         // for refcount_dec_and_lock_irqsave
#include "linux/spinlock.h"         // for spin_lock_irq, spin_unlock_irq
#include "linux/spinlock_types.h"   // for DEFINE_SPINLOCK
#include "linux/types.h"            // for hlist_head, hlist_node
#include "linux/uidgid.h"           // for __kuid_val, GLOBAL_ROOT_UID, kuid_t
---
  ./scripts/check-local-export kernel/user.o
  iwyu2 -Wp,-MMD,kernel/.signal.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/signal"' -DKBUILD_BASENAME='"signal"' -DKBUILD_MODNAME='"signal"' -D__KBUILD_MODNAME=kmod_signal -c -o kernel/signal.o kernel/signal.c  
In file included from kernel/signal.c:26:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/signal.c:26:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/signal.c:26:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/signal.c:30:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from kernel/signal.c:26:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/signal.c:26:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/signal.c:26:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/signal.c:30:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/signal.c should add these lines:
#include <asm/barrier.h>                // for smp_mb, smp_wmb
#include <asm/bug.h>                    // for WARN_ON_ONCE, BUG_ON, WARN_ON
#include <asm/posix_types.h>            // for __kernel_size_t
#include <asm/signal.h>                 // for old_sigset_t, stack_t, SIGKILL
#include <linux/bitops.h>               // for ffz
#include <linux/build_bug.h>            // for unlikely, likely
#include <linux/spinlock.h>             // for read_lock, read_unlock
#include <signal.h>                     // for sigset_t, siginfo_t, pid_t
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EFAULT, EINVAL, ESRCH, EPERM
#include "asm-generic/int-ll64.h"       // for u64, u32
#include "asm-generic/param.h"          // for HZ
#include "asm-generic/resource.h"       // for RLIMIT_SIGPENDING
#include "asm-generic/rwonce.h"         // for READ_ONCE
#include "asm-generic/siginfo.h"        // for si_pid, si_uid, si_addr, siginfo
#include "asm-generic/signal-defs.h"    // for __sighandler_t, SIG_IGN, SIG_DFL
#include "asm/bug.h"                    // for BUG
#include "asm/cache.h"                  // for __read_mostly
#include "asm/current.h"                // for current
#include "asm/processor.h"              // for KSTK_EIP
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/string_32.h"              // for memset
#include "asm/thread_info.h"            // for TIF_SIGPENDING
#include "asm/uaccess.h"                // for __put_user, __get_user, clear...
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/capability.h"           // for CAP_KILL
#include "linux/cgroup-defs.h"          // for cgroup_threadgroup_change_end
#include "linux/compiler_attributes.h"  // for __weak, fallthrough
#include "linux/compiler_types.h"       // for __user, inline, __releases
#include "linux/cred.h"                 // for cred, current_user_ns, curren...
#include "linux/err.h"                  // for IS_ERR, PTR_ERR
#include "linux/errno.h"                // for ERESTARTNOHAND
#include "linux/gfp.h"                  // for GFP_ATOMIC, GFP_KERNEL
#include "linux/hrtimer.h"              // for HRTIMER_MODE_REL
#include "linux/jiffies.h"              // for nsec_to_clock_t
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kernel.h"               // for get_option, ARRAY_SIZE
#include "linux/ktime.h"                // for timespec64_to_ktime, ktime_t
#include "linux/list.h"                 // for list_del_init, list_empty
#include "linux/lockdep.h"              // for lockdep_assert_held
#include "linux/mm.h"                   // for arch_vma_name
#include "linux/pid.h"                  // for PIDTYPE_PGID, PIDTYPE_PID
#include "linux/preempt.h"              // for preempt_disable, preempt_enable
#include "linux/printk.h"               // for pr_info, pr_cont
#include "linux/ptrace.h"               // for PTRACE_EVENT_STOP
#include "linux/ratelimit_types.h"      // for DEFINE_RATELIMIT_STATE, __rat...
#include "linux/rcupdate.h"             // for rcu_read_lock, rcu_read_unlock
#include "linux/restart_block.h"        // for do_no_restart_syscall, restar...
#include "linux/sched.h"                // for task_struct, task_pid_vnr
#include "linux/sched/jobctl.h"         // for JOBCTL_STOP_PENDING, JOBCTL_P...
#include "linux/sched/signal.h"         // for sighand_struct, signal_struct
#include "linux/signal.h"               // for SS_DISABLE, SS_FLAG_BITS, SS_...
#include "linux/signal_types.h"         // for kernel_siginfo, kernel_siginf...
#include "linux/spinlock.h"             // for spin_unlock_irq, spin_lock_irq
#include "linux/spinlock_types.h"       // for spinlock_t
#include "linux/stddef.h"               // for offsetof, false, true, sizeof...
#include "linux/thread_info.h"          // for clear_thread_flag
#include "linux/time.h"                 // for get_timespec64
#include "linux/time64.h"               // for timespec64_valid, KTIME_MAX
#include "linux/types.h"                // for list_head, bool, hlist_node
#include "linux/uidgid.h"               // for from_kuid_munged, uid_eq, mak...
#include "linux/wait.h"                 // for wake_up_all
#include "linux/wait_bit.h"             // for wake_up_bit
#include "vdso/limits.h"                // for INT_MIN
struct __kernel_timespec;
struct file;
struct vm_area_struct;

kernel/signal.c should remove these lines:
- #include <asm/cacheflush.h>  // lines 56-56
- #include <asm/param.h>  // lines 52-52
- #include <asm/siginfo.h>  // lines 55-55
- #include <linux/binfmts.h>  // lines 27-27
- #include <linux/compat.h>  // lines 42-42
- #include <linux/compiler.h>  // lines 44-44
- #include <linux/fs.h>  // lines 24-24
- #include <linux/nsproxy.h>  // lines 39-39
- #include <linux/posix-timers.h>  // lines 45-45
- #include <linux/ratelimit.h>  // lines 34-34
- #include <linux/sched/mm.h>  // lines 17-17
- #include <linux/sched/task_stack.h>  // lines 21-21
- #include <linux/sched/user.h>  // lines 18-18

The full include-list for kernel/signal.c:
#include <asm/barrier.h>                // for smp_mb, smp_wmb
#include <asm/bug.h>                    // for WARN_ON_ONCE, BUG_ON, WARN_ON
#include <asm/posix_types.h>            // for __kernel_size_t
#include <asm/signal.h>                 // for old_sigset_t, stack_t, SIGKILL
#include <asm/syscall.h>                // for syscall_get_arch
#include <asm/unistd.h>                 // for __ARCH_WANT_SYS_PAUSE, __ARCH...
#include <linux/audit.h>                // for audit_signal_info
#include <linux/bitops.h>               // for ffz
#include <linux/build_bug.h>            // for unlikely, likely
#include <linux/capability.h>           // for ns_capable
#include <linux/cgroup.h>               // for cgroup_enter_frozen, cgroup_l...
#include <linux/cn_proc.h>              // for proc_coredump_connector
#include <linux/coredump.h>             // for do_coredump
#include <linux/export.h>               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/file.h>                 // for fd, fdget, fdput
#include <linux/freezer.h>              // for freezable_schedule, freezing
#include <linux/init.h>                 // for __init, __setup
#include <linux/pid_namespace.h>        // for task_active_pid_ns, pid_names...
#include <linux/proc_fs.h>              // for tgid_pidfd_to_pid
#include <linux/ptrace.h>               // for ptrace_reparented, PT_SEIZED
#include <linux/sched/cputime.h>        // for task_cputime
#include <linux/sched/debug.h>          // for show_regs
#include <linux/sched/task.h>           // for tasklist_lock, do_group_exit
#include <linux/security.h>             // for security_task_kill
#include <linux/signal.h>               // for clear_siginfo, sigmask, SIL_F...
#include <linux/signalfd.h>             // for signalfd_notify
#include <linux/slab.h>                 // for kmem_cache_alloc, kmem_cache_...
#include <linux/spinlock.h>             // for read_lock, read_unlock
#include <linux/syscalls.h>             // for __MAP2, __MAP3, __MAP4, __MAP1
#include <linux/task_work.h>            // for task_work_pending, task_work_run
#include <linux/tty.h>                  // for is_current_pgrp_orphaned
#include <linux/uaccess.h>              // for copy_from_user, copy_to_user
#include <linux/uprobes.h>              // for uprobe_deny_signal
#include <linux/user_namespace.h>       // for dec_rlimit_put_ucounts, UCOUN...
#include <signal.h>                     // for sigset_t, siginfo_t, pid_t
#include <stddef.h>                     // for NULL
#include <trace/events/signal.h>        // for trace_signal_deliver, trace_s...
#include "asm-generic/errno-base.h"     // for EFAULT, EINVAL, ESRCH, EPERM
#include "asm-generic/int-ll64.h"       // for u64, u32
#include "asm-generic/param.h"          // for HZ
#include "asm-generic/resource.h"       // for RLIMIT_SIGPENDING
#include "asm-generic/rwonce.h"         // for READ_ONCE
#include "asm-generic/siginfo.h"        // for si_pid, si_uid, si_addr, siginfo
#include "asm-generic/signal-defs.h"    // for __sighandler_t, SIG_IGN, SIG_DFL
#include "asm/bug.h"                    // for BUG
#include "asm/cache.h"                  // for __read_mostly
#include "asm/current.h"                // for current
#include "asm/processor.h"              // for KSTK_EIP
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/string_32.h"              // for memset
#include "asm/thread_info.h"            // for TIF_SIGPENDING
#include "asm/uaccess.h"                // for __put_user, __get_user, clear...
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/capability.h"           // for CAP_KILL
#include "linux/cgroup-defs.h"          // for cgroup_threadgroup_change_end
#include "linux/compiler_attributes.h"  // for __weak, fallthrough
#include "linux/compiler_types.h"       // for __user, inline, __releases
#include "linux/cred.h"                 // for cred, current_user_ns, curren...
#include "linux/err.h"                  // for IS_ERR, PTR_ERR
#include "linux/errno.h"                // for ERESTARTNOHAND
#include "linux/gfp.h"                  // for GFP_ATOMIC, GFP_KERNEL
#include "linux/hrtimer.h"              // for HRTIMER_MODE_REL
#include "linux/jiffies.h"              // for nsec_to_clock_t
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kernel.h"               // for get_option, ARRAY_SIZE
#include "linux/ktime.h"                // for timespec64_to_ktime, ktime_t
#include "linux/list.h"                 // for list_del_init, list_empty
#include "linux/lockdep.h"              // for lockdep_assert_held
#include "linux/mm.h"                   // for arch_vma_name
#include "linux/pid.h"                  // for PIDTYPE_PGID, PIDTYPE_PID
#include "linux/preempt.h"              // for preempt_disable, preempt_enable
#include "linux/printk.h"               // for pr_info, pr_cont
#include "linux/ptrace.h"               // for PTRACE_EVENT_STOP
#include "linux/ratelimit_types.h"      // for DEFINE_RATELIMIT_STATE, __rat...
#include "linux/rcupdate.h"             // for rcu_read_lock, rcu_read_unlock
#include "linux/restart_block.h"        // for do_no_restart_syscall, restar...
#include "linux/sched.h"                // for task_struct, task_pid_vnr
#include "linux/sched/jobctl.h"         // for JOBCTL_STOP_PENDING, JOBCTL_P...
#include "linux/sched/signal.h"         // for sighand_struct, signal_struct
#include "linux/signal.h"               // for SS_DISABLE, SS_FLAG_BITS, SS_...
#include "linux/signal_types.h"         // for kernel_siginfo, kernel_siginf...
#include "linux/spinlock.h"             // for spin_unlock_irq, spin_lock_irq
#include "linux/spinlock_types.h"       // for spinlock_t
#include "linux/stddef.h"               // for offsetof, false, true, sizeof...
#include "linux/thread_info.h"          // for clear_thread_flag
#include "linux/time.h"                 // for get_timespec64
#include "linux/time64.h"               // for timespec64_valid, KTIME_MAX
#include "linux/types.h"                // for list_head, bool, hlist_node
#include "linux/uidgid.h"               // for from_kuid_munged, uid_eq, mak...
#include "linux/wait.h"                 // for wake_up_all
#include "linux/wait_bit.h"             // for wake_up_bit
#include "vdso/limits.h"                // for INT_MIN
struct __kernel_timespec;
struct file;
struct vm_area_struct;
---
  ./scripts/check-local-export kernel/signal.o
  iwyu2 -Wp,-MMD,kernel/.sys.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/sys"' -DKBUILD_BASENAME='"sys"' -DKBUILD_MODNAME='"sys"' -D__KBUILD_MODNAME=kmod_sys -c -o kernel/sys.o kernel/sys.c  
In file included from kernel/sys.c:10:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/sys.c:10:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/sys.c:10:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/sys.c:10:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from kernel/sys.c:10:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/sys.c:10:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/sys.c:10:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/sys.c:10:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/sys.c should add these lines:
#include <asm/bitops.h>                              // for test_bit
#include <asm/page_types.h>                          // for TASK_SIZE
#include <linux/ktime.h>                             // for ktime_get_bootti...
#include <linux/spinlock.h>                          // for read_lock, read_...
#include <ctime>                                     // for size_t, pid_t, NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/bitsperlong.h"                 // for BITS_PER_LONG
#include "asm-generic/errno-base.h"                  // for EINVAL, EFAULT
#include "asm-generic/errno.h"                       // for ENOSYS
#include "asm-generic/int-ll64.h"                    // for u64, __u64
#include "asm-generic/resource.h"                    // for RLIM_INFINITY
#include "asm-generic/topology.h"                    // for cpu_to_node
#include "asm/bug.h"                                 // for BUG
#include "asm/cmpxchg.h"                             // for __xchg_wrong_size
#include "asm/compat.h"                              // for COMPAT_UTS_MACHINE
#include "asm/current.h"                             // for current
#include "asm/page_types.h"                          // for PAGE_SIZE
#include "asm/processor.h"                           // for GET_TSC_CTL, SET...
#include "asm/ptrace.h"                              // for pt_regs
#include "asm/string_32.h"                           // for memcpy, memset
#include "asm/uaccess.h"                             // for put_user, strncp...
#include "linux/atomic/atomic-instrumented.h"        // for xchg
#include "linux/build_bug.h"                         // for BUILD_BUG_ON
#include "linux/capability.h"                        // for CAP_SYS_RESOURCE
#include "linux/compiler_attributes.h"               // for __weak, fallthrough
#include "linux/compiler_types.h"                    // for __user, inline
#include "linux/jiffies.h"                           // for nsec_to_clock_t
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/minmax.h"                            // for clamp_t
#include "linux/mm_types.h"                          // for mm_struct, mm_st...
#include "linux/mmap_lock.h"                         // for mmap_read_lock
#include "linux/nsproxy.h"                           // for nsproxy
#include "linux/personality.h"                       // for PER_LINUX32, UNA...
#include "linux/pid.h"                               // for PIDTYPE_PGID
#include "linux/resource.h"                          // for rlimit, rusage
#include "linux/rwsem.h"                             // for down_read, up_read
#include "linux/sched/prio.h"                        // for nice_to_rlimit
#include "linux/sched/signal.h"                      // for signal_struct
#include "linux/sched/user.h"                        // for find_user, free_uid
#include "linux/smp.h"                               // for raw_smp_processo...
#include "linux/spinlock.h"                          // for spin_lock, spin_...
#include "linux/stat.h"                              // for S_IRWXUGO, S_ISREG
#include "linux/stddef.h"                            // for offsetof, true
#include "linux/swap.h"                              // for si_swapinfo
#include "linux/sysinfo.h"                           // for sysinfo, SI_LOAD...
#include "linux/time32.h"                            // for ns_to_kernel_old...
#include "linux/time64.h"                            // for timespec64
#include "linux/types.h"                             // for list_head, bool
#include "linux/utsname.h"                           // for new_utsname, old...
#include "vdso/limits.h"                             // for ULONG_MAX
struct getcpu_cache;

kernel/sys.c should remove these lines:
- #include <asm/io.h>  // lines 73-73
- #include <linux/binfmts.h>  // lines 52-52
- #include <linux/compat.h>  // lines 47-47
- #include <linux/cpu.h>  // lines 35-35
- #include <linux/device.h>  // lines 23-23
- #include <linux/gfp.h>  // lines 41-41
- #include <linux/key.h>  // lines 24-24
- #include <linux/kmod.h>  // lines 17-17
- #include <linux/kmsg_dump.h>  // lines 68-68
- #include <linux/kprobes.h>  // lines 49-49
- #include <linux/mm_inline.h>  // lines 10-10
- #include <linux/mman.h>  // lines 12-12
- #include <linux/mount.h>  // lines 40-40
- #include <linux/reboot.h>  // lines 13-13
- #include <linux/suspend.h>  // lines 28-28
- #include <linux/syscore_ops.h>  // lines 42-42
- #include <linux/user_namespace.h>  // lines 50-50
- #include <linux/workqueue.h>  // lines 21-21
- #include "uid16.h"  // lines 76-76

The full include-list for kernel/sys.c:
#include <asm/bitops.h>                              // for test_bit
#include <asm/page_types.h>                          // for TASK_SIZE
#include <asm/unistd.h>                              // for __ARCH_WANT_SYS_...
#include <generated/utsrelease.h>                    // for UTS_RELEASE
#include <linux/capability.h>                        // for capable, ns_capable
#include <linux/cn_proc.h>                           // for proc_comm_connector
#include <linux/cred.h>                              // for cred, current_us...
#include <linux/ctype.h>                             // for isdigit
#include <linux/export.h>                            // for EXPORT_SYMBOL
#include <linux/file.h>                              // for fd, fdget, fdput
#include <linux/fs.h>                                // for file_inode, file...
#include <linux/fs_struct.h>                         // for fs_struct
#include <linux/highuid.h>                           // for DEFAULT_FS_OVERF...
#include <linux/kernel.h>                            // for scnprintf, ARRAY...
#include <linux/ktime.h>                             // for ktime_get_bootti...
#include <linux/mm.h>                                // for check_data_rlimit
#include <linux/nospec.h>                            // for arch_prctl_spec_...
#include <linux/perf_event.h>                        // for perf_event_task_...
#include <linux/personality.h>                       // for personality
#include <linux/posix-timers.h>                      // for update_rlimit_cpu
#include <linux/prctl.h>                             // for prctl_mm_map
#include <linux/ptrace.h>                            // for force_successful...
#include <linux/rcupdate.h>                          // for rcu_read_unlock
#include <linux/resource.h>                          // for getrusage
#include <linux/sched.h>                             // for task_struct, fin...
#include <linux/sched/autogroup.h>                   // for sched_autogroup_...
#include <linux/sched/coredump.h>                    // for MMF_DISABLE_THP
#include <linux/sched/cputime.h>                     // for thread_group_cpu...
#include <linux/sched/loadavg.h>                     // for get_avenrun, FSHIFT
#include <linux/sched/mm.h>                          // for get_task_mm, mmput
#include <linux/sched/stat.h>                        // for nr_threads
#include <linux/sched/task.h>                        // for task_lock, task_...
#include <linux/seccomp.h>                           // for prctl_get_seccomp
#include <linux/security.h>                          // for security_task_ge...
#include <linux/signal.h>                            // for valid_signal
#include <linux/spinlock.h>                          // for read_lock, read_...
#include <linux/syscall_user_dispatch.h>             // for set_syscall_user...
#include <linux/syscalls.h>                          // for __MAP2, __MAP1
#include <linux/task_io_accounting_ops.h>            // for task_io_get_inblock
#include <linux/time_namespace.h>                    // for timens_add_boottime
#include <linux/times.h>                             // for tms
#include <linux/tty.h>                               // for proc_clear_tty
#include <linux/uaccess.h>                           // for copy_to_user
#include <linux/uidgid.h>                            // for uid_eq, gid_eq
#include <linux/utsname.h>                           // for utsname, uts_pro...
#include <linux/version.h>                           // for LINUX_VERSION_PA...
#include <ctime>                                     // for size_t, pid_t, NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/bitsperlong.h"                 // for BITS_PER_LONG
#include "asm-generic/errno-base.h"                  // for EINVAL, EFAULT
#include "asm-generic/errno.h"                       // for ENOSYS
#include "asm-generic/int-ll64.h"                    // for u64, __u64
#include "asm-generic/resource.h"                    // for RLIM_INFINITY
#include "asm-generic/topology.h"                    // for cpu_to_node
#include "asm/bug.h"                                 // for BUG
#include "asm/cmpxchg.h"                             // for __xchg_wrong_size
#include "asm/compat.h"                              // for COMPAT_UTS_MACHINE
#include "asm/current.h"                             // for current
#include "asm/page_types.h"                          // for PAGE_SIZE
#include "asm/processor.h"                           // for GET_TSC_CTL, SET...
#include "asm/ptrace.h"                              // for pt_regs
#include "asm/string_32.h"                           // for memcpy, memset
#include "asm/uaccess.h"                             // for put_user, strncp...
#include "linux/atomic/atomic-instrumented.h"        // for xchg
#include "linux/build_bug.h"                         // for BUILD_BUG_ON
#include "linux/capability.h"                        // for CAP_SYS_RESOURCE
#include "linux/compiler_attributes.h"               // for __weak, fallthrough
#include "linux/compiler_types.h"                    // for __user, inline
#include "linux/jiffies.h"                           // for nsec_to_clock_t
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/minmax.h"                            // for clamp_t
#include "linux/mm_types.h"                          // for mm_struct, mm_st...
#include "linux/mmap_lock.h"                         // for mmap_read_lock
#include "linux/nsproxy.h"                           // for nsproxy
#include "linux/personality.h"                       // for PER_LINUX32, UNA...
#include "linux/pid.h"                               // for PIDTYPE_PGID
#include "linux/resource.h"                          // for rlimit, rusage
#include "linux/rwsem.h"                             // for down_read, up_read
#include "linux/sched/prio.h"                        // for nice_to_rlimit
#include "linux/sched/signal.h"                      // for signal_struct
#include "linux/sched/user.h"                        // for find_user, free_uid
#include "linux/smp.h"                               // for raw_smp_processo...
#include "linux/spinlock.h"                          // for spin_lock, spin_...
#include "linux/stat.h"                              // for S_IRWXUGO, S_ISREG
#include "linux/stddef.h"                            // for offsetof, true
#include "linux/swap.h"                              // for si_swapinfo
#include "linux/sysinfo.h"                           // for sysinfo, SI_LOAD...
#include "linux/time32.h"                            // for ns_to_kernel_old...
#include "linux/time64.h"                            // for timespec64
#include "linux/types.h"                             // for list_head, bool
#include "linux/utsname.h"                           // for new_utsname, old...
#include "vdso/limits.h"                             // for ULONG_MAX
struct getcpu_cache;
---
  ./scripts/check-local-export kernel/sys.o
  iwyu2 -Wp,-MMD,kernel/.umh.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/umh"' -DKBUILD_BASENAME='"umh"' -DKBUILD_MODNAME='"umh"' -D__KBUILD_MODNAME=kmod_umh -c -o kernel/umh.o kernel/umh.c  
In file included from kernel/umh.c:9:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/umh.c:9:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/umh.c:9:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/umh.c:9:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from kernel/umh.c:9:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/umh.c:9:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/umh.c:9:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/umh.c:9:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/umh.c should add these lines:
#include <asm/barrier.h>                       // for smp_mb__after_atomic
#include <signal.h>                            // for SIGCHLD
#include <ctime>                               // for NULL, pid_t, size_t
#include "asm-generic/errno-base.h"            // for EINVAL, EAGAIN, ENOMEM
#include "asm-generic/int-ll64.h"              // for __u32
#include "asm-generic/param.h"                 // for HZ
#include "asm-generic/signal-defs.h"           // for SIG_DFL, SIG_IGN
#include "asm/bug.h"                           // for BUG
#include "asm/cmpxchg.h"                       // for __xchg_wrong_size
#include "asm/current.h"                       // for current
#include "asm/string_32.h"                     // for strlen
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_de...
#include "linux/capability.h"                  // for cap_intersect, capable
#include "linux/container_of.h"                // for container_of
#include "linux/export.h"                      // for EXPORT_SYMBOL, EXPORT_...
#include "linux/freezer.h"                     // for try_to_freeze
#include "linux/gfp.h"                         // for GFP_ATOMIC, GFP_KERNEL
#include "linux/sched.h"                       // for CLONE_PARENT
#include "linux/sched/signal.h"                // for flush_signal_handlers
#include "linux/signal.h"                      // for kernel_sigaction
#include "linux/spinlock.h"                    // for spin_lock, spin_unlock
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK
#include "linux/sysctl.h"                      // for ctl_table, proc_doulon...
#include "linux/types.h"                       // for gfp_t, ATOMIC_INIT
#include "linux/umh.h"                         // for subprocess_info, UMH_N...
#include "linux/wait.h"                        // for wait_queue_head, finis...

kernel/umh.c should remove these lines:
- #include <linux/async.h>  // lines 28-28
- #include <linux/fdtable.h>  // lines 16-16
- #include <linux/file.h>  // lines 15-15
- #include <linux/init.h>  // lines 22-22
- #include <linux/kmod.h>  // lines 11-11
- #include <linux/module.h>  // lines 5-5
- #include <linux/mount.h>  // lines 20-20
- #include <linux/notifier.h>  // lines 24-24
- #include <linux/ptrace.h>  // lines 27-27
- #include <linux/resource.h>  // lines 23-23
- #include <linux/security.h>  // lines 19-19
- #include <linux/suspend.h>  // lines 25-25
- #include <linux/syscalls.h>  // lines 9-9
- #include <linux/uaccess.h>  // lines 29-29
- #include <linux/unistd.h>  // lines 10-10

The full include-list for kernel/umh.c:
#include <asm/barrier.h>                       // for smp_mb__after_atomic
#include <linux/binfmts.h>                     // for kernel_execve
#include <linux/completion.h>                  // for complete, wait_for_com...
#include <linux/cred.h>                        // for cred, abort_creds, com...
#include <linux/fs_struct.h>                   // for fs_struct
#include <linux/initrd.h>                      // for wait_for_initramfs
#include <linux/kernel.h>                      // for do_exit
#include <linux/rwsem.h>                       // for down_read, up_read
#include <linux/sched.h>                       // for schedule, schedule_tim...
#include <linux/sched/task.h>                  // for user_mode_thread, kern...
#include <linux/slab.h>                        // for kfree, kzalloc
#include <linux/workqueue.h>                   // for queue_work, work_struct
#include <signal.h>                            // for SIGCHLD
#include <ctime>                               // for NULL, pid_t, size_t
#include "asm-generic/errno-base.h"            // for EINVAL, EAGAIN, ENOMEM
#include "asm-generic/int-ll64.h"              // for __u32
#include "asm-generic/param.h"                 // for HZ
#include "asm-generic/signal-defs.h"           // for SIG_DFL, SIG_IGN
#include "asm/bug.h"                           // for BUG
#include "asm/cmpxchg.h"                       // for __xchg_wrong_size
#include "asm/current.h"                       // for current
#include "asm/string_32.h"                     // for strlen
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_de...
#include "linux/capability.h"                  // for cap_intersect, capable
#include "linux/container_of.h"                // for container_of
#include "linux/export.h"                      // for EXPORT_SYMBOL, EXPORT_...
#include "linux/freezer.h"                     // for try_to_freeze
#include "linux/gfp.h"                         // for GFP_ATOMIC, GFP_KERNEL
#include "linux/sched.h"                       // for CLONE_PARENT
#include "linux/sched/signal.h"                // for flush_signal_handlers
#include "linux/signal.h"                      // for kernel_sigaction
#include "linux/spinlock.h"                    // for spin_lock, spin_unlock
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK
#include "linux/sysctl.h"                      // for ctl_table, proc_doulon...
#include "linux/types.h"                       // for gfp_t, ATOMIC_INIT
#include "linux/umh.h"                         // for subprocess_info, UMH_N...
#include "linux/wait.h"                        // for wait_queue_head, finis...
---
  ./scripts/check-local-export kernel/umh.o
  iwyu2 -Wp,-MMD,kernel/.workqueue.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/workqueue"' -DKBUILD_BASENAME='"workqueue"' -DKBUILD_MODNAME='"workqueue"' -D__KBUILD_MODNAME=kmod_workqueue -c -o kernel/workqueue.o kernel/workqueue.c  
In file included from kernel/workqueue.c:36:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/workqueue.c:36:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/workqueue.c:36:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/workqueue.c:36:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/workqueue.c:36:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/workqueue.c:36:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/workqueue.c should add these lines:
#include <asm-generic/percpu.h>                      // for per_cpu, per_cpu...
#include <asm/barrier.h>                             // for smp_mb, smp_wmb
#include <asm/bitops.h>                              // for __set_bit, __cle...
#include <asm/bug.h>                                 // for WARN_ON_ONCE
#include <asm/percpu.h>                              // for raw_cpu_read_8
#include <linux/build_bug.h>                         // for unlikely, likely
#include <linux/preempt.h>                           // for preempt_count
#include <linux/rcupdate.h>                          // for rcu_barrier
#include <cstdio>                                    // for NULL, size_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for test_and_set_bit
#include "asm-generic/errno-base.h"                  // for ENOMEM, EAGAIN
#include "asm-generic/int-ll64.h"                    // for u32
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/rwonce.h"                      // for READ_ONCE, WRITE...
#include "asm-generic/topology.h"                    // for cpu_to_node, cpu...
#include "asm/cache.h"                               // for __read_mostly
#include "asm/current.h"                             // for current
#include "asm/percpu.h"                              // for __pcpu_op2_1
#include "asm/string_32.h"                           // for strcmp, memset
#include "asm/vdso/processor.h"                      // for cpu_relax
#include "linux/atomic/atomic-instrumented.h"        // for atomic_long_read
#include "linux/bitops.h"                            // for BITS_TO_LONGS
#include "linux/build_bug.h"                         // for BUILD_BUG_ON
#include "linux/cache.h"                             // for ____cacheline_al...
#include "linux/compiler_attributes.h"               // for __aligned, __printf
#include "linux/compiler_types.h"                    // for inline, __acquires
#include "linux/container_of.h"                      // for container_of
#include "linux/cpumask.h"                           // for cpumask_copy
#include "linux/err.h"                               // for IS_ERR, PTR_ERR
#include "linux/gfp.h"                               // for GFP_KERNEL
#include "linux/irqflags.h"                          // for local_irq_restore
#include "linux/jiffies.h"                           // for jiffies, jiffies...
#include "linux/kasan.h"                             // for kasan_record_aux...
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/list.h"                              // for list_empty, INIT...
#include "linux/minmax.h"                            // for clamp_val, swap
#include "linux/mutex.h"                             // for mutex_unlock
#include "linux/numa.h"                              // for NUMA_NO_NODE
#include "linux/overflow.h"                          // for struct_size
#include "linux/percpu.h"                            // for free_percpu, all...
#include "linux/preempt.h"                           // for preempt_disable
#include "linux/printk.h"                            // for pr_cont, pr_info
#include "linux/rcupdate.h"                          // for rcu_read_unlock
#include "linux/rcuwait.h"                           // for rcuwait_wake_up
#include "linux/sched/prio.h"                        // for MIN_NICE
#include "linux/smp.h"                               // for raw_smp_processo...
#include "linux/spinlock.h"                          // for raw_spin_unlock_irq
#include "linux/spinlock_types_raw.h"                // for DEFINE_RAW_SPINLOCK
#include "linux/stdarg.h"                            // for va_end, va_start
#include "linux/stddef.h"                            // for false, true
#include "linux/string.h"                            // for strscpy
#include "linux/timer.h"                             // for mod_timer, timer...
#include "linux/types.h"                             // for list_head, bool
#include "linux/wait.h"                              // for wait_queue_head
#include "vdso/limits.h"                             // for INT_MAX

kernel/workqueue.c should remove these lines:
- #include <linux/freezer.h>  // lines 41-41
- #include <linux/hardirq.h>  // lines 39-39
- #include <linux/mempolicy.h>  // lines 40-40
- #include <linux/notifier.h>  // lines 37-37
- #include <linux/signal.h>  // lines 32-32
- struct wq_device;  // lines 251-251

The full include-list for kernel/workqueue.c:
#include <asm-generic/percpu.h>                      // for per_cpu, per_cpu...
#include <asm/barrier.h>                             // for smp_mb, smp_wmb
#include <asm/bitops.h>                              // for __set_bit, __cle...
#include <asm/bug.h>                                 // for WARN_ON_ONCE
#include <asm/percpu.h>                              // for raw_cpu_read_8
#include <linux/build_bug.h>                         // for unlikely, likely
#include <linux/completion.h>                        // for complete, wait_f...
#include <linux/cpu.h>                               // for cpus_read_lock
#include <linux/debug_locks.h>                       // for debug_show_held_...
#include <linux/export.h>                            // for EXPORT_SYMBOL_GPL
#include <linux/hashtable.h>                         // for hash_del, hash_f...
#include <linux/idr.h>                               // for ida_free, ida_alloc
#include <linux/init.h>                              // for __init
#include <linux/jhash.h>                             // for jhash, jhash_1word
#include <linux/kernel.h>                            // for scnprintf, snprintf
#include <linux/kthread.h>                           // for kthread_data
#include <linux/lockdep.h>                           // for lockdep_assert_held
#include <linux/moduleparam.h>                       // for kernel_param
#include <linux/nmi.h>                               // for touch_nmi_watchdog
#include <linux/nodemask.h>                          // for for_each_node
#include <linux/preempt.h>                           // for preempt_count
#include <linux/rculist.h>                           // for list_for_each_en...
#include <linux/rcupdate.h>                          // for rcu_barrier
#include <linux/sched.h>                             // for task_struct, tas...
#include <linux/sched/isolation.h>                   // for housekeeping_cpu...
#include <linux/slab.h>                              // for kfree, kzalloc
#include <linux/uaccess.h>                           // for copy_from_kernel...
#include <linux/workqueue.h>                         // for work_struct, wor...
#include <trace/events/workqueue.h>                  // for trace_workqueue_...
#include <cstdio>                                    // for NULL, size_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for test_and_set_bit
#include "asm-generic/errno-base.h"                  // for ENOMEM, EAGAIN
#include "asm-generic/int-ll64.h"                    // for u32
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/rwonce.h"                      // for READ_ONCE, WRITE...
#include "asm-generic/topology.h"                    // for cpu_to_node, cpu...
#include "asm/cache.h"                               // for __read_mostly
#include "asm/current.h"                             // for current
#include "asm/percpu.h"                              // for __pcpu_op2_1
#include "asm/string_32.h"                           // for strcmp, memset
#include "asm/vdso/processor.h"                      // for cpu_relax
#include "linux/atomic/atomic-instrumented.h"        // for atomic_long_read
#include "linux/bitops.h"                            // for BITS_TO_LONGS
#include "linux/build_bug.h"                         // for BUILD_BUG_ON
#include "linux/cache.h"                             // for ____cacheline_al...
#include "linux/compiler_attributes.h"               // for __aligned, __printf
#include "linux/compiler_types.h"                    // for inline, __acquires
#include "linux/container_of.h"                      // for container_of
#include "linux/cpumask.h"                           // for cpumask_copy
#include "linux/err.h"                               // for IS_ERR, PTR_ERR
#include "linux/gfp.h"                               // for GFP_KERNEL
#include "linux/irqflags.h"                          // for local_irq_restore
#include "linux/jiffies.h"                           // for jiffies, jiffies...
#include "linux/kasan.h"                             // for kasan_record_aux...
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/list.h"                              // for list_empty, INIT...
#include "linux/minmax.h"                            // for clamp_val, swap
#include "linux/mutex.h"                             // for mutex_unlock
#include "linux/numa.h"                              // for NUMA_NO_NODE
#include "linux/overflow.h"                          // for struct_size
#include "linux/percpu.h"                            // for free_percpu, all...
#include "linux/preempt.h"                           // for preempt_disable
#include "linux/printk.h"                            // for pr_cont, pr_info
#include "linux/rcupdate.h"                          // for rcu_read_unlock
#include "linux/rcuwait.h"                           // for rcuwait_wake_up
#include "linux/sched/prio.h"                        // for MIN_NICE
#include "linux/smp.h"                               // for raw_smp_processo...
#include "linux/spinlock.h"                          // for raw_spin_unlock_irq
#include "linux/spinlock_types_raw.h"                // for DEFINE_RAW_SPINLOCK
#include "linux/stdarg.h"                            // for va_end, va_start
#include "linux/stddef.h"                            // for false, true
#include "linux/string.h"                            // for strscpy
#include "linux/timer.h"                             // for mod_timer, timer...
#include "linux/types.h"                             // for list_head, bool
#include "linux/wait.h"                              // for wait_queue_head
#include "vdso/limits.h"                             // for INT_MAX
#include "workqueue_internal.h"                      // for worker, worker::...
---
  ./scripts/check-local-export kernel/workqueue.o
  iwyu2 -Wp,-MMD,kernel/.pid.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/pid"' -DKBUILD_BASENAME='"pid"' -DKBUILD_MODNAME='"pid"' -D__KBUILD_MODNAME=kmod_pid -c -o kernel/pid.o kernel/pid.c  
In file included from kernel/pid.c:37:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/pid.c:37:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/pid.c:37:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/pid.c:37:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from kernel/pid.c:38:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/pid.c:45:
In file included from ./include/net/sock.h:46:
./include/linux/netdevice.h:1243:17: warning: declaration of 'struct rtnl_link_stats64' will not be visible outside of this function [-Wvisibility]
                                                   struct rtnl_link_stats64 *storage);
                                                          ^
./include/linux/netdevice.h:1268:19: warning: declaration of 'struct ifla_vf_info' will not be visible outside of this function [-Wvisibility]
                                                     struct ifla_vf_info *ivf);
                                                            ^
./include/linux/netdevice.h:1273:18: warning: declaration of 'struct ifla_vf_stats' will not be visible outside of this function [-Wvisibility]
                                                    struct ifla_vf_stats
                                                           ^
./include/linux/netdevice.h:1282:17: warning: declaration of 'struct ifla_vf_guid' will not be visible outside of this function [-Wvisibility]
                                                   struct ifla_vf_guid *node_guid,
                                                          ^
9 warnings generated.
In file included from kernel/pid.c:37:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/pid.c:37:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/pid.c:37:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/pid.c:37:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from kernel/pid.c:38:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/pid.c:45:
In file included from ./include/net/sock.h:46:
./include/linux/netdevice.h:1243:17: warning: declaration of 'struct rtnl_link_stats64' will not be visible outside of this function [-Wvisibility]
                                                   struct rtnl_link_stats64 *storage);
                                                          ^
./include/linux/netdevice.h:1268:19: warning: declaration of 'struct ifla_vf_info' will not be visible outside of this function [-Wvisibility]
                                                     struct ifla_vf_info *ivf);
                                                            ^
./include/linux/netdevice.h:1273:18: warning: declaration of 'struct ifla_vf_stats' will not be visible outside of this function [-Wvisibility]
                                                    struct ifla_vf_stats
                                                           ^
./include/linux/netdevice.h:1282:17: warning: declaration of 'struct ifla_vf_guid' will not be visible outside of this function [-Wvisibility]
                                                   struct ifla_vf_guid *node_guid,
                                                          ^

kernel/pid.c should add these lines:
#include <asm/bug.h>                 // for WARN_ON
#include <ctime>                     // for pid_t, NULL, size_t
#include "asm-generic/errno-base.h"  // for EINVAL, EBADF, ESRCH, ENOMEM
#include "asm-generic/fcntl.h"       // for O_CLOEXEC, O_RDWR, O_NONBLOCK
#include "asm-generic/rwonce.h"      // for WRITE_ONCE
#include "asm/current.h"             // for current
#include "asm/ptrace.h"              // for pt_regs
#include "linux/build_bug.h"         // for BUILD_BUG_ON
#include "linux/cache.h"             // for __cacheline_aligned_in_smp
#include "linux/capability.h"        // for checkpoint_restore_ns_capable
#include "linux/container_of.h"      // for container_of
#include "linux/cpumask.h"           // for num_possible_cpus
#include "linux/err.h"               // for ERR_PTR, IS_ERR, PTR_ERR, ERR_CAST
#include "linux/file.h"              // for fd, fdget, fdput, fget_task, fput
#include "linux/fs.h"                // for file
#include "linux/gfp.h"               // for GFP_ATOMIC, GFP_KERNEL
#include "linux/list.h"              // for INIT_HLIST_HEAD, hlist_entry
#include "linux/minmax.h"            // for max_t, min
#include "linux/pid.h"               // for pid, upid, get_pid, pid_type
#include "linux/printk.h"            // for pr_info
#include "linux/ptrace.h"            // for ptrace_may_access, PTRACE_MODE_A...
#include "linux/rcupdate.h"          // for rcu_read_lock, rcu_read_unlock
#include "linux/rwsem.h"             // for down_read_killable, up_read
#include "linux/sched.h"             // for task_struct, task_pid, wake_up_p...
#include "linux/spinlock.h"          // for spin_unlock_irq, spin_lock_irq
#include "linux/spinlock_types.h"    // for DEFINE_SPINLOCK
#include "linux/threads.h"           // for PID_MAX_LIMIT, PIDS_PER_CPU_DEFAULT
#include "linux/types.h"             // for hlist_head, hlist_node, rcu_head
#include "linux/user_namespace.h"    // for init_user_ns
#include "linux/wait.h"              // for init_waitqueue_head

kernel/pid.c should remove these lines:
- #include <linux/init_task.h>  // lines 37-37
- #include <linux/memblock.h>  // lines 35-35
- #include <linux/mm.h>  // lines 30-30
- #include <net/sock.h>  // lines 45-45

The full include-list for kernel/pid.c:
#include <asm/bug.h>                 // for WARN_ON
#include <linux/anon_inodes.h>       // for anon_inode_getfd
#include <linux/export.h>            // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include <linux/idr.h>               // for idr_remove, idr_alloc, idr_alloc...
#include <linux/init.h>              // for __init
#include <linux/pid_namespace.h>     // for pid_namespace, init_pid_ns, PIDN...
#include <linux/proc_ns.h>           // for PROC_PID_INIT_INO
#include <linux/rculist.h>           // for hlist_add_head_rcu, hlist_del_rcu
#include <linux/refcount.h>          // for refcount_dec_and_test, refcount_set
#include <linux/sched/signal.h>      // for signal_struct
#include <linux/sched/task.h>        // for get_task_struct, lockdep_tasklis...
#include <linux/slab.h>              // for kmem_cache_free, kmem_cache_alloc
#include <linux/syscalls.h>          // for __MAP2, __MAP3, SYSCALL_DEFINE2
#include <uapi/linux/pidfd.h>        // for PIDFD_NONBLOCK
#include <ctime>                     // for pid_t, NULL, size_t
#include "asm-generic/errno-base.h"  // for EINVAL, EBADF, ESRCH, ENOMEM
#include "asm-generic/fcntl.h"       // for O_CLOEXEC, O_RDWR, O_NONBLOCK
#include "asm-generic/rwonce.h"      // for WRITE_ONCE
#include "asm/current.h"             // for current
#include "asm/ptrace.h"              // for pt_regs
#include "linux/build_bug.h"         // for BUILD_BUG_ON
#include "linux/cache.h"             // for __cacheline_aligned_in_smp
#include "linux/capability.h"        // for checkpoint_restore_ns_capable
#include "linux/container_of.h"      // for container_of
#include "linux/cpumask.h"           // for num_possible_cpus
#include "linux/err.h"               // for ERR_PTR, IS_ERR, PTR_ERR, ERR_CAST
#include "linux/file.h"              // for fd, fdget, fdput, fget_task, fput
#include "linux/fs.h"                // for file
#include "linux/gfp.h"               // for GFP_ATOMIC, GFP_KERNEL
#include "linux/list.h"              // for INIT_HLIST_HEAD, hlist_entry
#include "linux/minmax.h"            // for max_t, min
#include "linux/pid.h"               // for pid, upid, get_pid, pid_type
#include "linux/printk.h"            // for pr_info
#include "linux/ptrace.h"            // for ptrace_may_access, PTRACE_MODE_A...
#include "linux/rcupdate.h"          // for rcu_read_lock, rcu_read_unlock
#include "linux/rwsem.h"             // for down_read_killable, up_read
#include "linux/sched.h"             // for task_struct, task_pid, wake_up_p...
#include "linux/spinlock.h"          // for spin_unlock_irq, spin_lock_irq
#include "linux/spinlock_types.h"    // for DEFINE_SPINLOCK
#include "linux/threads.h"           // for PID_MAX_LIMIT, PIDS_PER_CPU_DEFAULT
#include "linux/types.h"             // for hlist_head, hlist_node, rcu_head
#include "linux/user_namespace.h"    // for init_user_ns
#include "linux/wait.h"              // for init_waitqueue_head
---
  ./scripts/check-local-export kernel/pid.o
  iwyu2 -Wp,-MMD,kernel/.task_work.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/task_work"' -DKBUILD_BASENAME='"task_work"' -DKBUILD_MODNAME='"task_work"' -D__KBUILD_MODNAME=kmod_task_work -c -o kernel/task_work.o kernel/task_work.c  
In file included from kernel/task_work.c:4:
In file included from ./include/linux/resume_user_mode.h:8:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/task_work.c:4:
In file included from ./include/linux/resume_user_mode.h:8:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/task_work.c:4:
In file included from ./include/linux/resume_user_mode.h:8:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/task_work.c:4:
In file included from ./include/linux/resume_user_mode.h:8:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from kernel/task_work.c:4:
In file included from ./include/linux/resume_user_mode.h:8:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/task_work.c:4:
In file included from ./include/linux/resume_user_mode.h:8:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/task_work.c:4:
In file included from ./include/linux/resume_user_mode.h:8:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/task_work.c:4:
In file included from ./include/linux/resume_user_mode.h:8:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/task_work.c should add these lines:
#include <asm/bug.h>                           // for WARN_ON_ONCE
#include <stddef.h>                            // for NULL
#include "asm-generic/errno-base.h"            // for ESRCH
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "asm/current.h"                       // for current
#include "linux/atomic/atomic-instrumented.h"  // for cmpxchg
#include "linux/compiler.h"                    // for likely, unlikely
#include "linux/kasan.h"                       // for kasan_record_aux_stack
#include "linux/sched.h"                       // for task_struct, PF_EXITING
#include "linux/sched/signal.h"                // for __set_notify_signal
#include "linux/types.h"                       // for callback_head, bool

kernel/task_work.c should remove these lines:

The full include-list for kernel/task_work.c:
#include <asm/bug.h>                           // for WARN_ON_ONCE
#include <linux/resume_user_mode.h>            // for set_notify_resume
#include <linux/spinlock.h>                    // for raw_spin_lock_irq, raw...
#include <linux/task_work.h>                   // for task_work_pending, TWA...
#include <stddef.h>                            // for NULL
#include "asm-generic/errno-base.h"            // for ESRCH
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "asm/current.h"                       // for current
#include "linux/atomic/atomic-instrumented.h"  // for cmpxchg
#include "linux/compiler.h"                    // for likely, unlikely
#include "linux/kasan.h"                       // for kasan_record_aux_stack
#include "linux/sched.h"                       // for task_struct, PF_EXITING
#include "linux/sched/signal.h"                // for __set_notify_signal
#include "linux/types.h"                       // for callback_head, bool
---
  ./scripts/check-local-export kernel/task_work.o
  iwyu2 -Wp,-MMD,kernel/.extable.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/extable"' -DKBUILD_BASENAME='"extable"' -DKBUILD_MODNAME='"extable"' -D__KBUILD_MODNAME=kmod_extable -c -o kernel/extable.o kernel/extable.c  
In file included from kernel/extable.c:8:
In file included from ./include/linux/memory.h:19:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/extable.c:8:
In file included from ./include/linux/memory.h:19:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/extable.c:8:
In file included from ./include/linux/memory.h:19:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/extable.c:14:
In file included from ./include/linux/filter.h:12:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from kernel/extable.c:14:
In file included from ./include/linux/filter.h:20:
In file included from ./include/linux/if_vlan.h:10:
./include/linux/netdevice.h:1243:17: warning: declaration of 'struct rtnl_link_stats64' will not be visible outside of this function [-Wvisibility]
                                                   struct rtnl_link_stats64 *storage);
                                                          ^
./include/linux/netdevice.h:1268:19: warning: declaration of 'struct ifla_vf_info' will not be visible outside of this function [-Wvisibility]
                                                     struct ifla_vf_info *ivf);
                                                            ^
./include/linux/netdevice.h:1273:18: warning: declaration of 'struct ifla_vf_stats' will not be visible outside of this function [-Wvisibility]
                                                    struct ifla_vf_stats
                                                           ^
./include/linux/netdevice.h:1282:17: warning: declaration of 'struct ifla_vf_guid' will not be visible outside of this function [-Wvisibility]
                                                   struct ifla_vf_guid *node_guid,
                                                          ^
8 warnings generated.
In file included from kernel/extable.c:8:
In file included from ./include/linux/memory.h:19:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/extable.c:8:
In file included from ./include/linux/memory.h:19:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/extable.c:8:
In file included from ./include/linux/memory.h:19:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/extable.c:14:
In file included from ./include/linux/filter.h:12:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from kernel/extable.c:14:
In file included from ./include/linux/filter.h:20:
In file included from ./include/linux/if_vlan.h:10:
./include/linux/netdevice.h:1243:17: warning: declaration of 'struct rtnl_link_stats64' will not be visible outside of this function [-Wvisibility]
                                                   struct rtnl_link_stats64 *storage);
                                                          ^
./include/linux/netdevice.h:1268:19: warning: declaration of 'struct ifla_vf_info' will not be visible outside of this function [-Wvisibility]
                                                     struct ifla_vf_info *ivf);
                                                            ^
./include/linux/netdevice.h:1273:18: warning: declaration of 'struct ifla_vf_stats' will not be visible outside of this function [-Wvisibility]
                                                    struct ifla_vf_stats
                                                           ^
./include/linux/netdevice.h:1282:17: warning: declaration of 'struct ifla_vf_guid' will not be visible outside of this function [-Wvisibility]
                                                   struct ifla_vf_guid *node_guid,
                                                          ^

kernel/extable.c should add these lines:
#include <linux/linkage.h>              // for notrace
#include <linux/rcupdate.h>             // for rcu_is_watching
#include "asm-generic/int-ll64.h"       // for u32
#include "asm-generic/sections.h"       // for is_kernel_inittext, dereferen...
#include "asm/extable.h"                // for exception_table_entry
#include "linux/compiler_attributes.h"  // for __visible
#include "linux/hardirq.h"              // for rcu_nmi_enter, rcu_nmi_exit
#include "linux/kallsyms.h"             // for is_kernel_text
#include "linux/kernel.h"               // for SYSTEM_FREEING_INITMEM, __ker...
#include "linux/printk.h"               // for pr_notice
#include "linux/types.h"                // for bool

kernel/extable.c should remove these lines:
- #include <asm/sections.h>  // lines 16-16
- #include <linux/elf.h>  // lines 6-6
- #include <linux/memory.h>  // lines 8-8
- #include <linux/uaccess.h>  // lines 17-17

The full include-list for kernel/extable.c:
#include <linux/extable.h>              // for search_bpf_extables, search_e...
#include <linux/filter.h>               // for is_bpf_text_address
#include <linux/ftrace.h>               // for is_ftrace_trampoline
#include <linux/init.h>                 // for __init, __initdata
#include <linux/kprobes.h>              // for is_kprobe_insn_slot, is_kprob...
#include <linux/linkage.h>              // for notrace
#include <linux/module.h>               // for is_module_text_address
#include <linux/mutex.h>                // for mutex, DEFINE_MUTEX
#include <linux/rcupdate.h>             // for rcu_is_watching
#include "asm-generic/int-ll64.h"       // for u32
#include "asm-generic/sections.h"       // for is_kernel_inittext, dereferen...
#include "asm/extable.h"                // for exception_table_entry
#include "linux/compiler_attributes.h"  // for __visible
#include "linux/hardirq.h"              // for rcu_nmi_enter, rcu_nmi_exit
#include "linux/kallsyms.h"             // for is_kernel_text
#include "linux/kernel.h"               // for SYSTEM_FREEING_INITMEM, __ker...
#include "linux/printk.h"               // for pr_notice
#include "linux/types.h"                // for bool
---
  ./scripts/check-local-export kernel/extable.o
  iwyu2 -Wp,-MMD,kernel/.params.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/params"' -DKBUILD_BASENAME='"params"' -DKBUILD_MODNAME='"params"' -D__KBUILD_MODNAME=kmod_params -c -o kernel/params.o kernel/params.c  
In file included from kernel/params.c:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/params.c:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/params.c:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/params.c:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/params.c:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/params.c:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/params.c should add these lines:
#include <stddef.h>                  // for NULL, size_t
#include "asm-generic/errno-base.h"  // for EINVAL, ENOSPC, ENOENT, ENOMEM
#include "asm-generic/int-ll64.h"    // for s16
#include "asm/page_types.h"          // for PAGE_SIZE
#include "asm/string_32.h"           // for strlen, strcpy, strcmp
#include "linux/compiler_types.h"    // for inline
#include "linux/container_of.h"      // for container_of
#include "linux/export.h"            // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/init.h"              // for __init
#include "linux/irqflags.h"          // for irqs_disabled
#include "linux/kstrtox.h"           // for kstrtouint, kstrtoint, kstrtol
#include "linux/list.h"              // for list_add, list_del, LIST_HEAD
#include "linux/panic.h"             // for add_taint, LOCKDEP_STILL_OK, TAI...
#include "linux/printk.h"            // for pr_err, pr_debug, pr_notice, pr_...
#include "linux/spinlock.h"          // for spin_lock, spin_unlock
#include "linux/spinlock_types.h"    // for DEFINE_SPINLOCK
#include "linux/stddef.h"            // for false, true
#include "linux/sysfs.h"             // for attribute_group
#include "linux/types.h"             // for bool, list_head
struct module;

kernel/params.c should remove these lines:
- #include <linux/ctype.h>  // lines 14-14
- #include <linux/device.h>  // lines 11-11
- #include <linux/errno.h>  // lines 8-8

The full include-list for kernel/params.c:
#include <linux/err.h>               // for ERR_PTR
#include <linux/kernel.h>            // for scnprintf, sprintf, next_arg
#include <linux/module.h>            // for module_attribute
#include <linux/moduleparam.h>       // for kernel_param, kernel_param::(ano...
#include <linux/security.h>          // for security_locked_down, LOCKDOWN_M...
#include <linux/slab.h>              // for kfree, kmalloc, slab_is_available
#include <linux/string.h>            // for skip_spaces, strcspn
#include <stddef.h>                  // for NULL, size_t
#include "asm-generic/errno-base.h"  // for EINVAL, ENOSPC, ENOENT, ENOMEM
#include "asm-generic/int-ll64.h"    // for s16
#include "asm/page_types.h"          // for PAGE_SIZE
#include "asm/string_32.h"           // for strlen, strcpy, strcmp
#include "linux/compiler_types.h"    // for inline
#include "linux/container_of.h"      // for container_of
#include "linux/export.h"            // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/init.h"              // for __init
#include "linux/irqflags.h"          // for irqs_disabled
#include "linux/kstrtox.h"           // for kstrtouint, kstrtoint, kstrtol
#include "linux/list.h"              // for list_add, list_del, LIST_HEAD
#include "linux/panic.h"             // for add_taint, LOCKDEP_STILL_OK, TAI...
#include "linux/printk.h"            // for pr_err, pr_debug, pr_notice, pr_...
#include "linux/spinlock.h"          // for spin_lock, spin_unlock
#include "linux/spinlock_types.h"    // for DEFINE_SPINLOCK
#include "linux/stddef.h"            // for false, true
#include "linux/sysfs.h"             // for attribute_group
#include "linux/types.h"             // for bool, list_head
struct module;
---
  ./scripts/check-local-export kernel/params.o
  iwyu2 -Wp,-MMD,kernel/.platform-feature.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/platform-feature"' -DKBUILD_BASENAME='"platform_feature"' -DKBUILD_MODNAME='"platform_feature"' -D__KBUILD_MODNAME=kmod_platform_feature -c -o kernel/platform-feature.o kernel/platform-feature.c  

kernel/platform-feature.c should add these lines:
#include <asm/bitops.h>                              // for test_bit
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm/cache.h"                               // for __read_mostly
#include "linux/types.h"                             // for bool

kernel/platform-feature.c should remove these lines:
- #include <linux/cache.h>  // lines 4-4

The full include-list for kernel/platform-feature.c:
#include <asm/bitops.h>                              // for test_bit
#include <linux/bitops.h>                            // for BITS_TO_LONGS
#include <linux/export.h>                            // for EXPORT_SYMBOL_GPL
#include <linux/platform-feature.h>                  // for PLATFORM_FEAT_N
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm/cache.h"                               // for __read_mostly
#include "linux/types.h"                             // for bool
---
  ./scripts/check-local-export kernel/platform-feature.o
  iwyu2 -Wp,-MMD,kernel/.kthread.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/kthread"' -DKBUILD_BASENAME='"kthread"' -DKBUILD_MODNAME='"kthread"' -D__KBUILD_MODNAME=kmod_kthread -c -o kernel/kthread.o kernel/kthread.c  
In file included from kernel/kthread.c:12:
In file included from ./include/linux/mmu_context.h:5:
In file included from ./arch/x86/include/asm/mmu_context.h:10:
In file included from ./include/trace/events/tlb.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/kthread.c:12:
In file included from ./include/linux/mmu_context.h:5:
In file included from ./arch/x86/include/asm/mmu_context.h:10:
In file included from ./include/trace/events/tlb.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/kthread.c:12:
In file included from ./include/linux/mmu_context.h:5:
In file included from ./arch/x86/include/asm/mmu_context.h:10:
In file included from ./include/trace/events/tlb.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/kthread.c:19:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from kernel/kthread.c:12:
In file included from ./include/linux/mmu_context.h:5:
In file included from ./arch/x86/include/asm/mmu_context.h:10:
In file included from ./include/trace/events/tlb.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/kthread.c:12:
In file included from ./include/linux/mmu_context.h:5:
In file included from ./arch/x86/include/asm/mmu_context.h:10:
In file included from ./include/trace/events/tlb.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/kthread.c:12:
In file included from ./include/linux/mmu_context.h:5:
In file included from ./arch/x86/include/asm/mmu_context.h:10:
In file included from ./include/trace/events/tlb.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/kthread.c:19:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/kthread.c should add these lines:
#include <asm/barrier.h>                             // for smp_mb
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON_ONCE
#include <signal.h>                                  // for SIGCHLD
#include <cstdio>                                    // for NULL, va_list
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit, clear_bit
#include "asm-generic/errno-base.h"                  // for EINTR, ENOMEM
#include "asm-generic/errno.h"                       // for ENOSYS
#include "asm-generic/topology.h"                    // for cpu_to_node
#include "asm/cmpxchg.h"                             // for __xchg_wrong_size
#include "asm/current.h"                             // for current
#include "asm/mmu_context.h"                         // for enter_lazy_tlb
#include "asm/string_32.h"                           // for memset
#include "linux/atomic/atomic-instrumented.h"        // for xchg
#include "linux/compiler.h"                          // for unlikely, likely
#include "linux/compiler_attributes.h"               // for __noreturn, __pr...
#include "linux/compiler_types.h"                    // for inline
#include "linux/container_of.h"                      // for container_of
#include "linux/cpumask.h"                           // for cpumask (ptr only)
#include "linux/gfp.h"                               // for GFP_KERNEL
#include "linux/irqflags.h"                          // for local_irq_disable
#include "linux/jiffies.h"                           // for jiffies
#include "linux/kernel.h"                            // for do_exit, kvasprintf
#include "linux/list.h"                              // for list_empty, list...
#include "linux/lockdep.h"                           // for lockdep_assert_held
#include "linux/nodemask.h"                          // for N_MEMORY, node_s...
#include "linux/preempt.h"                           // for preempt_disable
#include "linux/sched.h"                             // for task_struct (ptr...
#include "linux/sched/signal.h"                      // for ignore_signals
#include "linux/spinlock.h"                          // for spin_lock, spin_...
#include "linux/spinlock_types.h"                    // for DEFINE_SPINLOCK
#include "linux/stdarg.h"                            // for va_end, va_start
#include "linux/stddef.h"                            // for false, true
#include "linux/string.h"                            // for strscpy_pad
#include "linux/timer.h"                             // for add_timer, timer...
#include "linux/types.h"                             // for bool, list_head
struct lock_class_key;
struct mm_struct;

kernel/kthread.c should remove these lines:
- #include <linux/file.h>  // lines 22-22
- #include <linux/mmu_context.h>  // lines 12-12
- #include <linux/mutex.h>  // lines 24-24
- #include <linux/ptrace.h>  // lines 27-27
- #include <linux/unistd.h>  // lines 21-21

The full include-list for kernel/kthread.c:
#include <asm/barrier.h>                             // for smp_mb
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON_ONCE
#include <linux/cgroup.h>                            // for cgroup_init_kthr...
#include <linux/completion.h>                        // for complete, wait_f...
#include <linux/cpuset.h>                            // for set_mems_allowed
#include <linux/err.h>                               // for ERR_PTR, IS_ERR
#include <linux/export.h>                            // for EXPORT_SYMBOL_GPL
#include <linux/freezer.h>                           // for freezing, __refr...
#include <linux/kthread.h>                           // for kthread_work
#include <linux/mm.h>                                // for sync_mm_rss
#include <linux/numa.h>                              // for NUMA_NO_NODE
#include <linux/sched.h>                             // for task_struct, wak...
#include <linux/sched/isolation.h>                   // for housekeeping_cpu...
#include <linux/sched/mm.h>                          // for membarrier_updat...
#include <linux/sched/task.h>                        // for task_lock, task_...
#include <linux/slab.h>                              // for kfree, kzalloc
#include <linux/uaccess.h>                           // for copy_from_kernel...
#include <signal.h>                                  // for SIGCHLD
#include <trace/events/sched.h>                      // for trace_sched_kthr...
#include <uapi/linux/sched/types.h>                  // for sched_param
#include <cstdio>                                    // for NULL, va_list
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit, clear_bit
#include "asm-generic/errno-base.h"                  // for EINTR, ENOMEM
#include "asm-generic/errno.h"                       // for ENOSYS
#include "asm-generic/topology.h"                    // for cpu_to_node
#include "asm/cmpxchg.h"                             // for __xchg_wrong_size
#include "asm/current.h"                             // for current
#include "asm/mmu_context.h"                         // for enter_lazy_tlb
#include "asm/string_32.h"                           // for memset
#include "linux/atomic/atomic-instrumented.h"        // for xchg
#include "linux/compiler.h"                          // for unlikely, likely
#include "linux/compiler_attributes.h"               // for __noreturn, __pr...
#include "linux/compiler_types.h"                    // for inline
#include "linux/container_of.h"                      // for container_of
#include "linux/cpumask.h"                           // for cpumask (ptr only)
#include "linux/gfp.h"                               // for GFP_KERNEL
#include "linux/irqflags.h"                          // for local_irq_disable
#include "linux/jiffies.h"                           // for jiffies
#include "linux/kernel.h"                            // for do_exit, kvasprintf
#include "linux/list.h"                              // for list_empty, list...
#include "linux/lockdep.h"                           // for lockdep_assert_held
#include "linux/nodemask.h"                          // for N_MEMORY, node_s...
#include "linux/preempt.h"                           // for preempt_disable
#include "linux/sched.h"                             // for task_struct (ptr...
#include "linux/sched/signal.h"                      // for ignore_signals
#include "linux/spinlock.h"                          // for spin_lock, spin_...
#include "linux/spinlock_types.h"                    // for DEFINE_SPINLOCK
#include "linux/stdarg.h"                            // for va_end, va_start
#include "linux/stddef.h"                            // for false, true
#include "linux/string.h"                            // for strscpy_pad
#include "linux/timer.h"                             // for add_timer, timer...
#include "linux/types.h"                             // for bool, list_head
struct lock_class_key;
struct mm_struct;
---
  ./scripts/check-local-export kernel/kthread.o
  iwyu2 -Wp,-MMD,kernel/.sys_ni.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/sys_ni"' -DKBUILD_BASENAME='"sys_ni"' -DKBUILD_MODNAME='"sys_ni"' -D__KBUILD_MODNAME=kmod_sys_ni -c -o kernel/sys_ni.o kernel/sys_ni.c  

kernel/sys_ni.c should add these lines:
#include "asm-generic/errno.h"    // for ENOSYS
struct pt_regs;

kernel/sys_ni.c should remove these lines:
- #include <asm/unistd.h>  // lines 6-6
- #include <linux/errno.h>  // lines 4-4

The full include-list for kernel/sys_ni.c:
#include <asm/syscall_wrapper.h>  // for COND_SYSCALL
#include <linux/linkage.h>        // for cond_syscall, asmlinkage
#include "asm-generic/errno.h"    // for ENOSYS
struct pt_regs;
---
  ./scripts/check-local-export kernel/sys_ni.o
  iwyu2 -Wp,-MMD,kernel/.nsproxy.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/nsproxy"' -DKBUILD_BASENAME='"nsproxy"' -DKBUILD_MODNAME='"nsproxy"' -D__KBUILD_MODNAME=kmod_nsproxy -c -o kernel/nsproxy.o kernel/nsproxy.c  
In file included from kernel/nsproxy.c:15:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/nsproxy.c:15:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/nsproxy.c:15:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/nsproxy.c:15:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from kernel/nsproxy.c:26:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
5 warnings generated.
In file included from kernel/nsproxy.c:15:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/nsproxy.c:15:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/nsproxy.c:15:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/nsproxy.c:15:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from kernel/nsproxy.c:26:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

kernel/nsproxy.c should add these lines:
#include <stddef.h>                            // for NULL
#include "asm-generic/errno-base.h"            // for EINVAL, EPERM, ENOMEM
#include "asm/current.h"                       // for current
#include "asm/ptrace.h"                        // for pt_regs
#include "linux/atomic/atomic-instrumented.h"  // for atomic_set
#include "linux/capability.h"                  // for ns_capable, CAP_SYS_ADMIN
#include "linux/compiler.h"                    // for likely
#include "linux/compiler_types.h"              // for inline
#include "linux/cred.h"                        // for current_user_ns, cred
#include "linux/err.h"                         // for IS_ERR, PTR_ERR, ERR_PTR
#include "linux/fs.h"                          // for file_inode, file, inode
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/init.h"                        // for __init
#include "linux/kernel.h"                      // for might_sleep
#include "linux/ns_common.h"                   // for ns_common
#include "linux/pid.h"                         // for pid_task, pidfd_pid
#include "linux/ptrace.h"                      // for ptrace_may_access, PTR...
#include "linux/rcupdate.h"                    // for rcu_read_unlock, rcu_r...
#include "linux/sched.h"                       // for task_struct, CLONE_NEWNS
#include "linux/sched/task.h"                  // for task_lock, task_unlock
#include "linux/types.h"                       // for ATOMIC_INIT
#include "linux/user_namespace.h"              // for put_user_ns, user_name...

kernel/nsproxy.c should remove these lines:
- #include <linux/export.h>  // lines 13-13
- #include <linux/init_task.h>  // lines 15-15

The full include-list for kernel/nsproxy.c:
#include <linux/cgroup.h>                      // for put_cgroup_ns, copy_cg...
#include <linux/file.h>                        // for fget, fput
#include <linux/fs_struct.h>                   // for copy_fs_struct, free_f...
#include <linux/ipc_namespace.h>               // for put_ipc_ns, copy_ipcs
#include <linux/mnt_namespace.h>               // for put_mnt_ns, copy_mnt_ns
#include <linux/nsproxy.h>                     // for nsproxy, nsset, get_ns...
#include <linux/perf_event.h>                  // for perf_event_namespaces
#include <linux/pid_namespace.h>               // for put_pid_ns, copy_pid_ns
#include <linux/proc_fs.h>                     // for proc_ns_file
#include <linux/proc_ns.h>                     // for proc_ns_operations
#include <linux/slab.h>                        // for kmem_cache_free, kmem_...
#include <linux/syscalls.h>                    // for __MAP2, SYSCALL_DEFINE2
#include <linux/time_namespace.h>              // for put_time_ns, copy_time_ns
#include <linux/utsname.h>                     // for put_uts_ns, copy_utsname
#include <net/net_namespace.h>                 // for put_net, copy_net_ns
#include <stddef.h>                            // for NULL
#include "asm-generic/errno-base.h"            // for EINVAL, EPERM, ENOMEM
#include "asm/current.h"                       // for current
#include "asm/ptrace.h"                        // for pt_regs
#include "linux/atomic/atomic-instrumented.h"  // for atomic_set
#include "linux/capability.h"                  // for ns_capable, CAP_SYS_ADMIN
#include "linux/compiler.h"                    // for likely
#include "linux/compiler_types.h"              // for inline
#include "linux/cred.h"                        // for current_user_ns, cred
#include "linux/err.h"                         // for IS_ERR, PTR_ERR, ERR_PTR
#include "linux/fs.h"                          // for file_inode, file, inode
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/init.h"                        // for __init
#include "linux/kernel.h"                      // for might_sleep
#include "linux/ns_common.h"                   // for ns_common
#include "linux/pid.h"                         // for pid_task, pidfd_pid
#include "linux/ptrace.h"                      // for ptrace_may_access, PTR...
#include "linux/rcupdate.h"                    // for rcu_read_unlock, rcu_r...
#include "linux/sched.h"                       // for task_struct, CLONE_NEWNS
#include "linux/sched/task.h"                  // for task_lock, task_unlock
#include "linux/types.h"                       // for ATOMIC_INIT
#include "linux/user_namespace.h"              // for put_user_ns, user_name...
---
  ./scripts/check-local-export kernel/nsproxy.o
  iwyu2 -Wp,-MMD,kernel/.notifier.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/notifier"' -DKBUILD_BASENAME='"notifier"' -DKBUILD_MODNAME='"notifier"' -D__KBUILD_MODNAME=kmod_notifier -c -o kernel/notifier.o kernel/notifier.c  

kernel/notifier.c should add these lines:
#include <asm/bug.h>                 // for WARN
#include <linux/linkage.h>           // for notrace
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EBUSY, EEXIST, ENOENT
#include "asm-generic/kprobes.h"     // for NOKPROBE_SYMBOL
#include "asm/bug.h"                 // for BUG
#include "asm/kdebug.h"              // for die_val
#include "linux/compiler.h"          // for unlikely
#include "linux/kernel.h"            // for SYSTEM_BOOTING, system_state
#include "linux/mutex.h"             // for mutex_lock, mutex_unlock, mutex_...
#include "linux/rwsem.h"             // for down_read, down_write, up_read
#include "linux/spinlock.h"          // for spin_unlock_irqrestore, spin_loc...
#include "linux/srcu.h"              // for init_srcu_struct, srcu_read_lock
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool
struct pt_regs;

kernel/notifier.c should remove these lines:
- #include <linux/kprobes.h>  // lines 3-3
- #include <linux/reboot.h>  // lines 8-8
- #include <linux/vmalloc.h>  // lines 7-7

The full include-list for kernel/notifier.c:
#include <asm/bug.h>                 // for WARN
#include <linux/export.h>            // for EXPORT_SYMBOL_GPL
#include <linux/kdebug.h>            // for die_args, notify_die, register_d...
#include <linux/linkage.h>           // for notrace
#include <linux/notifier.h>          // for blocking_notifier_head, atomic_n...
#include <linux/rcupdate.h>          // for rcu_access_pointer, rcu_is_watching
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EBUSY, EEXIST, ENOENT
#include "asm-generic/kprobes.h"     // for NOKPROBE_SYMBOL
#include "asm/bug.h"                 // for BUG
#include "asm/kdebug.h"              // for die_val
#include "linux/compiler.h"          // for unlikely
#include "linux/kernel.h"            // for SYSTEM_BOOTING, system_state
#include "linux/mutex.h"             // for mutex_lock, mutex_unlock, mutex_...
#include "linux/rwsem.h"             // for down_read, down_write, up_read
#include "linux/spinlock.h"          // for spin_unlock_irqrestore, spin_loc...
#include "linux/srcu.h"              // for init_srcu_struct, srcu_read_lock
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool
struct pt_regs;
---
  ./scripts/check-local-export kernel/notifier.o
  iwyu2 -Wp,-MMD,kernel/.ksysfs.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/ksysfs"' -DKBUILD_BASENAME='"ksysfs"' -DKBUILD_MODNAME='"ksysfs"' -D__KBUILD_MODNAME=kmod_ksysfs -c -o kernel/ksysfs.o kernel/ksysfs.c  

kernel/ksysfs.c should add these lines:
#include <cstdio>                       // for ssize_t, NULL, size_t
#include "asm-generic/errno-base.h"     // for ENOMEM
#include "asm/string_32.h"              // for memcpy
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/kernel.h"               // for sprintf
#include "linux/types.h"                // for loff_t
struct file;

kernel/ksysfs.c should remove these lines:
- #include <linux/compiler.h>  // lines 19-19
- #include <linux/kexec.h>  // lines 14-14
- #include <linux/profile.h>  // lines 15-15
- #include <linux/rcupdate.h>  // lines 21-21
- #include <linux/sched.h>  // lines 17-17
- #include <linux/string.h>  // lines 10-10

The full include-list for kernel/ksysfs.c:
#include <linux/capability.h>           // for file_caps_enabled
#include <linux/export.h>               // for EXPORT_SYMBOL_GPL
#include <linux/init.h>                 // for __init, core_initcall
#include <linux/kobject.h>              // for kobj_attribute, kobject_creat...
#include <linux/stat.h>                 // for S_IRUGO
#include <linux/sysfs.h>                // for __ATTR_RO, sysfs_create_bin_file
#include <cstdio>                       // for ssize_t, NULL, size_t
#include "asm-generic/errno-base.h"     // for ENOMEM
#include "asm/string_32.h"              // for memcpy
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/kernel.h"               // for sprintf
#include "linux/types.h"                // for loff_t
struct file;
---
  ./scripts/check-local-export kernel/ksysfs.o
  iwyu2 -Wp,-MMD,kernel/.cred.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/cred"' -DKBUILD_BASENAME='"cred"' -DKBUILD_MODNAME='"cred"' -D__KBUILD_MODNAME=kmod_cred -c -o kernel/cred.o kernel/cred.c  
In file included from kernel/cred.c:14:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/cred.c:14:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/cred.c:14:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/cred.c:14:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
4 warnings generated.
In file included from kernel/cred.c:14:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/cred.c:14:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/cred.c:14:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from kernel/cred.c:14:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^

kernel/cred.c should add these lines:
#include <asm/barrier.h>                       // for smp_wmb
#include <asm/bug.h>                           // for BUG_ON
#include <stddef.h>                            // for NULL
#include "asm-generic/errno-base.h"            // for EAGAIN, EINVAL, ENOMEM
#include "asm-generic/int-ll64.h"              // for u32
#include "asm/current.h"                       // for current
#include "asm/string_32.h"                     // for strlen, memcpy
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_set
#include "linux/capability.h"                  // for CAP_FULL_SET, cap_issu...
#include "linux/cn_proc.h"                     // for PROC_EVENT_GID, PROC_E...
#include "linux/compiler_types.h"              // for inline
#include "linux/container_of.h"                // for container_of
#include "linux/fs.h"                          // for inode
#include "linux/gfp.h"                         // for GFP_KERNEL, GFP_KERNEL...
#include "linux/init.h"                        // for __init
#include "linux/panic.h"                       // for panic
#include "linux/printk.h"                      // for no_printk
#include "linux/rcupdate.h"                    // for rcu_assign_pointer
#include "linux/sched.h"                       // for task_struct (ptr only)
#include "linux/sched/user.h"                  // for get_uid, free_uid, INI...
#include "linux/securebits.h"                  // for SECUREBITS_DEFAULT
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for ATOMIC_INIT, bool, rcu...
#include "linux/user_namespace.h"              // for inc_rlimit_ucounts

kernel/cred.c should remove these lines:
- #include <linux/init_task.h>  // lines 14-14

The full include-list for kernel/cred.c:
#include <asm/barrier.h>                       // for smp_wmb
#include <asm/bug.h>                           // for BUG_ON
#include <linux/binfmts.h>                     // for suid_dumpable
#include <linux/cn_proc.h>                     // for proc_id_connector
#include <linux/cred.h>                        // for cred, put_cred, valida...
#include <linux/export.h>                      // for EXPORT_SYMBOL
#include <linux/key.h>                         // for key_put, key_fsgid_cha...
#include <linux/sched.h>                       // for task_struct
#include <linux/sched/coredump.h>              // for set_dumpable
#include <linux/security.h>                    // for security_prepare_creds
#include <linux/slab.h>                        // for kmem_cache_alloc, kmem...
#include <linux/uidgid.h>                      // for uid_eq, gid_eq, gid_gt
#include <stddef.h>                            // for NULL
#include "asm-generic/errno-base.h"            // for EAGAIN, EINVAL, ENOMEM
#include "asm-generic/int-ll64.h"              // for u32
#include "asm/current.h"                       // for current
#include "asm/string_32.h"                     // for strlen, memcpy
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_set
#include "linux/capability.h"                  // for CAP_FULL_SET, cap_issu...
#include "linux/cn_proc.h"                     // for PROC_EVENT_GID, PROC_E...
#include "linux/compiler_types.h"              // for inline
#include "linux/container_of.h"                // for container_of
#include "linux/fs.h"                          // for inode
#include "linux/gfp.h"                         // for GFP_KERNEL, GFP_KERNEL...
#include "linux/init.h"                        // for __init
#include "linux/panic.h"                       // for panic
#include "linux/printk.h"                      // for no_printk
#include "linux/rcupdate.h"                    // for rcu_assign_pointer
#include "linux/sched.h"                       // for task_struct (ptr only)
#include "linux/sched/user.h"                  // for get_uid, free_uid, INI...
#include "linux/securebits.h"                  // for SECUREBITS_DEFAULT
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for ATOMIC_INIT, bool, rcu...
#include "linux/user_namespace.h"              // for inc_rlimit_ucounts
---
  ./scripts/check-local-export kernel/cred.o
  iwyu2 -Wp,-MMD,kernel/.reboot.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/reboot"' -DKBUILD_BASENAME='"reboot"' -DKBUILD_MODNAME='"reboot"' -D__KBUILD_MODNAME=kmod_reboot -c -o kernel/reboot.o kernel/reboot.c  
In file included from kernel/reboot.c:17:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/reboot.c:17:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/reboot.c:17:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/reboot.c:17:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from kernel/reboot.c:17:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from kernel/reboot.c:17:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/reboot.c:17:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/reboot.c:17:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/reboot.c should add these lines:
#include <asm/bug.h>                           // for WARN_ON
#include <asm/signal.h>                        // for SIGINT
#include <stddef.h>                            // for NULL
#include "asm-generic/errno-base.h"            // for EINVAL, ENOMEM, EBUSY
#include "asm/current.h"                       // for current
#include "asm/emergency-restart.h"             // for machine_emergency_restart
#include "asm/ptrace.h"                        // for pt_regs
#include "asm/string_32.h"                     // for strchr, strncmp, memset
#include "asm/uaccess.h"                       // for strncpy_from_user
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec_and_test
#include "linux/capability.h"                  // for ns_capable, CAP_SYS_BOOT
#include "linux/compiler_attributes.h"         // for __weak
#include "linux/compiler_types.h"              // for __user
#include "linux/container_of.h"                // for container_of
#include "linux/cpu.h"                         // for cpu_hotplug_disable
#include "linux/cpumask.h"                     // for cpu_online, cpumask_first
#include "linux/device.h"                      // for device_shutdown, devic...
#include "linux/err.h"                         // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/fs.h"                          // for emergency_sync
#include "linux/gfp.h"                         // for GFP_KERNEL, GFP_ATOMIC
#include "linux/init.h"                        // for __init, __setup
#include "linux/jiffies.h"                     // for msecs_to_jiffies
#include "linux/kernel.h"                      // for do_exit, system_state
#include "linux/kstrtox.h"                     // for simple_strtoul
#include "linux/mutex.h"                       // for mutex, mutex_lock, mut...
#include "linux/notifier.h"                    // for blocking_notifier_call...
#include "linux/pid_namespace.h"               // for reboot_pid_ns, task_ac...
#include "linux/printk.h"                      // for pr_emerg, pr_warn, pr_err
#include "linux/reboot.h"                      // for sys_off_data (ptr only)
#include "linux/sched.h"                       // for set_cpus_allowed_ptr
#include "linux/sched/signal.h"                // for kill_cad_pid
#include "linux/slab.h"                        // for kfree, kzalloc
#include "linux/stddef.h"                      // for true
#include "linux/string.h"                      // for argv_free, argv_split
#include "linux/types.h"                       // for bool, ATOMIC_INIT, ato...
#include "linux/umh.h"                         // for usermodehelper_disable
#include "linux/workqueue.h"                   // for work_struct, schedule_...

kernel/reboot.c should remove these lines:
- #include <linux/atomic.h>  // lines 10-10
- #include <linux/kexec.h>  // lines 13-13
- #include <linux/kmod.h>  // lines 14-14
- #include <linux/uaccess.h>  // lines 20-20

The full include-list for kernel/reboot.c:
#include <asm/bug.h>                           // for WARN_ON
#include <asm/signal.h>                        // for SIGINT
#include <linux/ctype.h>                       // for isdigit
#include <linux/export.h>                      // for EXPORT_SYMBOL_GPL, EXP...
#include <linux/kmsg_dump.h>                   // for kmsg_dump, KMSG_DUMP_S...
#include <linux/reboot.h>                      // for SYS_OFF_PRIO_DEFAULT
#include <linux/suspend.h>  // lines 17-17
#include <linux/syscalls.h>                    // for __MAP4, SYSCALL_DEFINE4
#include <linux/syscore_ops.h>                 // for syscore_shutdown
#include <stddef.h>                            // for NULL
#include "asm-generic/errno-base.h"            // for EINVAL, ENOMEM, EBUSY
#include "asm/current.h"                       // for current
#include "asm/emergency-restart.h"             // for machine_emergency_restart
#include "asm/ptrace.h"                        // for pt_regs
#include "asm/string_32.h"                     // for strchr, strncmp, memset
#include "asm/uaccess.h"                       // for strncpy_from_user
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec_and_test
#include "linux/capability.h"                  // for ns_capable, CAP_SYS_BOOT
#include "linux/compiler_attributes.h"         // for __weak
#include "linux/compiler_types.h"              // for __user
#include "linux/container_of.h"                // for container_of
#include "linux/cpu.h"                         // for cpu_hotplug_disable
#include "linux/cpumask.h"                     // for cpu_online, cpumask_first
#include "linux/device.h"                      // for device_shutdown, devic...
#include "linux/err.h"                         // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/fs.h"                          // for emergency_sync
#include "linux/gfp.h"                         // for GFP_KERNEL, GFP_ATOMIC
#include "linux/init.h"                        // for __init, __setup
#include "linux/jiffies.h"                     // for msecs_to_jiffies
#include "linux/kernel.h"                      // for do_exit, system_state
#include "linux/kstrtox.h"                     // for simple_strtoul
#include "linux/mutex.h"                       // for mutex, mutex_lock, mut...
#include "linux/notifier.h"                    // for blocking_notifier_call...
#include "linux/pid_namespace.h"               // for reboot_pid_ns, task_ac...
#include "linux/printk.h"                      // for pr_emerg, pr_warn, pr_err
#include "linux/reboot.h"                      // for sys_off_data (ptr only)
#include "linux/sched.h"                       // for set_cpus_allowed_ptr
#include "linux/sched/signal.h"                // for kill_cad_pid
#include "linux/slab.h"                        // for kfree, kzalloc
#include "linux/stddef.h"                      // for true
#include "linux/string.h"                      // for argv_free, argv_split
#include "linux/types.h"                       // for bool, ATOMIC_INIT, ato...
#include "linux/umh.h"                         // for usermodehelper_disable
#include "linux/workqueue.h"                   // for work_struct, schedule_...
---
  ./scripts/check-local-export kernel/reboot.o
  iwyu2 -Wp,-MMD,kernel/.async.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/async"' -DKBUILD_BASENAME='"async"' -DKBUILD_MODNAME='"async"' -D__KBUILD_MODNAME=kmod_async -c -o kernel/async.o kernel/async.c  
In file included from kernel/async.c:47:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/async.c:47:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/async.c:47:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/async.c:47:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/async.c:47:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/async.c:47:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

include/linux/async.h should add these lines:
#include "asm-generic/int-ll64.h"  // for u64
#include "linux/compiler_types.h"  // for inline

include/linux/async.h should remove these lines:

The full include-list for include/linux/async.h:
#include <linux/device.h>          // for dev_to_node
#include <linux/list.h>            // for LIST_HEAD_INIT
#include <linux/numa.h>            // for NUMA_NO_NODE
#include <linux/types.h>           // for bool, list_head
#include "asm-generic/int-ll64.h"  // for u64
#include "linux/compiler_types.h"  // for inline
---

kernel/async.c should add these lines:
#include <stddef.h>                            // for NULL
#include "asm/current.h"                       // for current
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec, atomic_inc
#include "linux/container_of.h"                // for container_of
#include "linux/gfp.h"                         // for GFP_ATOMIC
#include "linux/list.h"                        // for INIT_LIST_HEAD, list_a...
#include "linux/printk.h"                      // for pr_debug
#include "linux/spinlock.h"                    // for spin_unlock_irqrestore
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK
#include "linux/types.h"                       // for list_head, atomic_t, bool
#include "vdso/limits.h"                       // for ULLONG_MAX

kernel/async.c should remove these lines:
- #include <linux/atomic.h>  // lines 48-48

The full include-list for kernel/async.c:
#include <linux/async.h>
#include <linux/export.h>                      // for EXPORT_SYMBOL_GPL
#include <linux/ktime.h>                       // for ktime_get, ktime_t
#include <linux/sched.h>                       // for task_pid_nr
#include <linux/slab.h>                        // for kfree, kzalloc
#include <linux/wait.h>                        // for wait_queue_head, DECLA...
#include <linux/workqueue.h>                   // for work_struct, queue_wor...
#include <stddef.h>                            // for NULL
#include "asm/current.h"                       // for current
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec, atomic_inc
#include "linux/container_of.h"                // for container_of
#include "linux/gfp.h"                         // for GFP_ATOMIC
#include "linux/list.h"                        // for INIT_LIST_HEAD, list_a...
#include "linux/printk.h"                      // for pr_debug
#include "linux/spinlock.h"                    // for spin_unlock_irqrestore
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK
#include "linux/types.h"                       // for list_head, atomic_t, bool
#include "vdso/limits.h"                       // for ULLONG_MAX
#include "workqueue_internal.h"                // for current_wq_worker, worker
---
  ./scripts/check-local-export kernel/async.o
  iwyu2 -Wp,-MMD,kernel/.range.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/range"' -DKBUILD_BASENAME='"range"' -DKBUILD_MODNAME='"range"' -D__KBUILD_MODNAME=kmod_range -c -o kernel/range.o kernel/range.c  

kernel/range.c should add these lines:
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u64
#include "asm/string_32.h"         // for memmove

kernel/range.c should remove these lines:
- #include <linux/init.h>  // lines 5-5
- #include <linux/string.h>  // lines 9-9

The full include-list for kernel/range.c:
#include <linux/minmax.h>          // for max, min
#include <linux/printk.h>          // for pr_err
#include <linux/range.h>           // for range, add_range, add_range_with_m...
#include <linux/sort.h>            // for sort
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u64
#include "asm/string_32.h"         // for memmove
---
  ./scripts/check-local-export kernel/range.o
  iwyu2 -Wp,-MMD,kernel/.smpboot.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/smpboot"' -DKBUILD_BASENAME='"smpboot"' -DKBUILD_MODNAME='"smpboot"' -D__KBUILD_MODNAME=kmod_smpboot -c -o kernel/smpboot.o kernel/smpboot.c  
In file included from kernel/smpboot.c:5:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/smpboot.c:5:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/smpboot.c:5:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/smpboot.c:5:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/smpboot.c:5:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/smpboot.c:5:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/smpboot.h should add these lines:
#include "linux/init.h"  // for __init

kernel/smpboot.h should remove these lines:
- struct task_struct;  // lines 5-5

The full include-list for kernel/smpboot.h:
#include "linux/init.h"  // for __init
---

kernel/smpboot.c should add these lines:
#include <asm-generic/percpu.h>                // for per_cpu_ptr, per_cpu
#include <asm/bug.h>                           // for BUG_ON, WARN_ON
#include <stddef.h>                            // for NULL
#include "asm-generic/errno-base.h"            // for EAGAIN, EBUSY, EIO
#include "asm-generic/topology.h"              // for cpu_to_node
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_set
#include "linux/cpumask.h"                     // for cpu_online, for_each_o...
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/mutex.h"                       // for mutex_lock, mutex_unlock
#include "linux/preempt.h"                     // for preempt_enable, preemp...
#include "linux/types.h"                       // for list_head, ATOMIC_INIT

kernel/smpboot.c should remove these lines:
- #include <linux/delay.h>  // lines 8-8
- #include <linux/init.h>  // lines 9-9
- #include <linux/percpu.h>  // lines 15-15

The full include-list for kernel/smpboot.c:
#include "smpboot.h"
#include <asm-generic/percpu.h>                // for per_cpu_ptr, per_cpu
#include <asm/bug.h>                           // for BUG_ON, WARN_ON
#include <linux/cpu.h>                         // for cpus_read_lock, cpus_r...
#include <linux/err.h>                         // for IS_ERR, PTR_ERR
#include <linux/export.h>                      // for EXPORT_SYMBOL_GPL
#include <linux/kthread.h>                     // for kthread_park, kthread_...
#include <linux/list.h>                        // for list_add, list_del
#include <linux/sched.h>                       // for task_struct, TASK_RUNNING
#include <linux/sched/task.h>                  // for get_task_struct, put_t...
#include <linux/slab.h>                        // for kfree, kzalloc_node
#include <linux/smp.h>                         // for smp_processor_id
#include <linux/smpboot.h>                     // for smp_hotplug_thread
#include <stddef.h>                            // for NULL
#include "asm-generic/errno-base.h"            // for EAGAIN, EBUSY, EIO
#include "asm-generic/topology.h"              // for cpu_to_node
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_set
#include "linux/cpumask.h"                     // for cpu_online, for_each_o...
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/mutex.h"                       // for mutex_lock, mutex_unlock
#include "linux/preempt.h"                     // for preempt_enable, preemp...
#include "linux/types.h"                       // for list_head, ATOMIC_INIT
---
  ./scripts/check-local-export kernel/smpboot.o
  iwyu2 -Wp,-MMD,kernel/.ucount.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/ucount"' -DKBUILD_BASENAME='"ucount"' -DKBUILD_MODNAME='"ucount"' -D__KBUILD_MODNAME=kmod_ucount -c -o kernel/ucount.o kernel/ucount.c  

kernel/ucount.c should add these lines:
#include <asm/bug.h>                           // for WARN_ON_ONCE
#include <linux/atomic.h>                      // for atomic_long_t
#include <stddef.h>                            // for NULL
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_sub_return
#include "linux/compiler.h"                    // for likely, unlikely
#include "linux/compiler_types.h"              // for inline
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/init.h"                        // for __init, subsys_initcall
#include "linux/list.h"                        // for hlist_add_head, hlist_...
#include "linux/spinlock.h"                    // for spin_unlock_irq, spin_...
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK
#include "linux/stddef.h"                      // for true, false
#include "linux/types.h"                       // for bool, hlist_head, hlis...
#include "linux/uidgid.h"                      // for __kuid_val, kuid_t
#include "vdso/limits.h"                       // for LONG_MAX

kernel/ucount.c should remove these lines:
- #include <linux/cred.h>  // lines 6-6
- #include <linux/kmemleak.h>  // lines 8-8
- #include <linux/stat.h>  // lines 3-3
- #include <linux/sysctl.h>  // lines 4-4

The full include-list for kernel/ucount.c:
#include <asm/bug.h>                           // for WARN_ON_ONCE
#include <linux/atomic.h>                      // for atomic_long_t
#include <linux/hash.h>                        // for hash_long
#include <linux/slab.h>                        // for kfree, kzalloc
#include <linux/user_namespace.h>              // for ucounts, user_namespace
#include <stddef.h>                            // for NULL
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_sub_return
#include "linux/compiler.h"                    // for likely, unlikely
#include "linux/compiler_types.h"              // for inline
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/init.h"                        // for __init, subsys_initcall
#include "linux/list.h"                        // for hlist_add_head, hlist_...
#include "linux/spinlock.h"                    // for spin_unlock_irq, spin_...
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK
#include "linux/stddef.h"                      // for true, false
#include "linux/types.h"                       // for bool, hlist_head, hlis...
#include "linux/uidgid.h"                      // for __kuid_val, kuid_t
#include "vdso/limits.h"                       // for LONG_MAX
---
  ./scripts/check-local-export kernel/ucount.o
  iwyu2 -Wp,-MMD,kernel/.regset.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/regset"' -DKBUILD_BASENAME='"regset"' -DKBUILD_MODNAME='"regset"' -D__KBUILD_MODNAME=kmod_regset -c -o kernel/regset.o kernel/regset.c  

kernel/regset.c should add these lines:
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EFAULT, ENOMEM
#include "asm-generic/errno.h"       // for EOPNOTSUPP
#include "linux/compiler_types.h"    // for __user
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/uaccess.h"           // for copy_to_user
struct task_struct;

kernel/regset.c should remove these lines:

The full include-list for kernel/regset.c:
#include <linux/export.h>            // for EXPORT_SYMBOL
#include <linux/regset.h>            // for user_regset, copy_regset_to_user
#include <linux/slab.h>              // for kfree, kzalloc
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EFAULT, ENOMEM
#include "asm-generic/errno.h"       // for EOPNOTSUPP
#include "linux/compiler_types.h"    // for __user
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/uaccess.h"           // for copy_to_user
struct task_struct;
---
  ./scripts/check-local-export kernel/regset.o
  iwyu2 -Wp,-MMD,kernel/.dma.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/dma"' -DKBUILD_BASENAME='"dma"' -DKBUILD_MODNAME='"dma"' -D__KBUILD_MODNAME=kmod_dma -c -o kernel/dma.o kernel/dma.c  

kernel/dma.c should add these lines:
#include "asm-generic/errno-base.h"            // for EBUSY, EINVAL
#include "asm/cmpxchg.h"                       // for __xchg_wrong_size
#include "linux/atomic/atomic-instrumented.h"  // for xchg
#include "linux/kern_levels.h"                 // for KERN_WARNING
#include "linux/printk.h"                      // for printk
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK

kernel/dma.c should remove these lines:
- #include <linux/errno.h>  // lines 15-15
- #include <linux/init.h>  // lines 20-20
- #include <linux/kernel.h>  // lines 14-14
- #include <linux/proc_fs.h>  // lines 19-19
- #include <linux/seq_file.h>  // lines 18-18
- #include <linux/spinlock.h>  // lines 16-16
- #include <linux/string.h>  // lines 17-17

The full include-list for kernel/dma.c:
#include <asm/dma.h>                           // for MAX_DMA_CHANNELS, free...
#include <linux/export.h>                      // for EXPORT_SYMBOL
#include "asm-generic/errno-base.h"            // for EBUSY, EINVAL
#include "asm/cmpxchg.h"                       // for __xchg_wrong_size
#include "linux/atomic/atomic-instrumented.h"  // for xchg
#include "linux/kern_levels.h"                 // for KERN_WARNING
#include "linux/printk.h"                      // for printk
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK
---
  ./scripts/check-local-export kernel/dma.o
  iwyu2 -Wp,-MMD,kernel/.up.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/up"' -DKBUILD_BASENAME='"up"' -DKBUILD_MODNAME='"up"' -D__KBUILD_MODNAME=kmod_up -c -o kernel/up.o kernel/up.c  

kernel/up.c should add these lines:
#include "asm-generic/errno-base.h"  // for ENXIO
#include "linux/cpumask.h"           // for cpumask_test_cpu, cpumask (ptr o...
#include "linux/irqflags.h"          // for local_irq_restore, local_irq_save
#include "linux/preempt.h"           // for preempt_disable, preempt_enable
#include "linux/types.h"             // for bool

kernel/up.c should remove these lines:
- #include <linux/interrupt.h>  // lines 6-6
- #include <linux/kernel.h>  // lines 7-7

The full include-list for kernel/up.c:
#include <linux/export.h>            // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/hypervisor.h>        // for hypervisor_pin_vcpu
#include <linux/smp.h>               // for __call_single_data, on_each_cpu_...
#include "asm-generic/errno-base.h"  // for ENXIO
#include "linux/cpumask.h"           // for cpumask_test_cpu, cpumask (ptr o...
#include "linux/irqflags.h"          // for local_irq_restore, local_irq_save
#include "linux/preempt.h"           // for preempt_disable, preempt_enable
#include "linux/types.h"             // for bool
---
  ./scripts/check-local-export kernel/up.o
  iwyu2 -Wp,-MMD,kernel/.irq_work.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/irq_work"' -DKBUILD_BASENAME='"irq_work"' -DKBUILD_MODNAME='"irq_work"' -D__KBUILD_MODNAME=kmod_irq_work -c -o kernel/irq_work.o kernel/irq_work.c  

kernel/irq_work.c should add these lines:
#include <asm-generic/percpu.h>                // for this_cpu_ptr, DEFINE_P...
#include <asm/barrier.h>                       // for smp_mb
#include <asm/bug.h>                           // for BUG_ON, WARN_ON_ONCE
#include <asm/percpu.h>                        // for raw_cpu_read_8
#include "asm/current.h"                       // for current
#include "asm/irq_work.h"                      // for arch_irq_work_has_inte...
#include "asm/percpu.h"                        // for __pcpu_op2_1, __pcpu_o...
#include "asm/vdso/processor.h"                // for cpu_relax
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_cm...
#include "linux/compiler_attributes.h"         // for __weak
#include "linux/cpumask.h"                     // for cpu_is_offline
#include "linux/init.h"                        // for __init, early_initcall
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/llist.h"                       // for llist_empty, llist_add
#include "linux/lockdep.h"                     // for lockdep_assert_irqs_en...
#include "linux/preempt.h"                     // for preempt_disable, preem...
#include "linux/rcuwait.h"                     // for rcuwait_wake_up, rcuwa...
#include "linux/smp_types.h"                   // for __call_single_node
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for bool

kernel/irq_work.c should remove these lines:
- #include <asm/processor.h>  // lines 22-22
- #include <linux/bug.h>  // lines 9-9
- #include <linux/cpu.h>  // lines 18-18
- #include <linux/hardirq.h>  // lines 14-14
- #include <linux/kasan.h>  // lines 23-23
- #include <linux/notifier.h>  // lines 19-19
- #include <linux/percpu.h>  // lines 13-13

The full include-list for kernel/irq_work.c:
#include <asm-generic/percpu.h>                // for this_cpu_ptr, DEFINE_P...
#include <asm/barrier.h>                       // for smp_mb
#include <asm/bug.h>                           // for BUG_ON, WARN_ON_ONCE
#include <asm/percpu.h>                        // for raw_cpu_read_8
#include <linux/export.h>                      // for EXPORT_SYMBOL_GPL
#include <linux/irq_work.h>                    // for irq_work, irq_work_is_...
#include <linux/irqflags.h>                    // for irqs_disabled, lockdep...
#include <linux/kernel.h>                      // for might_sleep
#include <linux/sched.h>                       // for task_struct, sched_set...
#include <linux/smp.h>                         // for smp_processor_id
#include <linux/smpboot.h>                     // for smpboot_register_percp...
#include <linux/tick.h>                        // for tick_nohz_tick_stopped
#include "asm/current.h"                       // for current
#include "asm/irq_work.h"                      // for arch_irq_work_has_inte...
#include "asm/percpu.h"                        // for __pcpu_op2_1, __pcpu_o...
#include "asm/vdso/processor.h"                // for cpu_relax
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_cm...
#include "linux/compiler_attributes.h"         // for __weak
#include "linux/cpumask.h"                     // for cpu_is_offline
#include "linux/init.h"                        // for __init, early_initcall
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/llist.h"                       // for llist_empty, llist_add
#include "linux/lockdep.h"                     // for lockdep_assert_irqs_en...
#include "linux/preempt.h"                     // for preempt_disable, preem...
#include "linux/rcuwait.h"                     // for rcuwait_wake_up, rcuwa...
#include "linux/smp_types.h"                   // for __call_single_node
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for bool
---
  ./scripts/check-local-export kernel/irq_work.o
  iwyu2 -Wp,-MMD,kernel/.static_call.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/static_call"' -DKBUILD_BASENAME='"static_call"' -DKBUILD_MODNAME='"static_call"' -D__KBUILD_MODNAME=kmod_static_call -c -o kernel/static_call.o kernel/static_call.c  
In file included from kernel/static_call.c:2:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/static_call.c:2:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/static_call.c:2:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/static_call.c:2:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/static_call.c:2:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/static_call.c:2:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

include/linux/static_call.h should add these lines:
#include <stddef.h>                   // for NULL
#include "asm-generic/rwonce.h"       // for READ_ONCE, WRITE_ONCE
#include "linux/compiler_types.h"     // for inline
#include "linux/export.h"             // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/stddef.h"             // for false

include/linux/static_call.h should remove these lines:

The full include-list for include/linux/static_call.h:
#include <asm/static_call.h>          // for ARCH_DEFINE_STATIC_CALL_NULL_TRAMP
#include <linux/cpu.h>                // for cpus_read_lock, cpus_read_unlock
#include <linux/static_call_types.h>  // for STATIC_CALL_KEY, static_call_key
#include <linux/types.h>              // for bool
#include <stddef.h>                   // for NULL
#include "asm-generic/rwonce.h"       // for READ_ONCE, WRITE_ONCE
#include "linux/compiler_types.h"     // for inline
#include "linux/export.h"             // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/stddef.h"             // for false
---

(kernel/static_call.c has correct #includes/fwd-decls)
  ./scripts/check-local-export kernel/static_call.o
  iwyu2 -Wp,-MMD,kernel/.iomem.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"kernel/iomem"' -DKBUILD_BASENAME='"iomem"' -DKBUILD_MODNAME='"iomem"' -D__KBUILD_MODNAME=kmod_iomem -c -o kernel/iomem.o kernel/iomem.c  
In file included from kernel/iomem.c:2:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/iomem.c:2:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/iomem.c:2:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from kernel/iomem.c:2:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from kernel/iomem.c:2:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from kernel/iomem.c:2:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

kernel/iomem.c should add these lines:
#include <asm/bug.h>                   // for WARN_ONCE, WARN_ON
#include <stddef.h>                    // for NULL, size_t
#include "asm-generic/errno-base.h"    // for ENOMEM, ENXIO
#include "asm-generic/memory_model.h"  // for pfn_to_page
#include "asm/io.h"                    // for ioremap_cache, ioremap_wc, ior...
#include "asm/page.h"                  // for __va
#include "asm/page_32.h"               // for pfn_valid
#include "linux/compiler_types.h"      // for __force, __iomem
#include "linux/err.h"                 // for ERR_PTR
#include "linux/export.h"              // for EXPORT_SYMBOL
#include "linux/gfp.h"                 // for GFP_KERNEL
#include "linux/ioport.h"              // for IORESOURCE_SYSTEM_RAM, IORES_D...
#include "linux/pfn.h"                 // for PHYS_PFN
#include "linux/stddef.h"              // for true

kernel/iomem.c should remove these lines:

The full include-list for kernel/iomem.c:
#include <asm/bug.h>                   // for WARN_ONCE, WARN_ON
#include <linux/device.h>              // for dev_to_node, devres_add, devre...
#include <linux/io.h>                  // for MEMREMAP_WB, MEMREMAP_WC, MEMR...
#include <linux/mm.h>                  // for PageHighMem, region_intersects
#include <linux/types.h>               // for resource_size_t, bool
#include <stddef.h>                    // for NULL, size_t
#include "asm-generic/errno-base.h"    // for ENOMEM, ENXIO
#include "asm-generic/memory_model.h"  // for pfn_to_page
#include "asm/io.h"                    // for ioremap_cache, ioremap_wc, ior...
#include "asm/page.h"                  // for __va
#include "asm/page_32.h"               // for pfn_valid
#include "linux/compiler_types.h"      // for __force, __iomem
#include "linux/err.h"                 // for ERR_PTR
#include "linux/export.h"              // for EXPORT_SYMBOL
#include "linux/gfp.h"                 // for GFP_KERNEL
#include "linux/ioport.h"              // for IORESOURCE_SYSTEM_RAM, IORES_D...
#include "linux/pfn.h"                 // for PHYS_PFN
#include "linux/stddef.h"              // for true
---
  ./scripts/check-local-export kernel/iomem.o
  rm -f kernel/built-in.a; echo fork.o exec_domain.o panic.o cpu.o exit.o softirq.o resource.o sysctl.o capability.o ptrace.o user.o signal.o sys.o umh.o workqueue.o pid.o task_work.o extable.o params.o platform-feature.o kthread.o sys_ni.o nsproxy.o notifier.o ksysfs.o cred.o reboot.o async.o range.o smpboot.o ucount.o regset.o sched/built-in.a locking/built-in.a power/built-in.a printk/built-in.a irq/built-in.a rcu/built-in.a dma/built-in.a entry/built-in.a time/built-in.a dma.o up.o irq_work.o static_call.o events/built-in.a iomem.o | sed -E 's:([^ ]+):kernel/:g' | xargs llvm-ar cDPrST kernel/built-in.a
make -f ./scripts/Makefile.build obj=mm \
single-build= \
need-builtin=1 need-modorder=1
  iwyu2 -Wp,-MMD,mm/.filemap.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/filemap"' -DKBUILD_BASENAME='"filemap"' -DKBUILD_MODNAME='"filemap"' -D__KBUILD_MODNAME=kmod_filemap -c -o mm/filemap.o mm/filemap.c  
In file included from mm/filemap.c:23:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/filemap.c:23:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/filemap.c:23:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/filemap.c:23:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/filemap.c:40:
./include/linux/delayacct.h:27:44: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline int delayacct_add_tsk(struct taskstats *d,
                                           ^
5 warnings generated.
In file included from mm/filemap.c:23:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/filemap.c:23:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/filemap.c:23:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/filemap.c:23:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/filemap.c:40:
./include/linux/delayacct.h:27:44: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline int delayacct_add_tsk(struct taskstats *d,
                                           ^

mm/filemap.c should add these lines:
#include <asm/barrier.h>                             // for smp_load_acquire
#include <asm/bitops.h>                              // for test_bit, clear_...
#include <asm/bug.h>                                 // for WARN_ON_ONCE
#include <cstdio>                                    // for NULL, ssize_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for test_and_set_bit
#include "asm-generic/cacheflush.h"                  // for flush_dcache_page
#include "asm-generic/errno-base.h"                  // for EAGAIN, EIO, EEXIST
#include "asm-generic/error-injection.h"             // for ALLOW_ERROR_INJE...
#include "asm-generic/int-ll64.h"                    // for u64
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/rwonce.h"                      // for READ_ONCE, WRITE...
#include "asm/bug.h"                                 // for BUG
#include "asm/current.h"                             // for current
#include "asm/page_types.h"                          // for PAGE_SHIFT, PAGE...
#include "asm/pgtable-2level_types.h"                // for pte_t
#include "asm/pgtable.h"                             // for pmd_none, pte_none
#include "asm/vdso/processor.h"                      // for cpu_relax
#include "linux/build_bug.h"                         // for BUILD_BUG_ON
#include "linux/cache.h"                             // for __cacheline_aligned
#include "linux/cacheflush.h"                        // for flush_dcache_folio
#include "linux/compiler_attributes.h"               // for noinline
#include "linux/compiler_types.h"                    // for inline
#include "linux/container_of.h"                      // for container_of
#include "linux/err.h"                               // for ERR_PTR, IS_ERR
#include "linux/errno.h"                             // for EIOCBQUEUED
#include "linux/errseq.h"                            // for errseq_t, errseq...
#include "linux/fs.h"                                // for address_space (p...
#include "linux/huge_mm.h"                           // for folio_test_pmd_m...
#include "linux/init.h"                              // for __init
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/list.h"                              // for INIT_LIST_HEAD
#include "linux/math.h"                              // for DIV_ROUND_UP
#include "linux/minmax.h"                            // for min_t, max, max_t
#include "linux/mm_types.h"                          // for folio, folio::(a...
#include "linux/mmap_lock.h"                         // for mmap_read_unlock
#include "linux/mmdebug.h"                           // for VM_BUG_ON_FOLIO
#include "linux/mmzone.h"                            // for NR_FILE_PAGES
#include "linux/page_ref.h"                          // for folio_try_get_rcu
#include "linux/panic.h"                             // for add_taint, LOCKD...
#include "linux/pgtable.h"                           // for pmd_devmap_trans...
#include "linux/printk.h"                            // for dump_stack, pr_crit
#include "linux/ratelimit_types.h"                   // for DEFAULT_RATELIMI...
#include "linux/rcupdate.h"                          // for rcu_read_lock
#include "linux/rwsem.h"                             // for up_write, down_w...
#include "linux/sched.h"                             // for task_struct, TAS...
#include "linux/spinlock.h"                          // for spin_lock, spin_...
#include "linux/stat.h"                              // for S_ISBLK
#include "linux/stddef.h"                            // for false, true
#include "linux/types.h"                             // for loff_t, pgoff_t
#include "linux/vm_event_item.h"                     // for PGMAJFAULT
#include "linux/vmstat.h"                            // for __lruvec_stat_mo...
#include "linux/wait.h"                              // for wait_queue_entry_t
#include "linux/xarray.h"                            // for xa_is_value, xa_...
#include "vdso/limits.h"                             // for ULONG_MAX, LLONG...

mm/filemap.c should remove these lines:
- #include <asm/mman.h>  // lines 57-57
- #include <asm/pgalloc.h>  // lines 45-45
- #include <asm/tlbflush.h>  // lines 46-46
- #include <linux/capability.h>  // lines 19-19
- #include <linux/cpuset.h>  // lines 35-35
- #include <linux/dax.h>  // lines 15-15
- #include <linux/error-injection.h>  // lines 29-29
- #include <linux/hugetlb.h>  // lines 36-36
- #include <linux/kernel_stat.h>  // lines 20-20
- #include <linux/migrate.h>  // lines 44-44
- #include <linux/mman.h>  // lines 25-25
- #include <linux/ramfs.h>  // lines 42-42
- #include <linux/rmap.h>  // lines 39-39
- #include <linux/security.h>  // lines 34-34
- #include <linux/swapops.h>  // lines 24-24
- #include <linux/uaccess.h>  // lines 18-18

The full include-list for mm/filemap.c:
#include <asm/barrier.h>                             // for smp_load_acquire
#include <asm/bitops.h>                              // for test_bit, clear_...
#include <asm/bug.h>                                 // for WARN_ON_ONCE
#include <linux/backing-dev.h>                       // for mapping_can_writ...
#include <linux/buffer_head.h>                       // for try_to_free_buffers
#include <linux/compiler.h>                          // for unlikely, likely
#include <linux/delayacct.h>                         // for delayacct_thrash...
#include <linux/export.h>                            // for EXPORT_SYMBOL
#include <linux/file.h>                              // for fput
#include <linux/fs.h>                                // for address_space
#include <linux/gfp.h>                               // for __GFP_WRITE, GFP...
#include <linux/hash.h>                              // for hash_ptr
#include <linux/memcontrol.h>                        // for count_memcg_even...
#include <linux/mm.h>                                // for folio_put, vm_fault
#include <linux/page_idle.h>                         // for folio_clear_idle
#include <linux/pagemap.h>                           // for folio_trylock
#include <linux/pagevec.h>                           // for folio_batch_count
#include <linux/psi.h>                               // for psi_memstall_enter
#include <linux/sched/signal.h>                      // for fatal_signal_pen...
#include <linux/shmem_fs.h>                          // for shmem_mapping
#include <linux/swap.h>                              // for folio_mark_accessed
#include <linux/uio.h>                               // for iov_iter_count
#include <linux/writeback.h>                         // for WB_SYNC_ALL, bal...
#include <trace/events/filemap.h>                    // for trace_mm_filemap...
#include <cstdio>                                    // for NULL, ssize_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for test_and_set_bit
#include "asm-generic/cacheflush.h"                  // for flush_dcache_page
#include "asm-generic/errno-base.h"                  // for EAGAIN, EIO, EEXIST
#include "asm-generic/error-injection.h"             // for ALLOW_ERROR_INJE...
#include "asm-generic/int-ll64.h"                    // for u64
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/rwonce.h"                      // for READ_ONCE, WRITE...
#include "asm/bug.h"                                 // for BUG
#include "asm/current.h"                             // for current
#include "asm/page_types.h"                          // for PAGE_SHIFT, PAGE...
#include "asm/pgtable-2level_types.h"                // for pte_t
#include "asm/pgtable.h"                             // for pmd_none, pte_none
#include "asm/vdso/processor.h"                      // for cpu_relax
#include "internal.h"                                // for maybe_unlock_mma...
#include "linux/build_bug.h"                         // for BUILD_BUG_ON
#include "linux/cache.h"                             // for __cacheline_aligned
#include "linux/cacheflush.h"                        // for flush_dcache_folio
#include "linux/compiler_attributes.h"               // for noinline
#include "linux/compiler_types.h"                    // for inline
#include "linux/container_of.h"                      // for container_of
#include "linux/err.h"                               // for ERR_PTR, IS_ERR
#include "linux/errno.h"                             // for EIOCBQUEUED
#include "linux/errseq.h"                            // for errseq_t, errseq...
#include "linux/fs.h"                                // for address_space (p...
#include "linux/huge_mm.h"                           // for folio_test_pmd_m...
#include "linux/init.h"                              // for __init
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/list.h"                              // for INIT_LIST_HEAD
#include "linux/math.h"                              // for DIV_ROUND_UP
#include "linux/minmax.h"                            // for min_t, max, max_t
#include "linux/mm_types.h"                          // for folio, folio::(a...
#include "linux/mmap_lock.h"                         // for mmap_read_unlock
#include "linux/mmdebug.h"                           // for VM_BUG_ON_FOLIO
#include "linux/mmzone.h"                            // for NR_FILE_PAGES
#include "linux/page_ref.h"                          // for folio_try_get_rcu
#include "linux/panic.h"                             // for add_taint, LOCKD...
#include "linux/pgtable.h"                           // for pmd_devmap_trans...
#include "linux/printk.h"                            // for dump_stack, pr_crit
#include "linux/ratelimit_types.h"                   // for DEFAULT_RATELIMI...
#include "linux/rcupdate.h"                          // for rcu_read_lock
#include "linux/rwsem.h"                             // for up_write, down_w...
#include "linux/sched.h"                             // for task_struct, TAS...
#include "linux/spinlock.h"                          // for spin_lock, spin_...
#include "linux/stat.h"                              // for S_ISBLK
#include "linux/stddef.h"                            // for false, true
#include "linux/types.h"                             // for loff_t, pgoff_t
#include "linux/vm_event_item.h"                     // for PGMAJFAULT
#include "linux/vmstat.h"                            // for __lruvec_stat_mo...
#include "linux/wait.h"                              // for wait_queue_entry_t
#include "linux/xarray.h"                            // for xa_is_value, xa_...
#include "vdso/limits.h"                             // for ULONG_MAX, LLONG...
---
  ./scripts/check-local-export mm/filemap.o
  iwyu2 -Wp,-MMD,mm/.mempool.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/mempool"' -DKBUILD_BASENAME='"mempool"' -DKBUILD_MODNAME='"mempool"' -D__KBUILD_MODNAME=kmod_mempool -c -o mm/mempool.o mm/mempool.c  
In file included from mm/mempool.c:20:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/mempool.c:20:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/mempool.c:20:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/mempool.c:21:
In file included from mm/slab.h:160:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from mm/mempool.c:20:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/mempool.c:20:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/mempool.c:20:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/mempool.c:21:
In file included from mm/slab.h:160:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

mm/mempool.c should add these lines:
#include <asm/barrier.h>                // for smp_rmb, smp_wmb
#include <asm/bug.h>                    // for BUG_ON
#include <stddef.h>                     // for NULL, size_t
#include "asm-generic/errno-base.h"     // for ENOMEM
#include "asm-generic/param.h"          // for HZ
#include "asm-generic/rwonce.h"         // for READ_ONCE
#include "asm/string_32.h"              // for memcpy
#include "linux/compiler.h"             // for unlikely, likely
#include "linux/compiler_attributes.h"  // for __always_inline
#include "linux/compiler_types.h"       // for inline
#include "linux/gfp.h"                  // for GFP_KERNEL, __GFP_DIRECT_RECLAIM
#include "linux/kernel.h"               // for might_sleep, might_sleep_if
#include "linux/mmdebug.h"              // for VM_BUG_ON, VM_WARN_ON_ONCE
#include "linux/numa.h"                 // for NUMA_NO_NODE
#include "linux/sched.h"                // for io_schedule_timeout, TASK_UNI...
#include "linux/slub_def.h"             // for kmem_cache
#include "linux/spinlock.h"             // for spin_unlock_irqrestore, spin_...
#include "linux/stddef.h"               // for false
#include "linux/types.h"                // for gfp_t
#include "linux/wait.h"                 // for finish_wait, prepare_to_wait

mm/mempool.c should remove these lines:
- #include <linux/highmem.h>  // lines 15-15
- #include <linux/mm.h>  // lines 13-13
- #include <linux/writeback.h>  // lines 20-20
- #include "slab.h"  // lines 21-21

The full include-list for mm/mempool.c:
#include <asm/barrier.h>                // for smp_rmb, smp_wmb
#include <asm/bug.h>                    // for BUG_ON
#include <linux/export.h>               // for EXPORT_SYMBOL
#include <linux/kasan.h>                // for kasan_poison_pages, kasan_sla...
#include <linux/kmemleak.h>             // for kmemleak_update_trace
#include <linux/mempool.h>              // for mempool_t, mempool_alloc_t
#include <linux/slab.h>                 // for kfree, __ksize, kmalloc, kmal...
#include <stddef.h>                     // for NULL, size_t
#include "asm-generic/errno-base.h"     // for ENOMEM
#include "asm-generic/param.h"          // for HZ
#include "asm-generic/rwonce.h"         // for READ_ONCE
#include "asm/string_32.h"              // for memcpy
#include "linux/compiler.h"             // for unlikely, likely
#include "linux/compiler_attributes.h"  // for __always_inline
#include "linux/compiler_types.h"       // for inline
#include "linux/gfp.h"                  // for GFP_KERNEL, __GFP_DIRECT_RECLAIM
#include "linux/kernel.h"               // for might_sleep, might_sleep_if
#include "linux/mmdebug.h"              // for VM_BUG_ON, VM_WARN_ON_ONCE
#include "linux/numa.h"                 // for NUMA_NO_NODE
#include "linux/sched.h"                // for io_schedule_timeout, TASK_UNI...
#include "linux/slub_def.h"             // for kmem_cache
#include "linux/spinlock.h"             // for spin_unlock_irqrestore, spin_...
#include "linux/stddef.h"               // for false
#include "linux/types.h"                // for gfp_t
#include "linux/wait.h"                 // for finish_wait, prepare_to_wait
---
  ./scripts/check-local-export mm/mempool.o
  iwyu2 -Wp,-MMD,mm/.oom_kill.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/oom_kill"' -DKBUILD_BASENAME='"oom_kill"' -DKBUILD_MODNAME='"oom_kill"' -D__KBUILD_MODNAME=kmod_oom_kill -c -o mm/oom_kill.o mm/oom_kill.c  
In file included from mm/oom_kill.c:30:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/oom_kill.c:30:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/oom_kill.c:30:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/oom_kill.c:30:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/oom_kill.c:30:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/oom_kill.c:30:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/oom_kill.c:30:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/oom_kill.c:30:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/oom_kill.c should add these lines:
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON
#include <asm/signal.h>                              // for SIGKILL
#include <stddef.h>                                  // for NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit, test_an...
#include "asm-generic/errno-base.h"                  // for EINVAL, EAGAIN
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/rwonce.h"                      // for READ_ONCE
#include "asm/cache.h"                               // for __read_mostly
#include "asm/current.h"                             // for current
#include "asm/page_types.h"                          // for PAGE_SHIFT, PAGE...
#include "asm/ptrace.h"                              // for pt_regs
#include "asm/thread_info.h"                         // for TIF_MEMDIE
#include "linux/atomic/atomic-instrumented.h"        // for atomic_read, ato...
#include "linux/compiler.h"                          // for likely, unlikely
#include "linux/compiler_types.h"                    // for inline
#include "linux/container_of.h"                      // for container_of
#include "linux/cred.h"                              // for cred, task_uid
#include "linux/debug_locks.h"                       // for debug_show_all_l...
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/mm_types.h"                          // for mm_struct, mm_st...
#include "linux/mm_types_task.h"                     // for MM_ANONPAGES
#include "linux/mmap_lock.h"                         // for mmap_read_unlock
#include "linux/mmzone.h"                            // for node_present_pages
#include "linux/mutex.h"                             // for mutex, mutex_loc...
#include "linux/nodemask.h"                          // for for_each_node_mask
#include "linux/oom.h"                               // for oom_control (ptr...
#include "linux/panic.h"                             // for panic
#include "linux/pid.h"                               // for pidfd_get_task
#include "linux/printk.h"                            // for pr_info, pr_warn
#include "linux/ratelimit_types.h"                   // for DEFAULT_RATELIMI...
#include "linux/rcupdate.h"                          // for rcu_read_lock
#include "linux/sched/signal.h"                      // for signal_struct
#include "linux/signal.h"                            // for do_send_sig_info
#include "linux/spinlock.h"                          // for spin_lock_irq
#include "linux/spinlock_types.h"                    // for DEFINE_SPINLOCK
#include "linux/stddef.h"                            // for true, false
#include "linux/thread_info.h"                       // for clear_thread_flag
#include "linux/timer.h"                             // for add_timer, timer...
#include "linux/types.h"                             // for list_head, bool
#include "linux/uidgid.h"                            // for from_kuid
#include "linux/user_namespace.h"                    // for init_user_ns
#include "linux/vm_event_item.h"                     // for OOM_KILL
#include "linux/vmstat.h"                            // for global_node_page...
#include "vdso/limits.h"                             // for LONG_MIN, LONG_MAX

mm/oom_kill.c should remove these lines:
- #include <linux/ftrace.h>  // lines 42-42
- #include <linux/mempolicy.h>  // lines 38-38
- #include <linux/ptrace.h>  // lines 40-40
- #include <linux/ratelimit.h>  // lines 43-43
- #include <linux/security.h>  // lines 39-39
- #include <linux/timex.h>  // lines 32-32

The full include-list for mm/oom_kill.c:
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON
#include <asm/signal.h>                              // for SIGKILL
#include <asm/tlb.h>                                 // for mmu_gather
#include <linux/cpuset.h>                            // for cpuset_print_cur...
#include <linux/err.h>                               // for IS_ERR, PTR_ERR
#include <linux/export.h>                            // for EXPORT_SYMBOL_GPL
#include <linux/freezer.h>                           // for wait_queue_head
#include <linux/gfp.h>                               // for gfp_zone, __GFP_FS
#include <linux/init.h>                              // for __init, subsys_i...
#include <linux/jiffies.h>                           // for jiffies
#include <linux/kthread.h>                           // for kthread_run
#include <linux/memcontrol.h>                        // for mem_cgroup_scan_...
#include <linux/mm.h>                                // for get_mm_counter
#include <linux/mmu_notifier.h>                      // for mmu_notifier_inv...
#include <linux/notifier.h>                          // for blocking_notifie...
#include <linux/oom.h>                               // for oom_control, CON...
#include <linux/sched.h>                             // for task_struct, tas...
#include <linux/sched/coredump.h>                    // for MMF_OOM_SKIP
#include <linux/sched/debug.h>                       // for sched_show_task
#include <linux/sched/mm.h>                          // for mmgrab, mmdrop
#include <linux/sched/task.h>                        // for put_task_struct
#include <linux/swap.h>                              // for total_swap_pages
#include <linux/syscalls.h>                          // for __MAP2, SYSCALL_...
#include <stddef.h>                                  // for NULL
#include <trace/events/oom.h>                        // for trace_skip_task_...
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit, test_an...
#include "asm-generic/errno-base.h"                  // for EINVAL, EAGAIN
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/rwonce.h"                      // for READ_ONCE
#include "asm/cache.h"                               // for __read_mostly
#include "asm/current.h"                             // for current
#include "asm/page_types.h"                          // for PAGE_SHIFT, PAGE...
#include "asm/ptrace.h"                              // for pt_regs
#include "asm/thread_info.h"                         // for TIF_MEMDIE
#include "internal.h"                                // for unmap_page_range
#include "linux/atomic/atomic-instrumented.h"        // for atomic_read, ato...
#include "linux/compiler.h"                          // for likely, unlikely
#include "linux/compiler_types.h"                    // for inline
#include "linux/container_of.h"                      // for container_of
#include "linux/cred.h"                              // for cred, task_uid
#include "linux/debug_locks.h"                       // for debug_show_all_l...
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/mm_types.h"                          // for mm_struct, mm_st...
#include "linux/mm_types_task.h"                     // for MM_ANONPAGES
#include "linux/mmap_lock.h"                         // for mmap_read_unlock
#include "linux/mmzone.h"                            // for node_present_pages
#include "linux/mutex.h"                             // for mutex, mutex_loc...
#include "linux/nodemask.h"                          // for for_each_node_mask
#include "linux/oom.h"                               // for oom_control (ptr...
#include "linux/panic.h"                             // for panic
#include "linux/pid.h"                               // for pidfd_get_task
#include "linux/printk.h"                            // for pr_info, pr_warn
#include "linux/ratelimit_types.h"                   // for DEFAULT_RATELIMI...
#include "linux/rcupdate.h"                          // for rcu_read_lock
#include "linux/sched/signal.h"                      // for signal_struct
#include "linux/signal.h"                            // for do_send_sig_info
#include "linux/spinlock.h"                          // for spin_lock_irq
#include "linux/spinlock_types.h"                    // for DEFINE_SPINLOCK
#include "linux/stddef.h"                            // for true, false
#include "linux/thread_info.h"                       // for clear_thread_flag
#include "linux/timer.h"                             // for add_timer, timer...
#include "linux/types.h"                             // for list_head, bool
#include "linux/uidgid.h"                            // for from_kuid
#include "linux/user_namespace.h"                    // for init_user_ns
#include "linux/vm_event_item.h"                     // for OOM_KILL
#include "linux/vmstat.h"                            // for global_node_page...
#include "slab.h"                                    // for dump_unreclaimab...
#include "vdso/limits.h"                             // for LONG_MIN, LONG_MAX
---
  ./scripts/check-local-export mm/oom_kill.o
  iwyu2 -Wp,-MMD,mm/.fadvise.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/fadvise"' -DKBUILD_BASENAME='"fadvise"' -DKBUILD_MODNAME='"fadvise"' -D__KBUILD_MODNAME=kmod_fadvise -c -o mm/fadvise.o mm/fadvise.c  
In file included from mm/fadvise.c:16:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/fadvise.c:16:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/fadvise.c:16:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/fadvise.c:20:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from mm/fadvise.c:16:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/fadvise.c:16:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/fadvise.c:16:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/fadvise.c:20:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

mm/fadvise.c should add these lines:
#include "asm-generic/errno-base.h"  // for EINVAL, ESPIPE
#include "asm-generic/int-ll64.h"    // for u64
#include "asm/page_types.h"          // for PAGE_SHIFT, PAGE_MASK, PAGE_SIZE
#include "linux/backing-dev-defs.h"  // for backing_dev_info
#include "linux/export.h"            // for EXPORT_SYMBOL
#include "linux/spinlock.h"          // for spin_lock, spin_unlock
#include "linux/stat.h"              // for S_ISFIFO
#include "linux/types.h"             // for loff_t, pgoff_t

mm/fadvise.c should remove these lines:
- #include <asm/unistd.h>  // lines 23-23
- #include <linux/file.h>  // lines 12-12
- #include <linux/kernel.h>  // lines 11-11
- #include <linux/mm.h>  // lines 14-14
- #include <linux/pagevec.h>  // lines 17-17
- #include <linux/syscalls.h>  // lines 20-20

The full include-list for mm/fadvise.c:
#include <linux/backing-dev.h>       // for inode_to_bdi, noop_backing_dev_info
#include <linux/fadvise.h>           // for POSIX_FADV_DONTNEED, POSIX_FADV_...
#include <linux/fs.h>                // for file, FMODE_RANDOM, file_inode
#include <linux/pagemap.h>           // for __filemap_fdatawrite_range, inva...
#include <linux/swap.h>              // for lru_add_drain, lru_add_drain_all
#include <linux/writeback.h>         // for WB_SYNC_NONE
#include "asm-generic/errno-base.h"  // for EINVAL, ESPIPE
#include "asm-generic/int-ll64.h"    // for u64
#include "asm/page_types.h"          // for PAGE_SHIFT, PAGE_MASK, PAGE_SIZE
#include "internal.h"                // for force_page_cache_readahead, inva...
#include "linux/backing-dev-defs.h"  // for backing_dev_info
#include "linux/export.h"            // for EXPORT_SYMBOL
#include "linux/spinlock.h"          // for spin_lock, spin_unlock
#include "linux/stat.h"              // for S_ISFIFO
#include "linux/types.h"             // for loff_t, pgoff_t
---
  ./scripts/check-local-export mm/fadvise.o
  iwyu2 -Wp,-MMD,mm/.maccess.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/maccess"' -DKBUILD_BASENAME='"maccess"' -DKBUILD_MODNAME='"maccess"' -D__KBUILD_MODNAME=kmod_maccess -c -o mm/maccess.o mm/maccess.c  

mm/maccess.c should add these lines:
#include <asm/bug.h>                    // for WARN
#include <stddef.h>                     // for size_t
#include "asm-generic/errno-base.h"     // for EFAULT, ERANGE
#include "asm-generic/int-ll64.h"       // for u8, u16, u32, u64
#include "asm/ptrace.h"                 // for copy_from_kernel_nofault
#include "asm/uaccess.h"                // for __get_kernel_nofault, __put_k...
#include "generated/autoconf.h"         // for CONFIG_HAVE_EFFICIENT_UNALIGN...
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/compiler_types.h"       // for __user
#include "linux/kconfig.h"              // for __ARG_PLACEHOLDER_1, IS_ENABLED
#include "linux/stddef.h"               // for true
#include "linux/thread_info.h"          // for __copy_overflow
#include "linux/types.h"                // for bool

mm/maccess.c should remove these lines:
- #include <linux/mm.h>  // lines 6-6

The full include-list for mm/maccess.c:
#include <asm/bug.h>                    // for WARN
#include <linux/export.h>               // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include <linux/uaccess.h>              // for pagefault_enable, pagefault_d...
#include <stddef.h>                     // for size_t
#include "asm-generic/errno-base.h"     // for EFAULT, ERANGE
#include "asm-generic/int-ll64.h"       // for u8, u16, u32, u64
#include "asm/ptrace.h"                 // for copy_from_kernel_nofault
#include "asm/uaccess.h"                // for __get_kernel_nofault, __put_k...
#include "generated/autoconf.h"         // for CONFIG_HAVE_EFFICIENT_UNALIGN...
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/compiler_types.h"       // for __user
#include "linux/kconfig.h"              // for __ARG_PLACEHOLDER_1, IS_ENABLED
#include "linux/stddef.h"               // for true
#include "linux/thread_info.h"          // for __copy_overflow
#include "linux/types.h"                // for bool
---
  ./scripts/check-local-export mm/maccess.o
  iwyu2 -Wp,-MMD,mm/.page-writeback.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/page-writeback"' -DKBUILD_BASENAME='"page_writeback"' -DKBUILD_MODNAME='"page_writeback"' -D__KBUILD_MODNAME=kmod_page_writeback -c -o mm/page-writeback.o mm/page-writeback.c  
In file included from mm/page-writeback.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/page-writeback.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/page-writeback.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/page-writeback.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/page-writeback.c:27:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
5 warnings generated.
In file included from mm/page-writeback.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/page-writeback.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/page-writeback.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/page-writeback.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/page-writeback.c:27:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^

mm/page-writeback.c should add these lines:
#include <asm-generic/percpu.h>                // for DEFINE_PER_CPU, this_c...
#include <asm/bug.h>                           // for BUG_ON, WARN_ON_ONCE
#include <asm/percpu.h>                        // for raw_cpu_add_8
#include <stddef.h>                            // for NULL
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm-generic/errno-base.h"            // for EINVAL, EINTR, ENOMEM
#include "asm-generic/int-ll64.h"              // for u64, s64
#include "asm-generic/param.h"                 // for HZ
#include "asm-generic/rwonce.h"                // for READ_ONCE, WRITE_ONCE
#include "asm/current.h"                       // for current
#include "asm/page_types.h"                    // for PAGE_SIZE, PAGE_SHIFT
#include "asm/percpu.h"                        // for __pcpu_op1_1, __pcpu_o...
#include "asm/string_32.h"                     // for memset
#include "asm/topology.h"                      // for numa_node_id
#include "generated/bounds.h"                  // for MAX_NR_ZONES
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec, atomic_inc
#include "linux/backing-dev-defs.h"            // for bdi_writeback, backing...
#include "linux/compiler.h"                    // for unlikely, likely
#include "linux/compiler_types.h"              // for inline
#include "linux/cpuhotplug.h"                  // for cpuhp_setup_state, CPU...
#include "linux/cpumask.h"                     // for num_online_cpus
#include "linux/flex_proportions.h"            // for __fprop_add_percpu_max
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/irqflags.h"                    // for local_irq_restore, loc...
#include "linux/jiffies.h"                     // for jiffies, time_is_befor...
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/log2.h"                        // for roundup_pow_of_two, ilog2
#include "linux/math.h"                        // for DIV_ROUND_UP
#include "linux/math64.h"                      // for div_u64, div64_s64
#include "linux/memcontrol.h"                  // for folio_memcg_unlock
#include "linux/minmax.h"                      // for min, max, min_t, clamp
#include "linux/mm_types.h"                    // for folio, folio::(anonymous)
#include "linux/mmdebug.h"                     // for VM_BUG_ON_FOLIO
#include "linux/mmzone.h"                      // for pglist_data, NR_FILE_D...
#include "linux/percpu_counter.h"              // for percpu_counter_read
#include "linux/preempt.h"                     // for preempt_disable, preem...
#include "linux/rculist.h"                     // for list_for_each_entry_rcu
#include "linux/rcupdate.h"                    // for rcu_read_lock, rcu_rea...
#include "linux/sched.h"                       // for task_struct, io_schedu...
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for list_head, bool, pgoff_t
#include "linux/vmstat.h"                      // for global_node_page_state
#include "linux/workqueue.h"                   // for queue_delayed_work
#include "linux/xarray.h"                      // for xas_clear_mark, xas_se...
#include "vdso/limits.h"                       // for LLONG_MAX, ULONG_MAX

mm/page-writeback.c should remove these lines:
- #include <linux/cpu.h>  // lines 33-33
- #include <linux/kernel.h>  // lines 15-15
- #include <linux/mm_inline.h>  // lines 39-39
- #include <linux/percpu.h>  // lines 30-30
- #include <linux/slab.h>  // lines 21-21
- #include <linux/smp.h>  // lines 31-31
- #include <linux/syscalls.h>  // lines 34-34
- #include <linux/sysctl.h>  // lines 32-32

The full include-list for mm/page-writeback.c:
#include <asm-generic/percpu.h>                // for DEFINE_PER_CPU, this_c...
#include <asm/bug.h>                           // for BUG_ON, WARN_ON_ONCE
#include <asm/percpu.h>                        // for raw_cpu_add_8
#include <linux/backing-dev.h>                 // for bdi_list, wb_stat_mod
#include <linux/blkdev.h>                      // for blk_finish_plug, blk_s...
#include <linux/export.h>                      // for EXPORT_SYMBOL, EXPORT_...
#include <linux/fs.h>                          // for address_space, mapping...
#include <linux/init.h>                        // for __init
#include <linux/mm.h>                          // for folio_nr_pages, folio_...
#include <linux/pagemap.h>                     // for folio_mapping, folio_i...
#include <linux/pagevec.h>                     // for pagevec_init, pagevec_...
#include <linux/rmap.h>                        // for folio_mkclean
#include <linux/sched/rt.h>                    // for rt_task
#include <linux/sched/signal.h>                // for fatal_signal_pending
#include <linux/spinlock.h>                    // for spin_lock, spin_unlock
#include <linux/swap.h>                        // for totalreserve_pages
#include <linux/task_io_accounting_ops.h>      // for task_io_account_cancel...
#include <linux/timer.h>                       // for mod_timer, del_timer
#include <linux/writeback.h>                   // for wb_domain, writeback_c...
#include <stddef.h>                            // for NULL
#include <trace/events/writeback.h>            // for trace_balance_dirty_pages
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm-generic/errno-base.h"            // for EINVAL, EINTR, ENOMEM
#include "asm-generic/int-ll64.h"              // for u64, s64
#include "asm-generic/param.h"                 // for HZ
#include "asm-generic/rwonce.h"                // for READ_ONCE, WRITE_ONCE
#include "asm/current.h"                       // for current
#include "asm/page_types.h"                    // for PAGE_SIZE, PAGE_SHIFT
#include "asm/percpu.h"                        // for __pcpu_op1_1, __pcpu_o...
#include "asm/string_32.h"                     // for memset
#include "asm/topology.h"                      // for numa_node_id
#include "generated/bounds.h"                  // for MAX_NR_ZONES
#include "internal.h"                          // for reclaim_throttle, __fo...
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec, atomic_inc
#include "linux/backing-dev-defs.h"            // for bdi_writeback, backing...
#include "linux/compiler.h"                    // for unlikely, likely
#include "linux/compiler_types.h"              // for inline
#include "linux/cpuhotplug.h"                  // for cpuhp_setup_state, CPU...
#include "linux/cpumask.h"                     // for num_online_cpus
#include "linux/flex_proportions.h"            // for __fprop_add_percpu_max
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/irqflags.h"                    // for local_irq_restore, loc...
#include "linux/jiffies.h"                     // for jiffies, time_is_befor...
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/log2.h"                        // for roundup_pow_of_two, ilog2
#include "linux/math.h"                        // for DIV_ROUND_UP
#include "linux/math64.h"                      // for div_u64, div64_s64
#include "linux/memcontrol.h"                  // for folio_memcg_unlock
#include "linux/minmax.h"                      // for min, max, min_t, clamp
#include "linux/mm_types.h"                    // for folio, folio::(anonymous)
#include "linux/mmdebug.h"                     // for VM_BUG_ON_FOLIO
#include "linux/mmzone.h"                      // for pglist_data, NR_FILE_D...
#include "linux/percpu_counter.h"              // for percpu_counter_read
#include "linux/preempt.h"                     // for preempt_disable, preem...
#include "linux/rculist.h"                     // for list_for_each_entry_rcu
#include "linux/rcupdate.h"                    // for rcu_read_lock, rcu_rea...
#include "linux/sched.h"                       // for task_struct, io_schedu...
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for list_head, bool, pgoff_t
#include "linux/vmstat.h"                      // for global_node_page_state
#include "linux/workqueue.h"                   // for queue_delayed_work
#include "linux/xarray.h"                      // for xas_clear_mark, xas_se...
#include "vdso/limits.h"                       // for LLONG_MAX, ULONG_MAX
---
  ./scripts/check-local-export mm/page-writeback.o
  iwyu2 -Wp,-MMD,mm/.folio-compat.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/folio-compat"' -DKBUILD_BASENAME='"folio_compat"' -DKBUILD_MODNAME='"folio_compat"' -D__KBUILD_MODNAME=kmod_folio_compat -c -o mm/folio-compat.o mm/folio-compat.c  
In file included from mm/folio-compat.c:7:
In file included from ./include/linux/migrate.h:8:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/folio-compat.c:9:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/folio-compat.c:9:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/folio-compat.c:9:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/folio-compat.c:7:
In file included from ./include/linux/migrate.h:8:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/folio-compat.c:9:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/folio-compat.c:9:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/folio-compat.c:9:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/folio-compat.c should add these lines:
#include <linux/mm.h>                   // for page_folio, PageTail, folio_s...
#include "asm-generic/errno-base.h"     // for EBUSY
#include "linux/compiler_attributes.h"  // for noinline
#include "linux/export.h"               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/mm.h"                   // for folio_mapped, folio_mark_dirty
#include "linux/mm_types.h"             // for page (ptr only), folio, folio...
#include "linux/ratelimit.h"            // for WARN_RATELIMIT
#include "linux/types.h"                // for bool, gfp_t, pgoff_t
#include "linux/writeback.h"            // for filemap_dirty_folio, folio_re...
#include "linux/xarray.h"               // for xa_is_value
struct address_space;

mm/folio-compat.c should remove these lines:
- #include <linux/migrate.h>  // lines 7-7

The full include-list for mm/folio-compat.c:
#include <linux/mm.h>                   // for page_folio, PageTail, folio_s...
#include <linux/pagemap.h>              // for __filemap_get_folio, filemap_...
#include <linux/swap.h>                 // for folio_add_lru, folio_mark_acc...
#include "asm-generic/errno-base.h"     // for EBUSY
#include "internal.h"                   // for folio_isolate_lru, folio_putb...
#include "linux/compiler_attributes.h"  // for noinline
#include "linux/export.h"               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/mm.h"                   // for folio_mapped, folio_mark_dirty
#include "linux/mm_types.h"             // for page (ptr only), folio, folio...
#include "linux/ratelimit.h"            // for WARN_RATELIMIT
#include "linux/types.h"                // for bool, gfp_t, pgoff_t
#include "linux/writeback.h"            // for filemap_dirty_folio, folio_re...
#include "linux/xarray.h"               // for xa_is_value
struct address_space;
---
  ./scripts/check-local-export mm/folio-compat.o
  iwyu2 -Wp,-MMD,mm/.readahead.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/readahead"' -DKBUILD_BASENAME='"readahead"' -DKBUILD_MODNAME='"readahead"' -D__KBUILD_MODNAME=kmod_readahead -c -o mm/readahead.o mm/readahead.c  
In file included from mm/readahead.c:116:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/readahead.c:116:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/readahead.c:116:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/readahead.c:116:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from mm/readahead.c:125:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
5 warnings generated.
In file included from mm/readahead.c:116:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/readahead.c:116:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/readahead.c:116:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/readahead.c:116:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from mm/readahead.c:125:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

mm/readahead.c should add these lines:
#include <asm/bug.h>                 // for BUG_ON
#include <linux/bitops.h>            // for __ffs
#include <linux/mm.h>                // for folio_set_readahead, folio_clear...
#include <cstdio>                    // for size_t, NULL, ssize_t
#include "asm-generic/errno-base.h"  // for EBADF, EINVAL, ENOMEM
#include "asm/page_types.h"          // for PAGE_SHIFT, PAGE_SIZE
#include "asm/ptrace.h"              // for pt_regs
#include "linux/backing-dev-defs.h"  // for backing_dev_info
#include "linux/compiler.h"          // for unlikely
#include "linux/compiler_types.h"    // for inline
#include "linux/fs.h"                // for file_ra_state, address_space
#include "linux/log2.h"              // for roundup_pow_of_two
#include "linux/math.h"              // for round_up, DIV_ROUND_UP
#include "linux/minmax.h"            // for min, max_t, min_t
#include "linux/mm.h"                // for folio_put, put_page, folio_get
#include "linux/mm_types.h"          // for folio (ptr only), page, page::(a...
#include "linux/rcupdate.h"          // for rcu_read_lock, rcu_read_unlock
#include "linux/stat.h"              // for S_ISREG
#include "linux/stddef.h"            // for true
#include "linux/types.h"             // for pgoff_t, loff_t, gfp_t, bool
#include "linux/xarray.h"            // for xa_is_value, xa_load

mm/readahead.c should remove these lines:
- #include <linux/dax.h>  // lines 118-118
- #include <linux/gfp.h>  // lines 119-119
- #include <linux/kernel.h>  // lines 117-117
- #include <linux/mm_inline.h>  // lines 127-127
- #include <linux/pagevec.h>  // lines 123-123
- #include <linux/task_io_accounting_ops.h>  // lines 122-122

The full include-list for mm/readahead.c:
#include <asm/bug.h>                 // for BUG_ON
#include <linux/backing-dev.h>       // for inode_to_bdi
#include <linux/bitops.h>            // for __ffs
#include <linux/blk-cgroup.h>        // for blk_cgroup_congested
#include <linux/blkdev.h>            // for blk_finish_plug, blk_start_plug
#include <linux/export.h>            // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include <linux/fadvise.h>           // for POSIX_FADV_WILLNEED
#include <linux/file.h>              // for fd, fdget, fdput
#include <linux/mm.h>                // for folio_set_readahead, folio_clear...
#include <linux/pagemap.h>           // for readahead_control, readahead_index
#include <linux/sched/mm.h>          // for memalloc_nofs_restore, memalloc_...
#include <linux/syscalls.h>          // for __MAP3, SYSCALL_DEFINE3, ksys_re...
#include <cstdio>                    // for size_t, NULL, ssize_t
#include "asm-generic/errno-base.h"  // for EBADF, EINVAL, ENOMEM
#include "asm/page_types.h"          // for PAGE_SHIFT, PAGE_SIZE
#include "asm/ptrace.h"              // for pt_regs
#include "internal.h"                // for force_page_cache_ra, page_cache_...
#include "linux/backing-dev-defs.h"  // for backing_dev_info
#include "linux/compiler.h"          // for unlikely
#include "linux/compiler_types.h"    // for inline
#include "linux/fs.h"                // for file_ra_state, address_space
#include "linux/log2.h"              // for roundup_pow_of_two
#include "linux/math.h"              // for round_up, DIV_ROUND_UP
#include "linux/minmax.h"            // for min, max_t, min_t
#include "linux/mm.h"                // for folio_put, put_page, folio_get
#include "linux/mm_types.h"          // for folio (ptr only), page, page::(a...
#include "linux/rcupdate.h"          // for rcu_read_lock, rcu_read_unlock
#include "linux/stat.h"              // for S_ISREG
#include "linux/stddef.h"            // for true
#include "linux/types.h"             // for pgoff_t, loff_t, gfp_t, bool
#include "linux/xarray.h"            // for xa_is_value, xa_load
---
  ./scripts/check-local-export mm/readahead.o
  iwyu2 -Wp,-MMD,mm/.swap.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/swap"' -DKBUILD_BASENAME='"swap"' -DKBUILD_MODNAME='"swap"' -D__KBUILD_MODNAME=kmod_swap -c -o mm/swap.o mm/swap.c  
In file included from mm/swap.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/swap.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/swap.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/swap.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/swap.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/swap.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/swap.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/swap.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/swap.c should add these lines:
#include <asm-generic/percpu.h>                // for this_cpu_ptr, per_cpu
#include <asm/bug.h>                           // for WARN_ON
#include <linux/rcupdate.h>                    // for synchronize_rcu_expedited
#include <stddef.h>                            // for NULL
#include "asm/page_types.h"                    // for PAGE_SHIFT, PAGE_SIZE
#include "linux/atomic/atomic-instrumented.h"  // for atomic_inc
#include "linux/compiler.h"                    // for unlikely, data_race
#include "linux/compiler_types.h"              // for inline
#include "linux/highmem-internal.h"            // for kmap_to_page
#include "linux/huge_mm.h"                     // for is_huge_zero_page
#include "linux/list.h"                        // for list_del, INIT_LIST_HEAD
#include "linux/mm_types.h"                    // for page, page::(anonymous...
#include "linux/mmdebug.h"                     // for VM_BUG_ON_FOLIO, VM_BU...
#include "linux/mmzone.h"                      // for lruvec, NR_MLOCK, NR_A...
#include "linux/smp.h"                         // for smp_processor_id
#include "linux/spinlock.h"                    // for spin_lock_irq, spin_un...
#include "linux/stddef.h"                      // for true, false
#include "linux/types.h"                       // for list_head, bool, pgoff_t
#include "linux/vm_event_item.h"               // for PGDEACTIVATE, PGACTIVATE
#include "linux/vmstat.h"                      // for __count_vm_events, cou...
#include "linux/xarray.h"                      // for xa_is_value, xa_mark_t
struct address_space;

mm/swap.c should remove these lines:
- #include <linux/backing-dev.h>  // lines 32-32
- #include <linux/cpu.h>  // lines 30-30
- #include <linux/hugetlb.h>  // lines 36-36
- #include <linux/kernel_stat.h>  // lines 19-19
- #include <linux/memremap.h>  // lines 28-28
- #include <linux/mman.h>  // lines 21-21
- #include <linux/notifier.h>  // lines 31-31
- #include <linux/percpu.h>  // lines 29-29
- #include <linux/percpu_counter.h>  // lines 27-27
- #include <linux/sched.h>  // lines 18-18

The full include-list for mm/swap.c:
#include <asm-generic/percpu.h>                // for this_cpu_ptr, per_cpu
#include <asm/bug.h>                           // for WARN_ON
#include <linux/buffer_head.h>                 // for invalidate_bh_lrus_cpu
#include <linux/export.h>                      // for EXPORT_SYMBOL, EXPORT_...
#include <linux/gfp.h>                         // for drain_local_pages
#include <linux/init.h>                        // for __init
#include <linux/local_lock.h>                  // for local_lock, local_unlock
#include <linux/memcontrol.h>                  // for unlock_page_lruvec_irq...
#include <linux/mm.h>                          // for folio_test_unevictable
#include <linux/mm_inline.h>                   // for del_page_from_lru_list
#include <linux/page_idle.h>                   // for folio_clear_idle, foli...
#include <linux/pagemap.h>                     // for find_get_pages_range
#include <linux/pagevec.h>                     // for pagevec_count, pagevec
#include <linux/rcupdate.h>                    // for synchronize_rcu_expedited
#include <linux/swap.h>                        // for lru_cache_add, lru_cac...
#include <linux/uio.h>                         // for kvec
#include <stddef.h>                            // for NULL
#include <trace/events/pagemap.h>              // for trace_mm_lru_activate
#include "asm/page_types.h"                    // for PAGE_SHIFT, PAGE_SIZE
#include "internal.h"                          // for mlock_page_drain_local
#include "linux/atomic/atomic-instrumented.h"  // for atomic_inc
#include "linux/compiler.h"                    // for unlikely, data_race
#include "linux/compiler_types.h"              // for inline
#include "linux/highmem-internal.h"            // for kmap_to_page
#include "linux/huge_mm.h"                     // for is_huge_zero_page
#include "linux/list.h"                        // for list_del, INIT_LIST_HEAD
#include "linux/mm_types.h"                    // for page, page::(anonymous...
#include "linux/mmdebug.h"                     // for VM_BUG_ON_FOLIO, VM_BU...
#include "linux/mmzone.h"                      // for lruvec, NR_MLOCK, NR_A...
#include "linux/smp.h"                         // for smp_processor_id
#include "linux/spinlock.h"                    // for spin_lock_irq, spin_un...
#include "linux/stddef.h"                      // for true, false
#include "linux/types.h"                       // for list_head, bool, pgoff_t
#include "linux/vm_event_item.h"               // for PGDEACTIVATE, PGACTIVATE
#include "linux/vmstat.h"                      // for __count_vm_events, cou...
#include "linux/xarray.h"                      // for xa_is_value, xa_mark_t
struct address_space;
---
  ./scripts/check-local-export mm/swap.o
  iwyu2 -Wp,-MMD,mm/.truncate.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/truncate"' -DKBUILD_BASENAME='"truncate"' -DKBUILD_MODNAME='"truncate"' -D__KBUILD_MODNAME=kmod_truncate -c -o mm/truncate.o mm/truncate.c  
In file included from mm/truncate.c:12:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/truncate.c:12:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/truncate.c:12:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/truncate.c:16:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from mm/truncate.c:12:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/truncate.c:12:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/truncate.c:12:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/truncate.c:16:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

mm/truncate.c should add these lines:
#include <asm/bug.h>                 // for BUG_ON, WARN_ON
#include <stddef.h>                  // for NULL, size_t
#include "asm-generic/errno-base.h"  // for EBUSY, EIO, EINVAL
#include "asm-generic/int-ll64.h"    // for u64
#include "asm/page_types.h"          // for PAGE_SHIFT, PAGE_SIZE
#include "linux/compiler.h"          // for unlikely
#include "linux/compiler_types.h"    // for inline
#include "linux/fs.h"                // for address_space, inode, inode_add_lru
#include "linux/huge_mm.h"           // for split_huge_page
#include "linux/math.h"              // for round_up, round_down
#include "linux/mm_types.h"          // for folio, folio::(anonymous), folio...
#include "linux/mmdebug.h"           // for VM_BUG_ON_FOLIO, VM_BUG_ON_PAGE
#include "linux/page_ref.h"          // for folio_ref_count
#include "linux/sched.h"             // for cond_resched
#include "linux/spinlock.h"          // for spin_unlock, spin_lock
#include "linux/stat.h"              // for S_ISREG
#include "linux/stddef.h"            // for true, false
#include "linux/types.h"             // for pgoff_t, loff_t, bool
#include "linux/xarray.h"            // for xa_is_value, xa_unlock_irq, xa_l...

mm/truncate.c should remove these lines:
- #include <linux/backing-dev.h>  // lines 12-12
- #include <linux/buffer_head.h>  // lines 22-22
- #include <linux/kernel.h>  // lines 11-11
- #include <linux/task_io_accounting_ops.h>  // lines 21-21

The full include-list for mm/truncate.c:
#include <asm/bug.h>                 // for BUG_ON, WARN_ON
#include <linux/dax.h>               // for dax_mapping, dax_delete_mapping_...
#include <linux/export.h>            // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/gfp.h>               // for GFP_KERNEL
#include <linux/highmem.h>           // for folio_zero_range
#include <linux/mm.h>                // for folio_has_private, folio_mapped
#include <linux/pagemap.h>           // for folio_unlock, folio_wait_writeback
#include <linux/pagevec.h>           // for folio_batch_count, folio_batch
#include <linux/rmap.h>              // for page_mkclean
#include <linux/shmem_fs.h>          // for shmem_mapping
#include <linux/swap.h>              // for remove_mapping, workingset_updat...
#include <stddef.h>                  // for NULL, size_t
#include "asm-generic/errno-base.h"  // for EBUSY, EIO, EINVAL
#include "asm-generic/int-ll64.h"    // for u64
#include "asm/page_types.h"          // for PAGE_SHIFT, PAGE_SIZE
#include "internal.h"                // for find_get_entries, find_lock_entries
#include "linux/compiler.h"          // for unlikely
#include "linux/compiler_types.h"    // for inline
#include "linux/fs.h"                // for address_space, inode, inode_add_lru
#include "linux/huge_mm.h"           // for split_huge_page
#include "linux/math.h"              // for round_up, round_down
#include "linux/mm_types.h"          // for folio, folio::(anonymous), folio...
#include "linux/mmdebug.h"           // for VM_BUG_ON_FOLIO, VM_BUG_ON_PAGE
#include "linux/page_ref.h"          // for folio_ref_count
#include "linux/sched.h"             // for cond_resched
#include "linux/spinlock.h"          // for spin_unlock, spin_lock
#include "linux/stat.h"              // for S_ISREG
#include "linux/stddef.h"            // for true, false
#include "linux/types.h"             // for pgoff_t, loff_t, bool
#include "linux/xarray.h"            // for xa_is_value, xa_unlock_irq, xa_l...
---
  ./scripts/check-local-export mm/truncate.o
  iwyu2 -Wp,-MMD,mm/.vmscan.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/vmscan"' -DKBUILD_BASENAME='"vmscan"' -DKBUILD_MODNAME='"vmscan"' -D__KBUILD_MODNAME=kmod_vmscan -c -o mm/vmscan.o mm/vmscan.c  
In file included from mm/vmscan.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/vmscan.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/vmscan.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/vmscan.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/vmscan.c:28:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from mm/vmscan.c:45:
./include/linux/delayacct.h:27:44: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline int delayacct_add_tsk(struct taskstats *d,
                                           ^
6 warnings generated.
In file included from mm/vmscan.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/vmscan.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/vmscan.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/vmscan.c:20:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/vmscan.c:28:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from mm/vmscan.c:45:
./include/linux/delayacct.h:27:44: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline int delayacct_add_tsk(struct taskstats *d,
                                           ^

mm/vmscan.c should add these lines:
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for BUG_ON, WARN_ON_...
#include <linux/atomic.h>                            // for atomic_long_t
#include <linux/mmzone.h>                            // for pageblock_order
#include <stddef.h>                                  // for NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/errno-base.h"                  // for EBUSY, ENOMEM
#include "asm-generic/errno.h"                       // for ENOSYS
#include "asm-generic/int-ll64.h"                    // for u64, s8
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/rwonce.h"                      // for WRITE_ONCE, READ...
#include "asm-generic/topology.h"                    // for cpumask_of_node
#include "asm/bug.h"                                 // for BUG
#include "asm/current.h"                             // for current
#include "asm/page_types.h"                          // for PAGE_SHIFT
#include "asm/processor.h"                           // for prefetchw, ARCH_...
#include "asm/string_32.h"                           // for memset, memcpy
#include "generated/bounds.h"                        // for MAX_NR_ZONES
#include "linux/atomic/atomic-instrumented.h"        // for atomic_dec, atom...
#include "linux/backing-dev-defs.h"                  // for WB_REASON_VMSCAN
#include "linux/build_bug.h"                         // for BUILD_BUG_ON
#include "linux/compiler.h"                          // for unlikely, data_race
#include "linux/compiler_attributes.h"               // for fallthrough, __a...
#include "linux/compiler_types.h"                    // for inline
#include "linux/cpumask.h"                           // for cpumask_empty
#include "linux/err.h"                               // for IS_ERR
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/fs.h"                                // for address_space
#include "linux/huge_mm.h"                           // for split_folio_to_list
#include "linux/instruction_pointer.h"               // for _THIS_IP_
#include "linux/jiffies.h"                           // for jiffies_to_usecs
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/kernel.h"                            // for SYSTEM_RUNNING
#include "linux/limits.h"                            // for S8_MAX
#include "linux/list.h"                              // for list_empty, list...
#include "linux/math.h"                              // for int_sqrt
#include "linux/math64.h"                            // for div64_u64, DIV64...
#include "linux/migrate_mode.h"                      // for MIGRATE_ASYNC
#include "linux/minmax.h"                            // for min, max, max_t
#include "linux/mm_types.h"                          // for page, page::(ano...
#include "linux/mmdebug.h"                           // for VM_BUG_ON_FOLIO
#include "linux/mmzone.h"                            // for pg_data_t, zone
#include "linux/nodemask.h"                          // for nodemask_t, for_...
#include "linux/numa.h"                              // for NUMA_NO_NODE
#include "linux/page_ref.h"                          // for folio_ref_count
#include "linux/sched.h"                             // for cond_resched
#include "linux/sched/signal.h"                      // for fatal_signal_pen...
#include "linux/shrinker.h"                          // for shrinker, shrink...
#include "linux/slab.h"                              // for kfree, kzalloc
#include "linux/spinlock.h"                          // for spin_lock_irq
#include "linux/stddef.h"                            // for false, true
#include "linux/types.h"                             // for bool, list_head
#include "linux/vm_event_item.h"                     // for PGACTIVATE, PGDE...
#include "linux/wait.h"                              // for waitqueue_active
#include "linux/xarray.h"                            // for xa_unlock_irq
#include "vdso/limits.h"                             // for LLONG_MAX
struct mem_cgroup;
struct swap_iocb;

mm/vmscan.c should remove these lines:
- #include <asm/tlbflush.h>  // lines 54-54
- #include <linux/backing-dev.h>  // lines 32-32
- #include <linux/cpu.h>  // lines 35-35
- #include <linux/delay.h>  // lines 40-40
- #include <linux/file.h>  // lines 26-26
- #include <linux/highmem.h>  // lines 23-23
- #include <linux/kernel_stat.h>  // lines 19-19
- #include <linux/notifier.h>  // lines 38-38
- #include <linux/oom.h>  // lines 47-47
- #include <linux/swapops.h>  // lines 57-57
- #include <linux/sysctl.h>  // lines 46-46
- #include <linux/topology.h>  // lines 34-34

The full include-list for mm/vmscan.c:
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for BUG_ON, WARN_ON_...
#include <asm/div64.h>                               // for do_div
#include <linux/atomic.h>                            // for atomic_long_t
#include <linux/blkdev.h>                            // for blk_finish_plug
#include <linux/buffer_head.h>                       // for buffer_heads_ove...
#include <linux/compaction.h>                        // for compact_gap, wak...
#include <linux/cpuset.h>                            // for cpuset_zone_allowed
#include <linux/dax.h>                               // for dax_mapping
#include <linux/delayacct.h>                         // for delayacct_freepa...
#include <linux/freezer.h>                           // for try_to_freeze
#include <linux/gfp.h>                               // for gfp_zone, GFP_KE...
#include <linux/init.h>                              // for __init
#include <linux/kthread.h>                           // for kthread_should_stop
#include <linux/memcontrol.h>                        // for lruvec_page_state
#include <linux/migrate.h>                           // for next_demotion_node
#include <linux/mm.h>                                // for folio_test_large
#include <linux/mm_inline.h>                         // for folio_is_file_lru
#include <linux/mmzone.h>                            // for pageblock_order
#include <linux/module.h>                            // for module_init
#include <linux/pagemap.h>                           // for folio_unlock
#include <linux/pagevec.h>                           // for pagevec
#include <linux/printk.h>                            // for pr_err, pr_info
#include <linux/psi.h>                               // for psi_memstall_enter
#include <linux/rmap.h>                              // for folio_referenced
#include <linux/rwsem.h>                             // for down_write, up_w...
#include <linux/sched/mm.h>                          // for __fs_reclaim_acq...
#include <linux/sched/sysctl.h>                      // for NUMA_BALANCING_M...
#include <linux/swap.h>                              // for current_is_kswapd
#include <linux/vmpressure.h>                        // for vmpressure, vmpr...
#include <linux/vmstat.h>                            // for __count_vm_events
#include <linux/writeback.h>                         // for laptop_mode, wak...
#include <stddef.h>                                  // for NULL
#include <trace/events/vmscan.h>                     // for trace_mm_shrink_...
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/errno-base.h"                  // for EBUSY, ENOMEM
#include "asm-generic/errno.h"                       // for ENOSYS
#include "asm-generic/int-ll64.h"                    // for u64, s8
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/rwonce.h"                      // for WRITE_ONCE, READ...
#include "asm-generic/topology.h"                    // for cpumask_of_node
#include "asm/bug.h"                                 // for BUG
#include "asm/current.h"                             // for current
#include "asm/page_types.h"                          // for PAGE_SHIFT
#include "asm/processor.h"                           // for prefetchw, ARCH_...
#include "asm/string_32.h"                           // for memset, memcpy
#include "generated/bounds.h"                        // for MAX_NR_ZONES
#include "internal.h"                                // for free_unref_page_...
#include "linux/atomic/atomic-instrumented.h"        // for atomic_dec, atom...
#include "linux/backing-dev-defs.h"                  // for WB_REASON_VMSCAN
#include "linux/build_bug.h"                         // for BUILD_BUG_ON
#include "linux/compiler.h"                          // for unlikely, data_race
#include "linux/compiler_attributes.h"               // for fallthrough, __a...
#include "linux/compiler_types.h"                    // for inline
#include "linux/cpumask.h"                           // for cpumask_empty
#include "linux/err.h"                               // for IS_ERR
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/fs.h"                                // for address_space
#include "linux/huge_mm.h"                           // for split_folio_to_list
#include "linux/instruction_pointer.h"               // for _THIS_IP_
#include "linux/jiffies.h"                           // for jiffies_to_usecs
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/kernel.h"                            // for SYSTEM_RUNNING
#include "linux/limits.h"                            // for S8_MAX
#include "linux/list.h"                              // for list_empty, list...
#include "linux/math.h"                              // for int_sqrt
#include "linux/math64.h"                            // for div64_u64, DIV64...
#include "linux/migrate_mode.h"                      // for MIGRATE_ASYNC
#include "linux/minmax.h"                            // for min, max, max_t
#include "linux/mm_types.h"                          // for page, page::(ano...
#include "linux/mmdebug.h"                           // for VM_BUG_ON_FOLIO
#include "linux/mmzone.h"                            // for pg_data_t, zone
#include "linux/nodemask.h"                          // for nodemask_t, for_...
#include "linux/numa.h"                              // for NUMA_NO_NODE
#include "linux/page_ref.h"                          // for folio_ref_count
#include "linux/sched.h"                             // for cond_resched
#include "linux/sched/signal.h"                      // for fatal_signal_pen...
#include "linux/shrinker.h"                          // for shrinker, shrink...
#include "linux/slab.h"                              // for kfree, kzalloc
#include "linux/spinlock.h"                          // for spin_lock_irq
#include "linux/stddef.h"                            // for false, true
#include "linux/types.h"                             // for bool, list_head
#include "linux/vm_event_item.h"                     // for PGACTIVATE, PGDE...
#include "linux/wait.h"                              // for waitqueue_active
#include "linux/xarray.h"                            // for xa_unlock_irq
#include "swap.h"                                    // for page_swap_flags
#include "vdso/limits.h"                             // for LLONG_MAX
struct mem_cgroup;
struct swap_iocb;
---
  ./scripts/check-local-export mm/vmscan.o
  iwyu2 -Wp,-MMD,mm/.shmem.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/shmem"' -DKBUILD_BASENAME='"shmem"' -DKBUILD_MODNAME='"shmem"' -D__KBUILD_MODNAME=kmod_shmem -c -o mm/shmem.o mm/shmem.c  
In file included from mm/shmem.c:35:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/shmem.c:35:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/shmem.c:35:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/shmem.c:35:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/shmem.c:35:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/shmem.c:35:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/shmem.c:35:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/shmem.c:35:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/shmem.c should add these lines:
#include <asm/bug.h>                 // for BUG_ON
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL, ENOMEM, ENOSPC
#include "asm-generic/fcntl.h"       // for O_RDWR
#include "asm/current.h"             // for current
#include "linux/compiler.h"          // for unlikely
#include "linux/err.h"               // for IS_ERR, ERR_PTR, ERR_CAST, PTR_ERR
#include "linux/mm_types.h"          // for vm_area_struct, mm_struct, mm_st...
#include "linux/sched.h"             // for task_struct
#include "linux/stat.h"              // for S_IFREG, S_IRWXUGO
#include "linux/types.h"             // for loff_t, gfp_t, pgoff_t
struct ucounts;

mm/shmem.c should remove these lines:
- #include <linux/fs_parser.h>  // lines 38-38
- #include <linux/hugetlb.h>  // lines 37-37
- #include <linux/random.h>  // lines 32-32
- #include <linux/sched/signal.h>  // lines 33-33
- #include <linux/swap.h>  // lines 35-35
- #include <linux/uio.h>  // lines 36-36
- #include <linux/vfs.h>  // lines 26-26
- #include "swap.h"  // lines 39-39

The full include-list for mm/shmem.c:
#include <asm/bug.h>                 // for BUG_ON
#include <linux/export.h>            // for EXPORT_SYMBOL_GPL
#include <linux/file.h>              // for alloc_file_pseudo, fput
#include <linux/fs.h>                // for kill_litter_super, clear_nlink
#include <linux/init.h>              // for __init
#include <linux/mm.h>                // for truncate_inode_pages_range
#include <linux/mount.h>             // for kern_mount, vfsmount
#include <linux/pagemap.h>           // for read_cache_page_gfp
#include <linux/ramfs.h>             // for ramfs_init_fs_context, ramfs_get...
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL, ENOMEM, ENOSPC
#include "asm-generic/fcntl.h"       // for O_RDWR
#include "asm/current.h"             // for current
#include "linux/compiler.h"          // for unlikely
#include "linux/err.h"               // for IS_ERR, ERR_PTR, ERR_CAST, PTR_ERR
#include "linux/mm_types.h"          // for vm_area_struct, mm_struct, mm_st...
#include "linux/sched.h"             // for task_struct
#include "linux/stat.h"              // for S_IFREG, S_IRWXUGO
#include "linux/types.h"             // for loff_t, gfp_t, pgoff_t
struct ucounts;
---
  ./scripts/check-local-export mm/shmem.o
  iwyu2 -Wp,-MMD,mm/.util.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/util"' -DKBUILD_BASENAME='"util"' -DKBUILD_MODNAME='"util"' -D__KBUILD_MODNAME=kmod_util -c -o mm/util.o mm/util.c  
In file included from mm/util.c:13:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/util.c:13:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/util.c:13:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/util.c:13:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/util.c:13:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/util.c:13:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/util.c:13:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/util.c:13:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/util.c should add these lines:
#include <asm/bug.h>                           // for WARN_ON_ONCE
#include <linux/rcupdate.h>                    // for kvfree
#include <stddef.h>                            // for size_t, NULL
#include "asm-generic/errno-base.h"            // for ENOMEM, EFAULT, EINVAL
#include "asm-generic/resource.h"              // for RLIMIT_MEMLOCK
#include "asm-generic/sections.h"              // for is_kernel_rodata
#include "asm/cache.h"                         // for __read_mostly
#include "asm/current.h"                       // for current
#include "asm/elf.h"                           // for STACK_RND_MASK
#include "asm/page_types.h"                    // for PAGE_SHIFT, PAGE_SIZE
#include "asm/pgtable_32_areas.h"              // for VMALLOC_END, VMALLOC_S...
#include "asm/pgtable_types.h"                 // for PAGE_KERNEL
#include "asm/processor.h"                     // for KSTK_ESP, HAVE_ARCH_PI...
#include "asm/ptrace.h"                        // for pt_regs
#include "asm/string_32.h"                     // for strnlen, memcpy, strlen
#include "asm/uaccess.h"                       // for strnlen_user
#include "generated/autoconf.h"                // for CONFIG_MMU
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read
#include "linux/cache.h"                       // for ____cacheline_aligned_...
#include "linux/cacheflush.h"                  // for ARCH_IMPLEMENTS_FLUSH_...
#include "linux/capability.h"                  // for capable, CAP_IPC_LOCK
#include "linux/compiler_attributes.h"         // for __maybe_unused, __weak
#include "linux/compiler_types.h"              // for __user
#include "linux/file.h"                        // for fput
#include "linux/fs.h"                          // for file (ptr only), get_file
#include "linux/gfp.h"                         // for GFP_KERNEL, __GFP_NOWARN
#include "linux/highmem-internal.h"            // for kmap_atomic, kunmap_at...
#include "linux/highmem.h"                     // for copy_highpage
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/list.h"                        // for LIST_HEAD
#include "linux/minmax.h"                      // for min_t, swap
#include "linux/mm_types.h"                    // for mm_struct, mm_struct::...
#include "linux/mman.h"                        // for OVERCOMMIT_GUESS, OVER...
#include "linux/mmap_lock.h"                   // for mmap_write_unlock, mma...
#include "linux/overflow.h"                    // for check_mul_overflow
#include "linux/pagemap.h"                     // for folio_mapping
#include "linux/percpu_counter.h"              // for percpu_counter_read_po...
#include "linux/printk.h"                      // for pr_debug
#include "linux/rwsem.h"                       // for down_read, down_write
#include "linux/spinlock.h"                    // for spin_lock, spin_unlock
#include "linux/stddef.h"                      // for false, true
#include "linux/sysctl.h"                      // for proc_dointvec_minmax
#include "linux/types.h"                       // for gfp_t, bool, loff_t
#include "linux/workqueue.h"                   // for schedule_on_each_cpu
#include "vdso/limits.h"                       // for ULONG_MAX, INT_MAX

mm/util.c should remove these lines:
- #include <linux/compat.h>  // lines 25-25
- #include <linux/elf-randomize.h>  // lines 20-20
- #include <linux/elf.h>  // lines 19-19
- #include <linux/personality.h>  // lines 21-21
- #include <linux/sched/task_stack.h>  // lines 11-11
- #include <linux/sizes.h>  // lines 24-24
- #include <linux/swapops.h>  // lines 14-14

The full include-list for mm/util.c:
#include <asm/bug.h>                           // for WARN_ON_ONCE
#include <linux/compiler.h>                    // for unlikely, likely
#include <linux/err.h>                         // for ERR_PTR, IS_ERR
#include <linux/export.h>                      // for EXPORT_SYMBOL, EXPORT_...
#include <linux/hugetlb.h>                     // for hugetlb_total_pages
#include <linux/mm.h>                          // for folio_nr_pages, access...
#include <linux/mman.h>                        // for mm_compute_batch, vm_a...
#include <linux/random.h>                      // for get_random_long
#include <linux/rcupdate.h>                    // for kvfree
#include <linux/sched.h>                       // for task_struct, PF_RANDOMIZE
#include <linux/sched/mm.h>                    // for get_task_mm, mmput
#include <linux/sched/signal.h>                // for task_rlimit
#include <linux/security.h>                    // for security_mmap_file
#include <linux/slab.h>                        // for kfree, kmalloc_track_c...
#include <linux/string.h>                      // for memzero_explicit, kfre...
#include <linux/swap.h>                        // for folio_swap_entry, tota...
#include <linux/uaccess.h>                     // for copy_from_user
#include <linux/userfaultfd_k.h>               // for userfaultfd_unmap_comp...
#include <linux/vmalloc.h>                     // for __vmalloc, __vmalloc_n...
#include <stddef.h>                            // for size_t, NULL
#include "asm-generic/errno-base.h"            // for ENOMEM, EFAULT, EINVAL
#include "asm-generic/resource.h"              // for RLIMIT_MEMLOCK
#include "asm-generic/sections.h"              // for is_kernel_rodata
#include "asm/cache.h"                         // for __read_mostly
#include "asm/current.h"                       // for current
#include "asm/elf.h"                           // for STACK_RND_MASK
#include "asm/page_types.h"                    // for PAGE_SHIFT, PAGE_SIZE
#include "asm/pgtable_32_areas.h"              // for VMALLOC_END, VMALLOC_S...
#include "asm/pgtable_types.h"                 // for PAGE_KERNEL
#include "asm/processor.h"                     // for KSTK_ESP, HAVE_ARCH_PI...
#include "asm/ptrace.h"                        // for pt_regs
#include "asm/string_32.h"                     // for strnlen, memcpy, strlen
#include "asm/uaccess.h"                       // for strnlen_user
#include "generated/autoconf.h"                // for CONFIG_MMU
#include "internal.h"                          // for folio_raw_mapping, __v...
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read
#include "linux/cache.h"                       // for ____cacheline_aligned_...
#include "linux/cacheflush.h"                  // for ARCH_IMPLEMENTS_FLUSH_...
#include "linux/capability.h"                  // for capable, CAP_IPC_LOCK
#include "linux/compiler_attributes.h"         // for __maybe_unused, __weak
#include "linux/compiler_types.h"              // for __user
#include "linux/file.h"                        // for fput
#include "linux/fs.h"                          // for file (ptr only), get_file
#include "linux/gfp.h"                         // for GFP_KERNEL, __GFP_NOWARN
#include "linux/highmem-internal.h"            // for kmap_atomic, kunmap_at...
#include "linux/highmem.h"                     // for copy_highpage
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/list.h"                        // for LIST_HEAD
#include "linux/minmax.h"                      // for min_t, swap
#include "linux/mm_types.h"                    // for mm_struct, mm_struct::...
#include "linux/mman.h"                        // for OVERCOMMIT_GUESS, OVER...
#include "linux/mmap_lock.h"                   // for mmap_write_unlock, mma...
#include "linux/overflow.h"                    // for check_mul_overflow
#include "linux/pagemap.h"                     // for folio_mapping
#include "linux/percpu_counter.h"              // for percpu_counter_read_po...
#include "linux/printk.h"                      // for pr_debug
#include "linux/rwsem.h"                       // for down_read, down_write
#include "linux/spinlock.h"                    // for spin_lock, spin_unlock
#include "linux/stddef.h"                      // for false, true
#include "linux/sysctl.h"                      // for proc_dointvec_minmax
#include "linux/types.h"                       // for gfp_t, bool, loff_t
#include "linux/workqueue.h"                   // for schedule_on_each_cpu
#include "swap.h"                              // for swap_address_space
#include "vdso/limits.h"                       // for ULONG_MAX, INT_MAX
---
  ./scripts/check-local-export mm/util.o
  iwyu2 -Wp,-MMD,mm/.mmzone.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/mmzone"' -DKBUILD_BASENAME='"mmzone"' -DKBUILD_MODNAME='"mmzone"' -D__KBUILD_MODNAME=kmod_mmzone -c -o mm/mmzone.o mm/mmzone.c  

mm/mmzone.c should add these lines:
#include <stddef.h>                // for NULL
#include "asm/string_32.h"         // for memset
#include "generated/bounds.h"      // for MAX_NR_ZONES
#include "linux/compiler.h"        // for unlikely
#include "linux/compiler_types.h"  // for inline
#include "linux/list.h"            // for INIT_LIST_HEAD, list_del
#include "linux/nodemask.h"        // for nodemask_t, first_online_node, nex...
#include "linux/numa.h"            // for MAX_NUMNODES
#include "linux/spinlock.h"        // for spin_lock_init
#include "linux/types.h"           // for list_head

mm/mmzone.c should remove these lines:
- #include <linux/mm.h>  // lines 10-10
- #include <linux/stddef.h>  // lines 9-9

The full include-list for mm/mmzone.c:
#include <linux/mmzone.h>          // for NODE_DATA, zonelist_zone_idx, lruvec
#include <stddef.h>                // for NULL
#include "asm/string_32.h"         // for memset
#include "generated/bounds.h"      // for MAX_NR_ZONES
#include "linux/compiler.h"        // for unlikely
#include "linux/compiler_types.h"  // for inline
#include "linux/list.h"            // for INIT_LIST_HEAD, list_del
#include "linux/nodemask.h"        // for nodemask_t, first_online_node, nex...
#include "linux/numa.h"            // for MAX_NUMNODES
#include "linux/spinlock.h"        // for spin_lock_init
#include "linux/types.h"           // for list_head
---
  ./scripts/check-local-export mm/mmzone.o
  iwyu2 -Wp,-MMD,mm/.vmstat.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/vmstat"' -DKBUILD_BASENAME='"vmstat"' -DKBUILD_MODNAME='"vmstat"' -D__KBUILD_MODNAME=kmod_vmstat -c -o mm/vmstat.o mm/vmstat.c  
In file included from mm/vmstat.c:18:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/vmstat.c:18:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/vmstat.c:18:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/vmstat.c:28:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from mm/vmstat.c:18:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/vmstat.c:18:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/vmstat.c:18:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/vmstat.c:28:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

mm/vmstat.c should add these lines:
#include <linux/atomic.h>               // for atomic_long_t
#include "linux/cache.h"                // for __cacheline_aligned_in_smp
#include "linux/compiler_attributes.h"  // for __maybe_unused
#include "linux/export.h"               // for EXPORT_SYMBOL
#include "linux/init.h"                 // for __init
#include "linux/mmzone.h"               // for NR_VM_NODE_STAT_ITEMS, NR_VM_...
#include "linux/workqueue.h"            // for alloc_workqueue, WQ_MEM_RECLAIM

mm/vmstat.c should remove these lines:
- #include <linux/compaction.h>  // lines 27-27
- #include <linux/cpu.h>  // lines 18-18
- #include <linux/cpumask.h>  // lines 19-19
- #include <linux/debugfs.h>  // lines 23-23
- #include <linux/err.h>  // lines 15-15
- #include <linux/fs.h>  // lines 13-13
- #include <linux/math64.h>  // lines 25-25
- #include <linux/mm_inline.h>  // lines 28-28
- #include <linux/module.h>  // lines 16-16
- #include <linux/page_ext.h>  // lines 29-29
- #include <linux/page_owner.h>  // lines 30-30
- #include <linux/proc_fs.h>  // lines 21-21
- #include <linux/sched.h>  // lines 24-24
- #include <linux/seq_file.h>  // lines 22-22
- #include <linux/slab.h>  // lines 17-17
- #include <linux/vmstat.h>  // lines 20-20
- #include <linux/writeback.h>  // lines 26-26
- #include "internal.h"  // lines 33-33

The full include-list for mm/vmstat.c:
#include <linux/atomic.h>               // for atomic_long_t
#include <linux/migrate.h>              // for migrate_on_reclaim_init
#include <linux/mm.h>                   // for init_mm_internals
#include "linux/cache.h"                // for __cacheline_aligned_in_smp
#include "linux/compiler_attributes.h"  // for __maybe_unused
#include "linux/export.h"               // for EXPORT_SYMBOL
#include "linux/init.h"                 // for __init
#include "linux/mmzone.h"               // for NR_VM_NODE_STAT_ITEMS, NR_VM_...
#include "linux/workqueue.h"            // for alloc_workqueue, WQ_MEM_RECLAIM
---
  ./scripts/check-local-export mm/vmstat.o
  iwyu2 -Wp,-MMD,mm/.backing-dev.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/backing-dev"' -DKBUILD_BASENAME='"backing_dev"' -DKBUILD_MODNAME='"backing_dev"' -D__KBUILD_MODNAME=kmod_backing_dev -c -o mm/backing-dev.o mm/backing-dev.c  
In file included from mm/backing-dev.c:3:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/backing-dev.c:3:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/backing-dev.c:3:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/backing-dev.c:3:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
4 warnings generated.
In file included from mm/backing-dev.c:3:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/backing-dev.c:3:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/backing-dev.c:3:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/backing-dev.c:3:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^

mm/backing-dev.c should add these lines:
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON_ONCE
#include <linux/rcupdate.h>                          // for synchronize_rcu_...
#include <cstdio>                                    // for NULL, ssize_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit, test_an...
#include "asm-generic/errno-base.h"                  // for ENOMEM
#include "asm-generic/int-ll64.h"                    // for u64
#include "asm/page_types.h"                          // for PAGE_SHIFT
#include "asm/string_32.h"                           // for memset
#include "linux/atomic/atomic-instrumented.h"        // for atomic_set
#include "linux/backing-dev-defs.h"                  // for backing_dev_info
#include "linux/compiler_types.h"                    // for inline
#include "linux/container_of.h"                      // for container_of
#include "linux/dev_printk.h"                        // for dev_warn_once
#include "linux/device/class.h"                      // for class, class_create
#include "linux/err.h"                               // for IS_ERR, PTR_ERR
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/flex_proportions.h"                  // for fprop_local_dest...
#include "linux/gfp.h"                               // for GFP_KERNEL
#include "linux/init.h"                              // for __init, postcore...
#include "linux/jiffies.h"                           // for jiffies, msecs_t...
#include "linux/kdev_t.h"                            // for MKDEV
#include "linux/kernel.h"                            // for vsnprintf
#include "linux/kref.h"                              // for kref_init, kref_put
#include "linux/kstrtox.h"                           // for kstrtouint, kstr...
#include "linux/list.h"                              // for INIT_LIST_HEAD
#include "linux/lockdep.h"                           // for lockdep_assert_held
#include "linux/percpu_counter.h"                    // for percpu_counter_d...
#include "linux/rbtree_types.h"                      // for rb_node, rb_root
#include "linux/rculist.h"                           // for list_add_tail_rcu
#include "linux/slab.h"                              // for kfree, kzalloc_node
#include "linux/spinlock.h"                          // for spin_unlock_bh
#include "linux/spinlock_types.h"                    // for DEFINE_SPINLOCK
#include "linux/stdarg.h"                            // for va_end, va_start
#include "linux/sysfs.h"                             // for sysfs_emit, ATTR...
#include "linux/timer.h"                             // for del_timer_sync
#include "linux/types.h"                             // for gfp_t
#include "linux/workqueue.h"                         // for to_delayed_work

mm/backing-dev.c should remove these lines:
- #include <linux/blk-cgroup.h>  // lines 8-8
- #include <linux/blkdev.h>  // lines 3-3
- #include <linux/freezer.h>  // lines 9-9
- #include <linux/kthread.h>  // lines 6-6
- #include <linux/mm.h>  // lines 12-12
- #include <linux/module.h>  // lines 15-15
- #include <linux/sched.h>  // lines 14-14
- #include <linux/sched/mm.h>  // lines 13-13

The full include-list for mm/backing-dev.c:
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON_ONCE
#include <linux/backing-dev.h>                       // for bdi_set_min_ratio
#include <linux/device.h>                            // for dev_get_drvdata
#include <linux/fs.h>                                // for inode, super_block
#include <linux/pagemap.h>                           // for VM_READAHEAD_PAGES
#include <linux/rbtree.h>                            // for rb_erase, rb_ins...
#include <linux/rcupdate.h>                          // for synchronize_rcu_...
#include <linux/wait.h>                              // for init_waitqueue_head
#include <linux/writeback.h>                         // for wb_update_bandwidth
#include <trace/events/writeback.h>                  // for trace_writeback_...
#include <cstdio>                                    // for NULL, ssize_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit, test_an...
#include "asm-generic/errno-base.h"                  // for ENOMEM
#include "asm-generic/int-ll64.h"                    // for u64
#include "asm/page_types.h"                          // for PAGE_SHIFT
#include "asm/string_32.h"                           // for memset
#include "linux/atomic/atomic-instrumented.h"        // for atomic_set
#include "linux/backing-dev-defs.h"                  // for backing_dev_info
#include "linux/compiler_types.h"                    // for inline
#include "linux/container_of.h"                      // for container_of
#include "linux/dev_printk.h"                        // for dev_warn_once
#include "linux/device/class.h"                      // for class, class_create
#include "linux/err.h"                               // for IS_ERR, PTR_ERR
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/flex_proportions.h"                  // for fprop_local_dest...
#include "linux/gfp.h"                               // for GFP_KERNEL
#include "linux/init.h"                              // for __init, postcore...
#include "linux/jiffies.h"                           // for jiffies, msecs_t...
#include "linux/kdev_t.h"                            // for MKDEV
#include "linux/kernel.h"                            // for vsnprintf
#include "linux/kref.h"                              // for kref_init, kref_put
#include "linux/kstrtox.h"                           // for kstrtouint, kstr...
#include "linux/list.h"                              // for INIT_LIST_HEAD
#include "linux/lockdep.h"                           // for lockdep_assert_held
#include "linux/percpu_counter.h"                    // for percpu_counter_d...
#include "linux/rbtree_types.h"                      // for rb_node, rb_root
#include "linux/rculist.h"                           // for list_add_tail_rcu
#include "linux/slab.h"                              // for kfree, kzalloc_node
#include "linux/spinlock.h"                          // for spin_unlock_bh
#include "linux/spinlock_types.h"                    // for DEFINE_SPINLOCK
#include "linux/stdarg.h"                            // for va_end, va_start
#include "linux/sysfs.h"                             // for sysfs_emit, ATTR...
#include "linux/timer.h"                             // for del_timer_sync
#include "linux/types.h"                             // for gfp_t
#include "linux/workqueue.h"                         // for to_delayed_work
---
  ./scripts/check-local-export mm/backing-dev.o
  iwyu2 -Wp,-MMD,mm/.mm_init.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/mm_init"' -DKBUILD_BASENAME='"mm_init"' -DKBUILD_MODNAME='"mm_init"' -D__KBUILD_MODNAME=kmod_mm_init -c -o mm/mm_init.o mm/mm_init.c  
In file included from mm/mm_init.c:13:
In file included from ./include/linux/memory.h:19:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/mm_init.c:13:
In file included from ./include/linux/memory.h:19:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/mm_init.c:13:
In file included from ./include/linux/memory.h:19:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/mm_init.c:17:
In file included from mm/internal.h:13:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from mm/mm_init.c:13:
In file included from ./include/linux/memory.h:19:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/mm_init.c:13:
In file included from ./include/linux/memory.h:19:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/mm_init.c:13:
In file included from ./include/linux/memory.h:19:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/mm_init.c:17:
In file included from mm/internal.h:13:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

mm/mm_init.c should add these lines:
#include "asm-generic/errno-base.h"  // for ENOMEM

mm/mm_init.c should remove these lines:
- #include <linux/kernel.h>  // lines 9-9
- #include <linux/memory.h>  // lines 13-13
- #include <linux/mman.h>  // lines 16-16
- #include <linux/notifier.h>  // lines 14-14
- #include <linux/sched.h>  // lines 15-15
- #include "internal.h"  // lines 17-17

The full include-list for mm/mm_init.c:
#include <linux/export.h>            // for EXPORT_SYMBOL_GPL
#include <linux/init.h>              // for __init, postcore_initcall
#include <linux/kobject.h>           // for kobject_create_and_add, kernel_kobj
#include "asm-generic/errno-base.h"  // for ENOMEM
---
  ./scripts/check-local-export mm/mm_init.o
  iwyu2 -Wp,-MMD,mm/.percpu.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/percpu"' -DKBUILD_BASENAME='"percpu"' -DKBUILD_MODNAME='"percpu"' -D__KBUILD_MODNAME=kmod_percpu -c -o mm/percpu.o mm/percpu.c  
In file included from mm/percpu.c:90:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/percpu.c:90:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/percpu.c:90:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/percpu.c:90:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/percpu.c:90:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/percpu.c:90:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/percpu.c:90:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/percpu.c:90:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/percpu.c should add these lines:
#include <asm-generic/percpu.h>                      // for per_cpu_ptr
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON, BUG_ON
#include <linux/bitops.h>                            // for __ffs, fls
#include <linux/build_bug.h>                         // for unlikely
#include <stddef.h>                                  // for size_t, NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit
#include "asm-generic/bitsperlong.h"                 // for BITS_PER_LONG
#include "asm/bug.h"                                 // for BUG
#include "asm/cache.h"                               // for __read_mostly
#include "asm/dma.h"                                 // for MAX_DMA_ADDRESS
#include "asm/page.h"                                // for __pa
#include "asm/page_types.h"                          // for PAGE_SIZE, PAGE_...
#include "asm/string_32.h"                           // for memset
#include "linux/align.h"                             // for ALIGN, IS_ALIGNED
#include "linux/bitops.h"                            // for BITS_TO_LONGS
#include "linux/cache.h"                             // for __ro_after_init
#include "linux/compiler_attributes.h"               // for __maybe_unused
#include "linux/compiler_types.h"                    // for __percpu, __force
#include "linux/export.h"                            // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                               // for GFP_KERNEL, __GF...
#include "linux/init.h"                              // for __init, subsys_i...
#include "linux/instruction_pointer.h"               // for _RET_IP_
#include "linux/kern_levels.h"                       // for KERN_EMERG, KERN...
#include "linux/lockdep.h"                           // for lockdep_assert_held
#include "linux/minmax.h"                            // for min_t, min, max
#include "linux/mm_types.h"                          // for page, page::(ano...
#include "linux/overflow.h"                          // for struct_size
#include "linux/panic.h"                             // for panic
#include "linux/printk.h"                            // for pr_emerg, pr_cont
#include "linux/smp.h"                               // for raw_smp_processo...
#include "linux/spinlock_types.h"                    // for DEFINE_SPINLOCK
#include "linux/stddef.h"                            // for true, false
#include "linux/threads.h"                           // for NR_CPUS
#include "linux/types.h"                             // for list_head, bool
#include "vdso/limits.h"                             // for UINT_MAX
struct obj_cgroup;

mm/percpu.c should remove these lines:
- #include <asm/cacheflush.h>  // lines 92-92
- #include <asm/sections.h>  // lines 93-93
- #include <asm/tlbflush.h>  // lines 94-94
- #include <linux/err.h>  // lines 74-74
- #include <linux/memcontrol.h>  // lines 90-90
- #include <linux/module.h>  // lines 79-79

The full include-list for mm/percpu.c:
#include <asm-generic/percpu.h>                      // for per_cpu_ptr
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON, BUG_ON
#include <asm/io.h>                                  // for page_to_phys
#include <linux/bitmap.h>                            // for find_next_zero_bit
#include <linux/bitops.h>                            // for __ffs, fls
#include <linux/build_bug.h>                         // for unlikely
#include <linux/cpumask.h>                           // for cpu_possible_mask
#include <linux/kmemleak.h>                          // for kmemleak_alloc_p...
#include <linux/lcm.h>                               // for lcm
#include <linux/list.h>                              // for INIT_LIST_HEAD
#include <linux/log2.h>                              // for is_power_of_2
#include <linux/memblock.h>                          // for memblock_alloc
#include <linux/mm.h>                                // for offset_in_page
#include <linux/mutex.h>                             // for mutex_unlock, mutex
#include <linux/percpu.h>                            // for pcpu_alloc_info
#include <linux/pfn.h>                               // for PFN_DOWN, PFN_ALIGN
#include <linux/sched.h>                             // for cond_resched
#include <linux/sched/mm.h>                          // for current_gfp_context
#include <linux/slab.h>                              // for kvfree, kzalloc
#include <linux/spinlock.h>                          // for spin_lock_irq
#include <linux/vmalloc.h>                           // for __vmalloc
#include <linux/workqueue.h>                         // for work_struct, sch...
#include <stddef.h>                                  // for size_t, NULL
#include <trace/events/percpu.h>                     // for trace_percpu_all...
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit
#include "asm-generic/bitsperlong.h"                 // for BITS_PER_LONG
#include "asm/bug.h"                                 // for BUG
#include "asm/cache.h"                               // for __read_mostly
#include "asm/dma.h"                                 // for MAX_DMA_ADDRESS
#include "asm/page.h"                                // for __pa
#include "asm/page_types.h"                          // for PAGE_SIZE, PAGE_...
#include "asm/string_32.h"                           // for memset
#include "linux/align.h"                             // for ALIGN, IS_ALIGNED
#include "linux/bitops.h"                            // for BITS_TO_LONGS
#include "linux/cache.h"                             // for __ro_after_init
#include "linux/compiler_attributes.h"               // for __maybe_unused
#include "linux/compiler_types.h"                    // for __percpu, __force
#include "linux/export.h"                            // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                               // for GFP_KERNEL, __GF...
#include "linux/init.h"                              // for __init, subsys_i...
#include "linux/instruction_pointer.h"               // for _RET_IP_
#include "linux/kern_levels.h"                       // for KERN_EMERG, KERN...
#include "linux/lockdep.h"                           // for lockdep_assert_held
#include "linux/minmax.h"                            // for min_t, min, max
#include "linux/mm_types.h"                          // for page, page::(ano...
#include "linux/overflow.h"                          // for struct_size
#include "linux/panic.h"                             // for panic
#include "linux/printk.h"                            // for pr_emerg, pr_cont
#include "linux/smp.h"                               // for raw_smp_processo...
#include "linux/spinlock_types.h"                    // for DEFINE_SPINLOCK
#include "linux/stddef.h"                            // for true, false
#include "linux/threads.h"                           // for NR_CPUS
#include "linux/types.h"                             // for list_head, bool
#include "percpu-internal.h"                         // for pcpu_chunk, pcpu...
#include "percpu-km.c"                               // for pcpu_should_recl...
#include "vdso/limits.h"                             // for UINT_MAX
struct obj_cgroup;
---
  ./scripts/check-local-export mm/percpu.o
  iwyu2 -Wp,-MMD,mm/.slab_common.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/slab_common"' -DKBUILD_BASENAME='"slab_common"' -DKBUILD_MODNAME='"slab_common"' -D__KBUILD_MODNAME=kmod_slab_common -c -o mm/slab_common.o mm/slab_common.c  
In file included from mm/slab_common.c:12:
In file included from ./include/linux/memory.h:19:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/slab_common.c:12:
In file included from ./include/linux/memory.h:19:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/slab_common.c:12:
In file included from ./include/linux/memory.h:19:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/slab_common.c:26:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from mm/slab_common.c:12:
In file included from ./include/linux/memory.h:19:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/slab_common.c:12:
In file included from ./include/linux/memory.h:19:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/slab_common.c:12:
In file included from ./include/linux/memory.h:19:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/slab_common.c:26:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

mm/slab_common.c should add these lines:
#include <asm/bug.h>                      // for WARN_ON, WARN, WARN_ON_ONCE
#include <linux/bitops.h>                 // for fls
#include <linux/build_bug.h>              // for unlikely, likely
#include <linux/rcupdate.h>               // for rcu_barrier
#include <stddef.h>                       // for size_t, NULL
#include "asm-generic/errno-base.h"       // for ENOMEM, EBUSY, EINVAL
#include "asm-generic/error-injection.h"  // for ALLOW_ERROR_INJECTION
#include "asm-generic/int-ll64.h"         // for u8
#include "asm/page_types.h"               // for PAGE_SIZE
#include "asm/processor.h"                // for cache_line_size
#include "asm/string_32.h"                // for memcpy
#include "linux/align.h"                  // for ALIGN
#include "linux/build_bug.h"              // for BUILD_BUG_ON
#include "linux/compiler_attributes.h"    // for __always_inline
#include "linux/compiler_types.h"         // for inline
#include "linux/err.h"                    // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/export.h"                 // for EXPORT_SYMBOL
#include "linux/fault-inject.h"           // for __should_failslab, should_f...
#include "linux/gfp.h"                    // for alloc_pages, GFP_KERNEL
#include "linux/init.h"                   // for __init, __setup, __setup_param
#include "linux/instruction_pointer.h"    // for _RET_IP_
#include "linux/kconfig.h"                // for IS_ENABLED
#include "linux/kernel.h"                 // for ARRAY_SIZE
#include "linux/kmemleak.h"               // for kmemleak_alloc
#include "linux/list.h"                   // for list_add, LIST_HEAD, list_a...
#include "linux/log2.h"                   // for is_power_of_2
#include "linux/minmax.h"                 // for max
#include "linux/mmzone.h"                 // for NR_SLAB_UNRECLAIMABLE_B
#include "linux/mutex.h"                  // for mutex_lock, mutex_unlock
#include "linux/panic.h"                  // for panic
#include "linux/printk.h"                 // for dump_stack, pr_warn
#include "linux/slub_def.h"               // for kmem_cache
#include "linux/stddef.h"                 // for false, true
#include "linux/string.h"                 // for kfree_const, kstrdup_const
#include "linux/tracepoint.h"             // for EXPORT_TRACEPOINT_SYMBOL
#include "linux/types.h"                  // for gfp_t, list_head, slab_flags_t
#include "linux/vmstat.h"                 // for mod_lruvec_page_state
#include "linux/workqueue.h"              // for work_struct, schedule_work

mm/slab_common.c should remove these lines:
- #include <asm/cacheflush.h>  // lines 23-23
- #include <asm/page.h>  // lines 25-25
- #include <asm/tlbflush.h>  // lines 24-24
- #include <linux/compiler.h>  // lines 14-14
- #include <linux/debugfs.h>  // lines 21-21
- #include <linux/interrupt.h>  // lines 11-11
- #include <linux/memory.h>  // lines 12-12
- #include <linux/module.h>  // lines 16-16
- #include <linux/poison.h>  // lines 10-10
- #include <linux/proc_fs.h>  // lines 20-20
- #include <linux/seq_file.h>  // lines 19-19
- #include <linux/stackdepot.h>  // lines 27-27
- #include <linux/uaccess.h>  // lines 18-18
- #include <trace/events/kmem.h>  // lines 30-30

The full include-list for mm/slab_common.c:
#include <asm/bug.h>                      // for WARN_ON, WARN, WARN_ON_ONCE
#include <linux/bitops.h>                 // for fls
#include <linux/build_bug.h>              // for unlikely, likely
#include <linux/cache.h>                  // for __ro_after_init
#include <linux/cpu.h>                    // for cpus_read_lock, cpus_read_u...
#include <linux/kasan.h>                  // for kasan_check_byte, kasan_res...
#include <linux/kfence.h>                 // for kfence_ksize, kfence_shutdo...
#include <linux/memcontrol.h>             // for mem_cgroup_kmem_disabled
#include <linux/mm.h>                     // for page_address
#include <linux/rcupdate.h>               // for rcu_barrier
#include <linux/slab.h>                   // for KMALLOC_NORMAL, KMALLOC_REC...
#include <stddef.h>                       // for size_t, NULL
#include "asm-generic/errno-base.h"       // for ENOMEM, EBUSY, EINVAL
#include "asm-generic/error-injection.h"  // for ALLOW_ERROR_INJECTION
#include "asm-generic/int-ll64.h"         // for u8
#include "asm/page_types.h"               // for PAGE_SIZE
#include "asm/processor.h"                // for cache_line_size
#include "asm/string_32.h"                // for memcpy
#include "internal.h"                     // for GFP_SLAB_BUG_MASK
#include "linux/align.h"                  // for ALIGN
#include "linux/build_bug.h"              // for BUILD_BUG_ON
#include "linux/compiler_attributes.h"    // for __always_inline
#include "linux/compiler_types.h"         // for inline
#include "linux/err.h"                    // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/export.h"                 // for EXPORT_SYMBOL
#include "linux/fault-inject.h"           // for __should_failslab, should_f...
#include "linux/gfp.h"                    // for alloc_pages, GFP_KERNEL
#include "linux/init.h"                   // for __init, __setup, __setup_param
#include "linux/instruction_pointer.h"    // for _RET_IP_
#include "linux/kconfig.h"                // for IS_ENABLED
#include "linux/kernel.h"                 // for ARRAY_SIZE
#include "linux/kmemleak.h"               // for kmemleak_alloc
#include "linux/list.h"                   // for list_add, LIST_HEAD, list_a...
#include "linux/log2.h"                   // for is_power_of_2
#include "linux/minmax.h"                 // for max
#include "linux/mmzone.h"                 // for NR_SLAB_UNRECLAIMABLE_B
#include "linux/mutex.h"                  // for mutex_lock, mutex_unlock
#include "linux/panic.h"                  // for panic
#include "linux/printk.h"                 // for dump_stack, pr_warn
#include "linux/slub_def.h"               // for kmem_cache
#include "linux/stddef.h"                 // for false, true
#include "linux/string.h"                 // for kfree_const, kstrdup_const
#include "linux/tracepoint.h"             // for EXPORT_TRACEPOINT_SYMBOL
#include "linux/types.h"                  // for gfp_t, list_head, slab_flags_t
#include "linux/vmstat.h"                 // for mod_lruvec_page_state
#include "linux/workqueue.h"              // for work_struct, schedule_work
#include "slab.h"                         // for kmalloc_info_struct, __kmem...
---
  ./scripts/check-local-export mm/slab_common.o
  iwyu2 -Wp,-MMD,mm/.compaction.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/compaction"' -DKBUILD_BASENAME='"compaction"' -DKBUILD_MODNAME='"compaction"' -D__KBUILD_MODNAME=kmod_compaction -c -o mm/compaction.o mm/compaction.c  
In file included from mm/compaction.c:11:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/compaction.c:11:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/compaction.c:11:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/compaction.c:12:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from mm/compaction.c:11:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/compaction.c:11:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/compaction.c:11:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/compaction.c:12:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

mm/compaction.c should add these lines:

mm/compaction.c should remove these lines:
- #include <linux/backing-dev.h>  // lines 17-17
- #include <linux/compaction.h>  // lines 14-14
- #include <linux/cpu.h>  // lines 11-11
- #include <linux/freezer.h>  // lines 23-23
- #include <linux/kasan.h>  // lines 21-21
- #include <linux/kthread.h>  // lines 22-22
- #include <linux/migrate.h>  // lines 13-13
- #include <linux/mm_inline.h>  // lines 15-15
- #include <linux/page-isolation.h>  // lines 20-20
- #include <linux/page_owner.h>  // lines 24-24
- #include <linux/psi.h>  // lines 25-25
- #include <linux/sched/signal.h>  // lines 16-16
- #include <linux/swap.h>  // lines 12-12
- #include <linux/sysctl.h>  // lines 18-18
- #include <linux/sysfs.h>  // lines 19-19
- #include "internal.h"  // lines 26-26

The full include-list for mm/compaction.c:
---
  ./scripts/check-local-export mm/compaction.o
  iwyu2 -Wp,-MMD,mm/.vmacache.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/vmacache"' -DKBUILD_BASENAME='"vmacache"' -DKBUILD_MODNAME='"vmacache"' -D__KBUILD_MODNAME=kmod_vmacache -c -o mm/vmacache.o mm/vmacache.c  

mm/vmacache.c should add these lines:
#include <stddef.h>                     // for NULL
#include "asm-generic/pgtable-nopmd.h"  // for PMD_SHIFT
#include "asm/current.h"                // for current
#include "linux/compiler_types.h"       // for inline
#include "linux/mm_types.h"             // for vm_area_struct, mm_struct
#include "linux/mm_types_task.h"        // for vmacache, VMACACHE_MASK, VMAC...
#include "linux/sched.h"                // for task_struct, PF_KTHREAD
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool
#include "linux/vmstat.h"               // for count_vm_vmacache_event

mm/vmacache.c should remove these lines:
- #include <linux/mm.h>  // lines 7-7
- #include <linux/sched/signal.h>  // lines 5-5
- #include <linux/sched/task.h>  // lines 6-6

The full include-list for mm/vmacache.c:
#include <linux/vmacache.h>             // for vmacache_flush, vmacache_find
#include <stddef.h>                     // for NULL
#include "asm-generic/pgtable-nopmd.h"  // for PMD_SHIFT
#include "asm/current.h"                // for current
#include "linux/compiler_types.h"       // for inline
#include "linux/mm_types.h"             // for vm_area_struct, mm_struct
#include "linux/mm_types_task.h"        // for vmacache, VMACACHE_MASK, VMAC...
#include "linux/sched.h"                // for task_struct, PF_KTHREAD
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool
#include "linux/vmstat.h"               // for count_vm_vmacache_event
---
  ./scripts/check-local-export mm/vmacache.o
  iwyu2 -Wp,-MMD,mm/.interval_tree.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/interval_tree"' -DKBUILD_BASENAME='"interval_tree"' -DKBUILD_MODNAME='"interval_tree"' -D__KBUILD_MODNAME=kmod_interval_tree -c -o mm/interval_tree.o mm/interval_tree.c  
In file included from mm/interval_tree.c:10:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/interval_tree.c:10:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/interval_tree.c:10:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/interval_tree.c:10:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/interval_tree.c:10:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/interval_tree.c:10:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/interval_tree.c:10:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/interval_tree.c:10:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/interval_tree.c should add these lines:
#include "linux/compiler_types.h"         // for inline
#include "linux/mm_types.h"               // for vm_area_struct, vm_area_str...
#include "linux/mmdebug.h"                // for VM_BUG_ON_VMA
#include "linux/rbtree.h"                 // for rb_link_node, rb_entry
#include "linux/rbtree_augmented.h"       // for rb_insert_augmented
#include "linux/rbtree_types.h"           // for rb_node, rb_root_cached

mm/interval_tree.c should remove these lines:
- #include <linux/fs.h>  // lines 9-9

The full include-list for mm/interval_tree.c:
#include <linux/interval_tree_generic.h>  // for INTERVAL_TREE_DEFINE
#include <linux/mm.h>                     // for vma_pages, anon_vma_interva...
#include <linux/rmap.h>                   // for anon_vma_chain
#include "linux/compiler_types.h"         // for inline
#include "linux/mm_types.h"               // for vm_area_struct, vm_area_str...
#include "linux/mmdebug.h"                // for VM_BUG_ON_VMA
#include "linux/rbtree.h"                 // for rb_link_node, rb_entry
#include "linux/rbtree_augmented.h"       // for rb_insert_augmented
#include "linux/rbtree_types.h"           // for rb_node, rb_root_cached
---
  ./scripts/check-local-export mm/interval_tree.o
  iwyu2 -Wp,-MMD,mm/.list_lru.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/list_lru"' -DKBUILD_BASENAME='"list_lru"' -DKBUILD_MODNAME='"list_lru"' -D__KBUILD_MODNAME=kmod_list_lru -c -o mm/list_lru.o mm/list_lru.c  
In file included from mm/list_lru.c:14:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/list_lru.c:14:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/list_lru.c:14:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/list_lru.c:14:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/list_lru.c:14:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/list_lru.c:14:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/list_lru.c:14:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/list_lru.c:14:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/list_lru.c should add these lines:
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for ENOMEM
#include "asm-generic/rwonce.h"         // for READ_ONCE
#include "asm/bug.h"                    // for BUG
#include "asm/page.h"                   // for virt_to_page
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for inline
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/list.h"                 // for list_del_init, list_empty
#include "linux/lockdep.h"              // for lockdep_set_class
#include "linux/nodemask.h"             // for for_each_node, nr_node_ids
#include "linux/rcupdate.h"             // for rcu_read_lock, rcu_read_unlock
#include "linux/spinlock.h"             // for spin_unlock, spin_lock, spin_...
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool, list_head
struct lock_class_key;
struct mem_cgroup;
struct shrinker;

mm/list_lru.c should remove these lines:
- #include <linux/kernel.h>  // lines 8-8
- #include <linux/module.h>  // lines 9-9
- #include <linux/mutex.h>  // lines 13-13
- #include "internal.h"  // lines 16-16
- #include "slab.h"  // lines 15-15

The full include-list for mm/list_lru.c:
#include <linux/list_lru.h>             // for list_lru_node, list_lru_one
#include <linux/memcontrol.h>           // for memcg_kmem_id, set_shrinker_bit
#include <linux/mm.h>                   // for page_to_nid
#include <linux/slab.h>                 // for kcalloc, kfree
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for ENOMEM
#include "asm-generic/rwonce.h"         // for READ_ONCE
#include "asm/bug.h"                    // for BUG
#include "asm/page.h"                   // for virt_to_page
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for inline
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/list.h"                 // for list_del_init, list_empty
#include "linux/lockdep.h"              // for lockdep_set_class
#include "linux/nodemask.h"             // for for_each_node, nr_node_ids
#include "linux/rcupdate.h"             // for rcu_read_lock, rcu_read_unlock
#include "linux/spinlock.h"             // for spin_unlock, spin_lock, spin_...
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool, list_head
struct lock_class_key;
struct mem_cgroup;
struct shrinker;
---
  ./scripts/check-local-export mm/list_lru.o
  iwyu2 -Wp,-MMD,mm/.workingset.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/workingset"' -DKBUILD_BASENAME='"workingset"' -DKBUILD_MODNAME='"workingset"' -D__KBUILD_MODNAME=kmod_workingset -c -o mm/workingset.o mm/workingset.c  
In file included from mm/workingset.c:8:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/workingset.c:8:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/workingset.c:8:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/workingset.c:8:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
mm/workingset.c:496:3: warning: misleading indentation; statement is not part of the previous 'if' [-Wmisleading-indentation]
                pages = node_present_pages(sc->nid);
                ^
mm/workingset.c:471:2: note: previous statement is here
        if (!nodes)
        ^
5 warnings generated.
In file included from mm/workingset.c:8:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/workingset.c:8:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/workingset.c:8:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/workingset.c:8:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
mm/workingset.c:496:3: warning: misleading indentation; statement is not part of the previous 'if' [-Wmisleading-indentation]
                pages = node_present_pages(sc->nid);
                ^
mm/workingset.c:471:2: note: previous statement is here
        if (!nodes)
        ^

mm/workingset.c should add these lines:
#include <asm/bug.h>                           // for WARN_ON_ONCE
#include <stddef.h>                            // for NULL
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm/cache.h"                         // for __read_mostly
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_read, atom...
#include "linux/bitops.h"                      // for fls_long
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/compiler_types.h"              // for __must_hold
#include "linux/container_of.h"                // for container_of
#include "linux/init.h"                        // for __init
#include "linux/list.h"                        // for list_empty
#include "linux/list_lru.h"                    // for __list_lru_init, list_...
#include "linux/lockdep.h"                     // for lockdep_assert_held
#include "linux/lockdep_types.h"               // for lock_class_key
#include "linux/mmdebug.h"                     // for VM_BUG_ON_FOLIO
#include "linux/mmzone.h"                      // for NODE_DATA, WORKINGSET_...
#include "linux/numa.h"                        // for NODES_SHIFT
#include "linux/page_ref.h"                    // for folio_ref_count
#include "linux/printk.h"                      // for pr_info
#include "linux/rcupdate.h"                    // for rcu_read_lock, rcu_rea...
#include "linux/sched.h"                       // for cond_resched
#include "linux/shrinker.h"                    // for free_prealloced_shrinker
#include "linux/spinlock.h"                    // for spin_unlock, spin_unlo...
#include "linux/spinlock_types.h"              // for spinlock_t
#include "linux/stddef.h"                      // for true
#include "linux/types.h"                       // for bool, list_head (ptr o...
#include "linux/vmstat.h"                      // for mod_lruvec_state
#include "linux/xarray.h"                      // for xa_node, BITS_PER_XA_V...
struct folio;
struct mem_cgroup;

mm/workingset.c should remove these lines:
- #include <linux/atomic.h>  // lines 13-13
- #include <linux/dax.h>  // lines 16-16
- #include <linux/shmem_fs.h>  // lines 11-11
- #include <linux/writeback.h>  // lines 10-10

The full include-list for mm/workingset.c:
#include <asm/bug.h>                           // for WARN_ON_ONCE
#include <linux/fs.h>                          // for address_space, inode_a...
#include <linux/memcontrol.h>                  // for lruvec_page_state, mem...
#include <linux/mm.h>                          // for folio_nr_pages, folio_...
#include <linux/mm_inline.h>                   // for folio_is_file_lru
#include <linux/module.h>                      // for module_init
#include <linux/pagemap.h>                     // for mapping_shrinkable
#include <linux/swap.h>                        // for lru_note_cost_folio
#include <stddef.h>                            // for NULL
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm/cache.h"                         // for __read_mostly
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_read, atom...
#include "linux/bitops.h"                      // for fls_long
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/compiler_types.h"              // for __must_hold
#include "linux/container_of.h"                // for container_of
#include "linux/init.h"                        // for __init
#include "linux/list.h"                        // for list_empty
#include "linux/list_lru.h"                    // for __list_lru_init, list_...
#include "linux/lockdep.h"                     // for lockdep_assert_held
#include "linux/lockdep_types.h"               // for lock_class_key
#include "linux/mmdebug.h"                     // for VM_BUG_ON_FOLIO
#include "linux/mmzone.h"                      // for NODE_DATA, WORKINGSET_...
#include "linux/numa.h"                        // for NODES_SHIFT
#include "linux/page_ref.h"                    // for folio_ref_count
#include "linux/printk.h"                      // for pr_info
#include "linux/rcupdate.h"                    // for rcu_read_lock, rcu_rea...
#include "linux/sched.h"                       // for cond_resched
#include "linux/shrinker.h"                    // for free_prealloced_shrinker
#include "linux/spinlock.h"                    // for spin_unlock, spin_unlo...
#include "linux/spinlock_types.h"              // for spinlock_t
#include "linux/stddef.h"                      // for true
#include "linux/types.h"                       // for bool, list_head (ptr o...
#include "linux/vmstat.h"                      // for mod_lruvec_state
#include "linux/xarray.h"                      // for xa_node, BITS_PER_XA_V...
struct folio;
struct mem_cgroup;
---
  ./scripts/check-local-export mm/workingset.o
  iwyu2 -Wp,-MMD,mm/.debug.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/debug"' -DKBUILD_BASENAME='"debug"' -DKBUILD_MODNAME='"debug"' -D__KBUILD_MODNAME=kmod_debug -c -o mm/debug.o mm/debug.c  
In file included from mm/debug.c:11:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/debug.c:11:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/debug.c:11:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/debug.c:11:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from mm/debug.c:11:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/debug.c:11:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/debug.c:11:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:24:
In file included from ./arch/x86/include/asm/perf_event.h:5:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/debug.c:11:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

mm/debug.c should add these lines:
#include <stddef.h>                    // for NULL
#include "asm-generic/memory_model.h"  // for page_to_pfn
#include "linux/build_bug.h"           // for BUILD_BUG_ON
#include "linux/export.h"              // for EXPORT_SYMBOL
#include "linux/fs.h"                  // for dump_mapping
#include "linux/kern_levels.h"         // for KERN_WARNING
#include "linux/migrate_mode.h"        // for MR_TYPES
#include "linux/mm_types.h"            // for page, folio, folio::(anonymous)
#include "linux/mmdebug.h"             // for dump_page
#include "linux/mmzone.h"              // for MAX_ORDER_NR_PAGES, is_migrate...
#include "linux/page_ref.h"            // for page_ref_count
#include "linux/pagemap.h"             // for page_mapping, page_to_pgoff
#include "linux/printk.h"              // for print_hex_dump, pr_warn, DUMP_...
#include "linux/stddef.h"              // for false
#include "linux/tracepoint-defs.h"     // for trace_print_flags
#include "linux/types.h"               // for bool

mm/debug.c should remove these lines:
- #include <linux/ctype.h>  // lines 16-16
- #include <linux/memcontrol.h>  // lines 12-12
- #include <linux/migrate.h>  // lines 14-14
- #include <linux/trace_events.h>  // lines 11-11
- #include "internal.h"  // lines 18-18

The full include-list for mm/debug.c:
#include <linux/kernel.h>              // for ARRAY_SIZE
#include <linux/mm.h>                  // for PageAnon, PageCompound, PageKsm
#include <linux/page_owner.h>          // for dump_page_owner
#include <stddef.h>                    // for NULL
#include <trace/events/migrate.h>      // for MIGRATE_REASON
#include <trace/events/mmflags.h>      // for __def_gfpflag_names, __def_pag...
#include "asm-generic/memory_model.h"  // for page_to_pfn
#include "linux/build_bug.h"           // for BUILD_BUG_ON
#include "linux/export.h"              // for EXPORT_SYMBOL
#include "linux/fs.h"                  // for dump_mapping
#include "linux/kern_levels.h"         // for KERN_WARNING
#include "linux/migrate_mode.h"        // for MR_TYPES
#include "linux/mm_types.h"            // for page, folio, folio::(anonymous)
#include "linux/mmdebug.h"             // for dump_page
#include "linux/mmzone.h"              // for MAX_ORDER_NR_PAGES, is_migrate...
#include "linux/page_ref.h"            // for page_ref_count
#include "linux/pagemap.h"             // for page_mapping, page_to_pgoff
#include "linux/printk.h"              // for print_hex_dump, pr_warn, DUMP_...
#include "linux/stddef.h"              // for false
#include "linux/tracepoint-defs.h"     // for trace_print_flags
#include "linux/types.h"               // for bool
---
  ./scripts/check-local-export mm/debug.o
  iwyu2 -Wp,-MMD,mm/.gup.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/gup"' -DKBUILD_BASENAME='"gup"' -DKBUILD_MODNAME='"gup"' -D__KBUILD_MODNAME=kmod_gup -c -o mm/gup.o mm/gup.c  
In file included from mm/gup.c:10:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/gup.c:10:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/gup.c:10:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/gup.c:10:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/gup.c:10:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/gup.c:10:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/gup.c:10:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/gup.c:10:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/gup.c should add these lines:
#include <asm-generic/pgtable-nopmd.h>               // for pud_t, p4d_none
#include <asm-generic/pgtable-nopud.h>               // for p4d_t, pgd_none
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON_ONCE
#include <asm/page_types.h>                          // for TASK_SIZE
#include <stddef.h>                                  // for NULL, size_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit
#include "asm-generic/cacheflush.h"                  // for flush_dcache_page
#include "asm-generic/errno-base.h"                  // for EFAULT, EINVAL
#include "asm-generic/errno.h"                       // for EHWPOISON, EOPNO...
#include "asm-generic/pgtable-nopmd.h"               // for pmd_t, pud_none
#include "asm-generic/rwonce.h"                      // for READ_ONCE
#include "asm/bug.h"                                 // for BUG
#include "asm/current.h"                             // for current
#include "asm/page_32.h"                             // for pfn_valid
#include "asm/page_types.h"                          // for PAGE_SIZE, PAGE_...
#include "asm/pgtable-2level_types.h"                // for pte_t, PGDIR_SHIFT
#include "asm/pgtable.h"                             // for pte_pfn, pmd_pre...
#include "asm/pgtable_32_types.h"                    // for PGDIR_MASK
#include "asm/pgtable_types.h"                       // for pgd_t
#include "asm/uaccess.h"                             // for unsafe_get_user
#include "generated/autoconf.h"                      // for CONFIG_HAVE_FAST...
#include "linux/atomic/atomic-instrumented.h"        // for atomic_add, atom...
#include "linux/build_bug.h"                         // for BUILD_BUG_ON
#include "linux/compiler.h"                          // for unlikely, likely
#include "linux/compiler_attributes.h"               // for __always_inline
#include "linux/compiler_types.h"                    // for __user, inline
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/fs.h"                                // for vma_is_fsdax
#include "linux/highmem.h"                           // for flush_anon_page
#include "linux/huge_mm.h"                           // for follow_devmap_pmd
#include "linux/hugetlb_inline.h"                    // for is_vm_hugetlb_page
#include "linux/irqflags.h"                          // for local_irq_restore
#include "linux/kconfig.h"                           // for IS_ENABLED, __AR...
#include "linux/lockdep.h"                           // for might_lock_read
#include "linux/minmax.h"                            // for min, min_t
#include "linux/mm_types.h"                          // for page (ptr only)
#include "linux/mmap_lock.h"                         // for mmap_read_lock
#include "linux/mmdebug.h"                           // for VM_BUG_ON, VM_BU...
#include "linux/mmzone.h"                            // for NR_FOLL_PIN_ACQU...
#include "linux/overflow.h"                          // for check_add_overflow
#include "linux/page_ref.h"                          // for folio_ref_add
#include "linux/pgtable.h"                           // for pmd_trans_huge
#include "linux/sched.h"                             // for task_struct, con...
#include "linux/sched/coredump.h"                    // for MMF_HAS_PINNED
#include "linux/seqlock.h"                           // for __seqprop_mutex_ptr
#include "linux/spinlock_types.h"                    // for spinlock_t
#include "linux/stddef.h"                            // for false, true
#include "linux/types.h"                             // for bool
#include "linux/uaccess.h"                           // for probe_subpage_wr...
#include "linux/vmstat.h"                            // for node_stat_mod_folio

mm/gup.c should remove these lines:
- #include <asm/tlbflush.h>  // lines 23-23
- #include <linux/errno.h>  // lines 3-3
- #include <linux/kernel.h>  // lines 2-2
- #include <linux/migrate.h>  // lines 18-18
- #include <linux/mm_inline.h>  // lines 19-19
- #include <linux/rmap.h>  // lines 10-10
- #include <linux/rwsem.h>  // lines 16-16

The full include-list for mm/gup.c:
#include <asm-generic/pgtable-nopmd.h>               // for pud_t, p4d_none
#include <asm-generic/pgtable-nopud.h>               // for p4d_t, pgd_none
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON_ONCE
#include <asm/mmu_context.h>                         // for arch_vma_access_...
#include <asm/page_types.h>                          // for TASK_SIZE
#include <linux/err.h>                               // for ERR_PTR, PTR_ERR
#include <linux/hugetlb.h>                           // for follow_huge_pd
#include <linux/memremap.h>                          // for put_dev_pagemap
#include <linux/mm.h>                                // for FOLL_PIN, FOLL_GET
#include <linux/pagemap.h>                           // for folio_lock, foli...
#include <linux/sched/mm.h>                          // for memalloc_pin_res...
#include <linux/sched/signal.h>                      // for fatal_signal_pen...
#include <linux/secretmem.h>                         // for vma_is_secretmem
#include <linux/spinlock.h>                          // for spin_unlock
#include <linux/swap.h>                              // for lru_add_drain
#include <linux/swapops.h>                           // for pmd_migration_en...
#include <stddef.h>                                  // for NULL, size_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit
#include "asm-generic/cacheflush.h"                  // for flush_dcache_page
#include "asm-generic/errno-base.h"                  // for EFAULT, EINVAL
#include "asm-generic/errno.h"                       // for EHWPOISON, EOPNO...
#include "asm-generic/pgtable-nopmd.h"               // for pmd_t, pud_none
#include "asm-generic/rwonce.h"                      // for READ_ONCE
#include "asm/bug.h"                                 // for BUG
#include "asm/current.h"                             // for current
#include "asm/page_32.h"                             // for pfn_valid
#include "asm/page_types.h"                          // for PAGE_SIZE, PAGE_...
#include "asm/pgtable-2level_types.h"                // for pte_t, PGDIR_SHIFT
#include "asm/pgtable.h"                             // for pte_pfn, pmd_pre...
#include "asm/pgtable_32_types.h"                    // for PGDIR_MASK
#include "asm/pgtable_types.h"                       // for pgd_t
#include "asm/uaccess.h"                             // for unsafe_get_user
#include "generated/autoconf.h"                      // for CONFIG_HAVE_FAST...
#include "internal.h"                                // for faultin_vma_page...
#include "linux/atomic/atomic-instrumented.h"        // for atomic_add, atom...
#include "linux/build_bug.h"                         // for BUILD_BUG_ON
#include "linux/compiler.h"                          // for unlikely, likely
#include "linux/compiler_attributes.h"               // for __always_inline
#include "linux/compiler_types.h"                    // for __user, inline
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/fs.h"                                // for vma_is_fsdax
#include "linux/highmem.h"                           // for flush_anon_page
#include "linux/huge_mm.h"                           // for follow_devmap_pmd
#include "linux/hugetlb_inline.h"                    // for is_vm_hugetlb_page
#include "linux/irqflags.h"                          // for local_irq_restore
#include "linux/kconfig.h"                           // for IS_ENABLED, __AR...
#include "linux/lockdep.h"                           // for might_lock_read
#include "linux/minmax.h"                            // for min, min_t
#include "linux/mm_types.h"                          // for page (ptr only)
#include "linux/mmap_lock.h"                         // for mmap_read_lock
#include "linux/mmdebug.h"                           // for VM_BUG_ON, VM_BU...
#include "linux/mmzone.h"                            // for NR_FOLL_PIN_ACQU...
#include "linux/overflow.h"                          // for check_add_overflow
#include "linux/page_ref.h"                          // for folio_ref_add
#include "linux/pgtable.h"                           // for pmd_trans_huge
#include "linux/sched.h"                             // for task_struct, con...
#include "linux/sched/coredump.h"                    // for MMF_HAS_PINNED
#include "linux/seqlock.h"                           // for __seqprop_mutex_ptr
#include "linux/spinlock_types.h"                    // for spinlock_t
#include "linux/stddef.h"                            // for false, true
#include "linux/types.h"                             // for bool
#include "linux/uaccess.h"                           // for probe_subpage_wr...
#include "linux/vmstat.h"                            // for node_stat_mod_folio
---
  ./scripts/check-local-export mm/gup.o
  iwyu2 -Wp,-MMD,mm/.mmap_lock.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/mmap_lock"' -DKBUILD_BASENAME='"mmap_lock"' -DKBUILD_MODNAME='"mmap_lock"' -D__KBUILD_MODNAME=kmod_mmap_lock -c -o mm/mmap_lock.o mm/mmap_lock.c  
In file included from mm/mmap_lock.c:6:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/mmap_lock.c:7:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/mmap_lock.c:7:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/mmap_lock.c:7:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/mmap_lock.c:6:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/mmap_lock.c:7:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/mmap_lock.c:7:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/mmap_lock.c:7:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/mmap_lock.c should add these lines:
#include "linux/tracepoint.h"  // for EXPORT_TRACEPOINT_SYMBOL

mm/mmap_lock.c should remove these lines:
- #include <linux/cgroup.h>  // lines 6-6
- #include <linux/local_lock.h>  // lines 14-14
- #include <linux/memcontrol.h>  // lines 7-7
- #include <linux/mm.h>  // lines 5-5
- #include <linux/mmap_lock.h>  // lines 8-8
- #include <linux/mutex.h>  // lines 9-9
- #include <linux/percpu.h>  // lines 10-10
- #include <linux/rcupdate.h>  // lines 11-11
- #include <linux/smp.h>  // lines 12-12
- #include <linux/trace_events.h>  // lines 13-13

The full include-list for mm/mmap_lock.c:
#include "linux/tracepoint.h"  // for EXPORT_TRACEPOINT_SYMBOL
---
  ./scripts/check-local-export mm/mmap_lock.o
  iwyu2 -Wp,-MMD,mm/.highmem.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/highmem"' -DKBUILD_BASENAME='"highmem"' -DKBUILD_MODNAME='"highmem"' -D__KBUILD_MODNAME=kmod_highmem -c -o mm/highmem.o mm/highmem.c  
In file included from mm/highmem.c:22:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/highmem.c:22:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/highmem.c:22:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/highmem.c:22:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/highmem.c:22:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/highmem.c:22:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/highmem.c:22:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/highmem.c:22:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/highmem.c should add these lines:
#include <asm/bug.h>                   // for WARN_ON_ONCE, BUG_ON
#include <asm/fixmap.h>                // for __fix_to_virt
#include <stddef.h>                    // for NULL
#include "asm-generic/kmap_size.h"     // for KM_MAX_IDX
#include "asm-generic/memory_model.h"  // for page_to_pfn
#include "asm/current.h"               // for current
#include "asm/fixmap.h"                // for FIX_KMAP_BEGIN, FIX_KMAP_END
#include "asm/page_types.h"            // for PAGE_MASK, PAGE_OFFSET
#include "asm/pgtable-2level_types.h"  // for pte_t
#include "asm/pgtable.h"               // for pte_none, set_pte_at, pfn_pte
#include "asm/pgtable_types.h"         // for pgprot_t
#include "asm/string_32.h"             // for memset
#include "linux/compiler_types.h"      // for inline
#include "linux/highmem-internal.h"    // for __kmap_local_page_prot, __kmap...
#include "linux/irqflags.h"            // for irqs_disabled
#include "linux/kconfig.h"             // for IS_ENABLED
#include "linux/mm_types.h"            // for init_mm, page (ptr only)
#include "linux/pgtable.h"             // for virt_to_kpte
#include "linux/preempt.h"             // for migrate_disable, migrate_enable
#include "linux/sched.h"               // for task_struct, kmap_ctrl
#include "linux/smp.h"                 // for smp_processor_id
#include "linux/stddef.h"              // for false
#include "linux/types.h"               // for bool

mm/highmem.c should remove these lines:
- #include <asm/kmap_size.h>  // lines 43-43
- #include <asm/tlbflush.h>  // lines 30-30
- #include <linux/bio.h>  // lines 23-23
- #include <linux/hash.h>  // lines 27-27
- #include <linux/highmem.h>  // lines 28-28
- #include <linux/init.h>  // lines 26-26
- #include <linux/kgdb.h>  // lines 29-29
- #include <linux/mempool.h>  // lines 25-25
- #include <linux/pagemap.h>  // lines 24-24
- #include <linux/swap.h>  // lines 22-22
- #include <linux/vmalloc.h>  // lines 31-31

The full include-list for mm/highmem.c:
#include <asm/bug.h>                   // for WARN_ON_ONCE, BUG_ON
#include <asm/fixmap.h>                // for __fix_to_virt
#include <linux/export.h>              // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/mm.h>                  // for PageHighMem, page_address
#include <stddef.h>                    // for NULL
#include "asm-generic/kmap_size.h"     // for KM_MAX_IDX
#include "asm-generic/memory_model.h"  // for page_to_pfn
#include "asm/current.h"               // for current
#include "asm/fixmap.h"                // for FIX_KMAP_BEGIN, FIX_KMAP_END
#include "asm/page_types.h"            // for PAGE_MASK, PAGE_OFFSET
#include "asm/pgtable-2level_types.h"  // for pte_t
#include "asm/pgtable.h"               // for pte_none, set_pte_at, pfn_pte
#include "asm/pgtable_types.h"         // for pgprot_t
#include "asm/string_32.h"             // for memset
#include "linux/compiler_types.h"      // for inline
#include "linux/highmem-internal.h"    // for __kmap_local_page_prot, __kmap...
#include "linux/irqflags.h"            // for irqs_disabled
#include "linux/kconfig.h"             // for IS_ENABLED
#include "linux/mm_types.h"            // for init_mm, page (ptr only)
#include "linux/pgtable.h"             // for virt_to_kpte
#include "linux/preempt.h"             // for migrate_disable, migrate_enable
#include "linux/sched.h"               // for task_struct, kmap_ctrl
#include "linux/smp.h"                 // for smp_processor_id
#include "linux/stddef.h"              // for false
#include "linux/types.h"               // for bool
---
  ./scripts/check-local-export mm/highmem.o
  iwyu2 -Wp,-MMD,mm/.memory.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/memory"' -DKBUILD_BASENAME='"memory"' -DKBUILD_MODNAME='"memory"' -D__KBUILD_MODNAME=kmod_memory -c -o mm/memory.o mm/memory.c  
In file included from mm/memory.c:44:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/memory.c:44:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/memory.c:44:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/memory.c:44:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/memory.c:58:
./include/linux/delayacct.h:27:44: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline int delayacct_add_tsk(struct taskstats *d,
                                           ^
5 warnings generated.
In file included from mm/memory.c:44:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/memory.c:44:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/memory.c:44:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/memory.c:44:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/memory.c:58:
./include/linux/delayacct.h:27:44: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline int delayacct_add_tsk(struct taskstats *d,
                                           ^

mm/memory.c should add these lines:
#include <asm/barrier.h>                 // for smp_wmb
#include <asm/bug.h>                     // for BUG_ON, WARN_ON_ONCE, WARN_ON
#include <stddef.h>                      // for NULL
#include "asm-generic/cacheflush.h"      // for flush_cache_page, flush_dcac...
#include "asm-generic/errno-base.h"      // for ENOMEM, EINVAL, EBUSY, EAGAIN
#include "asm-generic/memory_model.h"    // for pfn_to_page, page_to_pfn
#include "asm-generic/param.h"           // for HZ
#include "asm-generic/pgtable-nop4d.h"   // for p4d_offset, p4d_t, pgd_none
#include "asm-generic/pgtable-nopmd.h"   // for pmd_t, pud_none, pmd_offset
#include "asm-generic/pgtable-nopud.h"   // for pud_t, p4d_none, pud_offset
#include "asm-generic/pgtable_uffd.h"    // for pte_mkuffd_wp, pte_swp_uffd_wp
#include "asm-generic/rwonce.h"          // for READ_ONCE
#include "asm/cache.h"                   // for __read_mostly
#include "asm/current.h"                 // for current
#include "asm/page.h"                    // for alloc_zeroed_user_highpage_m...
#include "asm/page_32.h"                 // for clear_page, pfn_valid
#include "asm/page_types.h"              // for PAGE_SHIFT, PAGE_SIZE, PAGE_...
#include "asm/pgtable-2level_types.h"    // for pte_t, PTRS_PER_PTE, ARCH_PA...
#include "asm/pgtable.h"                 // for set_pte_at, pte_same, pmd_none
#include "asm/pgtable_32_types.h"        // for PGDIR_MASK
#include "asm/pgtable_types.h"           // for pgprot_t, pgd_t, pgtable_t
#include "asm/string_32.h"               // for memset
#include "asm/topology.h"                // for numa_node_id
#include "generated/autoconf.h"          // for CONFIG_ARCH_HAS_PTE_SPECIAL
#include "linux/compiler.h"              // for unlikely, likely, barrier
#include "linux/compiler_types.h"        // for inline, __releases, __user
#include "linux/err.h"                   // for IS_ERR
#include "linux/file.h"                  // for fput
#include "linux/fs.h"                    // for address_space, file, i_mmap_...
#include "linux/highmem-internal.h"      // for kmap, kmap_atomic, kunmap
#include "linux/huge_mm.h"               // for is_swap_pmd, __split_huge_pmd
#include "linux/hugetlb_inline.h"        // for is_vm_hugetlb_page
#include "linux/jiffies.h"               // for jiffies, time_before
#include "linux/kconfig.h"               // for __ARG_PLACEHOLDER_1, IS_ENABLED
#include "linux/list.h"                  // for list_empty, list_add
#include "linux/lockdep.h"               // for SINGLE_DEPTH_NESTING
#include "linux/log2.h"                  // for rounddown_pow_of_two
#include "linux/mempolicy.h"             // for mpol_misplaced
#include "linux/minmax.h"                // for max, min, min_t, min3
#include "linux/mm_types.h"              // for vm_area_struct, vm_fault_t
#include "linux/mm_types_task.h"         // for MM_ANONPAGES, NR_MM_COUNTERS
#include "linux/mmap_lock.h"             // for mmap_read_trylock, mmap_read...
#include "linux/mmdebug.h"               // for VM_BUG_ON, VM_BUG_ON_PAGE
#include "linux/page-flags-layout.h"     // for LAST_CPUPID_SHIFT
#include "linux/page_ref.h"              // for page_count
#include "linux/panic.h"                 // for add_taint, LOCKDEP_NOW_UNREL...
#include "linux/perf_event.h"            // for PERF_COUNT_SW_PAGE_FAULTS_MAJ
#include "linux/pfn.h"                   // for pfn_t
#include "linux/pgtable.h"               // for update_mmu_tlb, pmd_trans_huge
#include "linux/printk.h"                // for pr_alert, dump_stack, printk
#include "linux/rbtree.h"                // for RB_EMPTY_ROOT
#include "linux/rbtree_types.h"          // for rb_root_cached
#include "linux/sched.h"                 // for task_struct, need_resched
#include "linux/seqlock.h"               // for __seqprop_mutex_preemptible
#include "linux/spinlock.h"              // for spin_lock, spin_unlock, spin...
#include "linux/spinlock_types.h"        // for spinlock_t
#include "linux/stddef.h"                // for false, true
#include "linux/types.h"                 // for bool, pgoff_t, resource_size_t
#include "linux/uprobes.h"               // for uprobe_munmap
#include "linux/vm_event_item.h"         // for PGFAULT, PGMAJFAULT, PGREUSE
#include "linux/vmstat.h"                // for count_vm_event, count_vm_num...
#include "vdso/limits.h"                 // for ULONG_MAX
struct pt_regs;

mm/memory.c should remove these lines:
- #include <linux/dax.h>  // lines 71-71
- #include <linux/debugfs.h>  // lines 69-69
- #include <linux/elf.h>  // lines 65-65
- #include <linux/kernel_stat.h>  // lines 42-42
- #include <linux/mman.h>  // lines 50-50
- #include <linux/ptrace.h>  // lines 75-75
- #include <linux/sched/coredump.h>  // lines 46-46

The full include-list for mm/memory.c:
#include <asm/barrier.h>                 // for smp_wmb
#include <asm/bug.h>                     // for BUG_ON, WARN_ON_ONCE, WARN_ON
#include <asm/io.h>                      // for iounmap, ioremap_prot, memcp...
#include <asm/mmu_context.h>             // for arch_vma_access_permitted
#include <asm/pgalloc.h>                 // for pte_alloc_one, pte_free, pmd...
#include <asm/tlb.h>                     // for mmu_gather, tlb_change_page_...
#include <asm/tlbflush.h>                // for flush_tlb_page
#include <linux/delayacct.h>             // for delayacct_wpcopy_end, delaya...
#include <linux/export.h>                // for EXPORT_SYMBOL, EXPORT_SYMBOL...
#include <linux/gfp.h>                   // for GFP_KERNEL, alloc_page_vma
#include <linux/highmem.h>               // for copy_user_highpage
#include <linux/hugetlb.h>               // for __unmap_hugepage_range_final
#include <linux/init.h>                  // for __init, __setup, early_initcall
#include <linux/ksm.h>                   // for ksm_might_need_to_copy
#include <linux/memcontrol.h>            // for mem_cgroup_charge, count_mem...
#include <linux/memremap.h>              // for dev_pagemap, dev_pagemap_ops
#include <linux/migrate.h>               // for migrate_misplaced_page
#include <linux/mm.h>                    // for vm_fault, vm_fault::(anonymous)
#include <linux/mm_inline.h>             // for mm_tlb_flush_pending, pte_in...
#include <linux/mmu_notifier.h>          // for mmu_notifier_invalidate_rang...
#include <linux/numa.h>                  // for NUMA_NO_NODE
#include <linux/oom.h>                   // for check_stable_address_space
#include <linux/pagemap.h>               // for unlock_page, linear_page_index
#include <linux/perf_event.h>            // for perf_sw_event
#include <linux/pfn_t.h>                 // for pfn_t_to_pfn, pfn_t_devmap
#include <linux/rmap.h>                  // for page_add_new_anon_rmap, anon...
#include <linux/sched/mm.h>              // for get_task_mm, mmput
#include <linux/sched/numa_balancing.h>  // for task_numa_fault, TNF_FAULT_L...
#include <linux/sched/task.h>            // for mmlist_lock
#include <linux/string.h>                // for kbasename
#include <linux/swap.h>                  // for cgroup_throttle_swaprate
#include <linux/swapops.h>               // for pfn_swap_entry_to_page, pte_...
#include <linux/uaccess.h>               // for __copy_from_user_inatomic
#include <linux/userfaultfd_k.h>         // for userfaultfd_wp, handle_userf...
#include <linux/vmalloc.h>               // for arch_sync_kernel_mappings
#include <linux/writeback.h>             // for balance_dirty_pages_ratelimited
#include <stddef.h>                      // for NULL
#include <trace/events/kmem.h>           // for trace_rss_stat
#include "asm-generic/cacheflush.h"      // for flush_cache_page, flush_dcac...
#include "asm-generic/errno-base.h"      // for ENOMEM, EINVAL, EBUSY, EAGAIN
#include "asm-generic/memory_model.h"    // for pfn_to_page, page_to_pfn
#include "asm-generic/param.h"           // for HZ
#include "asm-generic/pgtable-nop4d.h"   // for p4d_offset, p4d_t, pgd_none
#include "asm-generic/pgtable-nopmd.h"   // for pmd_t, pud_none, pmd_offset
#include "asm-generic/pgtable-nopud.h"   // for pud_t, p4d_none, pud_offset
#include "asm-generic/pgtable_uffd.h"    // for pte_mkuffd_wp, pte_swp_uffd_wp
#include "asm-generic/rwonce.h"          // for READ_ONCE
#include "asm/cache.h"                   // for __read_mostly
#include "asm/current.h"                 // for current
#include "asm/page.h"                    // for alloc_zeroed_user_highpage_m...
#include "asm/page_32.h"                 // for clear_page, pfn_valid
#include "asm/page_types.h"              // for PAGE_SHIFT, PAGE_SIZE, PAGE_...
#include "asm/pgtable-2level_types.h"    // for pte_t, PTRS_PER_PTE, ARCH_PA...
#include "asm/pgtable.h"                 // for set_pte_at, pte_same, pmd_none
#include "asm/pgtable_32_types.h"        // for PGDIR_MASK
#include "asm/pgtable_types.h"           // for pgprot_t, pgd_t, pgtable_t
#include "asm/string_32.h"               // for memset
#include "asm/topology.h"                // for numa_node_id
#include "generated/autoconf.h"          // for CONFIG_ARCH_HAS_PTE_SPECIAL
#include "internal.h"                    // for flush_tlb_batched_pending
#include "linux/compiler.h"              // for unlikely, likely, barrier
#include "linux/compiler_types.h"        // for inline, __releases, __user
#include "linux/err.h"                   // for IS_ERR
#include "linux/file.h"                  // for fput
#include "linux/fs.h"                    // for address_space, file, i_mmap_...
#include "linux/highmem-internal.h"      // for kmap, kmap_atomic, kunmap
#include "linux/huge_mm.h"               // for is_swap_pmd, __split_huge_pmd
#include "linux/hugetlb_inline.h"        // for is_vm_hugetlb_page
#include "linux/jiffies.h"               // for jiffies, time_before
#include "linux/kconfig.h"               // for __ARG_PLACEHOLDER_1, IS_ENABLED
#include "linux/list.h"                  // for list_empty, list_add
#include "linux/lockdep.h"               // for SINGLE_DEPTH_NESTING
#include "linux/log2.h"                  // for rounddown_pow_of_two
#include "linux/mempolicy.h"             // for mpol_misplaced
#include "linux/minmax.h"                // for max, min, min_t, min3
#include "linux/mm_types.h"              // for vm_area_struct, vm_fault_t
#include "linux/mm_types_task.h"         // for MM_ANONPAGES, NR_MM_COUNTERS
#include "linux/mmap_lock.h"             // for mmap_read_trylock, mmap_read...
#include "linux/mmdebug.h"               // for VM_BUG_ON, VM_BUG_ON_PAGE
#include "linux/page-flags-layout.h"     // for LAST_CPUPID_SHIFT
#include "linux/page_ref.h"              // for page_count
#include "linux/panic.h"                 // for add_taint, LOCKDEP_NOW_UNREL...
#include "linux/perf_event.h"            // for PERF_COUNT_SW_PAGE_FAULTS_MAJ
#include "linux/pfn.h"                   // for pfn_t
#include "linux/pgtable.h"               // for update_mmu_tlb, pmd_trans_huge
#include "linux/printk.h"                // for pr_alert, dump_stack, printk
#include "linux/rbtree.h"                // for RB_EMPTY_ROOT
#include "linux/rbtree_types.h"          // for rb_root_cached
#include "linux/sched.h"                 // for task_struct, need_resched
#include "linux/seqlock.h"               // for __seqprop_mutex_preemptible
#include "linux/spinlock.h"              // for spin_lock, spin_unlock, spin...
#include "linux/spinlock_types.h"        // for spinlock_t
#include "linux/stddef.h"                // for false, true
#include "linux/types.h"                 // for bool, pgoff_t, resource_size_t
#include "linux/uprobes.h"               // for uprobe_munmap
#include "linux/vm_event_item.h"         // for PGFAULT, PGMAJFAULT, PGREUSE
#include "linux/vmstat.h"                // for count_vm_event, count_vm_num...
#include "pgalloc-track.h"               // for p4d_alloc_track, pmd_alloc_t...
#include "swap.h"                        // for free_swap_cache, get_shadow_...
#include "vdso/limits.h"                 // for ULONG_MAX
struct pt_regs;
---
  ./scripts/check-local-export mm/memory.o
  iwyu2 -Wp,-MMD,mm/.mincore.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/mincore"' -DKBUILD_BASENAME='"mincore"' -DKBUILD_MODNAME='"mincore"' -D__KBUILD_MODNAME=kmod_mincore -c -o mm/mincore.o mm/mincore.c  
In file included from mm/mincore.c:15:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/mincore.c:15:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/mincore.c:15:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/mincore.c:15:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from mm/mincore.c:15:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/mincore.c:15:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/mincore.c:15:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/mincore.c:15:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

mm/mincore.c should add these lines:
#include <asm/bug.h>                    // for WARN_ON
#include <linux/mm.h>                   // for PageUptodate
#include <stddef.h>                     // for size_t
#include "asm-generic/errno-base.h"     // for EFAULT, ENOMEM, EAGAIN, EINVAL
#include "asm-generic/pgtable-nopmd.h"  // for pmd_t
#include "asm/bug.h"                    // for BUG
#include "asm/current.h"                // for current
#include "asm/page_types.h"             // for PAGE_SHIFT, PAGE_SIZE, PAGE_MASK
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable.h"                // for pte_present
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/string_32.h"              // for memset
#include "asm/uaccess.h"                // for access_ok
#include "linux/compiler_attributes.h"  // for __always_unused
#include "linux/compiler_types.h"       // for __user, inline
#include "linux/fs.h"                   // for file_inode, file_permission
#include "linux/huge_mm.h"              // for pmd_trans_huge_lock
#include "linux/math.h"                 // for DIV_ROUND_UP
#include "linux/minmax.h"               // for min
#include "linux/mm.h"                   // for find_vma, put_page, vma_is_an...
#include "linux/mm_types.h"             // for vm_area_struct, swp_entry_t
#include "linux/mmap_lock.h"            // for mmap_read_lock, mmap_read_unlock
#include "linux/sched.h"                // for task_struct, cond_resched
#include "linux/spinlock.h"             // for spin_unlock
#include "linux/spinlock_types.h"       // for spinlock_t
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for pgoff_t, bool
#include "linux/user_namespace.h"       // for init_user_ns

mm/mincore.c should remove these lines:
- #include <linux/hugetlb.h>  // lines 19-19
- #include <linux/mman.h>  // lines 14-14
- #include <linux/shmem_fs.h>  // lines 18-18
- #include <linux/swap.h>  // lines 16-16

The full include-list for mm/mincore.c:
#include <asm/bug.h>                    // for WARN_ON
#include <linux/gfp.h>                  // for GFP_USER, __get_free_page
#include <linux/mm.h>                   // for PageUptodate
#include <linux/pagemap.h>              // for linear_page_index
#include <linux/pagewalk.h>             // for mm_walk, walk_page_range, mm_...
#include <linux/pgtable.h>              // for pmd_trans_unstable
#include <linux/swapops.h>              // for non_swap_entry, pte_none_mostly
#include <linux/syscalls.h>             // for __MAP3, SYSCALL_DEFINE3
#include <linux/uaccess.h>              // for copy_to_user
#include <stddef.h>                     // for size_t
#include "asm-generic/errno-base.h"     // for EFAULT, ENOMEM, EAGAIN, EINVAL
#include "asm-generic/pgtable-nopmd.h"  // for pmd_t
#include "asm/bug.h"                    // for BUG
#include "asm/current.h"                // for current
#include "asm/page_types.h"             // for PAGE_SHIFT, PAGE_SIZE, PAGE_MASK
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable.h"                // for pte_present
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/string_32.h"              // for memset
#include "asm/uaccess.h"                // for access_ok
#include "linux/compiler_attributes.h"  // for __always_unused
#include "linux/compiler_types.h"       // for __user, inline
#include "linux/fs.h"                   // for file_inode, file_permission
#include "linux/huge_mm.h"              // for pmd_trans_huge_lock
#include "linux/math.h"                 // for DIV_ROUND_UP
#include "linux/minmax.h"               // for min
#include "linux/mm.h"                   // for find_vma, put_page, vma_is_an...
#include "linux/mm_types.h"             // for vm_area_struct, swp_entry_t
#include "linux/mmap_lock.h"            // for mmap_read_lock, mmap_read_unlock
#include "linux/sched.h"                // for task_struct, cond_resched
#include "linux/spinlock.h"             // for spin_unlock
#include "linux/spinlock_types.h"       // for spinlock_t
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for pgoff_t, bool
#include "linux/user_namespace.h"       // for init_user_ns
#include "swap.h"                       // for find_get_incore_page
---
  ./scripts/check-local-export mm/mincore.o
  iwyu2 -Wp,-MMD,mm/.mlock.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/mlock"' -DKBUILD_BASENAME='"mlock"' -DKBUILD_MODNAME='"mlock"' -D__KBUILD_MODNAME=kmod_mlock -c -o mm/mlock.o mm/mlock.c  
In file included from mm/mlock.c:13:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/mlock.c:13:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/mlock.c:13:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/mlock.c:13:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/mlock.c:13:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/mlock.c:13:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/mlock.c:13:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/mlock.c:13:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/mlock.c should add these lines:
#include <asm-generic/percpu.h>         // for this_cpu_ptr, per_cpu, DEFINE...
#include <asm/bug.h>                    // for WARN_ON_ONCE
#include <asm/page_types.h>             // for TASK_SIZE
#include <linux/local_lock.h>           // for INIT_LOCAL_LOCK, local_lock_t
#include <stddef.h>                     // for size_t, NULL
#include "asm-generic/errno-base.h"     // for ENOMEM, EINTR, EINVAL, EPERM
#include "asm-generic/mman-common.h"    // for MLOCK_ONFAULT
#include "asm-generic/mman.h"           // for MCL_CURRENT, MCL_ONFAULT, MCL...
#include "asm-generic/pgtable-nopmd.h"  // for pmd_t
#include "asm-generic/resource.h"       // for RLIMIT_MEMLOCK, RLIM_INFINITY
#include "asm-generic/rwonce.h"         // for WRITE_ONCE
#include "asm/current.h"                // for current
#include "asm/page_types.h"             // for PAGE_SHIFT, PAGE_SIZE, PAGE_MASK
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable.h"                // for pmd_present, pte_present, pmd...
#include "asm/ptrace.h"                 // for pt_regs
#include "linux/capability.h"           // for CAP_IPC_LOCK
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __must_check
#include "linux/compiler_types.h"       // for inline
#include "linux/cpumask.h"              // for cpu_online
#include "linux/fs.h"                   // for vma_is_dax
#include "linux/huge_mm.h"              // for is_huge_zero_pmd, pmd_trans_h...
#include "linux/hugetlb_inline.h"       // for is_vm_hugetlb_page
#include "linux/local_lock.h"           // for local_lock, local_unlock
#include "linux/mm_types.h"             // for vm_area_struct, vm_flags_t
#include "linux/mmap_lock.h"            // for mmap_write_lock_killable, mma...
#include "linux/mmdebug.h"              // for VM_BUG_ON, VM_BUG_ON_PAGE
#include "linux/pgtable.h"              // for pte_unmap
#include "linux/sched/signal.h"         // for rlimit
#include "linux/spinlock.h"             // for spin_unlock, spin_lock
#include "linux/spinlock_types.h"       // for DEFINE_SPINLOCK, spinlock_t
#include "linux/stddef.h"               // for true, false
#include "linux/types.h"                // for bool, pgoff_t
#include "linux/user_namespace.h"       // for dec_rlimit_ucounts, UCOUNT_RL...
#include "linux/vm_event_item.h"        // for UNEVICTABLE_PGCULLED, UNEVICT...
#include "linux/vmstat.h"               // for __count_vm_events, __mod_zone...
#include "vdso/limits.h"                // for LONG_MAX

mm/mlock.c should remove these lines:
- #include <linux/hugetlb.h>  // lines 24-24
- #include <linux/mman.h>  // lines 10-10
- #include <linux/rmap.h>  // lines 22-22
- #include <linux/sched/user.h>  // lines 12-12
- #include <linux/swapops.h>  // lines 14-14

The full include-list for mm/mlock.c:
#include <asm-generic/percpu.h>         // for this_cpu_ptr, per_cpu, DEFINE...
#include <asm/bug.h>                    // for WARN_ON_ONCE
#include <asm/page_types.h>             // for TASK_SIZE
#include <linux/capability.h>           // for capable
#include <linux/export.h>               // for EXPORT_SYMBOL
#include <linux/local_lock.h>           // for INIT_LOCAL_LOCK, local_lock_t
#include <linux/memcontrol.h>           // for folio_lruvec_relock_irq, unlo...
#include <linux/mempolicy.h>            // for vma_policy
#include <linux/mm.h>                   // for PageUnevictable, thp_nr_pages
#include <linux/mm_inline.h>            // for add_page_to_lru_list, del_pag...
#include <linux/mmzone.h>               // for NR_MLOCK
#include <linux/pagemap.h>              // for release_pages
#include <linux/pagevec.h>              // for pagevec_count, pagevec_add
#include <linux/pagewalk.h>             // for walk_page_range, mm_walk, mm_...
#include <linux/sched.h>                // for task_struct, cond_resched
#include <linux/secretmem.h>            // for vma_is_secretmem
#include <linux/swap.h>                 // for lru_cache_disabled, lru_add_d...
#include <linux/syscalls.h>             // for __MAP2, __MAP1, __MAP3, SYSCA...
#include <stddef.h>                     // for size_t, NULL
#include "asm-generic/errno-base.h"     // for ENOMEM, EINTR, EINVAL, EPERM
#include "asm-generic/mman-common.h"    // for MLOCK_ONFAULT
#include "asm-generic/mman.h"           // for MCL_CURRENT, MCL_ONFAULT, MCL...
#include "asm-generic/pgtable-nopmd.h"  // for pmd_t
#include "asm-generic/resource.h"       // for RLIMIT_MEMLOCK, RLIM_INFINITY
#include "asm-generic/rwonce.h"         // for WRITE_ONCE
#include "asm/current.h"                // for current
#include "asm/page_types.h"             // for PAGE_SHIFT, PAGE_SIZE, PAGE_MASK
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable.h"                // for pmd_present, pte_present, pmd...
#include "asm/ptrace.h"                 // for pt_regs
#include "internal.h"                   // for page_evictable, mlock_folio
#include "linux/capability.h"           // for CAP_IPC_LOCK
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __must_check
#include "linux/compiler_types.h"       // for inline
#include "linux/cpumask.h"              // for cpu_online
#include "linux/fs.h"                   // for vma_is_dax
#include "linux/huge_mm.h"              // for is_huge_zero_pmd, pmd_trans_h...
#include "linux/hugetlb_inline.h"       // for is_vm_hugetlb_page
#include "linux/local_lock.h"           // for local_lock, local_unlock
#include "linux/mm_types.h"             // for vm_area_struct, vm_flags_t
#include "linux/mmap_lock.h"            // for mmap_write_lock_killable, mma...
#include "linux/mmdebug.h"              // for VM_BUG_ON, VM_BUG_ON_PAGE
#include "linux/pgtable.h"              // for pte_unmap
#include "linux/sched/signal.h"         // for rlimit
#include "linux/spinlock.h"             // for spin_unlock, spin_lock
#include "linux/spinlock_types.h"       // for DEFINE_SPINLOCK, spinlock_t
#include "linux/stddef.h"               // for true, false
#include "linux/types.h"                // for bool, pgoff_t
#include "linux/user_namespace.h"       // for dec_rlimit_ucounts, UCOUNT_RL...
#include "linux/vm_event_item.h"        // for UNEVICTABLE_PGCULLED, UNEVICT...
#include "linux/vmstat.h"               // for __count_vm_events, __mod_zone...
#include "vdso/limits.h"                // for LONG_MAX
---
  ./scripts/check-local-export mm/mlock.o
  iwyu2 -Wp,-MMD,mm/.mmap.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/mmap"' -DKBUILD_BASENAME='"mmap"' -DKBUILD_MODNAME='"mmap"' -D__KBUILD_MODNAME=kmod_mmap -c -o mm/mmap.o mm/mmap.c  
In file included from mm/mmap.c:14:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/mmap.c:14:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/mmap.c:14:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/mmap.c:16:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from mm/mmap.c:14:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/mmap.c:14:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/mmap.c:14:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/mmap.c:16:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

mm/mmap.c should add these lines:
#include <asm/bitops.h>                              // for test_bit, __test...
#include <asm/bug.h>                                 // for BUG_ON, WARN_ON_...
#include <asm/page_types.h>                          // for TASK_SIZE
#include <stddef.h>                                  // for NULL, size_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit, test_an...
#include "asm-generic/cacheflush.h"                  // for flush_dcache_mma...
#include "asm-generic/errno-base.h"                  // for ENOMEM, EINVAL
#include "asm-generic/errno.h"                       // for EOVERFLOW, EOPNO...
#include "asm-generic/int-ll64.h"                    // for u64
#include "asm-generic/mman-common.h"                 // for MAP_FIXED, MAP_P...
#include "asm-generic/mman.h"                        // for MAP_LOCKED, MAP_...
#include "asm-generic/resource.h"                    // for RLIMIT_DATA, RLI...
#include "asm-generic/rwonce.h"                      // for READ_ONCE, WRITE...
#include "asm/bug.h"                                 // for BUG
#include "asm/cache.h"                               // for __read_mostly
#include "asm/current.h"                             // for current
#include "asm/page_types.h"                          // for PAGE_SHIFT, PAGE...
#include "asm/pgtable.h"                             // for pgprot_modify
#include "asm/pgtable_types.h"                       // for pgprot_t, pgprot...
#include "asm/ptrace.h"                              // for pt_regs
#include "asm/unistd.h"                              // for __ARCH_WANT_SYS_...
#include "generated/autoconf.h"                      // for CONFIG_ARCH_MMAP...
#include "linux/align.h"                             // for ALIGN
#include "linux/cache.h"                             // for __ro_after_init
#include "linux/capability.h"                        // for CAP_IPC_LOCK
#include "linux/compiler.h"                          // for unlikely, likely
#include "linux/compiler_attributes.h"               // for __always_inline
#include "linux/compiler_types.h"                    // for inline, __user
#include "linux/err.h"                               // for ERR_PTR, IS_ERR_...
#include "linux/gfp.h"                               // for GFP_KERNEL
#include "linux/huge_mm.h"                           // for vma_adjust_trans...
#include "linux/hugetlb_inline.h"                    // for is_vm_hugetlb_page
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/kstrtox.h"                           // for simple_strtoul
#include "linux/list.h"                              // for list_is_singular
#include "linux/minmax.h"                            // for min, max, swap
#include "linux/mm_types.h"                          // for vm_area_struct
#include "linux/mman.h"                              // for MAP_SHARED, MAP_...
#include "linux/mmap_lock.h"                         // for mmap_write_unlock
#include "linux/mmzone.h"                            // for NR_FREE_PAGES
#include "linux/mutex.h"                             // for mutex, mutex_is_...
#include "linux/percpu_counter.h"                    // for percpu_counter_init
#include "linux/personality.h"                       // for READ_IMPLIES_EXEC
#include "linux/pgtable.h"                           // for FIRST_USER_ADDRESS
#include "linux/rbtree.h"                            // for rb_entry, rb_parent
#include "linux/rbtree_types.h"                      // for rb_node, rb_root
#include "linux/rwsem.h"                             // for down_write_nest_...
#include "linux/sched.h"                             // for task_struct, con...
#include "linux/sched/coredump.h"                    // for MMF_OOM_SKIP
#include "linux/sched/signal.h"                      // for rlimit, signal_p...
#include "linux/spinlock.h"                          // for spin_lock, spin_...
#include "linux/stat.h"                              // for S_ISBLK, S_ISREG
#include "linux/stddef.h"                            // for false, true
#include "linux/types.h"                             // for bool, list_head
#include "linux/vmstat.h"                            // for global_zone_page...
#include "vdso/limits.h"                             // for ULONG_MAX

mm/mmap.c should remove these lines:
- #include <asm/cacheflush.h>  // lines 53-53
- #include <linux/mount.h>  // lines 33-33
- #include <linux/personality.h>  // lines 27-27
- #include <linux/profile.h>  // lines 31-31
- #include <linux/shm.h>  // lines 18-18
- #include <linux/slab.h>  // lines 13-13

The full include-list for mm/mmap.c:
#include <asm/bitops.h>                              // for test_bit, __test...
#include <asm/bug.h>                                 // for BUG_ON, WARN_ON_...
#include <asm/mmu_context.h>                         // for arch_exit_mmap
#include <asm/page_types.h>                          // for TASK_SIZE
#include <asm/tlb.h>                                 // for mmu_gather
#include <linux/audit.h>                             // for audit_mmap_fd
#include <linux/backing-dev.h>                       // for mapping_can_writ...
#include <linux/capability.h>                        // for capable
#include <linux/export.h>                            // for EXPORT_SYMBOL
#include <linux/file.h>                              // for fput, fget
#include <linux/fs.h>                                // for file, get_file
#include <linux/hugetlb.h>                           // for huge_page_size
#include <linux/init.h>                              // for subsys_initcall
#include <linux/kernel.h>                            // for might_sleep
#include <linux/khugepaged.h>                        // for khugepaged_enter...
#include <linux/memory.h>                            // for MEM_OFFLINE, MEM...
#include <linux/mempolicy.h>                         // for mpol_equal, mpol...
#include <linux/mm.h>                                // for vm_unmapped_area...
#include <linux/mm_inline.h>                         // for anon_vma_name
#include <linux/mman.h>                              // for vm_unacct_memory
#include <linux/mmdebug.h>                           // for VM_WARN_ON, VM_B...
#include <linux/mmu_notifier.h>                      // for mmu_notifier_rel...
#include <linux/moduleparam.h>                       // for kernel_param
#include <linux/notifier.h>                          // for NOTIFY_OK, notif...
#include <linux/oom.h>                               // for __oom_reap_task_mm
#include <linux/pagemap.h>                           // for AS_MM_ALL_LOCKS
#include <linux/perf_event.h>                        // for perf_event_mmap
#include <linux/pkeys.h>                             // for execute_only_pkey
#include <linux/printk.h>                            // for pr_info, pr_warn...
#include <linux/rbtree_augmented.h>                  // for rb_erase_augmented
#include <linux/rmap.h>                              // for anon_vma_chain
#include <linux/sched/mm.h>                          // for arch_get_mmap_end
#include <linux/security.h>                          // for mmap_min_addr
#include <linux/shmem_fs.h>                          // for shmem_zero_setup
#include <linux/swap.h>                              // for lru_add_drain
#include <linux/syscalls.h>                          // for __MAP1, __MAP2
#include <linux/uaccess.h>                           // for copy_from_user
#include <linux/uprobes.h>                           // for uprobe_mmap, upr...
#include <linux/userfaultfd_k.h>                     // for userfaultfd_unma...
#include <linux/vmacache.h>                          // for vmacache_invalidate
#include <stddef.h>                                  // for NULL, size_t
#include <trace/events/mmap.h>                       // for trace_vm_unmappe...
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit, test_an...
#include "asm-generic/cacheflush.h"                  // for flush_dcache_mma...
#include "asm-generic/errno-base.h"                  // for ENOMEM, EINVAL
#include "asm-generic/errno.h"                       // for EOVERFLOW, EOPNO...
#include "asm-generic/int-ll64.h"                    // for u64
#include "asm-generic/mman-common.h"                 // for MAP_FIXED, MAP_P...
#include "asm-generic/mman.h"                        // for MAP_LOCKED, MAP_...
#include "asm-generic/resource.h"                    // for RLIMIT_DATA, RLI...
#include "asm-generic/rwonce.h"                      // for READ_ONCE, WRITE...
#include "asm/bug.h"                                 // for BUG
#include "asm/cache.h"                               // for __read_mostly
#include "asm/current.h"                             // for current
#include "asm/page_types.h"                          // for PAGE_SHIFT, PAGE...
#include "asm/pgtable.h"                             // for pgprot_modify
#include "asm/pgtable_types.h"                       // for pgprot_t, pgprot...
#include "asm/ptrace.h"                              // for pt_regs
#include "asm/unistd.h"                              // for __ARCH_WANT_SYS_...
#include "generated/autoconf.h"                      // for CONFIG_ARCH_MMAP...
#include "internal.h"                                // for free_pgtables
#include "linux/align.h"                             // for ALIGN
#include "linux/cache.h"                             // for __ro_after_init
#include "linux/capability.h"                        // for CAP_IPC_LOCK
#include "linux/compiler.h"                          // for unlikely, likely
#include "linux/compiler_attributes.h"               // for __always_inline
#include "linux/compiler_types.h"                    // for inline, __user
#include "linux/err.h"                               // for ERR_PTR, IS_ERR_...
#include "linux/gfp.h"                               // for GFP_KERNEL
#include "linux/huge_mm.h"                           // for vma_adjust_trans...
#include "linux/hugetlb_inline.h"                    // for is_vm_hugetlb_page
#include "linux/kconfig.h"                           // for IS_ENABLED
#include "linux/kstrtox.h"                           // for simple_strtoul
#include "linux/list.h"                              // for list_is_singular
#include "linux/minmax.h"                            // for min, max, swap
#include "linux/mm_types.h"                          // for vm_area_struct
#include "linux/mman.h"                              // for MAP_SHARED, MAP_...
#include "linux/mmap_lock.h"                         // for mmap_write_unlock
#include "linux/mmzone.h"                            // for NR_FREE_PAGES
#include "linux/mutex.h"                             // for mutex, mutex_is_...
#include "linux/percpu_counter.h"                    // for percpu_counter_init
#include "linux/personality.h"                       // for READ_IMPLIES_EXEC
#include "linux/pgtable.h"                           // for FIRST_USER_ADDRESS
#include "linux/rbtree.h"                            // for rb_entry, rb_parent
#include "linux/rbtree_types.h"                      // for rb_node, rb_root
#include "linux/rwsem.h"                             // for down_write_nest_...
#include "linux/sched.h"                             // for task_struct, con...
#include "linux/sched/coredump.h"                    // for MMF_OOM_SKIP
#include "linux/sched/signal.h"                      // for rlimit, signal_p...
#include "linux/spinlock.h"                          // for spin_lock, spin_...
#include "linux/stat.h"                              // for S_ISBLK, S_ISREG
#include "linux/stddef.h"                            // for false, true
#include "linux/types.h"                             // for bool, list_head
#include "linux/vmstat.h"                            // for global_zone_page...
#include "vdso/limits.h"                             // for ULONG_MAX
---
  ./scripts/check-local-export mm/mmap.o
  iwyu2 -Wp,-MMD,mm/.mmu_gather.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/mmu_gather"' -DKBUILD_BASENAME='"mmu_gather"' -DKBUILD_MODNAME='"mmu_gather"' -D__KBUILD_MODNAME=kmod_mmu_gather -c -o mm/mmu_gather.o mm/mmu_gather.c  
In file included from mm/mmu_gather.c:6:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/mmu_gather.c:6:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/mmu_gather.c:6:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/mmu_gather.c:6:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/mmu_gather.c:6:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/mmu_gather.c:6:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/mmu_gather.c:6:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/mmu_gather.c:6:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/mmu_gather.c should add these lines:
#include <stddef.h>                // for NULL
#include "linux/compiler_types.h"  // for inline
#include "linux/minmax.h"          // for min
#include "linux/sched.h"           // for cond_resched
#include "linux/stddef.h"          // for false, true
#include "linux/types.h"           // for bool

mm/mmu_gather.c should remove these lines:
- #include <asm/pgalloc.h>  // lines 12-12
- #include <linux/highmem.h>  // lines 2-2
- #include <linux/pagemap.h>  // lines 7-7
- #include <linux/rcupdate.h>  // lines 8-8
- #include <linux/smp.h>  // lines 9-9

The full include-list for mm/mmu_gather.c:
#include <asm/tlb.h>               // for mmu_gather, mmu_gather_batch, __tl...
#include <linux/gfp.h>             // for __get_free_pages, free_pages, GFP_...
#include <linux/kernel.h>          // for ARRAY_SIZE
#include <linux/mm_inline.h>       // for dec_tlb_flush_pending, inc_tlb_flu...
#include <linux/mm_types.h>        // for tlb_finish_mmu, tlb_gather_mmu
#include <linux/mmdebug.h>         // for VM_BUG_ON, VM_BUG_ON_PAGE
#include <linux/swap.h>            // for free_pages_and_swap_cache
#include <stddef.h>                // for NULL
#include "linux/compiler_types.h"  // for inline
#include "linux/minmax.h"          // for min
#include "linux/sched.h"           // for cond_resched
#include "linux/stddef.h"          // for false, true
#include "linux/types.h"           // for bool
---
  ./scripts/check-local-export mm/mmu_gather.o
  iwyu2 -Wp,-MMD,mm/.mprotect.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/mprotect"' -DKBUILD_BASENAME='"mprotect"' -DKBUILD_MODNAME='"mprotect"' -D__KBUILD_MODNAME=kmod_mprotect -c -o mm/mprotect.o mm/mprotect.c  
In file included from mm/mprotect.c:13:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/mprotect.c:21:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/mprotect.c:21:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/mprotect.c:21:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/mprotect.c:13:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/mprotect.c:21:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/mprotect.c:21:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/mprotect.c:21:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/mprotect.c should add these lines:
#include <asm/bug.h>                           // for WARN_ON_ONCE, BUG_ON
#include <linux/mm.h>                          // for PageAnon, PageDirty
#include <stddef.h>                            // for size_t, NULL
#include "asm-generic/errno-base.h"            // for EINVAL, ENOMEM, EACCES
#include "asm-generic/mman-common.h"           // for PROT_GROWSDOWN, PROT_G...
#include "asm-generic/pgtable-nop4d.h"         // for p4d_offset, p4d_t, p4d...
#include "asm-generic/pgtable-nopmd.h"         // for pmd_t, pmd_addr_end
#include "asm-generic/pgtable-nopud.h"         // for pud_t, pud_addr_end
#include "asm-generic/pgtable_uffd.h"          // for pte_swp_mkuffd_wp, pte...
#include "asm/current.h"                       // for current
#include "asm/page_types.h"                    // for PAGE_SIZE, PAGE_SHIFT
#include "asm/pgtable-2level_types.h"          // for pte_t
#include "asm/pgtable.h"                       // for pfn_modify_allowed
#include "asm/pgtable_types.h"                 // for pgprot_t, pgd_t
#include "asm/ptrace.h"                        // for pt_regs
#include "asm/topology.h"                      // for numa_node_id
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read
#include "linux/compiler.h"                    // for unlikely
#include "linux/compiler_types.h"              // for inline
#include "linux/huge_mm.h"                     // for is_swap_pmd, __split_h...
#include "linux/hugetlb_inline.h"              // for is_vm_hugetlb_page
#include "linux/mm_types.h"                    // for vm_area_struct, tlb_fi...
#include "linux/mmap_lock.h"                   // for mmap_write_lock_killable
#include "linux/mmdebug.h"                     // for VM_WARN_ON
#include "linux/node.h"                        // for node_is_toptier
#include "linux/numa.h"                        // for NUMA_NO_NODE
#include "linux/page_ref.h"                    // for page_count
#include "linux/personality.h"                 // for READ_IMPLIES_EXEC
#include "linux/sched.h"                       // for task_struct, cond_resched
#include "linux/spinlock_types.h"              // for spinlock_t
#include "linux/stddef.h"                      // for false
#include "linux/types.h"                       // for bool, pgoff_t
#include "linux/vmstat.h"                      // for count_vm_numa_events

mm/mprotect.c should remove these lines:
- #include <asm/cacheflush.h>  // lines 34-34
- #include <asm/mmu_context.h>  // lines 35-35
- #include <linux/fs.h>  // lines 16-16
- #include <linux/highmem.h>  // lines 17-17
- #include <linux/ksm.h>  // lines 28-28
- #include <linux/migrate.h>  // lines 25-25
- #include <linux/personality.h>  // lines 20-20
- #include <linux/shm.h>  // lines 14-14
- #include <linux/swap.h>  // lines 22-22
- #include <linux/uaccess.h>  // lines 29-29

The full include-list for mm/mprotect.c:
#include <asm/bug.h>                           // for WARN_ON_ONCE, BUG_ON
#include <asm/tlb.h>                           // for tlb_change_page_size
#include <asm/tlbflush.h>                      // for pte_needs_flush
#include <linux/hugetlb.h>                     // for hugetlb_change_protection
#include <linux/mempolicy.h>                   // for vma_policy
#include <linux/mm.h>                          // for PageAnon, PageDirty
#include <linux/mm_inline.h>                   // for anon_vma_name, page_is...
#include <linux/mman.h>                        // for calc_vm_prot_bits, vm_...
#include <linux/mmu_notifier.h>                // for mmu_notifier_range
#include <linux/pagewalk.h>                    // for walk_page_range, mm_walk
#include <linux/perf_event.h>                  // for perf_event_mmap
#include <linux/pgtable.h>                     // for pmd_devmap, pmd_trans_...
#include <linux/pkeys.h>                       // for may_expand_vm, split_vma
#include <linux/sched/sysctl.h>                // for NUMA_BALANCING_NORMAL
#include <linux/security.h>                    // for security_file_mprotect
#include <linux/swapops.h>                     // for swp_offset, swp_entry_...
#include <linux/syscalls.h>                    // for __MAP3, SYSCALL_DEFINE3
#include <linux/userfaultfd_k.h>               // for pte_marker_entry_uffd_wp
#include <stddef.h>                            // for size_t, NULL
#include "asm-generic/errno-base.h"            // for EINVAL, ENOMEM, EACCES
#include "asm-generic/mman-common.h"           // for PROT_GROWSDOWN, PROT_G...
#include "asm-generic/pgtable-nop4d.h"         // for p4d_offset, p4d_t, p4d...
#include "asm-generic/pgtable-nopmd.h"         // for pmd_t, pmd_addr_end
#include "asm-generic/pgtable-nopud.h"         // for pud_t, pud_addr_end
#include "asm-generic/pgtable_uffd.h"          // for pte_swp_mkuffd_wp, pte...
#include "asm/current.h"                       // for current
#include "asm/page_types.h"                    // for PAGE_SIZE, PAGE_SHIFT
#include "asm/pgtable-2level_types.h"          // for pte_t
#include "asm/pgtable.h"                       // for pfn_modify_allowed
#include "asm/pgtable_types.h"                 // for pgprot_t, pgd_t
#include "asm/ptrace.h"                        // for pt_regs
#include "asm/topology.h"                      // for numa_node_id
#include "internal.h"                          // for flush_tlb_batched_pending
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read
#include "linux/compiler.h"                    // for unlikely
#include "linux/compiler_types.h"              // for inline
#include "linux/huge_mm.h"                     // for is_swap_pmd, __split_h...
#include "linux/hugetlb_inline.h"              // for is_vm_hugetlb_page
#include "linux/mm_types.h"                    // for vm_area_struct, tlb_fi...
#include "linux/mmap_lock.h"                   // for mmap_write_lock_killable
#include "linux/mmdebug.h"                     // for VM_WARN_ON
#include "linux/node.h"                        // for node_is_toptier
#include "linux/numa.h"                        // for NUMA_NO_NODE
#include "linux/page_ref.h"                    // for page_count
#include "linux/personality.h"                 // for READ_IMPLIES_EXEC
#include "linux/sched.h"                       // for task_struct, cond_resched
#include "linux/spinlock_types.h"              // for spinlock_t
#include "linux/stddef.h"                      // for false
#include "linux/types.h"                       // for bool, pgoff_t
#include "linux/vmstat.h"                      // for count_vm_numa_events
---
  ./scripts/check-local-export mm/mprotect.o
  iwyu2 -Wp,-MMD,mm/.mremap.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/mremap"' -DKBUILD_BASENAME='"mremap"' -DKBUILD_MODNAME='"mremap"' -D__KBUILD_MODNAME=kmod_mremap -c -o mm/mremap.o mm/mremap.c  
In file included from mm/mremap.c:12:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/mremap.c:14:
In file included from ./include/linux/ksm.h:14:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/mremap.c:14:
In file included from ./include/linux/ksm.h:14:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/mremap.c:14:
In file included from ./include/linux/ksm.h:14:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/mremap.c:12:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/mremap.c:14:
In file included from ./include/linux/ksm.h:14:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/mremap.c:14:
In file included from ./include/linux/ksm.h:14:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/mremap.c:14:
In file included from ./include/linux/ksm.h:14:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/mremap.c should add these lines:
#include <asm/bug.h>                    // for WARN_ON_ONCE
#include <asm/page_types.h>             // for TASK_SIZE
#include <stddef.h>                     // for NULL
#include "asm-generic/cacheflush.h"     // for flush_cache_range
#include "asm-generic/errno-base.h"     // for ENOMEM, EINVAL, EFAULT, EAGAIN
#include "asm-generic/mman-common.h"    // for MAP_FIXED, MADV_UNMERGEABLE
#include "asm-generic/pgtable-nop4d.h"  // for p4d_offset, p4d_t
#include "asm-generic/pgtable-nopmd.h"  // for pmd_t, PMD_SIZE, PMD_MASK
#include "asm-generic/pgtable-nopud.h"  // for pud_t, PUD_SIZE, PUD_MASK
#include "asm/current.h"                // for current
#include "asm/page_types.h"             // for PAGE_SHIFT, PAGE_SIZE, PAGE_MASK
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable.h"                // for pmd_none, pte_none, pte_present
#include "asm/pgtable_types.h"          // for pgd_t
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/tlbflush.h"               // for flush_tlb_range
#include "generated/autoconf.h"         // for CONFIG_HAVE_MOVE_PUD, CONFIG_...
#include "linux/align.h"                // for ALIGN
#include "linux/build_bug.h"            // for BUILD_BUG
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __always_inline, __maybe_unused
#include "linux/compiler_types.h"       // for inline
#include "linux/err.h"                  // for ERR_PTR, IS_ERR, PTR_ERR, IS_...
#include "linux/huge_mm.h"              // for is_swap_pmd, move_huge_pmd
#include "linux/hugetlb_inline.h"       // for is_vm_hugetlb_page
#include "linux/kconfig.h"              // for __ARG_PLACEHOLDER_1, IS_ENABLED
#include "linux/list.h"                 // for LIST_HEAD
#include "linux/lockdep.h"              // for SINGLE_DEPTH_NESTING
#include "linux/mm_types.h"             // for vm_area_struct, mm_struct
#include "linux/mman.h"                 // for MREMAP_DONTUNMAP, MREMAP_FIXED
#include "linux/mmap_lock.h"            // for mmap_read_unlock, mmap_write_...
#include "linux/mmdebug.h"              // for VM_BUG_ON
#include "linux/pgtable.h"              // for pmd_trans_huge, p4d_none_or_c...
#include "linux/printk.h"               // for pr_warn_once
#include "linux/rmap.h"                 // for anon_vma_lock_write, anon_vma...
#include "linux/sched.h"                // for task_struct, cond_resched
#include "linux/spinlock.h"             // for spin_unlock, spin_lock_nested
#include "linux/spinlock_types.h"       // for spinlock_t
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool, list_head (ptr only)

mm/mremap.c should remove these lines:
- #include <asm/cacheflush.h>  // lines 27-27
- #include <asm/tlb.h>  // lines 28-28
- #include <linux/capability.h>  // lines 17-17
- #include <linux/highmem.h>  // lines 20-20
- #include <linux/shm.h>  // lines 13-13
- #include <linux/swap.h>  // lines 16-16
- #include <linux/swapops.h>  // lines 19-19
- #include <linux/uaccess.h>  // lines 24-24

The full include-list for mm/mremap.c:
#include <asm/bug.h>                    // for WARN_ON_ONCE
#include <asm/page_types.h>             // for TASK_SIZE
#include <asm/pgalloc.h>                // for pmd_populate
#include <linux/fs.h>                   // for i_mmap_lock_write, i_mmap_unl...
#include <linux/hugetlb.h>              // for huge_page_size, huge_page_mask
#include <linux/ksm.h>                  // for ksm_madvise
#include <linux/mm.h>                   // for do_munmap, get_unmapped_area
#include <linux/mman.h>                 // for vm_unacct_memory, vm_acct_memory
#include <linux/mmu_notifier.h>         // for mmu_notifier_invalidate_range...
#include <linux/security.h>             // for security_vm_enough_memory_mm
#include <linux/syscalls.h>             // for __MAP5, SYSCALL_DEFINE5
#include <linux/userfaultfd_k.h>        // for userfaultfd_unmap_complete
#include <stddef.h>                     // for NULL
#include "asm-generic/cacheflush.h"     // for flush_cache_range
#include "asm-generic/errno-base.h"     // for ENOMEM, EINVAL, EFAULT, EAGAIN
#include "asm-generic/mman-common.h"    // for MAP_FIXED, MADV_UNMERGEABLE
#include "asm-generic/pgtable-nop4d.h"  // for p4d_offset, p4d_t
#include "asm-generic/pgtable-nopmd.h"  // for pmd_t, PMD_SIZE, PMD_MASK
#include "asm-generic/pgtable-nopud.h"  // for pud_t, PUD_SIZE, PUD_MASK
#include "asm/current.h"                // for current
#include "asm/page_types.h"             // for PAGE_SHIFT, PAGE_SIZE, PAGE_MASK
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable.h"                // for pmd_none, pte_none, pte_present
#include "asm/pgtable_types.h"          // for pgd_t
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/tlbflush.h"               // for flush_tlb_range
#include "generated/autoconf.h"         // for CONFIG_HAVE_MOVE_PUD, CONFIG_...
#include "internal.h"                   // for flush_tlb_batched_pending
#include "linux/align.h"                // for ALIGN
#include "linux/build_bug.h"            // for BUILD_BUG
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __always_inline, __maybe_unused
#include "linux/compiler_types.h"       // for inline
#include "linux/err.h"                  // for ERR_PTR, IS_ERR, PTR_ERR, IS_...
#include "linux/huge_mm.h"              // for is_swap_pmd, move_huge_pmd
#include "linux/hugetlb_inline.h"       // for is_vm_hugetlb_page
#include "linux/kconfig.h"              // for __ARG_PLACEHOLDER_1, IS_ENABLED
#include "linux/list.h"                 // for LIST_HEAD
#include "linux/lockdep.h"              // for SINGLE_DEPTH_NESTING
#include "linux/mm_types.h"             // for vm_area_struct, mm_struct
#include "linux/mman.h"                 // for MREMAP_DONTUNMAP, MREMAP_FIXED
#include "linux/mmap_lock.h"            // for mmap_read_unlock, mmap_write_...
#include "linux/mmdebug.h"              // for VM_BUG_ON
#include "linux/pgtable.h"              // for pmd_trans_huge, p4d_none_or_c...
#include "linux/printk.h"               // for pr_warn_once
#include "linux/rmap.h"                 // for anon_vma_lock_write, anon_vma...
#include "linux/sched.h"                // for task_struct, cond_resched
#include "linux/spinlock.h"             // for spin_unlock, spin_lock_nested
#include "linux/spinlock_types.h"       // for spinlock_t
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool, list_head (ptr only)
---
  ./scripts/check-local-export mm/mremap.o
  iwyu2 -Wp,-MMD,mm/.msync.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/msync"' -DKBUILD_BASENAME='"msync"' -DKBUILD_MODNAME='"msync"' -D__KBUILD_MODNAME=kmod_msync -c -o mm/msync.o mm/msync.c  
In file included from mm/msync.c:15:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/msync.c:15:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/msync.c:15:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/msync.c:15:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from mm/msync.c:15:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/msync.c:15:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/msync.c:15:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/msync.c:15:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

mm/msync.c should add these lines:
#include <stddef.h>                   // for size_t
#include "asm-generic/errno-base.h"   // for ENOMEM, EBUSY, EINVAL
#include "asm-generic/mman-common.h"  // for MS_ASYNC, MS_SYNC, MS_INVALIDATE
#include "asm/current.h"              // for current
#include "asm/page_types.h"           // for PAGE_MASK, PAGE_SHIFT
#include "asm/ptrace.h"               // for pt_regs
#include "linux/minmax.h"             // for min
#include "linux/mm_types.h"           // for vm_area_struct
#include "linux/mmap_lock.h"          // for mmap_read_lock, mmap_read_unlock
#include "linux/types.h"              // for loff_t

mm/msync.c should remove these lines:
- #include <linux/mman.h>  // lines 13-13

The full include-list for mm/msync.c:
#include <linux/file.h>               // for fput
#include <linux/fs.h>                 // for get_file, vfs_fsync_range
#include <linux/mm.h>                 // for find_vma, VM_LOCKED, VM_SHARED
#include <linux/sched.h>              // for task_struct
#include <linux/syscalls.h>           // for __MAP3, SYSCALL_DEFINE3
#include <stddef.h>                   // for size_t
#include "asm-generic/errno-base.h"   // for ENOMEM, EBUSY, EINVAL
#include "asm-generic/mman-common.h"  // for MS_ASYNC, MS_SYNC, MS_INVALIDATE
#include "asm/current.h"              // for current
#include "asm/page_types.h"           // for PAGE_MASK, PAGE_SHIFT
#include "asm/ptrace.h"               // for pt_regs
#include "linux/minmax.h"             // for min
#include "linux/mm_types.h"           // for vm_area_struct
#include "linux/mmap_lock.h"          // for mmap_read_lock, mmap_read_unlock
#include "linux/types.h"              // for loff_t
---
  ./scripts/check-local-export mm/msync.o
  iwyu2 -Wp,-MMD,mm/.page_vma_mapped.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/page_vma_mapped"' -DKBUILD_BASENAME='"page_vma_mapped"' -DKBUILD_MODNAME='"page_vma_mapped"' -D__KBUILD_MODNAME=kmod_page_vma_mapped -c -o mm/page_vma_mapped.o mm/page_vma_mapped.c  
In file included from mm/page_vma_mapped.c:3:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/page_vma_mapped.c:3:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/page_vma_mapped.c:3:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/page_vma_mapped.c:3:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/page_vma_mapped.c:3:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/page_vma_mapped.c:3:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/page_vma_mapped.c:3:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/page_vma_mapped.c:3:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/page_vma_mapped.c should add these lines:
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EFAULT
#include "asm-generic/memory_model.h"   // for page_to_pfn
#include "asm-generic/pgtable-nop4d.h"  // for p4d_offset, pgd_present, P4D_...
#include "asm-generic/pgtable-nopmd.h"  // for pmd_t, pud_present, PMD_SIZE
#include "asm-generic/pgtable-nopud.h"  // for p4d_present, PUD_SIZE, pud_of...
#include "asm-generic/rwonce.h"         // for READ_ONCE
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/pgtable.h"                // for pmd_present, pte_present, pmd...
#include "asm/pgtable_32_types.h"       // for PGDIR_SIZE
#include "asm/pgtable_types.h"          // for pgd_t
#include "linux/compiler.h"             // for likely, unlikely
#include "linux/compiler_types.h"       // for inline
#include "linux/huge_mm.h"              // for thp_migration_supported, tran...
#include "linux/hugetlb_inline.h"       // for is_vm_hugetlb_page
#include "linux/mm_types.h"             // for swp_entry_t, vm_area_struct
#include "linux/pgtable.h"              // for pmd_devmap, pmd_trans_huge
#include "linux/spinlock.h"             // for spin_lock, spin_unlock
#include "linux/spinlock_types.h"       // for spinlock_t
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool
#include "vdso/limits.h"                // for ULONG_MAX

mm/page_vma_mapped.c should remove these lines:
- #include <linux/swap.h>  // lines 5-5

The full include-list for mm/page_vma_mapped.c:
#include <linux/hugetlb.h>              // for hstate_vma, huge_page_size
#include <linux/mm.h>                   // for pte_lockptr, pmd_lock
#include <linux/rmap.h>                 // for page_vma_mapped_walk, page_vm...
#include <linux/swapops.h>              // for is_swap_pte, is_device_exclus...
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EFAULT
#include "asm-generic/memory_model.h"   // for page_to_pfn
#include "asm-generic/pgtable-nop4d.h"  // for p4d_offset, pgd_present, P4D_...
#include "asm-generic/pgtable-nopmd.h"  // for pmd_t, pud_present, PMD_SIZE
#include "asm-generic/pgtable-nopud.h"  // for p4d_present, PUD_SIZE, pud_of...
#include "asm-generic/rwonce.h"         // for READ_ONCE
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/pgtable.h"                // for pmd_present, pte_present, pmd...
#include "asm/pgtable_32_types.h"       // for PGDIR_SIZE
#include "asm/pgtable_types.h"          // for pgd_t
#include "internal.h"                   // for vma_address, vma_address_end
#include "linux/compiler.h"             // for likely, unlikely
#include "linux/compiler_types.h"       // for inline
#include "linux/huge_mm.h"              // for thp_migration_supported, tran...
#include "linux/hugetlb_inline.h"       // for is_vm_hugetlb_page
#include "linux/mm_types.h"             // for swp_entry_t, vm_area_struct
#include "linux/pgtable.h"              // for pmd_devmap, pmd_trans_huge
#include "linux/spinlock.h"             // for spin_lock, spin_unlock
#include "linux/spinlock_types.h"       // for spinlock_t
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool
#include "vdso/limits.h"                // for ULONG_MAX
---
  ./scripts/check-local-export mm/page_vma_mapped.o
  iwyu2 -Wp,-MMD,mm/.pagewalk.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/pagewalk"' -DKBUILD_BASENAME='"pagewalk"' -DKBUILD_MODNAME='"pagewalk"' -D__KBUILD_MODNAME=kmod_pagewalk -c -o mm/pagewalk.o mm/pagewalk.c  
In file included from mm/pagewalk.c:5:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
1 warning generated.
In file included from mm/pagewalk.c:5:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

include/linux/pagewalk.h should add these lines:
#include "asm-generic/pgtable-nop4d.h"  // for p4d_t
#include "asm-generic/pgtable-nopmd.h"  // for pmd_t
#include "asm-generic/pgtable-nopud.h"  // for pud_t
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable_types.h"          // for pgd_t
#include "linux/types.h"                // for pgoff_t, bool
struct address_space;
struct mm_struct;
struct vm_area_struct;

include/linux/pagewalk.h should remove these lines:
- #include <linux/mm.h>  // lines 5-5

The full include-list for include/linux/pagewalk.h:
#include "asm-generic/pgtable-nop4d.h"  // for p4d_t
#include "asm-generic/pgtable-nopmd.h"  // for pmd_t
#include "asm-generic/pgtable-nopud.h"  // for pud_t
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable_types.h"          // for pgd_t
#include "linux/types.h"                // for pgoff_t, bool
struct address_space;
struct mm_struct;
struct mm_walk;  // lines 7-7
struct vm_area_struct;
---

mm/pagewalk.c should add these lines:
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm/page_types.h"          // for PAGE_SIZE, PAGE_SHIFT
#include "asm/pgtable.h"             // for pmd_none, pmd_present, pmd_leaf
#include "linux/fs.h"                // for address_space
#include "linux/huge_mm.h"           // for split_huge_pmd, split_huge_pud
#include "linux/hugetlb_inline.h"    // for is_vm_hugetlb_page
#include "linux/lockdep.h"           // for lockdep_assert_held
#include "linux/minmax.h"            // for min, max
#include "linux/mm.h"                // for find_vma, vma_pages, VM_PFNMAP
#include "linux/mm_types.h"          // for vm_area_struct, mm_struct (ptr o...
#include "linux/mmap_lock.h"         // for mmap_assert_locked
#include "linux/pgtable.h"           // for p4d_none_or_clear_bad, pgd_none_...
#include "linux/spinlock_types.h"    // for spinlock_t
#include "linux/stddef.h"            // for true

mm/pagewalk.c should remove these lines:
- #include <linux/highmem.h>  // lines 3-3
- #include <linux/sched.h>  // lines 4-4

The full include-list for mm/pagewalk.c:
#include <linux/pagewalk.h>
#include <linux/hugetlb.h>           // for hugepd_t, is_hugepd
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm/page_types.h"          // for PAGE_SIZE, PAGE_SHIFT
#include "asm/pgtable.h"             // for pmd_none, pmd_present, pmd_leaf
#include "linux/fs.h"                // for address_space
#include "linux/huge_mm.h"           // for split_huge_pmd, split_huge_pud
#include "linux/hugetlb_inline.h"    // for is_vm_hugetlb_page
#include "linux/lockdep.h"           // for lockdep_assert_held
#include "linux/minmax.h"            // for min, max
#include "linux/mm.h"                // for find_vma, vma_pages, VM_PFNMAP
#include "linux/mm_types.h"          // for vm_area_struct, mm_struct (ptr o...
#include "linux/mmap_lock.h"         // for mmap_assert_locked
#include "linux/pgtable.h"           // for p4d_none_or_clear_bad, pgd_none_...
#include "linux/spinlock_types.h"    // for spinlock_t
#include "linux/stddef.h"            // for true
---
  ./scripts/check-local-export mm/pagewalk.o
  iwyu2 -Wp,-MMD,mm/.pgtable-generic.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/pgtable-generic"' -DKBUILD_BASENAME='"pgtable_generic"' -DKBUILD_MODNAME='"pgtable_generic"' -D__KBUILD_MODNAME=kmod_pgtable_generic -c -o mm/pgtable-generic.o mm/pgtable-generic.c  
In file included from mm/pgtable-generic.c:11:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/pgtable-generic.c:13:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/pgtable-generic.c:13:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/pgtable-generic.c:13:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/pgtable-generic.c:11:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/pgtable-generic.c:13:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/pgtable-generic.c:13:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/pgtable-generic.c:13:
In file included from ./include/linux/mm_inline.h:7:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/pgtable-generic.c should add these lines:
#include "asm-generic/pgtable-nop4d.h"  // for pgd_clear, __PAGETABLE_P4D_FO...
#include "asm-generic/pgtable-nopmd.h"  // for pmd_ERROR, pmd_t
#include "asm-generic/pgtable-nopud.h"  // for __PAGETABLE_PUD_FOLDED
#include "asm/pgtable-2level.h"         // for pgd_ERROR
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable.h"                // for ptep_get_and_clear, __HAVE_AR...
#include "asm/pgtable_types.h"          // for pgd_t
#include "asm/tlbflush.h"               // for flush_tlb_page
#include "linux/mm_types.h"             // for vm_area_struct

mm/pgtable-generic.c should remove these lines:
- #include <asm/tlb.h>  // lines 14-14
- #include <linux/hugetlb.h>  // lines 11-11
- #include <linux/mm_inline.h>  // lines 13-13
- #include <linux/pagemap.h>  // lines 10-10

The full include-list for mm/pgtable-generic.c:
#include <linux/pgtable.h>              // for pgd_clear_bad, pmd_clear_bad
#include "asm-generic/pgtable-nop4d.h"  // for pgd_clear, __PAGETABLE_P4D_FO...
#include "asm-generic/pgtable-nopmd.h"  // for pmd_ERROR, pmd_t
#include "asm-generic/pgtable-nopud.h"  // for __PAGETABLE_PUD_FOLDED
#include "asm/pgtable-2level.h"         // for pgd_ERROR
#include "asm/pgtable-2level_types.h"   // for pte_t
#include "asm/pgtable.h"                // for ptep_get_and_clear, __HAVE_AR...
#include "asm/pgtable_types.h"          // for pgd_t
#include "asm/tlbflush.h"               // for flush_tlb_page
#include "linux/mm_types.h"             // for vm_area_struct
---
  ./scripts/check-local-export mm/pgtable-generic.o
  iwyu2 -Wp,-MMD,mm/.rmap.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/rmap"' -DKBUILD_BASENAME='"rmap"' -DKBUILD_MODNAME='"rmap"' -D__KBUILD_MODNAME=kmod_rmap -c -o mm/rmap.o mm/rmap.c  
In file included from mm/rmap.c:59:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/rmap.c:59:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/rmap.c:59:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/rmap.c:59:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/rmap.c:59:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/rmap.c:59:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/rmap.c:59:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/rmap.c:59:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/rmap.c should add these lines:
#include <asm/barrier.h>                       // for smp_mb, smp_rmb
#include <asm/bug.h>                           // for WARN_ON_ONCE, BUG_ON
#include <stddef.h>                            // for NULL
#include "asm-generic/cacheflush.h"            // for flush_cache_page, flus...
#include "asm-generic/errno-base.h"            // for EFAULT, ENOMEM
#include "asm-generic/memory_model.h"          // for page_to_pfn
#include "asm-generic/pgtable-nop4d.h"         // for p4d_offset, pgd_present
#include "asm-generic/pgtable-nopmd.h"         // for pmd_t, pud_present
#include "asm-generic/pgtable-nopud.h"         // for p4d_present, pud_offset
#include "asm-generic/pgtable_uffd.h"          // for pte_swp_mkuffd_wp, pte...
#include "asm-generic/rwonce.h"                // for READ_ONCE, WRITE_ONCE
#include "asm/current.h"                       // for current
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/pgtable-2level_types.h"          // for pte_t
#include "asm/pgtable.h"                       // for set_pte_at, pte_pfn
#include "asm/pgtable_types.h"                 // for pgd_t
#include "linux/atomic/atomic-instrumented.h"  // for atomic_add_negative
#include "linux/compiler.h"                    // for unlikely, barrier, likely
#include "linux/compiler_types.h"              // for inline
#include "linux/cpumask.h"                     // for cpumask_any_but, nr_cp...
#include "linux/fs.h"                          // for i_mmap_lock_read, i_mm...
#include "linux/gfp.h"                         // for GFP_KERNEL, GFP_NOWAIT
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/kernel.h"                      // for might_sleep
#include "linux/list.h"                        // for list_add, list_del
#include "linux/mm_types.h"                    // for vm_area_struct, page
#include "linux/mm_types_task.h"               // for tlbflush_unmap_batch
#include "linux/mmdebug.h"                     // for VM_BUG_ON_PAGE, VM_BUG...
#include "linux/mmzone.h"                      // for NR_ANON_MAPPED, NR_ANO...
#include "linux/page_ref.h"                    // for folio_ref_count
#include "linux/pgtable.h"                     // for pte_swp_mksoft_dirty
#include "linux/rbtree.h"                      // for RB_EMPTY_ROOT
#include "linux/rbtree_types.h"                // for rb_root_cached, RB_ROO...
#include "linux/rwsem.h"                       // for up_write, down_read_tr...
#include "linux/sched.h"                       // for task_struct, cond_resched
#include "linux/smp.h"                         // for get_cpu, put_cpu
#include "linux/spinlock.h"                    // for spin_lock, spin_unlock
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for bool, list_head, pgoff_t
#include "linux/vmstat.h"                      // for __mod_lruvec_page_state
struct mem_cgroup;

mm/rmap.c should remove these lines:
- #include <linux/backing-dev.h>  // lines 72-72
- #include <linux/migrate.h>  // lines 69-69
- #include <linux/sched/mm.h>  // lines 56-56
- #include <trace/events/tlb.h>  // lines 81-81

The full include-list for mm/rmap.c:
#include <asm/barrier.h>                       // for smp_mb, smp_rmb
#include <asm/bug.h>                           // for WARN_ON_ONCE, BUG_ON
#include <asm/tlbflush.h>                      // for arch_tlbbatch_add_mm
#include <linux/export.h>                      // for EXPORT_SYMBOL_GPL
#include <linux/huge_mm.h>                     // for deferred_split_huge_page
#include <linux/hugetlb.h>                     // for set_huge_swap_pte_at
#include <linux/init.h>                        // for __init
#include <linux/ksm.h>                         // for rmap_walk_ksm
#include <linux/memcontrol.h>                  // for lock_page_memcg, unloc...
#include <linux/memremap.h>                    // for folio_is_device_private
#include <linux/mm.h>                          // for folio_test_anon, folio...
#include <linux/mm_inline.h>                   // for pte_install_uffd_wp_if...
#include <linux/mmu_notifier.h>                // for mmu_notifier_range
#include <linux/page_idle.h>                   // for folio_clear_idle, foli...
#include <linux/pagemap.h>                     // for folio_mapping, folio_p...
#include <linux/rcupdate.h>                    // for rcu_read_unlock, rcu_r...
#include <linux/rmap.h>                        // for page_vma_mapped_walk
#include <linux/sched/task.h>                  // for mmlist_lock
#include <linux/slab.h>                        // for kmem_cache_alloc, kmem...
#include <linux/swap.h>                        // for swap_free, swap_duplicate
#include <linux/swapops.h>                     // for swp_entry_to_pte, make...
#include <linux/userfaultfd_k.h>               // for userfaultfd_armed
#include <stddef.h>                            // for NULL
#include <trace/events/migrate.h>              // for trace_set_migration_pte
#include "asm-generic/cacheflush.h"            // for flush_cache_page, flus...
#include "asm-generic/errno-base.h"            // for EFAULT, ENOMEM
#include "asm-generic/memory_model.h"          // for page_to_pfn
#include "asm-generic/pgtable-nop4d.h"         // for p4d_offset, pgd_present
#include "asm-generic/pgtable-nopmd.h"         // for pmd_t, pud_present
#include "asm-generic/pgtable-nopud.h"         // for p4d_present, pud_offset
#include "asm-generic/pgtable_uffd.h"          // for pte_swp_mkuffd_wp, pte...
#include "asm-generic/rwonce.h"                // for READ_ONCE, WRITE_ONCE
#include "asm/current.h"                       // for current
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/pgtable-2level_types.h"          // for pte_t
#include "asm/pgtable.h"                       // for set_pte_at, pte_pfn
#include "asm/pgtable_types.h"                 // for pgd_t
#include "internal.h"                          // for folio_anon_vma, vma_ad...
#include "linux/atomic/atomic-instrumented.h"  // for atomic_add_negative
#include "linux/compiler.h"                    // for unlikely, barrier, likely
#include "linux/compiler_types.h"              // for inline
#include "linux/cpumask.h"                     // for cpumask_any_but, nr_cp...
#include "linux/fs.h"                          // for i_mmap_lock_read, i_mm...
#include "linux/gfp.h"                         // for GFP_KERNEL, GFP_NOWAIT
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/kernel.h"                      // for might_sleep
#include "linux/list.h"                        // for list_add, list_del
#include "linux/mm_types.h"                    // for vm_area_struct, page
#include "linux/mm_types_task.h"               // for tlbflush_unmap_batch
#include "linux/mmdebug.h"                     // for VM_BUG_ON_PAGE, VM_BUG...
#include "linux/mmzone.h"                      // for NR_ANON_MAPPED, NR_ANO...
#include "linux/page_ref.h"                    // for folio_ref_count
#include "linux/pgtable.h"                     // for pte_swp_mksoft_dirty
#include "linux/rbtree.h"                      // for RB_EMPTY_ROOT
#include "linux/rbtree_types.h"                // for rb_root_cached, RB_ROO...
#include "linux/rwsem.h"                       // for up_write, down_read_tr...
#include "linux/sched.h"                       // for task_struct, cond_resched
#include "linux/smp.h"                         // for get_cpu, put_cpu
#include "linux/spinlock.h"                    // for spin_lock, spin_unlock
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for bool, list_head, pgoff_t
#include "linux/vmstat.h"                      // for __mod_lruvec_page_state
struct mem_cgroup;
---
  ./scripts/check-local-export mm/rmap.o
  iwyu2 -Wp,-MMD,mm/.vmalloc.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/vmalloc"' -DKBUILD_BASENAME='"vmalloc"' -DKBUILD_MODNAME='"vmalloc"' -D__KBUILD_MODNAME=kmod_vmalloc -c -o mm/vmalloc.o mm/vmalloc.c  
In file included from mm/vmalloc.c:34:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/vmalloc.c:34:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/vmalloc.c:34:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/vmalloc.c:34:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/vmalloc.c:34:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/vmalloc.c:34:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/vmalloc.c:34:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/vmalloc.c:34:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

include/linux/vmalloc.h should add these lines:
#include <stddef.h>                    // for size_t
#include "asm-generic/int-ll64.h"      // for u64
#include "asm/page_types.h"            // for PAGE_SIZE, IOREMAP_MAX_ORDER
#include "asm/pgtable-2level_types.h"  // for ARCH_PAGE_TABLE_SYNC_MASK
#include "asm/pgtable_32_areas.h"      // for VMALLOC_END, VMALLOC_START
#include "asm/pgtable_types.h"         // for pgprot_t
#include "linux/compiler_types.h"      // for __alloc_size, inline
#include "linux/rbtree_types.h"        // for rb_node
#include "linux/stddef.h"              // for false
#include "linux/types.h"               // for gfp_t, bool, list_head, phys_a...
struct page;

include/linux/vmalloc.h should remove these lines:
- #include <asm/page.h>  // lines 9-9
- #include <asm/vmalloc.h>  // lines 13-13
- #include <linux/list.h>  // lines 7-7
- #include <linux/llist.h>  // lines 8-8
- #include <linux/overflow.h>  // lines 11-11
- #include <linux/rbtree.h>  // lines 10-10
- #include <linux/spinlock.h>  // lines 5-5

The full include-list for include/linux/vmalloc.h:
#include <linux/init.h>                // for __init
#include <stddef.h>                    // for size_t
#include "asm-generic/int-ll64.h"      // for u64
#include "asm/page_types.h"            // for PAGE_SIZE, IOREMAP_MAX_ORDER
#include "asm/pgtable-2level_types.h"  // for ARCH_PAGE_TABLE_SYNC_MASK
#include "asm/pgtable_32_areas.h"      // for VMALLOC_END, VMALLOC_START
#include "asm/pgtable_types.h"         // for pgprot_t
#include "linux/compiler_types.h"      // for __alloc_size, inline
#include "linux/rbtree_types.h"        // for rb_node
#include "linux/stddef.h"              // for false
#include "linux/types.h"               // for gfp_t, bool, list_head, phys_a...
struct notifier_block;  // lines 16-16
struct page;
struct vm_area_struct;  // lines 15-15
---

mm/vmalloc.c should add these lines:
#include <asm-generic/percpu.h>                // for per_cpu, DEFINE_PER_CPU
#include <asm-generic/pgtable-nopmd.h>         // for pud_t, p4d_bad, PUD_SIZE
#include <asm/barrier.h>                       // for smp_wmb
#include <asm/bug.h>                           // for BUG_ON, WARN_ON_ONCE
#include <asm/percpu.h>                        // for raw_cpu_read_8, raw_cp...
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm-generic/cacheflush.h"            // for flush_cache_vunmap
#include "asm-generic/errno-base.h"            // for ENOMEM, EINVAL, EBUSY
#include "asm-generic/getorder.h"              // for get_order
#include "asm-generic/memory_model.h"          // for page_to_pfn
#include "asm-generic/pgtable-nop4d.h"         // for pgd_bad, p4d_t, p4d_of...
#include "asm-generic/pgtable-nopmd.h"         // for pmd_t, pud_bad, PMD_SIZE
#include "asm/cache.h"                         // for __read_mostly
#include "asm/current.h"                       // for current
#include "asm/page.h"                          // for __pa
#include "asm/page_32.h"                       // for pfn_valid
#include "asm/percpu.h"                        // for __pcpu_type_1, __pcpu_...
#include "asm/pgtable.h"                       // for pte_none, pmd_bad, pte...
#include "asm/set_memory.h"                    // for set_direct_map_default...
#include "asm/string_32.h"                     // for memset, memcpy
#include "asm/topology.h"                      // for numa_node_id
#include "linux/align.h"                       // for ALIGN, IS_ALIGNED
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_read, atom...
#include "linux/compiler_attributes.h"         // for __always_inline
#include "linux/container_of.h"                // for container_of
#include "linux/cpumask.h"                     // for for_each_possible_cpu
#include "linux/debug_locks.h"                 // for debug_check_no_locks_f...
#include "linux/err.h"                         // for ERR_PTR, IS_ERR, ERR_CAST
#include "linux/export.h"                      // for EXPORT_SYMBOL, EXPORT_...
#include "linux/gfp.h"                         // for GFP_KERNEL, __GFP_IO
#include "linux/highmem-internal.h"            // for kmap_atomic, kunmap_at...
#include "linux/init.h"                        // for __init, __initdata
#include "linux/kasan-enabled.h"               // for kasan_hw_tags_enabled
#include "linux/kasan.h"                       // for kasan_reset_tag, kasan...
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/kern_levels.h"                 // for KERN_ERR
#include "linux/kernel.h"                      // for might_sleep, might_sle...
#include "linux/limits.h"                      // for SIZE_MAX
#include "linux/lockdep.h"                     // for lockdep_assert_held
#include "linux/log2.h"                        // for roundup_pow_of_two
#include "linux/minmax.h"                      // for max, min, clamp_t
#include "linux/mm_types.h"                    // for init_mm, page, vm_area...
#include "linux/mmdebug.h"                     // for VIRTUAL_BUG_ON
#include "linux/mutex.h"                       // for mutex_lock, mutex_unlock
#include "linux/nodemask.h"                    // for num_online_nodes
#include "linux/numa.h"                        // for NUMA_NO_NODE
#include "linux/preempt.h"                     // for in_interrupt, in_nmi
#include "linux/printk.h"                      // for printk_ratelimit, pr_warn
#include "linux/rculist.h"                     // for list_del_rcu, list_add...
#include "linux/sched.h"                       // for schedule_timeout_unint...
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK, spinl...
#include "linux/threads.h"                     // for NR_CPUS
#include "linux/workqueue.h"                   // for work_struct, schedule_...
#include "vdso/limits.h"                       // for ULONG_MAX

mm/vmalloc.c should remove these lines:
- #include <linux/highmem.h>  // lines 14-14
- #include <linux/hugetlb.h>  // lines 41-41
- #include <linux/interrupt.h>  // lines 18-18
- #include <linux/kallsyms.h>  // lines 23-23
- #include <linux/module.h>  // lines 13-13
- #include <linux/proc_fs.h>  // lines 19-19
- #include <linux/seq_file.h>  // lines 20-20
- #include <linux/set_memory.h>  // lines 21-21
- #include <linux/uaccess.h>  // lines 40-40

The full include-list for mm/vmalloc.c:
#include <linux/vmalloc.h>
#include <asm-generic/percpu.h>                // for per_cpu, DEFINE_PER_CPU
#include <asm-generic/pgtable-nopmd.h>         // for pud_t, p4d_bad, PUD_SIZE
#include <asm/barrier.h>                       // for smp_wmb
#include <asm/bug.h>                           // for BUG_ON, WARN_ON_ONCE
#include <asm/percpu.h>                        // for raw_cpu_read_8, raw_cp...
#include <asm/shmparam.h>                      // for SHMLBA
#include <asm/tlbflush.h>                      // for flush_tlb_kernel_range
#include <linux/atomic.h>                      // for atomic_long_t, ATOMIC_...
#include <linux/bitops.h>                      // for get_count_order_long, fls
#include <linux/compiler.h>                    // for unlikely, likely
#include <linux/debugobjects.h>                // for debug_check_no_obj_freed
#include <linux/io.h>                          // for ioremap_page_range
#include <linux/kmemleak.h>                    // for kmemleak_free, kmemlea...
#include <linux/list.h>                        // for INIT_LIST_HEAD, list_del
#include <linux/llist.h>                       // for init_llist_head, llist...
#include <linux/memcontrol.h>                  // for mod_memcg_page_state
#include <linux/mm.h>                          // for warn_alloc, debug_page...
#include <linux/notifier.h>                    // for blocking_notifier_call...
#include <linux/overflow.h>                    // for check_add_overflow
#include <linux/pfn.h>                         // for PFN_DOWN
#include <linux/pgtable.h>                     // for pgtbl_mod_mask, pgd_of...
#include <linux/rbtree.h>                      // for rb_entry, rb_erase
#include <linux/rbtree_augmented.h>            // for rb_erase_augmented
#include <linux/rcupdate.h>                    // for rcu_read_lock, rcu_rea...
#include <linux/sched/mm.h>                    // for memalloc_nofs_restore
#include <linux/sched/signal.h>                // for fatal_signal_pending
#include <linux/slab.h>                        // for kfree, kmem_cache_free
#include <linux/spinlock.h>                    // for spin_unlock, spin_lock
#include <linux/xarray.h>                      // for xa_erase, xa_insert
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm-generic/cacheflush.h"            // for flush_cache_vunmap
#include "asm-generic/errno-base.h"            // for ENOMEM, EINVAL, EBUSY
#include "asm-generic/getorder.h"              // for get_order
#include "asm-generic/memory_model.h"          // for page_to_pfn
#include "asm-generic/pgtable-nop4d.h"         // for pgd_bad, p4d_t, p4d_of...
#include "asm-generic/pgtable-nopmd.h"         // for pmd_t, pud_bad, PMD_SIZE
#include "asm/cache.h"                         // for __read_mostly
#include "asm/current.h"                       // for current
#include "asm/page.h"                          // for __pa
#include "asm/page_32.h"                       // for pfn_valid
#include "asm/percpu.h"                        // for __pcpu_type_1, __pcpu_...
#include "asm/pgtable.h"                       // for pte_none, pmd_bad, pte...
#include "asm/set_memory.h"                    // for set_direct_map_default...
#include "asm/string_32.h"                     // for memset, memcpy
#include "asm/topology.h"                      // for numa_node_id
#include "internal.h"                          // for GFP_RECLAIM_MASK, vmap...
#include "linux/align.h"                       // for ALIGN, IS_ALIGNED
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_read, atom...
#include "linux/compiler_attributes.h"         // for __always_inline
#include "linux/container_of.h"                // for container_of
#include "linux/cpumask.h"                     // for for_each_possible_cpu
#include "linux/debug_locks.h"                 // for debug_check_no_locks_f...
#include "linux/err.h"                         // for ERR_PTR, IS_ERR, ERR_CAST
#include "linux/export.h"                      // for EXPORT_SYMBOL, EXPORT_...
#include "linux/gfp.h"                         // for GFP_KERNEL, __GFP_IO
#include "linux/highmem-internal.h"            // for kmap_atomic, kunmap_at...
#include "linux/init.h"                        // for __init, __initdata
#include "linux/kasan-enabled.h"               // for kasan_hw_tags_enabled
#include "linux/kasan.h"                       // for kasan_reset_tag, kasan...
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/kern_levels.h"                 // for KERN_ERR
#include "linux/kernel.h"                      // for might_sleep, might_sle...
#include "linux/limits.h"                      // for SIZE_MAX
#include "linux/lockdep.h"                     // for lockdep_assert_held
#include "linux/log2.h"                        // for roundup_pow_of_two
#include "linux/minmax.h"                      // for max, min, clamp_t
#include "linux/mm_types.h"                    // for init_mm, page, vm_area...
#include "linux/mmdebug.h"                     // for VIRTUAL_BUG_ON
#include "linux/mutex.h"                       // for mutex_lock, mutex_unlock
#include "linux/nodemask.h"                    // for num_online_nodes
#include "linux/numa.h"                        // for NUMA_NO_NODE
#include "linux/preempt.h"                     // for in_interrupt, in_nmi
#include "linux/printk.h"                      // for printk_ratelimit, pr_warn
#include "linux/rculist.h"                     // for list_del_rcu, list_add...
#include "linux/sched.h"                       // for schedule_timeout_unint...
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK, spinl...
#include "linux/threads.h"                     // for NR_CPUS
#include "linux/workqueue.h"                   // for work_struct, schedule_...
#include "pgalloc-track.h"                     // for p4d_alloc_track, pmd_a...
#include "vdso/limits.h"                       // for ULONG_MAX
---
  ./scripts/check-local-export mm/vmalloc.o
  iwyu2 -Wp,-MMD,mm/.page_alloc.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/page-alloc"' -DKBUILD_BASENAME='"page_alloc"' -DKBUILD_MODNAME='"page_alloc"' -D__KBUILD_MODNAME=kmod_page_alloc -c -o mm/page_alloc.o mm/page_alloc.c  
In file included from mm/page_alloc.c:21:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/page_alloc.c:21:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/page_alloc.c:21:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/page_alloc.c:21:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/page_alloc.c:33:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from mm/page_alloc.c:77:
./include/linux/delayacct.h:27:44: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline int delayacct_add_tsk(struct taskstats *d,
                                           ^
6 warnings generated.
In file included from mm/page_alloc.c:21:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/page_alloc.c:21:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/page_alloc.c:21:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/page_alloc.c:21:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/page_alloc.c:33:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from mm/page_alloc.c:77:
./include/linux/delayacct.h:27:44: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline int delayacct_add_tsk(struct taskstats *d,
                                           ^

mm/page_alloc.c should add these lines:
#include <asm-generic/percpu.h>                      // for per_cpu_ptr, DEF...
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON, WARN_ON...
#include <asm/percpu.h>                              // for this_cpu_read_8
#include <linux/atomic.h>                            // for atomic_long_t
#include <linux/bitops.h>                            // for __ffs, __fls
#include <linux/local_lock.h>                        // for INIT_LOCAL_LOCK
#include <linux/mmzone.h>                            // for pageblock_nr_pages
#include <cstdio>                                    // for NULL, size_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/bitsperlong.h"                 // for BITS_PER_LONG
#include "asm-generic/errno-base.h"                  // for EINVAL, ENOENT
#include "asm-generic/error-injection.h"             // for ALLOW_ERROR_INJE...
#include "asm-generic/getorder.h"                    // for get_order
#include "asm-generic/int-ll64.h"                    // for u64, u8
#include "asm-generic/memory_model.h"                // for page_to_pfn, pfn...
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/rwonce.h"                      // for READ_ONCE, WRITE...
#include "asm-generic/sections.h"                    // for __start_rodata
#include "asm-generic/topology.h"                    // for cpumask_of_node
#include "asm/bitsperlong.h"                         // for __BITS_PER_LONG
#include "asm/cache.h"                               // for __read_mostly
#include "asm/current.h"                             // for current
#include "asm/page.h"                                // for virt_to_page
#include "asm/page_32.h"                             // for pfn_valid
#include "asm/page_types.h"                          // for PAGE_SHIFT, PAGE...
#include "asm/percpu.h"                              // for __pcpu_op2_1
#include "asm/processor.h"                           // for prefetchw
#include "asm/string_32.h"                           // for memset
#include "asm/thread_info.h"                         // for TIF_MEMDIE
#include "asm/topology.h"                            // for numa_node_id
#include "generated/autoconf.h"                      // for CONFIG_MMU
#include "generated/bounds.h"                        // for MAX_NR_ZONES
#include "linux/align.h"                             // for ALIGN, ALIGN_DOWN
#include "linux/atomic/atomic-instrumented.h"        // for atomic_long_add
#include "linux/build_bug.h"                         // for BUILD_BUG_ON
#include "linux/cache.h"                             // for SMP_CACHE_BYTES
#include "linux/compiler_attributes.h"               // for __always_inline
#include "linux/compiler_types.h"                    // for inline, __force
#include "linux/container_of.h"                      // for container_of
#include "linux/cpuhotplug.h"                        // for cpuhp_setup_stat...
#include "linux/cpumask.h"                           // for for_each_online_cpu
#include "linux/debug_locks.h"                       // for debug_check_no_l...
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/gfp.h"                               // for alloc_pages_node
#include "linux/highmem-internal.h"                  // for nr_free_highpages
#include "linux/huge_mm.h"                           // for prep_transhuge_page
#include "linux/init.h"                              // for __init, __meminit
#include "linux/jump_label.h"                        // for DEFINE_STATIC_KE...
#include "linux/kasan-enabled.h"                     // for kasan_hw_tags_en...
#include "linux/kconfig.h"                           // for IS_ENABLED, __AR...
#include "linux/kern_levels.h"                       // for KERN_CONT
#include "linux/kstrtox.h"                           // for kstrtobool, simp...
#include "linux/list.h"                              // for list_del, INIT_L...
#include "linux/local_lock.h"                        // for local_unlock_irq...
#include "linux/log2.h"                              // for ilog2, rounddown...
#include "linux/math.h"                              // for roundup, int_sqrt
#include "linux/minmax.h"                            // for min, clamp, max
#include "linux/mm_types.h"                          // for page, page::(ano...
#include "linux/mmdebug.h"                           // for VM_BUG_ON_PAGE
#include "linux/mmzone.h"                            // for zone, per_cpu_pages
#include "linux/mutex.h"                             // for mutex, mutex_unlock
#include "linux/numa.h"                              // for MAX_NUMNODES
#include "linux/page_ext.h"                          // for pgdat_page_ext_init
#include "linux/page_ref.h"                          // for page_ref_count
#include "linux/panic.h"                             // for panic, add_taint
#include "linux/percpu.h"                            // for free_percpu, all...
#include "linux/poison.h"                            // for TAIL_MAPPING
#include "linux/preempt.h"                           // for in_task, migrate...
#include "linux/printk.h"                            // for pr_info, printk
#include "linux/ratelimit_types.h"                   // for DEFINE_RATELIMIT...
#include "linux/sched.h"                             // for task_struct, con...
#include "linux/sizes.h"                             // for SZ_4G
#include "linux/smp.h"                               // for smp_processor_id
#include "linux/spinlock.h"                          // for spin_unlock_irqr...
#include "linux/spinlock_types.h"                    // for DEFINE_SPINLOCK
#include "linux/stdarg.h"                            // for va_end, va_start
#include "linux/sysinfo.h"                           // for sysinfo
#include "linux/thread_info.h"                       // for test_thread_flag
#include "linux/types.h"                             // for bool, gfp_t, lis...
#include "linux/vm_event_item.h"                     // for PGALLOC_NORMAL
#include "linux/wait.h"                              // for init_waitqueue_head
#include "linux/workqueue.h"                         // for work_struct, flu...
#include "linux/writeback.h"                         // for node_dirty_ok
#include "vdso/bits.h"                               // for BIT
#include "vdso/limits.h"                             // for ULONG_MAX
struct capture_control;
struct vmem_altmap;

mm/page_alloc.c should remove these lines:
- #include <asm/sections.h>  // lines 78-78
- #include <asm/tlbflush.h>  // lines 79-79
- #include <linux/backing-dev.h>  // lines 51-51
- #include <linux/cpu.h>  // lines 39-39
- #include <linux/delayacct.h>  // lines 77-77
- #include <linux/ftrace.h>  // lines 70-70
- #include <linux/interrupt.h>  // lines 23-23
- #include <linux/kthread.h>  // lines 68-68
- #include <linux/memremap.h>  // lines 46-46
- #include <linux/migrate.h>  // lines 62-62
- #include <linux/mm_inline.h>  // lines 60-60
- #include <linux/mmu_notifier.h>  // lines 61-61
- #include <linux/nmi.h>  // lines 72-72
- #include <linux/padata.h>  // lines 74-74
- #include <linux/pagemap.h>  // lines 24-24
- #include <linux/pagevec.h>  // lines 32-32
- #include <linux/random.h>  // lines 48-48
- #include <linux/ratelimit.h>  // lines 35-35
- #include <linux/slab.h>  // lines 34-34
- #include <linux/sort.h>  // lines 49-49
- #include <linux/stop_machine.h>  // lines 47-47
- #include <linux/suspend.h>  // lines 31-31
- #include <linux/swapops.h>  // lines 22-22
- #include <linux/topology.h>  // lines 37-37

The full include-list for mm/page_alloc.c:
#include <asm-generic/percpu.h>                      // for per_cpu_ptr, DEF...
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON, WARN_ON...
#include <asm/div64.h>                               // for do_div
#include <asm/percpu.h>                              // for this_cpu_read_8
#include <linux/atomic.h>                            // for atomic_long_t
#include <linux/bitops.h>                            // for __ffs, __fls
#include <linux/blkdev.h>                            // for nr_blockdev_pages
#include <linux/buffer_head.h>                       // for buffer_init
#include <linux/compaction.h>                        // for compact_priority
#include <linux/compiler.h>                          // for unlikely, likely
#include <linux/cpuset.h>                            // for cpusets_enabled
#include <linux/debugobjects.h>                      // for debug_check_no_o...
#include <linux/fault-inject.h>                      // for should_fail_allo...
#include <linux/highmem.h>                           // for clear_highpage
#include <linux/hugetlb.h>                           // for hugetlb_show_mem...
#include <linux/jiffies.h>                           // for jiffies, time_be...
#include <linux/kasan.h>                             // for kasan_has_integr...
#include <linux/kernel.h>                            // for memparse, parse_...
#include <linux/khugepaged.h>                        // for khugepaged_min_f...
#include <linux/kmemleak.h>                          // for kmemleak_alloc
#include <linux/local_lock.h>                        // for INIT_LOCAL_LOCK
#include <linux/lockdep.h>                           // for lockdep_assert_held
#include <linux/memblock.h>                          // for memblock_region_...
#include <linux/memcontrol.h>                        // for memcg_kmem_enabled
#include <linux/memory_hotplug.h>                    // for arch_refresh_nod...
#include <linux/mempolicy.h>                         // for check_highest_zone
#include <linux/mm.h>                                // for page_zone, compo...
#include <linux/mmzone.h>                            // for pageblock_nr_pages
#include <linux/module.h>                            // for print_modules
#include <linux/nodemask.h>                          // for nodemask_t, node...
#include <linux/oom.h>                               // for tsk_is_oom_victim
#include <linux/page-isolation.h>                    // for is_migrate_isolate
#include <linux/page_owner.h>                        // for reset_page_owner
#include <linux/page_table_check.h>                  // for page_table_check...
#include <linux/pfn.h>                               // for PFN_DOWN, PHYS_PFN
#include <linux/psi.h>                               // for psi_memstall_enter
#include <linux/sched/mm.h>                          // for fs_reclaim_acquire
#include <linux/sched/rt.h>                          // for rt_task
#include <linux/stddef.h>                            // for false, true
#include <linux/swap.h>                              // for lru_add_drain_cpu
#include <linux/sysctl.h>                            // for proc_dointvec_mi...
#include <linux/vmalloc.h>                           // for is_vm_area_hugep...
#include <linux/vmstat.h>                            // for global_node_page...
#include <trace/events/kmem.h>                       // for trace_mm_page_alloc
#include <trace/events/oom.h>                        // for trace_reclaim_re...
#include <cstdio>                                    // for NULL, size_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/bitsperlong.h"                 // for BITS_PER_LONG
#include "asm-generic/errno-base.h"                  // for EINVAL, ENOENT
#include "asm-generic/error-injection.h"             // for ALLOW_ERROR_INJE...
#include "asm-generic/getorder.h"                    // for get_order
#include "asm-generic/int-ll64.h"                    // for u64, u8
#include "asm-generic/memory_model.h"                // for page_to_pfn, pfn...
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/rwonce.h"                      // for READ_ONCE, WRITE...
#include "asm-generic/sections.h"                    // for __start_rodata
#include "asm-generic/topology.h"                    // for cpumask_of_node
#include "asm/bitsperlong.h"                         // for __BITS_PER_LONG
#include "asm/cache.h"                               // for __read_mostly
#include "asm/current.h"                             // for current
#include "asm/page.h"                                // for virt_to_page
#include "asm/page_32.h"                             // for pfn_valid
#include "asm/page_types.h"                          // for PAGE_SHIFT, PAGE...
#include "asm/percpu.h"                              // for __pcpu_op2_1
#include "asm/processor.h"                           // for prefetchw
#include "asm/string_32.h"                           // for memset
#include "asm/thread_info.h"                         // for TIF_MEMDIE
#include "asm/topology.h"                            // for numa_node_id
#include "generated/autoconf.h"                      // for CONFIG_MMU
#include "generated/bounds.h"                        // for MAX_NR_ZONES
#include "internal.h"                                // for alloc_context
#include "linux/align.h"                             // for ALIGN, ALIGN_DOWN
#include "linux/atomic/atomic-instrumented.h"        // for atomic_long_add
#include "linux/build_bug.h"                         // for BUILD_BUG_ON
#include "linux/cache.h"                             // for SMP_CACHE_BYTES
#include "linux/compiler_attributes.h"               // for __always_inline
#include "linux/compiler_types.h"                    // for inline, __force
#include "linux/container_of.h"                      // for container_of
#include "linux/cpuhotplug.h"                        // for cpuhp_setup_stat...
#include "linux/cpumask.h"                           // for for_each_online_cpu
#include "linux/debug_locks.h"                       // for debug_check_no_l...
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/gfp.h"                               // for alloc_pages_node
#include "linux/highmem-internal.h"                  // for nr_free_highpages
#include "linux/huge_mm.h"                           // for prep_transhuge_page
#include "linux/init.h"                              // for __init, __meminit
#include "linux/jump_label.h"                        // for DEFINE_STATIC_KE...
#include "linux/kasan-enabled.h"                     // for kasan_hw_tags_en...
#include "linux/kconfig.h"                           // for IS_ENABLED, __AR...
#include "linux/kern_levels.h"                       // for KERN_CONT
#include "linux/kstrtox.h"                           // for kstrtobool, simp...
#include "linux/list.h"                              // for list_del, INIT_L...
#include "linux/local_lock.h"                        // for local_unlock_irq...
#include "linux/log2.h"                              // for ilog2, rounddown...
#include "linux/math.h"                              // for roundup, int_sqrt
#include "linux/minmax.h"                            // for min, clamp, max
#include "linux/mm_types.h"                          // for page, page::(ano...
#include "linux/mmdebug.h"                           // for VM_BUG_ON_PAGE
#include "linux/mmzone.h"                            // for zone, per_cpu_pages
#include "linux/mutex.h"                             // for mutex, mutex_unlock
#include "linux/numa.h"                              // for MAX_NUMNODES
#include "linux/page_ext.h"                          // for pgdat_page_ext_init
#include "linux/page_ref.h"                          // for page_ref_count
#include "linux/panic.h"                             // for panic, add_taint
#include "linux/percpu.h"                            // for free_percpu, all...
#include "linux/poison.h"                            // for TAIL_MAPPING
#include "linux/preempt.h"                           // for in_task, migrate...
#include "linux/printk.h"                            // for pr_info, printk
#include "linux/ratelimit_types.h"                   // for DEFINE_RATELIMIT...
#include "linux/sched.h"                             // for task_struct, con...
#include "linux/sizes.h"                             // for SZ_4G
#include "linux/smp.h"                               // for smp_processor_id
#include "linux/spinlock.h"                          // for spin_unlock_irqr...
#include "linux/spinlock_types.h"                    // for DEFINE_SPINLOCK
#include "linux/stdarg.h"                            // for va_end, va_start
#include "linux/sysinfo.h"                           // for sysinfo
#include "linux/thread_info.h"                       // for test_thread_flag
#include "linux/types.h"                             // for bool, gfp_t, lis...
#include "linux/vm_event_item.h"                     // for PGALLOC_NORMAL
#include "linux/wait.h"                              // for init_waitqueue_head
#include "linux/workqueue.h"                         // for work_struct, flu...
#include "linux/writeback.h"                         // for node_dirty_ok
#include "page_reporting.h"                          // for page_reporting_n...
#include "shuffle.h"                                 // for is_shuffle_order
#include "swap.h"                                    // for show_swap_cache_...
#include "vdso/bits.h"                               // for BIT
#include "vdso/limits.h"                             // for ULONG_MAX
struct capture_control;
struct vmem_altmap;
---
  ./scripts/check-local-export mm/page_alloc.o
  iwyu2 -Wp,-MMD,mm/.init-mm.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -Wno-override-init -Wno-initializer-overrides    -DKBUILD_MODFILE='"mm/init-mm"' -DKBUILD_BASENAME='"init_mm"' -DKBUILD_MODNAME='"init_mm"' -D__KBUILD_MODNAME=kmod_init_mm -c -o mm/init-mm.o mm/init-mm.c  

mm/init-mm.c should add these lines:
#include <asm/pgtable.h>           // for swapper_pg_dir
#include "linux/mm.h"              // for setup_initial_init_mm
#include "linux/mmap_lock.h"       // for MMAP_LOCK_INITIALIZER
#include "linux/mutex.h"           // for mutex
#include "linux/rbtree_types.h"    // for RB_ROOT
#include "linux/seqlock.h"         // for SEQCNT_ZERO
#include "linux/spinlock_types.h"  // for __SPIN_LOCK_UNLOCKED
#include "linux/types.h"           // for ATOMIC_INIT

mm/init-mm.c should remove these lines:
- #include <linux/atomic.h>  // lines 11-11
- #include <linux/mman.h>  // lines 8-8
- #include <linux/pgtable.h>  // lines 9-9
- #include <linux/rbtree.h>  // lines 3-3
- #include <linux/rwsem.h>  // lines 4-4
- #include <linux/spinlock.h>  // lines 5-5

The full include-list for mm/init-mm.c:
#include <asm/mmu.h>               // for INIT_MM_CONTEXT
#include <asm/pgtable.h>           // for swapper_pg_dir
#include <linux/cpumask.h>         // for CPU_BITS_NONE
#include <linux/list.h>            // for LIST_HEAD_INIT
#include <linux/mm_types.h>        // for mm_struct, mm_struct::(anonymous)
#include <linux/user_namespace.h>  // for init_user_ns
#include "linux/mm.h"              // for setup_initial_init_mm
#include "linux/mmap_lock.h"       // for MMAP_LOCK_INITIALIZER
#include "linux/mutex.h"           // for mutex
#include "linux/rbtree_types.h"    // for RB_ROOT
#include "linux/seqlock.h"         // for SEQCNT_ZERO
#include "linux/spinlock_types.h"  // for __SPIN_LOCK_UNLOCKED
#include "linux/types.h"           // for ATOMIC_INIT
---
  ./scripts/check-local-export mm/init-mm.o
  iwyu2 -Wp,-MMD,mm/.memblock.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/memblock"' -DKBUILD_BASENAME='"memblock"' -DKBUILD_MODNAME='"memblock"' -D__KBUILD_MODNAME=kmod_memblock -c -o mm/memblock.o mm/memblock.c  
In file included from mm/memblock.c:23:
In file included from mm/internal.h:13:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/memblock.c:23:
In file included from mm/internal.h:13:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/memblock.c:23:
In file included from mm/internal.h:13:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/memblock.c:23:
In file included from mm/internal.h:13:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/memblock.c:23:
In file included from mm/internal.h:13:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/memblock.c:23:
In file included from mm/internal.h:13:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/memblock.c:23:
In file included from mm/internal.h:13:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/memblock.c:23:
In file included from mm/internal.h:13:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/memblock.c should add these lines:
#include <asm/bug.h>                           // for BUG_ON, WARN_ON, WARN_...
#include <linux/mmzone.h>                      // for pageblock_nr_pages
#include <stddef.h>                            // for NULL, size_t
#include "asm-generic/errno-base.h"            // for ENOMEM
#include "asm-generic/int-ll64.h"              // for u64, u32
#include "asm-generic/memory_model.h"          // for pfn_to_page
#include "asm/io.h"                            // for phys_to_virt
#include "asm/page.h"                          // for __pa, __va
#include "asm/page_types.h"                    // for PAGE_SIZE, PAGE_MASK
#include "asm/string_32.h"                     // for memmove, strstr, memset
#include "generated/bounds.h"                  // for MAX_NR_ZONES
#include "linux/align.h"                       // for ALIGN
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_set
#include "linux/cache.h"                       // for SMP_CACHE_BYTES
#include "linux/compiler_types.h"              // for inline
#include "linux/export.h"                      // for EXPORT_SYMBOL
#include "linux/gfp.h"                         // for GFP_KERNEL, GFP_NOWAIT
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/limits.h"                      // for PHYS_ADDR_MAX
#include "linux/math.h"                        // for round_down, round_up
#include "linux/memory_hotplug.h"              // for movable_node_is_enabled
#include "linux/minmax.h"                      // for min, clamp, max, max_t
#include "linux/mm.h"                          // for reserve_bootmem_region
#include "linux/mm_types.h"                    // for page
#include "linux/mmzone.h"                      // for pg_data_t, zone, MAX_O...
#include "linux/numa.h"                        // for NUMA_NO_NODE, MAX_NUMN...
#include "linux/printk.h"                      // for pr_info, dump_stack
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for phys_addr_t, bool
#include "vdso/limits.h"                       // for ULLONG_MAX

mm/memblock.c should remove these lines:
- #include <asm/sections.h>  // lines 20-20
- #include <linux/debugfs.h>  // lines 15-15
- #include <linux/io.h>  // lines 21-21
- #include <linux/kernel.h>  // lines 9-9
- #include <linux/poison.h>  // lines 13-13
- #include <linux/seq_file.h>  // lines 17-17

The full include-list for mm/memblock.c:
#include <asm/bug.h>                           // for BUG_ON, WARN_ON, WARN_...
#include <linux/bitops.h>                      // for __ffs
#include <linux/init.h>                        // for __init, __refdata, __i...
#include <linux/kmemleak.h>                    // for kmemleak_free_part_phys
#include <linux/memblock.h>                    // for memblock_region, membl...
#include <linux/mmzone.h>                      // for pageblock_nr_pages
#include <linux/pfn.h>                         // for PFN_DOWN, PFN_UP, PFN_...
#include <linux/slab.h>                        // for kfree, slab_is_available
#include <stddef.h>                            // for NULL, size_t
#include "asm-generic/errno-base.h"            // for ENOMEM
#include "asm-generic/int-ll64.h"              // for u64, u32
#include "asm-generic/memory_model.h"          // for pfn_to_page
#include "asm/io.h"                            // for phys_to_virt
#include "asm/page.h"                          // for __pa, __va
#include "asm/page_types.h"                    // for PAGE_SIZE, PAGE_MASK
#include "asm/string_32.h"                     // for memmove, strstr, memset
#include "generated/bounds.h"                  // for MAX_NR_ZONES
#include "internal.h"                          // for memblock_free_pages
#include "linux/align.h"                       // for ALIGN
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_set
#include "linux/cache.h"                       // for SMP_CACHE_BYTES
#include "linux/compiler_types.h"              // for inline
#include "linux/export.h"                      // for EXPORT_SYMBOL
#include "linux/gfp.h"                         // for GFP_KERNEL, GFP_NOWAIT
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/limits.h"                      // for PHYS_ADDR_MAX
#include "linux/math.h"                        // for round_down, round_up
#include "linux/memory_hotplug.h"              // for movable_node_is_enabled
#include "linux/minmax.h"                      // for min, clamp, max, max_t
#include "linux/mm.h"                          // for reserve_bootmem_region
#include "linux/mm_types.h"                    // for page
#include "linux/mmzone.h"                      // for pg_data_t, zone, MAX_O...
#include "linux/numa.h"                        // for NUMA_NO_NODE, MAX_NUMN...
#include "linux/printk.h"                      // for pr_info, dump_stack
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for phys_addr_t, bool
#include "vdso/limits.h"                       // for ULLONG_MAX
---
  ./scripts/check-local-export mm/memblock.o
  iwyu2 -Wp,-MMD,mm/.dmapool.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/dmapool"' -DKBUILD_BASENAME='"dmapool"' -DKBUILD_MODNAME='"dmapool"' -D__KBUILD_MODNAME=kmod_dmapool -c -o mm/dmapool.o mm/dmapool.c  
In file included from mm/dmapool.c:22:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/dmapool.c:22:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/dmapool.c:22:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from mm/dmapool.c:22:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/dmapool.c:22:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/dmapool.c:22:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/dmapool.c should add these lines:
#include <asm/bug.h>               // for WARN_ON
#include <cstdio>                  // for size_t, NULL, ssize_t
#include "asm/page_types.h"        // for PAGE_SIZE
#include "asm/string_32.h"         // for memset
#include "linux/align.h"           // for ALIGN
#include "linux/compiler.h"        // for unlikely
#include "linux/compiler_types.h"  // for inline
#include "linux/dev_printk.h"      // for dev_err
#include "linux/gfp.h"             // for GFP_KERNEL, __GFP_ZERO
#include "linux/minmax.h"          // for max_t
#include "linux/mm.h"              // for want_init_on_alloc, want_init_on_free
#include "linux/printk.h"          // for pr_err
#include "linux/spinlock_types.h"  // for spinlock_t
#include "linux/stddef.h"          // for false, true

mm/dmapool.c should remove these lines:
- #include <linux/poison.h>  // lines 29-29
- #include <linux/sched.h>  // lines 30-30
- #include <linux/stat.h>  // lines 33-33
- #include <linux/wait.h>  // lines 37-37

The full include-list for mm/dmapool.c:
#include <asm/bug.h>               // for WARN_ON
#include <linux/device.h>          // for device, device_create_file, device...
#include <linux/dma-mapping.h>     // for dma_alloc_coherent, dma_free_coherent
#include <linux/export.h>          // for EXPORT_SYMBOL
#include <linux/kernel.h>          // for scnprintf
#include <linux/list.h>            // for list_del, INIT_LIST_HEAD, list_add
#include <linux/mutex.h>           // for mutex_unlock, mutex_lock, mutex
#include <linux/sched/mm.h>        // for might_alloc
#include <linux/slab.h>            // for kfree, kmalloc
#include <linux/spinlock.h>        // for spin_unlock_irqrestore, spin_lock_irq
#include <linux/string.h>          // for strscpy
#include <linux/types.h>           // for list_head, dma_addr_t, bool, gfp_t
#include <cstdio>                  // for size_t, NULL, ssize_t
#include "asm/page_types.h"        // for PAGE_SIZE
#include "asm/string_32.h"         // for memset
#include "linux/align.h"           // for ALIGN
#include "linux/compiler.h"        // for unlikely
#include "linux/compiler_types.h"  // for inline
#include "linux/dev_printk.h"      // for dev_err
#include "linux/gfp.h"             // for GFP_KERNEL, __GFP_ZERO
#include "linux/minmax.h"          // for max_t
#include "linux/mm.h"              // for want_init_on_alloc, want_init_on_free
#include "linux/printk.h"          // for pr_err
#include "linux/spinlock_types.h"  // for spinlock_t
#include "linux/stddef.h"          // for false, true
---
  ./scripts/check-local-export mm/dmapool.o
  iwyu2 -Wp,-MMD,mm/.slub.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/slub"' -DKBUILD_BASENAME='"slub"' -DKBUILD_MODNAME='"slub"' -D__KBUILD_MODNAME=kmod_slub -c -o mm/slub.o mm/slub.c  
In file included from mm/slub.c:14:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/slub.c:14:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/slub.c:14:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/slub.c:14:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/slub.c:40:
./include/kunit/test.h:509:24: warning: declaration of 'struct kunit_loc' will not be visible outside of this function [-Wvisibility]
                               const struct kunit_loc *loc,
                                            ^
./include/kunit/test.h:510:16: warning: declaration of 'enum kunit_assert_type' will not be visible outside of this function [-Wvisibility]
                               enum kunit_assert_type type,
                                    ^
./include/kunit/test.h:511:24: warning: declaration of 'struct kunit_assert' will not be visible outside of this function [-Wvisibility]
                               const struct kunit_assert *assert,
                                            ^
7 warnings generated.
In file included from mm/slub.c:14:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/slub.c:14:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/slub.c:14:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/slub.c:14:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from mm/slub.c:40:
./include/kunit/test.h:509:24: warning: declaration of 'struct kunit_loc' will not be visible outside of this function [-Wvisibility]
                               const struct kunit_loc *loc,
                                            ^
./include/kunit/test.h:510:16: warning: declaration of 'enum kunit_assert_type' will not be visible outside of this function [-Wvisibility]
                               enum kunit_assert_type type,
                                    ^
./include/kunit/test.h:511:24: warning: declaration of 'struct kunit_assert' will not be visible outside of this function [-Wvisibility]
                               const struct kunit_assert *assert,
                                            ^

mm/slub.c should add these lines:
#include <asm-generic/percpu.h>                // for put_cpu_ptr, this_cpu_ptr
#include <asm/bug.h>                           // for BUG_ON, WARN_ON, WARN_...
#include <asm/cpufeatures.h>                   // for REQUIRED_MASK0, REQUIR...
#include <asm/percpu.h>                        // for this_cpu_cmpxchg_double_1
#include <linux/local_lock.h>                  // for local_lock_t
#include <stddef.h>                            // for NULL, size_t
#include "asm-generic/errno-base.h"            // for EINVAL, ENOMEM
#include "asm-generic/errno.h"                 // for ENOSYS
#include "asm-generic/getorder.h"              // for get_order
#include "asm-generic/int-ll64.h"              // for u8
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "asm/cmpxchg_32.h"                    // for system_has_cmpxchg_double
#include "asm/current.h"                       // for current
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/percpu.h"                        // for this_cpu_cmpxchg_double_4
#include "asm/processor.h"                     // for prefetchw, cache_line_...
#include "asm/string_32.h"                     // for memset, memcpy
#include "asm/vdso/processor.h"                // for cpu_relax
#include "generated/autoconf.h"                // for CONFIG_HAVE_ALIGNED_ST...
#include "linux/align.h"                       // for ALIGN, ALIGN_DOWN
#include "linux/atomic/atomic-instrumented.h"  // for cmpxchg_double
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/compiler.h"                    // for unlikely, likely, barrier
#include "linux/compiler_attributes.h"         // for __always_inline, noinline
#include "linux/compiler_types.h"              // for inline, __force
#include "linux/container_of.h"                // for container_of
#include "linux/cpuhotplug.h"                  // for cpuhp_setup_state_nocalls
#include "linux/cpumask.h"                     // for for_each_online_cpu
#include "linux/debug_locks.h"                 // for debug_check_no_locks_f...
#include "linux/export.h"                      // for EXPORT_SYMBOL
#include "linux/gfp.h"                         // for __free_pages, GFP_KERNEL
#include "linux/init.h"                        // for __init, __setup, __ini...
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/irqflags.h"                    // for local_irq_restore, loc...
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/kcsan-checks.h"                // for __kcsan_check_access
#include "linux/kernel.h"                      // for get_option, no_hash_po...
#include "linux/kmemleak.h"                    // for kmemleak_alloc, kmemle...
#include "linux/list.h"                        // for INIT_LIST_HEAD, list_add
#include "linux/local_lock.h"                  // for local_unlock_irqrestore
#include "linux/lockdep.h"                     // for lockdep_assert_held
#include "linux/log2.h"                        // for ilog2
#include "linux/minmax.h"                      // for max, min, max_t, min_t
#include "linux/mm_types.h"                    // for page, folio, folio::(a...
#include "linux/mmdebug.h"                     // for VM_BUG_ON, VM_BUG_ON_PAGE
#include "linux/mmzone.h"                      // for MAX_ORDER, NR_SLAB_UNR...
#include "linux/mutex.h"                       // for mutex_lock, mutex_unlock
#include "linux/nodemask.h"                    // for node_isset, node_set
#include "linux/notifier.h"                    // for notifier_from_errno
#include "linux/numa.h"                        // for NUMA_NO_NODE
#include "linux/percpu.h"                      // for __alloc_percpu, free_p...
#include "linux/poison.h"                      // for SLUB_RED_INACTIVE
#include "linux/printk.h"                      // for pr_err, pr_info, pr_wa...
#include "linux/rcupdate.h"                    // for call_rcu
#include "linux/reciprocal_div.h"              // for reciprocal_value
#include "linux/sched.h"                       // for task_struct
#include "linux/slub_def.h"                    // for kmem_cache, kmem_cache...
#include "linux/smp.h"                         // for smp_processor_id
#include "linux/spinlock.h"                    // for spin_unlock_irqrestore
#include "linux/stddef.h"                      // for false, true, offsetof
#include "linux/topology.h"                    // for numa_mem_id
#include "linux/types.h"                       // for list_head, gfp_t, bool
#include "linux/uaccess.h"                     // for copy_from_kernel_nofault
#include "linux/vmstat.h"                      // for mod_lruvec_page_state
#include "linux/workqueue.h"                   // for work_struct, flush_work
struct list_lru;

mm/slub.c should remove these lines:
- #include <kunit/test.h>  // lines 40-40
- #include <linux/cpuset.h>  // lines 26-26
- #include <linux/ctype.h>  // lines 28-28
- #include <linux/debugfs.h>  // lines 43-43
- #include <linux/fault-inject.h>  // lines 35-35
- #include <linux/interrupt.h>  // lines 17-17
- #include <linux/kallsyms.h>  // lines 31-31
- #include <linux/math64.h>  // lines 34-34
- #include <linux/memcontrol.h>  // lines 38-38
- #include <linux/mempolicy.h>  // lines 27-27
- #include <linux/module.h>  // lines 15-15
- #include <linux/proc_fs.h>  // lines 22-22
- #include <linux/random.h>  // lines 39-39
- #include <linux/seq_file.h>  // lines 23-23
- #include <linux/sort.h>  // lines 41-41
- #include <linux/stackdepot.h>  // lines 29-29
- #include <linux/stacktrace.h>  // lines 36-36
- #include <linux/swab.h>  // lines 18-18

The full include-list for mm/slub.c:
#include <asm-generic/percpu.h>                // for put_cpu_ptr, this_cpu_ptr
#include <asm/bug.h>                           // for BUG_ON, WARN_ON, WARN_...
#include <asm/cpufeatures.h>                   // for REQUIRED_MASK0, REQUIR...
#include <asm/percpu.h>                        // for this_cpu_cmpxchg_double_1
#include <linux/bit_spinlock.h>                // for __bit_spin_unlock, bit...
#include <linux/bitops.h>                      // for fls
#include <linux/cpu.h>                         // for cpus_read_lock, cpus_r...
#include <linux/debugobjects.h>                // for debug_check_no_obj_freed
#include <linux/kasan.h>                       // for kasan_reset_tag, kasan...
#include <linux/kfence.h>                      // for is_kfence_address, kfe...
#include <linux/local_lock.h>                  // for local_lock_t
#include <linux/memory.h>                      // for memory_notify, MEM_CAN...
#include <linux/mm.h>                          // for folio_test_slab, virt_...
#include <linux/slab.h>                        // for SLAB_STORE_USER, SLAB_...
#include <linux/swap.h>                        // for reclaim_state
#include <stddef.h>                            // for NULL, size_t
#include <trace/events/kmem.h>                 // for trace_kmalloc, trace_k...
#include "asm-generic/errno-base.h"            // for EINVAL, ENOMEM
#include "asm-generic/errno.h"                 // for ENOSYS
#include "asm-generic/getorder.h"              // for get_order
#include "asm-generic/int-ll64.h"              // for u8
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "asm/cmpxchg_32.h"                    // for system_has_cmpxchg_double
#include "asm/current.h"                       // for current
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/percpu.h"                        // for this_cpu_cmpxchg_double_4
#include "asm/processor.h"                     // for prefetchw, cache_line_...
#include "asm/string_32.h"                     // for memset, memcpy
#include "asm/vdso/processor.h"                // for cpu_relax
#include "generated/autoconf.h"                // for CONFIG_HAVE_ALIGNED_ST...
#include "internal.h"                          // for GFP_CONSTRAINT_MASK
#include "linux/align.h"                       // for ALIGN, ALIGN_DOWN
#include "linux/atomic/atomic-instrumented.h"  // for cmpxchg_double
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/compiler.h"                    // for unlikely, likely, barrier
#include "linux/compiler_attributes.h"         // for __always_inline, noinline
#include "linux/compiler_types.h"              // for inline, __force
#include "linux/container_of.h"                // for container_of
#include "linux/cpuhotplug.h"                  // for cpuhp_setup_state_nocalls
#include "linux/cpumask.h"                     // for for_each_online_cpu
#include "linux/debug_locks.h"                 // for debug_check_no_locks_f...
#include "linux/export.h"                      // for EXPORT_SYMBOL
#include "linux/gfp.h"                         // for __free_pages, GFP_KERNEL
#include "linux/init.h"                        // for __init, __setup, __ini...
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/irqflags.h"                    // for local_irq_restore, loc...
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/kcsan-checks.h"                // for __kcsan_check_access
#include "linux/kernel.h"                      // for get_option, no_hash_po...
#include "linux/kmemleak.h"                    // for kmemleak_alloc, kmemle...
#include "linux/list.h"                        // for INIT_LIST_HEAD, list_add
#include "linux/local_lock.h"                  // for local_unlock_irqrestore
#include "linux/lockdep.h"                     // for lockdep_assert_held
#include "linux/log2.h"                        // for ilog2
#include "linux/minmax.h"                      // for max, min, max_t, min_t
#include "linux/mm_types.h"                    // for page, folio, folio::(a...
#include "linux/mmdebug.h"                     // for VM_BUG_ON, VM_BUG_ON_PAGE
#include "linux/mmzone.h"                      // for MAX_ORDER, NR_SLAB_UNR...
#include "linux/mutex.h"                       // for mutex_lock, mutex_unlock
#include "linux/nodemask.h"                    // for node_isset, node_set
#include "linux/notifier.h"                    // for notifier_from_errno
#include "linux/numa.h"                        // for NUMA_NO_NODE
#include "linux/percpu.h"                      // for __alloc_percpu, free_p...
#include "linux/poison.h"                      // for SLUB_RED_INACTIVE
#include "linux/printk.h"                      // for pr_err, pr_info, pr_wa...
#include "linux/rcupdate.h"                    // for call_rcu
#include "linux/reciprocal_div.h"              // for reciprocal_value
#include "linux/sched.h"                       // for task_struct
#include "linux/slub_def.h"                    // for kmem_cache, kmem_cache...
#include "linux/smp.h"                         // for smp_processor_id
#include "linux/spinlock.h"                    // for spin_unlock_irqrestore
#include "linux/stddef.h"                      // for false, true, offsetof
#include "linux/topology.h"                    // for numa_mem_id
#include "linux/types.h"                       // for list_head, gfp_t, bool
#include "linux/uaccess.h"                     // for copy_from_kernel_nofault
#include "linux/vmstat.h"                      // for mod_lruvec_page_state
#include "linux/workqueue.h"                   // for work_struct, flush_work
#include "slab.h"                              // for slab, slab::(anonymous)
struct list_lru;
---
  ./scripts/check-local-export mm/slub.o
  iwyu2 -Wp,-MMD,mm/.early_ioremap.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"mm/early_ioremap"' -DKBUILD_BASENAME='"early_ioremap"' -DKBUILD_MODNAME='"early_ioremap"' -D__KBUILD_MODNAME=kmod_early_ioremap -c -o mm/early_ioremap.o mm/early_ioremap.c  
In file included from mm/early_ioremap.c:20:
In file included from mm/internal.h:13:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/early_ioremap.c:20:
In file included from mm/internal.h:13:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/early_ioremap.c:20:
In file included from mm/internal.h:13:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/early_ioremap.c:20:
In file included from mm/internal.h:13:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from mm/early_ioremap.c:20:
In file included from mm/internal.h:13:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from mm/early_ioremap.c:20:
In file included from mm/internal.h:13:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from mm/early_ioremap.c:20:
In file included from mm/internal.h:13:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from mm/early_ioremap.c:20:
In file included from mm/internal.h:13:
In file included from ./include/linux/rmap.h:12:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

mm/early_ioremap.c should add these lines:
#include <asm/bug.h>                    // for WARN, WARN_ON
#include <stddef.h>                     // for NULL
#include "asm-generic/early_ioremap.h"  // for copy_from_early_mem, early_io...
#include "asm/page_types.h"             // for PAGE_SHIFT, PAGE_MASK, PAGE_SIZE
#include "asm/pgtable_types.h"          // for pgprot_t
#include "asm/string_32.h"              // for memcpy
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/compiler_types.h"       // for __iomem, __force
#include "linux/kern_levels.h"          // for KERN_WARNING
#include "linux/types.h"                // for resource_size_t, phys_addr_t

mm/early_ioremap.c should remove these lines:
- #include <asm/early_ioremap.h>  // lines 19-19
- #include <linux/io.h>  // lines 13-13
- #include <linux/module.h>  // lines 14-14
- #include <linux/slab.h>  // lines 15-15
- #include <linux/vmalloc.h>  // lines 17-17

The full include-list for mm/early_ioremap.c:
#include <asm/bug.h>                    // for WARN, WARN_ON
#include <asm/fixmap.h>                 // for FIX_BTMAPS_SLOTS, NR_FIX_BTMAPS
#include <linux/init.h>                 // for __init, __initdata, early_param
#include <linux/kernel.h>               // for SYSTEM_RUNNING, system_state
#include <linux/mm.h>                   // for offset_in_page, PAGE_ALIGN
#include <stddef.h>                     // for NULL
#include "asm-generic/early_ioremap.h"  // for copy_from_early_mem, early_io...
#include "asm/page_types.h"             // for PAGE_SHIFT, PAGE_MASK, PAGE_SIZE
#include "asm/pgtable_types.h"          // for pgprot_t
#include "asm/string_32.h"              // for memcpy
#include "internal.h"                   // for early_memremap_pgprot_adjust
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/compiler_types.h"       // for __iomem, __force
#include "linux/kern_levels.h"          // for KERN_WARNING
#include "linux/types.h"                // for resource_size_t, phys_addr_t
---
  ./scripts/check-local-export mm/early_ioremap.o
  rm -f mm/built-in.a; echo filemap.o mempool.o oom_kill.o fadvise.o maccess.o page-writeback.o folio-compat.o readahead.o swap.o truncate.o vmscan.o shmem.o util.o mmzone.o vmstat.o backing-dev.o mm_init.o percpu.o slab_common.o compaction.o vmacache.o interval_tree.o list_lru.o workingset.o debug.o gup.o mmap_lock.o highmem.o memory.o mincore.o mlock.o mmap.o mmu_gather.o mprotect.o mremap.o msync.o page_vma_mapped.o pagewalk.o pgtable-generic.o rmap.o vmalloc.o page_alloc.o init-mm.o memblock.o dmapool.o slub.o early_ioremap.o | sed -E 's:([^ ]+):mm/:g' | xargs llvm-ar cDPrST mm/built-in.a
make -f ./scripts/Makefile.build obj=fs \
single-build= \
need-builtin=1 need-modorder=1
make -f ./scripts/Makefile.build obj=fs/ramfs \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,fs/ramfs/.inode.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/ramfs/ramfs"' -DKBUILD_BASENAME='"inode"' -DKBUILD_MODNAME='"ramfs"' -D__KBUILD_MODNAME=kmod_ramfs -c -o fs/ramfs/inode.o fs/ramfs/inode.c  
In file included from fs/ramfs/inode.c:32:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/ramfs/inode.c:32:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/ramfs/inode.c:32:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from fs/ramfs/inode.c:32:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/ramfs/inode.c:32:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/ramfs/inode.c:32:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

fs/ramfs/inode.c should add these lines:
#include <stddef.h>                  // for NULL
#include <sys/types.h>               // for dev_t
#include "asm-generic/errno-base.h"  // for ENOSPC, ENOMEM
#include "asm/page_types.h"          // for PAGE_SHIFT, PAGE_SIZE
#include "asm/string_32.h"           // for strlen
#include "linux/dcache.h"            // for d_instantiate, dget, d_make_root
#include "linux/errno.h"             // for ENOPARAM
#include "linux/gfp.h"               // for GFP_HIGHUSER, GFP_KERNEL
#include "linux/projid.h"            // for init_user_ns
#include "linux/stat.h"              // for S_IFDIR, S_IFLNK, S_IFREG, S_IAL...
#include "linux/types.h"             // for umode_t, bool
struct user_namespace;

fs/ramfs/inode.c should remove these lines:
- #include <linux/backing-dev.h>  // lines 32-32
- #include <linux/highmem.h>  // lines 28-28
- #include <linux/parser.h>  // lines 35-35
- #include <linux/sched.h>  // lines 34-34
- #include <linux/string.h>  // lines 31-31
- #include <linux/time.h>  // lines 29-29
- #include <linux/uaccess.h>  // lines 38-38

The full include-list for fs/ramfs/inode.c:
#include <linux/fs.h>                // for inode, super_block, current_time
#include <linux/fs_context.h>        // for fs_context, get_tree_nodev, vfs_...
#include <linux/fs_parser.h>         // for fs_parse, fs_parse_result, fs_pa...
#include <linux/init.h>              // for __init, fs_initcall
#include <linux/magic.h>             // for RAMFS_MAGIC
#include <linux/pagemap.h>           // for mapping_set_gfp_mask, mapping_se...
#include <linux/ramfs.h>             // for ramfs_file_operations, ramfs_get...
#include <linux/seq_file.h>          // for seq_printf
#include <linux/slab.h>              // for kfree, kzalloc
#include <stddef.h>                  // for NULL
#include <sys/types.h>               // for dev_t
#include "asm-generic/errno-base.h"  // for ENOSPC, ENOMEM
#include "asm/page_types.h"          // for PAGE_SHIFT, PAGE_SIZE
#include "asm/string_32.h"           // for strlen
#include "internal.h"                // for ramfs_file_inode_operations
#include "linux/dcache.h"            // for d_instantiate, dget, d_make_root
#include "linux/errno.h"             // for ENOPARAM
#include "linux/gfp.h"               // for GFP_HIGHUSER, GFP_KERNEL
#include "linux/projid.h"            // for init_user_ns
#include "linux/stat.h"              // for S_IFDIR, S_IFLNK, S_IFREG, S_IAL...
#include "linux/types.h"             // for umode_t, bool
struct user_namespace;
---
  ./scripts/check-local-export fs/ramfs/inode.o
  iwyu2 -Wp,-MMD,fs/ramfs/.file-mmu.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/ramfs/ramfs"' -DKBUILD_BASENAME='"file_mmu"' -DKBUILD_MODNAME='"ramfs"' -D__KBUILD_MODNAME=kmod_ramfs -c -o fs/ramfs/file-mmu.o fs/ramfs/file-mmu.c  

fs/ramfs/file-mmu.c should add these lines:
#include "asm/current.h"     // for current
#include "linux/mm_types.h"  // for mm_struct, mm_struct::(anonymous)

fs/ramfs/file-mmu.c should remove these lines:
- #include <linux/mm.h>  // lines 28-28
- #include <linux/ramfs.h>  // lines 29-29
- #include "internal.h"  // lines 32-32

The full include-list for fs/ramfs/file-mmu.c:
#include <linux/fs.h>        // for generic_file_llseek, generic_file_mmap
#include <linux/sched.h>     // for task_struct
#include "asm/current.h"     // for current
#include "linux/mm_types.h"  // for mm_struct, mm_struct::(anonymous)
---
  ./scripts/check-local-export fs/ramfs/file-mmu.o
  rm -f fs/ramfs/built-in.a; echo inode.o file-mmu.o | sed -E 's:([^ ]+):fs/ramfs/:g' | xargs llvm-ar cDPrST fs/ramfs/built-in.a
  iwyu2 -Wp,-MMD,fs/.open.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/open"' -DKBUILD_BASENAME='"open"' -DKBUILD_MODNAME='"open"' -D__KBUILD_MODNAME=kmod_open -c -o fs/open.o fs/open.c  
In file included from fs/open.c:12:
In file included from ./include/linux/fsnotify.h:16:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^
In file included from fs/open.c:14:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/open.c:14:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/open.c:14:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/open.c:27:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
5 warnings generated.
In file included from fs/open.c:12:
In file included from ./include/linux/fsnotify.h:16:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^
In file included from fs/open.c:14:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/open.c:14:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/open.c:14:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/open.c:27:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/open.c should add these lines:
#include <asm/barrier.h>              // for smp_mb
#include <asm/bug.h>                  // for BUG_ON, WARN_ON, WARN_ON_ONCE
#include <stddef.h>                   // for NULL
#include <sys/types.h>                // for gid_t, uid_t, size_t
#include "asm-generic/bitsperlong.h"  // for BITS_PER_LONG
#include "asm-generic/errno-base.h"   // for EINVAL, EBADF, EPERM, EISDIR
#include "asm-generic/errno.h"        // for EOPNOTSUPP, EOVERFLOW
#include "asm-generic/fcntl.h"        // for O_PATH, O_CREAT, O_LARGEFILE
#include "asm-generic/int-ll64.h"     // for u64
#include "asm/current.h"              // for current
#include "asm/ptrace.h"               // for pt_regs
#include "linux/build_bug.h"          // for BUILD_BUG_ON, BUILD_BUG_ON_MSG
#include "linux/capability.h"         // for CAP_SYS_CHROOT, CAP_SYS_TTY_CONFIG
#include "linux/compiler.h"           // for unlikely, likely
#include "linux/compiler_types.h"     // for __user, inline
#include "linux/cred.h"               // for cred, current_user_ns, validate...
#include "linux/dcache.h"             // for d_backing_inode, dentry, d_can_...
#include "linux/err.h"                // for IS_ERR, ERR_PTR, PTR_ERR, ERR_CAST
#include "linux/errno.h"              // for ERESTARTNOHAND, ERESTARTNOINTR
#include "linux/export.h"             // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/falloc.h"             // for FALLOC_FL_KEEP_SIZE, FALLOC_FL_...
#include "linux/fcntl.h"              // for AT_FDCWD, AT_SYMLINK_NOFOLLOW
#include "linux/kconfig.h"            // for __ARG_PLACEHOLDER_1
#include "linux/kern_levels.h"        // for KERN_ERR
#include "linux/kernel.h"             // for upper_32_bits
#include "linux/openat2.h"            // for open_how, RESOLVE_BENEATH, RESO...
#include "linux/path.h"               // for path, path_put, path_get
#include "linux/printk.h"             // for printk
#include "linux/sched.h"              // for task_struct
#include "linux/securebits.h"         // for SECURE_NO_SETUID_FIXUP
#include "linux/stat.h"               // for S_ISREG, S_IALLUGO, S_ISDIR
#include "linux/stddef.h"             // for true
#include "linux/types.h"              // for umode_t, loff_t
#include "linux/uidgid.h"             // for make_kuid, gid_valid, make_kgid
struct user_namespace;

fs/open.c should remove these lines:
- #include <linux/backing-dev.h>  // lines 16-16
- #include <linux/compat.h>  // lines 34-34
- #include <linux/ima.h>  // lines 32-32
- #include <linux/module.h>  // lines 13-13
- #include <linux/personality.h>  // lines 25-25
- #include <linux/rcupdate.h>  // lines 28-28
- #include <linux/slab.h>  // lines 22-22
- #include <linux/string.h>  // lines 8-8

The full include-list for fs/open.c:
#include <asm/barrier.h>              // for smp_mb
#include <asm/bug.h>                  // for BUG_ON, WARN_ON, WARN_ON_ONCE
#include <linux/audit.h>              // for audit_file, audit_openat2_how
#include <linux/capability.h>         // for capable, ns_capable, cap_clear
#include <linux/dnotify.h>            // for dnotify_flush
#include <linux/falloc.h>             // for FALLOC_FL_SUPPORTED_MASK
#include <linux/fcntl.h>              // for force_o_largefile, VALID_OPEN_F...
#include <linux/fdtable.h>            // for __close_range, close_fd
#include <linux/file.h>               // for fd, fdput, fdget, fput, fd_install
#include <linux/fs.h>                 // for file, inode, iattr, file_operat...
#include <linux/fs_struct.h>          // for set_fs_pwd, set_fs_root
#include <linux/fsnotify.h>           // for fsnotify_modify, fsnotify_open
#include <linux/mm.h>                 // for truncate_inode_pages, unmap_map...
#include <linux/mnt_idmapping.h>      // for mapped_kgid_user, mapped_kuid_user
#include <linux/mount.h>              // for mnt_user_ns, mnt_drop_write
#include <linux/namei.h>              // for retry_estale, user_path_at, LOO...
#include <linux/pagemap.h>            // for file_sample_sb_err, filemap_nr_...
#include <linux/securebits.h>         // for issecure
#include <linux/security.h>           // for security_path_truncate, securit...
#include <linux/syscalls.h>           // for __MAP2, __MAP3, __MAP1, __MAP4
#include <linux/tty.h>                // for tty_vhangup_self
#include <linux/uaccess.h>            // for copy_struct_from_user
#include <stddef.h>                   // for NULL
#include <sys/types.h>                // for gid_t, uid_t, size_t
#include "asm-generic/bitsperlong.h"  // for BITS_PER_LONG
#include "asm-generic/errno-base.h"   // for EINVAL, EBADF, EPERM, EISDIR
#include "asm-generic/errno.h"        // for EOPNOTSUPP, EOVERFLOW
#include "asm-generic/fcntl.h"        // for O_PATH, O_CREAT, O_LARGEFILE
#include "asm-generic/int-ll64.h"     // for u64
#include "asm/current.h"              // for current
#include "asm/ptrace.h"               // for pt_regs
#include "internal.h"                 // for open_flags, alloc_empty_file
#include "linux/build_bug.h"          // for BUILD_BUG_ON, BUILD_BUG_ON_MSG
#include "linux/capability.h"         // for CAP_SYS_CHROOT, CAP_SYS_TTY_CONFIG
#include "linux/compiler.h"           // for unlikely, likely
#include "linux/compiler_types.h"     // for __user, inline
#include "linux/cred.h"               // for cred, current_user_ns, validate...
#include "linux/dcache.h"             // for d_backing_inode, dentry, d_can_...
#include "linux/err.h"                // for IS_ERR, ERR_PTR, PTR_ERR, ERR_CAST
#include "linux/errno.h"              // for ERESTARTNOHAND, ERESTARTNOINTR
#include "linux/export.h"             // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/falloc.h"             // for FALLOC_FL_KEEP_SIZE, FALLOC_FL_...
#include "linux/fcntl.h"              // for AT_FDCWD, AT_SYMLINK_NOFOLLOW
#include "linux/kconfig.h"            // for __ARG_PLACEHOLDER_1
#include "linux/kern_levels.h"        // for KERN_ERR
#include "linux/kernel.h"             // for upper_32_bits
#include "linux/openat2.h"            // for open_how, RESOLVE_BENEATH, RESO...
#include "linux/path.h"               // for path, path_put, path_get
#include "linux/printk.h"             // for printk
#include "linux/sched.h"              // for task_struct
#include "linux/securebits.h"         // for SECURE_NO_SETUID_FIXUP
#include "linux/stat.h"               // for S_ISREG, S_IALLUGO, S_ISDIR
#include "linux/stddef.h"             // for true
#include "linux/types.h"              // for umode_t, loff_t
#include "linux/uidgid.h"             // for make_kuid, gid_valid, make_kgid
struct user_namespace;
---
  ./scripts/check-local-export fs/open.o
  iwyu2 -Wp,-MMD,fs/.read_write.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/read_write"' -DKBUILD_BASENAME='"read_write"' -DKBUILD_MODNAME='"read_write"' -D__KBUILD_MODNAME=kmod_read_write -c -o fs/read_write.o fs/read_write.c  
In file included from fs/read_write.c:14:
In file included from ./include/linux/fsnotify.h:16:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^
In file included from fs/read_write.c:17:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/read_write.c:17:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/read_write.c:17:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/read_write.c:17:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
5 warnings generated.
In file included from fs/read_write.c:14:
In file included from ./include/linux/fsnotify.h:16:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^
In file included from fs/read_write.c:17:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/read_write.c:17:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/read_write.c:17:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/read_write.c:17:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/read_write.c should add these lines:
#include <asm/bug.h>                  // for BUG_ON, WARN_ON_ONCE
#include <asm/signal.h>               // for SIGXFSZ
#include <linux/build_bug.h>          // for unlikely
#include <stdint.h>                   // for uint64_t
#include <cstdio>                     // for size_t, ssize_t, off_t, NULL
#include "asm-generic/bitsperlong.h"  // for BITS_PER_LONG
#include "asm-generic/errno-base.h"   // for EINVAL, EBADF, EFAULT, ESPIPE
#include "asm-generic/errno.h"        // for EOVERFLOW, EOPNOTSUPP
#include "asm-generic/fcntl.h"        // for O_APPEND, O_LARGEFILE
#include "asm-generic/resource.h"     // for RLIMIT_FSIZE, RLIM_INFINITY
#include "asm/current.h"              // for current
#include "asm/ptrace.h"               // for pt_regs
#include "asm/uaccess.h"              // for access_ok, put_user, get_user
#include "linux/compiler_types.h"     // for __user, inline
#include "linux/errno.h"              // for EIOCBQUEUED
#include "linux/fs.h"                 // for file (ptr only), SEEK_CUR, kioc...
#include "linux/kernel.h"             // for READ, WRITE, ARRAY_SIZE
#include "linux/minmax.h"             // for min, min_t
#include "linux/pipe_fs_i.h"          // for get_pipe_info
#include "linux/printk.h"             // for pr_warn_ratelimited
#include "linux/sched.h"              // for task_struct
#include "linux/sched/signal.h"       // for rlimit, send_sig
#include "linux/spinlock.h"           // for spin_lock, spin_unlock
#include "linux/stat.h"               // for S_ISDIR, S_ISREG
#include "linux/stddef.h"             // for true
#include "linux/types.h"              // for loff_t, bool
#include "linux/uio.h"                // for iovec, iov_iter (ptr only), UIO...

fs/read_write.c should remove these lines:
- #include <asm/unistd.h>  // lines 26-26
- #include <linux/compat.h>  // lines 20-20
- #include <linux/fcntl.h>  // lines 11-11
- #include <linux/mount.h>  // lines 21-21
- #include <linux/pagemap.h>  // lines 18-18
- #include <linux/splice.h>  // lines 19-19
- #include <linux/stat.h>  // lines 9-9

The full include-list for fs/read_write.c:
#include <asm/bug.h>                  // for BUG_ON, WARN_ON_ONCE
#include <asm/signal.h>               // for SIGXFSZ
#include <linux/build_bug.h>          // for unlikely
#include <linux/export.h>             // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/file.h>               // for fd, fdget, fdput, fdget_pos
#include <linux/fs.h>                 // for file, file_inode, file_operations
#include <linux/fsnotify.h>           // for fsnotify_access, fsnotify_modify
#include <linux/sched/xacct.h>        // for add_rchar, add_wchar, inc_syscr
#include <linux/security.h>           // for security_file_permission
#include <linux/slab.h>               // for kfree
#include <linux/syscalls.h>           // for __MAP3, __MAP4, __MAP5, __MAP6
#include <linux/uaccess.h>            // for copy_from_user, copy_to_user
#include <linux/uio.h>                // for iov_iter_count, import_iovec
#include <stdint.h>                   // for uint64_t
#include <cstdio>                     // for size_t, ssize_t, off_t, NULL
#include "asm-generic/bitsperlong.h"  // for BITS_PER_LONG
#include "asm-generic/errno-base.h"   // for EINVAL, EBADF, EFAULT, ESPIPE
#include "asm-generic/errno.h"        // for EOVERFLOW, EOPNOTSUPP
#include "asm-generic/fcntl.h"        // for O_APPEND, O_LARGEFILE
#include "asm-generic/resource.h"     // for RLIMIT_FSIZE, RLIM_INFINITY
#include "asm/current.h"              // for current
#include "asm/ptrace.h"               // for pt_regs
#include "asm/uaccess.h"              // for access_ok, put_user, get_user
#include "internal.h"                 // for splice_file_to_pipe
#include "linux/compiler_types.h"     // for __user, inline
#include "linux/errno.h"              // for EIOCBQUEUED
#include "linux/fs.h"                 // for file (ptr only), SEEK_CUR, kioc...
#include "linux/kernel.h"             // for READ, WRITE, ARRAY_SIZE
#include "linux/minmax.h"             // for min, min_t
#include "linux/pipe_fs_i.h"          // for get_pipe_info
#include "linux/printk.h"             // for pr_warn_ratelimited
#include "linux/sched.h"              // for task_struct
#include "linux/sched/signal.h"       // for rlimit, send_sig
#include "linux/spinlock.h"           // for spin_lock, spin_unlock
#include "linux/stat.h"               // for S_ISDIR, S_ISREG
#include "linux/stddef.h"             // for true
#include "linux/types.h"              // for loff_t, bool
#include "linux/uio.h"                // for iovec, iov_iter (ptr only), UIO...
---
  ./scripts/check-local-export fs/read_write.o
  iwyu2 -Wp,-MMD,fs/.file_table.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/file_table"' -DKBUILD_BASENAME='"file_table"' -DKBUILD_MODNAME='"file_table"' -D__KBUILD_MODNAME=kmod_file_table -c -o fs/file_table.o fs/file_table.c  
In file included from fs/file_table.c:22:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/file_table.c:22:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/file_table.c:22:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/file_table.c:29:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from fs/file_table.c:22:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/file_table.c:22:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/file_table.c:22:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/file_table.c:29:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/file_table.c should add these lines:
#include <asm/bug.h>                           // for BUG_ON
#include <linux/spinlock.h>                    // for rwlock_init
#include <stddef.h>                            // for NULL
#include "asm-generic/errno-base.h"            // for ENOMEM, ENFILE
#include "asm-generic/fcntl.h"                 // for FASYNC
#include "asm/cache.h"                         // for __read_mostly
#include "asm/current.h"                       // for current
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/string_32.h"                     // for strlen
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_dec_and_test
#include "linux/cache.h"                       // for __cacheline_aligned_in...
#include "linux/capability.h"                  // for CAP_SYS_ADMIN
#include "linux/compiler.h"                    // for unlikely, likely
#include "linux/compiler_types.h"              // for inline
#include "linux/container_of.h"                // for container_of
#include "linux/dcache.h"                      // for d_instantiate, d_set_d_op
#include "linux/err.h"                         // for IS_ERR, ERR_PTR
#include "linux/export.h"                      // for EXPORT_SYMBOL, EXPORT_...
#include "linux/fs.h"                          // for file (ptr only), files...
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/kernel.h"                      // for might_sleep
#include "linux/llist.h"                       // for llist_add, llist_del_all
#include "linux/minmax.h"                      // for max_t, min
#include "linux/mm.h"                          // for totalram_pages
#include "linux/mutex.h"                       // for mutex_init
#include "linux/pagemap.h"                     // for file_sample_sb_err
#include "linux/path.h"                        // for path, path_get, path_put
#include "linux/pid.h"                         // for put_pid
#include "linux/preempt.h"                     // for in_interrupt
#include "linux/printk.h"                      // for pr_info
#include "linux/sched.h"                       // for task_struct, PF_KTHREAD
#include "linux/spinlock.h"                    // for spin_lock_init
#include "linux/stat.h"                        // for S_ISCHR
#include "linux/types.h"                       // for callback_head (ptr only)
#include "linux/workqueue.h"                   // for work_struct, schedule_...

fs/file_table.c should remove these lines:
- #include <linux/atomic.h>  // lines 32-32
- #include <linux/fdtable.h>  // lines 12-12
- #include <linux/kmemleak.h>  // lines 30-30
- #include <linux/module.h>  // lines 14-14
- #include <linux/percpu.h>  // lines 26-26
- #include <linux/string.h>  // lines 9-9
- #include <linux/sysctl.h>  // lines 24-24

The full include-list for fs/file_table.c:
#include <asm/bug.h>                           // for BUG_ON
#include <linux/capability.h>                  // for capable
#include <linux/cdev.h>                        // for cdev_put
#include <linux/cred.h>                        // for get_cred, put_cred
#include <linux/eventpoll.h>                   // for eventpoll_release
#include <linux/file.h>                        // for __fput_sync, alloc_fil...
#include <linux/fs.h>                          // for file, file::(anonymous)
#include <linux/fsnotify.h>                    // for fsnotify_close
#include <linux/ima.h>                         // for ima_file_free
#include <linux/init.h>                        // for __init
#include <linux/mount.h>                       // for __mnt_drop_write, mntget
#include <linux/percpu_counter.h>              // for percpu_counter_dec
#include <linux/rcupdate.h>                    // for call_rcu
#include <linux/security.h>                    // for security_file_alloc
#include <linux/slab.h>                        // for kmem_cache_create, kme...
#include <linux/spinlock.h>                    // for rwlock_init
#include <linux/swap.h>                        // for nr_free_pages
#include <linux/task_work.h>                   // for init_task_work, task_w...
#include <stddef.h>                            // for NULL
#include "asm-generic/errno-base.h"            // for ENOMEM, ENFILE
#include "asm-generic/fcntl.h"                 // for FASYNC
#include "asm/cache.h"                         // for __read_mostly
#include "asm/current.h"                       // for current
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/string_32.h"                     // for strlen
#include "internal.h"                          // for simple_dname, d_alloc_...
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_dec_and_test
#include "linux/cache.h"                       // for __cacheline_aligned_in...
#include "linux/capability.h"                  // for CAP_SYS_ADMIN
#include "linux/compiler.h"                    // for unlikely, likely
#include "linux/compiler_types.h"              // for inline
#include "linux/container_of.h"                // for container_of
#include "linux/dcache.h"                      // for d_instantiate, d_set_d_op
#include "linux/err.h"                         // for IS_ERR, ERR_PTR
#include "linux/export.h"                      // for EXPORT_SYMBOL, EXPORT_...
#include "linux/fs.h"                          // for file (ptr only), files...
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/kernel.h"                      // for might_sleep
#include "linux/llist.h"                       // for llist_add, llist_del_all
#include "linux/minmax.h"                      // for max_t, min
#include "linux/mm.h"                          // for totalram_pages
#include "linux/mutex.h"                       // for mutex_init
#include "linux/pagemap.h"                     // for file_sample_sb_err
#include "linux/path.h"                        // for path, path_get, path_put
#include "linux/pid.h"                         // for put_pid
#include "linux/preempt.h"                     // for in_interrupt
#include "linux/printk.h"                      // for pr_info
#include "linux/sched.h"                       // for task_struct, PF_KTHREAD
#include "linux/spinlock.h"                    // for spin_lock_init
#include "linux/stat.h"                        // for S_ISCHR
#include "linux/types.h"                       // for callback_head (ptr only)
#include "linux/workqueue.h"                   // for work_struct, schedule_...
---
  ./scripts/check-local-export fs/file_table.o
  iwyu2 -Wp,-MMD,fs/.super.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/super"' -DKBUILD_BASENAME='"super"' -DKBUILD_MODNAME='"super"' -D__KBUILD_MODNAME=kmod_super -c -o fs/super.o fs/super.c  
In file included from fs/super.c:26:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/super.c:26:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/super.c:26:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/super.c:26:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
4 warnings generated.
In file included from fs/super.c:26:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/super.c:26:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/super.c:26:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/super.c:26:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^

fs/super.c should add these lines:
#include <asm/barrier.h>                       // for smp_wmb, smp_rmb
#include <asm/bug.h>                           // for WARN_ON, WARN
#include <linux/atomic.h>                      // for ATOMIC_LONG_INIT, atom...
#include <sys/types.h>                         // for dev_t
#include <cstdio>                              // for NULL, va_list
#include "asm-generic/errno-base.h"            // for EBUSY, ENOMEM, EINVAL
#include "asm-generic/rwonce.h"                // for WRITE_ONCE
#include "asm/bug.h"                           // for BUG
#include "linux/atomic/atomic-instrumented.h"  // for atomic_add_unless, ato...
#include "linux/capability.h"                  // for capable, ns_capable
#include "linux/compiler.h"                    // for unlikely
#include "linux/compiler_types.h"              // for __releases
#include "linux/container_of.h"                // for container_of
#include "linux/cred.h"                        // for current_user_ns
#include "linux/dcache.h"                      // for dget, d_genocide, dput
#include "linux/err.h"                         // for ERR_PTR, IS_ERR, ERR_CAST
#include "linux/fs.h"                          // for super_block, sb_writers
#include "linux/fsnotify_backend.h"            // for fsnotify_sb_delete
#include "linux/gfp.h"                         // for GFP_ATOMIC, GFP_USER
#include "linux/instruction_pointer.h"         // for _THIS_IP_
#include "linux/kdev_t.h"                      // for MINOR, MINORBITS, MKDEV
#include "linux/kern_levels.h"                 // for KERN_ERR, KERN_WARNING
#include "linux/list.h"                        // for hlist_unhashed, INIT_L...
#include "linux/list_bl.h"                     // for INIT_HLIST_BL_HEAD
#include "linux/list_lru.h"                    // for list_lru_destroy, list...
#include "linux/lockdep_types.h"               // for lock_class_key
#include "linux/math.h"                        // for mult_frac
#include "linux/numa.h"                        // for NUMA_NO_NODE
#include "linux/percpu-rwsem.h"                // for percpu_rw_semaphore
#include "linux/printk.h"                      // for printk, pr_err
#include "linux/quota.h"                       // for quota_info
#include "linux/rcupdate.h"                    // for call_rcu
#include "linux/rwsem.h"                       // for up_write, down_write
#include "linux/shrinker.h"                    // for shrink_control, regist...
#include "linux/spinlock.h"                    // for spin_unlock, spin_lock
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK
#include "linux/stdarg.h"                      // for va_end, va_start
#include "linux/stddef.h"                      // for false, true
#include "linux/string.h"                      // for strlcpy
#include "linux/time64.h"                      // for TIME64_MAX, TIME64_MIN
#include "linux/types.h"                       // for list_head, hlist_node
#include "linux/wait.h"                        // for wake_up, init_waitqueu...
#include "linux/workqueue.h"                   // for work_struct, schedule_...
struct block_device;

fs/super.c should remove these lines:
- #include <linux/fsnotify.h>  // lines 35-35
- #include <linux/mount.h>  // lines 27-27
- #include <linux/rculist_bl.h>  // lines 33-33

The full include-list for fs/super.c:
#include <asm/barrier.h>                       // for smp_wmb, smp_rmb
#include <asm/bug.h>                           // for WARN_ON, WARN
#include <linux/atomic.h>                      // for ATOMIC_LONG_INIT, atom...
#include <linux/backing-dev.h>                 // for bdi_put, noop_backing_...
#include <linux/blkdev.h>                      // for invalidate_bdev
#include <linux/export.h>                      // for EXPORT_SYMBOL
#include <linux/fs_context.h>                  // for fs_context, fs_context...
#include <linux/fscrypt.h>                     // for fscrypt_sb_free
#include <linux/idr.h>                         // for ida_alloc_range, ida_free
#include <linux/lockdep.h>                     // for lockdep_set_class
#include <linux/mutex.h>                       // for mutex_init
#include <linux/security.h>                    // for security_sb_free, secu...
#include <linux/slab.h>                        // for kfree, kmalloc, kzalloc
#include <linux/user_namespace.h>              // for put_user_ns, get_user_ns
#include <linux/writeback.h>                   // for cgroup_writeback_umount
#include <sys/types.h>                         // for dev_t
#include <uapi/linux/mount.h>                  // for MS_RMT_MASK
#include <cstdio>                              // for NULL, va_list
#include "asm-generic/errno-base.h"            // for EBUSY, ENOMEM, EINVAL
#include "asm-generic/rwonce.h"                // for WRITE_ONCE
#include "asm/bug.h"                           // for BUG
#include "internal.h"                          // for parse_monolithic_mount...
#include "linux/atomic/atomic-instrumented.h"  // for atomic_add_unless, ato...
#include "linux/capability.h"                  // for capable, ns_capable
#include "linux/compiler.h"                    // for unlikely
#include "linux/compiler_types.h"              // for __releases
#include "linux/container_of.h"                // for container_of
#include "linux/cred.h"                        // for current_user_ns
#include "linux/dcache.h"                      // for dget, d_genocide, dput
#include "linux/err.h"                         // for ERR_PTR, IS_ERR, ERR_CAST
#include "linux/fs.h"                          // for super_block, sb_writers
#include "linux/fsnotify_backend.h"            // for fsnotify_sb_delete
#include "linux/gfp.h"                         // for GFP_ATOMIC, GFP_USER
#include "linux/instruction_pointer.h"         // for _THIS_IP_
#include "linux/kdev_t.h"                      // for MINOR, MINORBITS, MKDEV
#include "linux/kern_levels.h"                 // for KERN_ERR, KERN_WARNING
#include "linux/list.h"                        // for hlist_unhashed, INIT_L...
#include "linux/list_bl.h"                     // for INIT_HLIST_BL_HEAD
#include "linux/list_lru.h"                    // for list_lru_destroy, list...
#include "linux/lockdep_types.h"               // for lock_class_key
#include "linux/math.h"                        // for mult_frac
#include "linux/numa.h"                        // for NUMA_NO_NODE
#include "linux/percpu-rwsem.h"                // for percpu_rw_semaphore
#include "linux/printk.h"                      // for printk, pr_err
#include "linux/quota.h"                       // for quota_info
#include "linux/rcupdate.h"                    // for call_rcu
#include "linux/rwsem.h"                       // for up_write, down_write
#include "linux/shrinker.h"                    // for shrink_control, regist...
#include "linux/spinlock.h"                    // for spin_unlock, spin_lock
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK
#include "linux/stdarg.h"                      // for va_end, va_start
#include "linux/stddef.h"                      // for false, true
#include "linux/string.h"                      // for strlcpy
#include "linux/time64.h"                      // for TIME64_MAX, TIME64_MIN
#include "linux/types.h"                       // for list_head, hlist_node
#include "linux/wait.h"                        // for wake_up, init_waitqueu...
#include "linux/workqueue.h"                   // for work_struct, schedule_...
struct block_device;
---
  ./scripts/check-local-export fs/super.o
  iwyu2 -Wp,-MMD,fs/.char_dev.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/char_dev"' -DKBUILD_BASENAME='"char_dev"' -DKBUILD_MODNAME='"char_dev"' -D__KBUILD_MODNAME=kmod_char_dev -c -o fs/char_dev.o fs/char_dev.c  
In file included from fs/char_dev.c:21:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/char_dev.c:21:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/char_dev.c:21:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from fs/char_dev.c:21:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/char_dev.c:21:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/char_dev.c:21:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

fs/char_dev.c should add these lines:
#include <asm/bug.h>                 // for WARN_ON
#include <stddef.h>                  // for NULL
#include <sys/types.h>               // for dev_t
#include "asm-generic/errno-base.h"  // for ENXIO, EBUSY, EINVAL, ENOMEM
#include "asm/string_32.h"           // for memset
#include "linux/compiler_types.h"    // for inline
#include "linux/container_of.h"      // for container_of
#include "linux/device.h"            // for device, device_add, device_del
#include "linux/err.h"               // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/export.h"            // for EXPORT_SYMBOL
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/kernel.h"            // for ARRAY_SIZE
#include "linux/kmod.h"              // for request_module
#include "linux/list.h"              // for INIT_LIST_HEAD, list_del_init
#include "linux/printk.h"            // for pr_err
#include "linux/spinlock.h"          // for spin_lock, spin_unlock
#include "linux/spinlock_types.h"    // for DEFINE_SPINLOCK
#include "linux/types.h"             // for list_head

fs/char_dev.c should remove these lines:
- #include <linux/backing-dev.h>  // lines 23-23
- #include <linux/errno.h>  // lines 15-15
- #include <linux/major.h>  // lines 14-14
- #include <linux/seq_file.h>  // lines 17-17
- #include <linux/tty.h>  // lines 24-24

The full include-list for fs/char_dev.c:
#include <asm/bug.h>                 // for WARN_ON
#include <linux/cdev.h>              // for cdev, cd_forget, cdev_add, cdev_...
#include <linux/fs.h>                // for inode, inode::(anonymous), file_...
#include <linux/init.h>              // for __init
#include <linux/kdev_t.h>            // for MAJOR, MKDEV, MINOR, MINORMASK
#include <linux/kobj_map.h>          // for kobj_lookup, kobj_map, kobj_map_...
#include <linux/kobject.h>           // for kobject_put, kobject_init, kobject
#include <linux/module.h>            // for module_put, try_module_get
#include <linux/mutex.h>             // for mutex_unlock, mutex, mutex_lock
#include <linux/slab.h>              // for kfree, kzalloc
#include <linux/string.h>            // for strlcpy
#include <stddef.h>                  // for NULL
#include <sys/types.h>               // for dev_t
#include "asm-generic/errno-base.h"  // for ENXIO, EBUSY, EINVAL, ENOMEM
#include "asm/string_32.h"           // for memset
#include "internal.h"                // for chrdev_init
#include "linux/compiler_types.h"    // for inline
#include "linux/container_of.h"      // for container_of
#include "linux/device.h"            // for device, device_add, device_del
#include "linux/err.h"               // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/export.h"            // for EXPORT_SYMBOL
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/kernel.h"            // for ARRAY_SIZE
#include "linux/kmod.h"              // for request_module
#include "linux/list.h"              // for INIT_LIST_HEAD, list_del_init
#include "linux/printk.h"            // for pr_err
#include "linux/spinlock.h"          // for spin_lock, spin_unlock
#include "linux/spinlock_types.h"    // for DEFINE_SPINLOCK
#include "linux/types.h"             // for list_head
---
  ./scripts/check-local-export fs/char_dev.o
  iwyu2 -Wp,-MMD,fs/.stat.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/stat"' -DKBUILD_BASENAME='"stat"' -DKBUILD_MODNAME='"stat"' -D__KBUILD_MODNAME=kmod_stat -c -o fs/stat.o fs/stat.c  
In file included from fs/stat.c:17:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/stat.c:17:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/stat.c:17:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/stat.c:17:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from fs/stat.c:17:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/stat.c:17:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/stat.c:17:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/stat.c:17:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/stat.c should add these lines:
#include <stddef.h>                   // for NULL
#include <sys/stat.h>                 // for stat
#include "asm-generic/bitsperlong.h"  // for BITS_PER_LONG
#include "asm-generic/errno-base.h"   // for EINVAL, EFAULT, EBADF, ENOENT
#include "asm-generic/errno.h"        // for EOVERFLOW
#include "asm-generic/int-ll64.h"     // for u32, u64
#include "asm/current.h"              // for current
#include "asm/ptrace.h"               // for pt_regs
#include "asm/stat.h"                 // for stat64, stat (ptr only), __old_...
#include "asm/string_32.h"            // for memset
#include "linux/compiler_types.h"     // for __user, noinline_for_stack
#include "linux/dcache.h"             // for d_backing_inode, d_is_symlink
#include "linux/fcntl.h"              // for AT_STATX_SYNC_TYPE, AT_NO_AUTOM...
#include "linux/kdev_t.h"             // for huge_encode_dev, new_encode_dev
#include "linux/kern_levels.h"        // for KERN_WARNING
#include "linux/mount.h"              // for mnt_user_ns, vfsmount
#include "linux/path.h"               // for path, path_put
#include "linux/printk.h"             // for printk
#include "linux/sched.h"              // for task_struct
#include "linux/spinlock.h"           // for spin_lock, spin_unlock
#include "linux/stat.h"               // for kstat, statx, statx_timestamp
#include "linux/time64.h"             // for timespec64
#include "linux/types.h"              // for loff_t
#include "linux/uidgid.h"             // for from_kgid_munged, from_kuid_munged
struct user_namespace;

fs/stat.c should remove these lines:
- #include <linux/compat.h>  // lines 19-19
- #include <linux/errno.h>  // lines 10-10
- #include <linux/mm.h>  // lines 9-9
- #include <linux/pagemap.h>  // lines 18-18

The full include-list for fs/stat.c:
#include <asm/unistd.h>               // for __ARCH_WANT_STAT64, __ARCH_WANT...
#include <linux/cred.h>               // for current_user_ns
#include <linux/export.h>             // for EXPORT_SYMBOL
#include <linux/file.h>               // for fd, fdget_raw, fdput
#include <linux/fs.h>                 // for inode, vfs_lstat, vfs_stat, get...
#include <linux/highuid.h>            // for SET_GID, SET_UID
#include <linux/namei.h>              // for retry_estale, user_path_at_empty
#include <linux/security.h>           // for security_inode_getattr, securit...
#include <linux/syscalls.h>           // for __MAP2, __MAP4, SYSCALL_DEFINE2
#include <linux/uaccess.h>            // for copy_to_user
#include <stddef.h>                   // for NULL
#include <sys/stat.h>                 // for stat
#include "asm-generic/bitsperlong.h"  // for BITS_PER_LONG
#include "asm-generic/errno-base.h"   // for EINVAL, EFAULT, EBADF, ENOENT
#include "asm-generic/errno.h"        // for EOVERFLOW
#include "asm-generic/int-ll64.h"     // for u32, u64
#include "asm/current.h"              // for current
#include "asm/ptrace.h"               // for pt_regs
#include "asm/stat.h"                 // for stat64, stat (ptr only), __old_...
#include "asm/string_32.h"            // for memset
#include "internal.h"                 // for filename_lookup, do_statx, getn...
#include "linux/compiler_types.h"     // for __user, noinline_for_stack
#include "linux/dcache.h"             // for d_backing_inode, d_is_symlink
#include "linux/fcntl.h"              // for AT_STATX_SYNC_TYPE, AT_NO_AUTOM...
#include "linux/kdev_t.h"             // for huge_encode_dev, new_encode_dev
#include "linux/kern_levels.h"        // for KERN_WARNING
#include "linux/mount.h"              // for mnt_user_ns, vfsmount
#include "linux/path.h"               // for path, path_put
#include "linux/printk.h"             // for printk
#include "linux/sched.h"              // for task_struct
#include "linux/spinlock.h"           // for spin_lock, spin_unlock
#include "linux/stat.h"               // for kstat, statx, statx_timestamp
#include "linux/time64.h"             // for timespec64
#include "linux/types.h"              // for loff_t
#include "linux/uidgid.h"             // for from_kgid_munged, from_kuid_munged
#include "mount.h"                    // for real_mount, mount
struct user_namespace;
---
  ./scripts/check-local-export fs/stat.o
  iwyu2 -Wp,-MMD,fs/.exec.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/exec"' -DKBUILD_BASENAME='"exec"' -DKBUILD_MODNAME='"exec"' -D__KBUILD_MODNAME=kmod_exec -c -o fs/exec.o fs/exec.c  
In file included from fs/exec.c:34:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from fs/exec.c:34:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/exec.c:34:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/exec.c:34:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/exec.c:56:
./include/linux/tsacct_kern.h:13:13: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
                                 struct taskstats *stats, struct task_struct *tsk)
                                        ^
./include/linux/tsacct_kern.h:16:41: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline void xacct_add_tsk(struct taskstats *stats, struct task_struct *p)
                                        ^
6 warnings generated.
In file included from fs/exec.c:34:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from fs/exec.c:34:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/exec.c:34:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/exec.c:34:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/exec.c:56:
./include/linux/tsacct_kern.h:13:13: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
                                 struct taskstats *stats, struct task_struct *tsk)
                                        ^
./include/linux/tsacct_kern.h:16:41: warning: declaration of 'struct taskstats' will not be visible outside of this function [-Wvisibility]
static inline void xacct_add_tsk(struct taskstats *stats, struct task_struct *p)
                                        ^

fs/exec.c should add these lines:
#include <asm/bug.h>                      // for BUG_ON, WARN_ON_ONCE, WARN_ON
#include <asm/page_types.h>               // for STACK_TOP_MAX, TASK_SIZE
#include <asm/signal.h>                   // for SIGSEGV
#include <linux/spinlock_types.h>         // for DEFINE_RWLOCK
#include <signal.h>                       // for SIGCHLD
#include <ctime>                          // for NULL, pid_t, size_t
#include "asm-generic/cacheflush.h"       // for flush_dcache_page, flush_ca...
#include "asm-generic/errno-base.h"       // for ENOMEM, E2BIG, EFAULT, EAGAIN
#include "asm-generic/errno.h"            // for ELOOP
#include "asm-generic/fcntl.h"            // for O_LARGEFILE, O_RDONLY
#include "asm-generic/int-ll64.h"         // for u64
#include "asm-generic/memory_model.h"     // for page_to_pfn
#include "asm-generic/resource.h"         // for RLIMIT_STACK, RLIMIT_NPROC
#include "asm-generic/rwonce.h"           // for READ_ONCE, WRITE_ONCE
#include "asm/current.h"                  // for current
#include "asm/page_types.h"               // for PAGE_SIZE, PAGE_MASK
#include "asm/processor.h"                // for arch_align_stack
#include "asm/ptrace.h"                   // for pt_regs
#include "asm/string_32.h"                // for strnlen, memcpy, memset
#include "asm/thread_info.h"              // for arch_setup_new_exec, thread...
#include "asm/uaccess.h"                  // for strnlen_user, get_user
#include "generated/autoconf.h"           // for CONFIG_MMU
#include "linux/binfmts.h"                // for linux_binprm (ptr only)
#include "linux/bitops.h"                 // for set_mask_bits
#include "linux/build_bug.h"              // for BUILD_BUG_ON
#include "linux/capability.h"             // for privileged_wrt_inode_uidgid
#include "linux/cgroup-defs.h"            // for cgroup_threadgroup_change_end
#include "linux/compiler.h"               // for unlikely, likely
#include "linux/compiler_types.h"         // for __user, inline
#include "linux/cred.h"                   // for cred, abort_creds, commit_c...
#include "linux/dcache.h"                 // for dentry
#include "linux/err.h"                    // for IS_ERR, PTR_ERR, ERR_PTR
#include "linux/errno.h"                  // for ERESTARTNOHAND, ERESTARTNOINTR
#include "linux/export.h"                 // for EXPORT_SYMBOL, EXPORT_SYMBO...
#include "linux/fcntl.h"                  // for AT_FDCWD, AT_EMPTY_PATH
#include "linux/fs.h"                     // for inode, putname, allow_write...
#include "linux/gfp.h"                    // for GFP_KERNEL
#include "linux/highmem-internal.h"       // for kmap_atomic, kunmap, kmap
#include "linux/irqflags.h"               // for local_irq_enable, local_irq...
#include "linux/kconfig.h"                // for IS_ENABLED, __ARG_PLACEHOLD...
#include "linux/kernel.h"                 // for kasprintf
#include "linux/limits.h"                 // for ARG_MAX
#include "linux/list.h"                   // for list_add, list_add_tail
#include "linux/minmax.h"                 // for max, max_t, min, min_not_zero
#include "linux/mm_types.h"               // for vm_area_struct, mm_struct
#include "linux/mm_types_task.h"          // for MM_ANONPAGES
#include "linux/mmap_lock.h"              // for mmap_write_unlock, mmap_rea...
#include "linux/mutex.h"                  // for mutex_unlock, mutex_lock_in...
#include "linux/path.h"                   // for path
#include "linux/personality.h"            // for PER_CLEAR_ON_SETID
#include "linux/pgtable.h"                // for USER_PGTABLES_CEILING
#include "linux/pid.h"                    // for transfer_pid, exchange_tids
#include "linux/printk.h"                 // for pr_warn_once
#include "linux/ptrace.h"                 // for ptrace_event, PTRACE_EVENT_...
#include "linux/rculist.h"                // for list_replace_rcu
#include "linux/rcupdate.h"               // for rcu_read_lock, rcu_read_unlock
#include "linux/refcount.h"               // for refcount_read, refcount_set
#include "linux/resource.h"               // for rlimit, _STK_LIM
#include "linux/rwsem.h"                  // for up_write, down_write_killable
#include "linux/sched.h"                  // for task_struct, schedule, task...
#include "linux/signal.h"                 // for sighand_cachep
#include "linux/spinlock_types.h"         // for spinlock_t
#include "linux/stat.h"                   // for S_ISGID, S_ISUID, S_IXGRP
#include "linux/stddef.h"                 // for false, true
#include "linux/thread_info.h"            // for SYSCALL_WORK_BIT_SYSCALL_US...
#include "linux/types.h"                  // for umode_t, bool, list_head
#include "linux/uidgid.h"                 // for gid_eq, kgid_has_mapping
#include "linux/user_namespace.h"         // for get_user_ns, is_ucounts_ove...

fs/exec.c should remove these lines:
- #include <linux/compat.h>  // lines 63-63
- #include <linux/coredump.h>  // lines 67-67
- #include <linux/fcntl.h>  // lines 33-33
- #include <linux/highmem.h>  // lines 44-44
- #include <linux/init.h>  // lines 36-36
- #include <linux/kernel_read_file.h>  // lines 26-26
- #include <linux/key.h>  // lines 46-46
- #include <linux/oom.h>  // lines 62-62
- #include <linux/pagemap.h>  // lines 42-42
- #include <linux/personality.h>  // lines 47-47
- #include <linux/stat.h>  // lines 32-32
- #include <linux/vmalloc.h>  // lines 64-64

The full include-list for fs/exec.c:
#include <asm/bug.h>                      // for BUG_ON, WARN_ON_ONCE, WARN_ON
#include <asm/mmu_context.h>              // for activate_mm
#include <asm/page_types.h>               // for STACK_TOP_MAX, TASK_SIZE
#include <asm/signal.h>                   // for SIGSEGV
#include <asm/tlb.h>                      // for mmu_gather
#include <linux/audit.h>                  // for audit_bprm
#include <linux/binfmts.h>                // for linux_binprm, linux_binfmt
#include <linux/cn_proc.h>                // for proc_exec_connector
#include <linux/fdtable.h>                // for do_close_on_exec, unshare_f...
#include <linux/file.h>                   // for fput, fd_install, get_close...
#include <linux/fs_struct.h>              // for fs_struct
#include <linux/fsnotify.h>               // for fsnotify_open
#include <linux/io_uring.h>               // for io_uring_task_cancel
#include <linux/kmod.h>                   // for request_module
#include <linux/mm.h>                     // for free_pgd_range, vma_adjust
#include <linux/module.h>                 // for module_put, __module_get
#include <linux/mount.h>                  // for mnt_may_suid, vfsmount, MNT...
#include <linux/namei.h>                  // for LOOKUP_FOLLOW, LOOKUP_EMPTY
#include <linux/perf_event.h>             // for perf_event_comm, perf_event...
#include <linux/pid_namespace.h>          // for task_active_pid_ns
#include <linux/sched/coredump.h>         // for get_dumpable, SUID_DUMP_USER
#include <linux/sched/mm.h>               // for mmdrop, mmput, arch_pick_mm...
#include <linux/sched/numa_balancing.h>   // for task_numa_free
#include <linux/sched/signal.h>           // for signal_struct, fatal_signal...
#include <linux/sched/task.h>             // for task_lock, task_unlock, tas...
#include <linux/security.h>               // for security_bprm_check, securi...
#include <linux/slab.h>                   // for kfree, kmem_cache_alloc
#include <linux/spinlock.h>               // for spin_unlock_irq, spin_lock
#include <linux/spinlock_types.h>         // for DEFINE_RWLOCK
#include <linux/string.h>                 // for strscpy_pad, kbasename, kst...
#include <linux/swap.h>                   // for lru_add_drain
#include <linux/syscall_user_dispatch.h>  // for clear_syscall_work_syscall_...
#include <linux/syscalls.h>               // for __MAP3, __MAP5, SYSCALL_DEF...
#include <linux/tsacct_kern.h>            // for acct_update_integrals
#include <linux/uaccess.h>                // for copy_from_user
#include <linux/utsname.h>                // for init_user_ns
#include <linux/vmacache.h>               // for vmacache_flush
#include <signal.h>                       // for SIGCHLD
#include <trace/events/sched.h>           // for trace_sched_process_exec
#include <trace/events/task.h>            // for trace_task_rename
#include <ctime>                          // for NULL, pid_t, size_t
#include "asm-generic/cacheflush.h"       // for flush_dcache_page, flush_ca...
#include "asm-generic/errno-base.h"       // for ENOMEM, E2BIG, EFAULT, EAGAIN
#include "asm-generic/errno.h"            // for ELOOP
#include "asm-generic/fcntl.h"            // for O_LARGEFILE, O_RDONLY
#include "asm-generic/int-ll64.h"         // for u64
#include "asm-generic/memory_model.h"     // for page_to_pfn
#include "asm-generic/resource.h"         // for RLIMIT_STACK, RLIMIT_NPROC
#include "asm-generic/rwonce.h"           // for READ_ONCE, WRITE_ONCE
#include "asm/current.h"                  // for current
#include "asm/page_types.h"               // for PAGE_SIZE, PAGE_MASK
#include "asm/processor.h"                // for arch_align_stack
#include "asm/ptrace.h"                   // for pt_regs
#include "asm/string_32.h"                // for strnlen, memcpy, memset
#include "asm/thread_info.h"              // for arch_setup_new_exec, thread...
#include "asm/uaccess.h"                  // for strnlen_user, get_user
#include "generated/autoconf.h"           // for CONFIG_MMU
#include "internal.h"                     // for do_filp_open, open_flags
#include "linux/binfmts.h"                // for linux_binprm (ptr only)
#include "linux/bitops.h"                 // for set_mask_bits
#include "linux/build_bug.h"              // for BUILD_BUG_ON
#include "linux/capability.h"             // for privileged_wrt_inode_uidgid
#include "linux/cgroup-defs.h"            // for cgroup_threadgroup_change_end
#include "linux/compiler.h"               // for unlikely, likely
#include "linux/compiler_types.h"         // for __user, inline
#include "linux/cred.h"                   // for cred, abort_creds, commit_c...
#include "linux/dcache.h"                 // for dentry
#include "linux/err.h"                    // for IS_ERR, PTR_ERR, ERR_PTR
#include "linux/errno.h"                  // for ERESTARTNOHAND, ERESTARTNOINTR
#include "linux/export.h"                 // for EXPORT_SYMBOL, EXPORT_SYMBO...
#include "linux/fcntl.h"                  // for AT_FDCWD, AT_EMPTY_PATH
#include "linux/fs.h"                     // for inode, putname, allow_write...
#include "linux/gfp.h"                    // for GFP_KERNEL
#include "linux/highmem-internal.h"       // for kmap_atomic, kunmap, kmap
#include "linux/irqflags.h"               // for local_irq_enable, local_irq...
#include "linux/kconfig.h"                // for IS_ENABLED, __ARG_PLACEHOLD...
#include "linux/kernel.h"                 // for kasprintf
#include "linux/limits.h"                 // for ARG_MAX
#include "linux/list.h"                   // for list_add, list_add_tail
#include "linux/minmax.h"                 // for max, max_t, min, min_not_zero
#include "linux/mm_types.h"               // for vm_area_struct, mm_struct
#include "linux/mm_types_task.h"          // for MM_ANONPAGES
#include "linux/mmap_lock.h"              // for mmap_write_unlock, mmap_rea...
#include "linux/mutex.h"                  // for mutex_unlock, mutex_lock_in...
#include "linux/path.h"                   // for path
#include "linux/personality.h"            // for PER_CLEAR_ON_SETID
#include "linux/pgtable.h"                // for USER_PGTABLES_CEILING
#include "linux/pid.h"                    // for transfer_pid, exchange_tids
#include "linux/printk.h"                 // for pr_warn_once
#include "linux/ptrace.h"                 // for ptrace_event, PTRACE_EVENT_...
#include "linux/rculist.h"                // for list_replace_rcu
#include "linux/rcupdate.h"               // for rcu_read_lock, rcu_read_unlock
#include "linux/refcount.h"               // for refcount_read, refcount_set
#include "linux/resource.h"               // for rlimit, _STK_LIM
#include "linux/rwsem.h"                  // for up_write, down_write_killable
#include "linux/sched.h"                  // for task_struct, schedule, task...
#include "linux/signal.h"                 // for sighand_cachep
#include "linux/spinlock_types.h"         // for spinlock_t
#include "linux/stat.h"                   // for S_ISGID, S_ISUID, S_IXGRP
#include "linux/stddef.h"                 // for false, true
#include "linux/thread_info.h"            // for SYSCALL_WORK_BIT_SYSCALL_US...
#include "linux/types.h"                  // for umode_t, bool, list_head
#include "linux/uidgid.h"                 // for gid_eq, kgid_has_mapping
#include "linux/user_namespace.h"         // for get_user_ns, is_ucounts_ove...
---
  ./scripts/check-local-export fs/exec.o
  iwyu2 -Wp,-MMD,fs/.pipe.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/pipe"' -DKBUILD_BASENAME='"pipe"' -DKBUILD_MODNAME='"pipe"' -D__KBUILD_MODNAME=kmod_pipe -c -o fs/pipe.o fs/pipe.c  
In file included from fs/pipe.c:24:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/pipe.c:24:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/pipe.c:24:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/pipe.c:24:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from fs/pipe.c:24:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/pipe.c:24:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/pipe.c:24:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/pipe.c:24:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/pipe.c should add these lines:
#include <asm/barrier.h>                       // for smp_load_acquire
#include <asm/bug.h>                           // for BUG_ON
#include <asm/signal.h>                        // for SIGIO, SIGPIPE
#include <cstdio>                              // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"            // for EFAULT, EINVAL, ENOMEM
#include "asm-generic/errno.h"                 // for ENOBUFS
#include "asm-generic/fcntl.h"                 // for O_NONBLOCK, O_DIRECT
#include "asm-generic/ioctls.h"                // for FIONREAD
#include "asm-generic/rwonce.h"                // for READ_ONCE, WRITE_ONCE
#include "asm-generic/siginfo.h"               // for POLL_IN, POLL_OUT
#include "asm/cache.h"                         // for __read_mostly
#include "asm/current.h"                       // for current
#include "asm/page_types.h"                    // for PAGE_SIZE, PAGE_SHIFT
#include "asm/ptrace.h"                        // for pt_regs
#include "asm/string_32.h"                     // for memcpy
#include "asm/uaccess.h"                       // for put_user
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_add_return
#include "linux/capability.h"                  // for capable, CAP_SYS_RESOURCE
#include "linux/compiler.h"                    // for unlikely
#include "linux/compiler_types.h"              // for inline, __user
#include "linux/cred.h"                        // for cred, current_fsgid
#include "linux/dcache.h"                      // for d_inode, dynamic_dname
#include "linux/err.h"                         // for IS_ERR, PTR_ERR
#include "linux/errno.h"                       // for ERESTARTSYS, ENOIOCTLCMD
#include "linux/eventpoll.h"                   // for EPOLLIN, EPOLLOUT, EPO...
#include "linux/export.h"                      // for EXPORT_SYMBOL
#include "linux/fcntl.h"                       // for F_GETPIPE_SZ, F_SETPIP...
#include "linux/fs.h"                          // for file (ptr only), inode...
#include "linux/gfp.h"                         // for GFP_KERNEL_ACCOUNT
#include "linux/mutex.h"                       // for mutex_unlock, mutex_lo...
#include "linux/page_ref.h"                    // for page_count
#include "linux/sched.h"                       // for task_struct, schedule
#include "linux/sched/signal.h"                // for send_sig, signal_pending
#include "linux/sched/user.h"                  // for free_uid, user_struct
#include "linux/spinlock.h"                    // for spin_unlock, spin_unlo...
#include "linux/stat.h"                        // for S_IFIFO, S_IRUSR, S_IWUSR
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for bool, __poll_t
#include "linux/wait.h"                        // for wait_queue_head_t, wak...
#include "linux/watch_queue.h"                 // for O_NOTIFICATION_PIPE
struct fs_context;

fs/pipe.c should remove these lines:
- #include <asm/ioctls.h>  // lines 31-31
- #include <linux/fcntl.h>  // lines 25-25
- #include <linux/highmem.h>  // lines 21-21
- #include <linux/module.h>  // lines 12-12
- #include <linux/sysctl.h>  // lines 28-28

The full include-list for fs/pipe.c:
#include <asm/barrier.h>                       // for smp_load_acquire
#include <asm/bug.h>                           // for BUG_ON
#include <asm/signal.h>                        // for SIGIO, SIGPIPE
#include <linux/audit.h>                       // for audit_fd_pair
#include <linux/file.h>                        // for fput, fd_install, put_...
#include <linux/fs.h>                          // for inode, file, kill_fasync
#include <linux/init.h>                        // for __init, fs_initcall
#include <linux/log2.h>                        // for roundup_pow_of_two
#include <linux/magic.h>                       // for PIPEFS_MAGIC
#include <linux/memcontrol.h>                  // for memcg_kmem_uncharge_page
#include <linux/mm.h>                          // for put_page, __SetPageLocked
#include <linux/mount.h>                       // for kern_mount, vfsmount
#include <linux/pagemap.h>                     // for lock_page
#include <linux/pipe_fs_i.h>                   // for pipe_inode_info, pipe_...
#include <linux/poll.h>                        // for poll_wait, poll_table
#include <linux/pseudo_fs.h>                   // for init_pseudo, pseudo_fs...
#include <linux/slab.h>                        // for kfree, kcalloc, kzalloc
#include <linux/syscalls.h>                    // for __MAP1, __MAP2, SYSCAL...
#include <linux/uaccess.h>                     // for copy_to_user
#include <linux/uio.h>                         // for iov_iter_count, copy_p...
#include <linux/watch_queue.h>                 // for watch_queue_init
#include <cstdio>                              // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"            // for EFAULT, EINVAL, ENOMEM
#include "asm-generic/errno.h"                 // for ENOBUFS
#include "asm-generic/fcntl.h"                 // for O_NONBLOCK, O_DIRECT
#include "asm-generic/ioctls.h"                // for FIONREAD
#include "asm-generic/rwonce.h"                // for READ_ONCE, WRITE_ONCE
#include "asm-generic/siginfo.h"               // for POLL_IN, POLL_OUT
#include "asm/cache.h"                         // for __read_mostly
#include "asm/current.h"                       // for current
#include "asm/page_types.h"                    // for PAGE_SIZE, PAGE_SHIFT
#include "asm/ptrace.h"                        // for pt_regs
#include "asm/string_32.h"                     // for memcpy
#include "asm/uaccess.h"                       // for put_user
#include "internal.h"                          // for pipefifo_fops
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_add_return
#include "linux/capability.h"                  // for capable, CAP_SYS_RESOURCE
#include "linux/compiler.h"                    // for unlikely
#include "linux/compiler_types.h"              // for inline, __user
#include "linux/cred.h"                        // for cred, current_fsgid
#include "linux/dcache.h"                      // for d_inode, dynamic_dname
#include "linux/err.h"                         // for IS_ERR, PTR_ERR
#include "linux/errno.h"                       // for ERESTARTSYS, ENOIOCTLCMD
#include "linux/eventpoll.h"                   // for EPOLLIN, EPOLLOUT, EPO...
#include "linux/export.h"                      // for EXPORT_SYMBOL
#include "linux/fcntl.h"                       // for F_GETPIPE_SZ, F_SETPIP...
#include "linux/fs.h"                          // for file (ptr only), inode...
#include "linux/gfp.h"                         // for GFP_KERNEL_ACCOUNT
#include "linux/mutex.h"                       // for mutex_unlock, mutex_lo...
#include "linux/page_ref.h"                    // for page_count
#include "linux/sched.h"                       // for task_struct, schedule
#include "linux/sched/signal.h"                // for send_sig, signal_pending
#include "linux/sched/user.h"                  // for free_uid, user_struct
#include "linux/spinlock.h"                    // for spin_unlock, spin_unlo...
#include "linux/stat.h"                        // for S_IFIFO, S_IRUSR, S_IWUSR
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for bool, __poll_t
#include "linux/wait.h"                        // for wait_queue_head_t, wak...
#include "linux/watch_queue.h"                 // for O_NOTIFICATION_PIPE
struct fs_context;
---
  ./scripts/check-local-export fs/pipe.o
  iwyu2 -Wp,-MMD,fs/.namei.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/namei"' -DKBUILD_BASENAME='"namei"' -DKBUILD_MODNAME='"namei"' -D__KBUILD_MODNAME=kmod_namei -c -o fs/namei.o fs/namei.c  
In file included from fs/namei.c:26:
In file included from ./include/linux/fsnotify.h:16:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^
In file included from fs/namei.c:30:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/namei.c:30:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/namei.c:30:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/namei.c:30:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from fs/namei.c:41:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
6 warnings generated.
In file included from fs/namei.c:26:
In file included from ./include/linux/fsnotify.h:16:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^
In file included from fs/namei.c:30:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/namei.c:30:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/namei.c:30:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/namei.c:30:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from fs/namei.c:41:
In file included from ./include/linux/init_task.h:18:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^

fs/namei.c should add these lines:
#include <asm/barrier.h>                // for smp_load_acquire, smp_rmb
#include <asm/bug.h>                    // for BUG_ON, WARN_ON, WARN_ON_ONCE
#include <linux/mm.h>                   // for PageUptodate
#include <stddef.h>                     // for NULL, size_t
#include <sys/types.h>                  // for dev_t
#include "asm-generic/errno-base.h"     // for ECHILD, ENOENT, EPERM, EACCES
#include "asm-generic/errno.h"          // for ELOOP, ESTALE, EOVERFLOW, ENA...
#include "asm-generic/fcntl.h"          // for O_CREAT, O_TRUNC, O_EXCL, O_A...
#include "asm-generic/int-ll64.h"       // for u64
#include "asm-generic/rwonce.h"         // for READ_ONCE
#include "asm/cache.h"                  // for __read_mostly
#include "asm/current.h"                // for current
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/string_32.h"              // for strlen, memcpy
#include "asm/uaccess.h"                // for strncpy_from_user
#include "linux/audit.h"                // for AUDIT_ANOM_LINK, AUDIT_ANOM_C...
#include "linux/capability.h"           // for CAP_DAC_READ_SEARCH, CAP_DAC_...
#include "linux/compiler.h"             // for unlikely, likely
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for __user, inline, __randomize_l...
#include "linux/cred.h"                 // for cred, current_fsuid, in_group_p
#include "linux/dcache.h"               // for dentry, dput, qstr, dget, d_i...
#include "linux/delayed_call.h"         // for do_delayed_call, clear_delaye...
#include "linux/err.h"                  // for ERR_PTR, IS_ERR, PTR_ERR, ERR...
#include "linux/errno.h"                // for EOPENSTALE
#include "linux/fcntl.h"                // for AT_FDCWD, AT_EMPTY_PATH, AT_R...
#include "linux/fs.h"                   // for inode (ptr only), filename (p...
#include "linux/gfp.h"                  // for GFP_KERNEL, GFP_ATOMIC, __GFP_FS
#include "linux/kdev_t.h"               // for new_decode_dev
#include "linux/limits.h"               // for PATH_MAX
#include "linux/lockref.h"              // for lockref_get_not_dead
#include "linux/mm.h"                   // for put_page, page_address
#include "linux/mutex.h"                // for mutex_lock, mutex_unlock
#include "linux/path.h"                 // for path, path_equal, path_get
#include "linux/rcupdate.h"             // for rcu_read_unlock, rcu_read_lock
#include "linux/sched.h"                // for task_struct, cond_resched
#include "linux/seqlock.h"              // for __seqprop_mutex_ptr, __seqpro...
#include "linux/spinlock.h"             // for spin_lock, spin_unlock
#include "linux/stat.h"                 // for S_IFREG, S_ISREG, S_ISVTX
#include "linux/stddef.h"               // for false, true, offsetof
#include "linux/stringhash.h"           // for hashlen_create, hashlen_len
#include "linux/types.h"                // for umode_t, bool
#include "linux/uidgid.h"               // for uid_eq, uid_valid, gid_valid
#include "linux/utsname.h"              // for init_user_ns
#include "linux/wait.h"                 // for wait_queue_head, DECLARE_WAIT...
struct user_namespace;

fs/namei.c should remove these lines:
- #include <linux/fcntl.h>  // lines 35-35
- #include <linux/init.h>  // lines 18-18
- #include <linux/init_task.h>  // lines 41-41
- #include <linux/personality.h>  // lines 27-27

The full include-list for fs/namei.c:
#include <asm/barrier.h>                // for smp_load_acquire, smp_rmb
#include <asm/bug.h>                    // for BUG_ON, WARN_ON, WARN_ON_ONCE
#include <asm/word-at-a-time.h>         // for has_zero, load_unaligned_zeropad
#include <linux/audit.h>                // for audit_inode, audit_inode_child
#include <linux/bitops.h>               // for rol32
#include <linux/capability.h>           // for capable_wrt_inode_uidgid, cap...
#include <linux/device_cgroup.h>        // for devcgroup_inode_mknod, devcgr...
#include <linux/export.h>               // for EXPORT_SYMBOL
#include <linux/file.h>                 // for fdput, fd, fdget_raw, fput
#include <linux/fs.h>                   // for inode, inode_unlock, inode_lo...
#include <linux/fs_struct.h>            // for fs_struct, get_fs_pwd, get_fs...
#include <linux/fsnotify.h>             // for fsnotify_create, d_delete_notify
#include <linux/hash.h>                 // for __hash_32
#include <linux/ima.h>                  // for ima_file_check, ima_post_crea...
#include <linux/kernel.h>               // for REPEAT_BYTE
#include <linux/mm.h>                   // for PageUptodate
#include <linux/mount.h>                // for mnt_user_ns, mnt_drop_write
#include <linux/namei.h>                // for LOOKUP_RCU, retry_estale, LOO...
#include <linux/pagemap.h>              // for find_get_page, mapping_gfp_co...
#include <linux/sched/mm.h>             // for memalloc_nofs_restore, memall...
#include <linux/security.h>             // for security_inode_create, securi...
#include <linux/slab.h>                 // for kfree, kmalloc, kmalloc_array
#include <linux/syscalls.h>             // for __MAP2, __MAP3, __MAP1, __MAP4
#include <linux/uaccess.h>              // for copy_to_user
#include <stddef.h>                     // for NULL, size_t
#include <sys/types.h>                  // for dev_t
#include "asm-generic/errno-base.h"     // for ECHILD, ENOENT, EPERM, EACCES
#include "asm-generic/errno.h"          // for ELOOP, ESTALE, EOVERFLOW, ENA...
#include "asm-generic/fcntl.h"          // for O_CREAT, O_TRUNC, O_EXCL, O_A...
#include "asm-generic/int-ll64.h"       // for u64
#include "asm-generic/rwonce.h"         // for READ_ONCE
#include "asm/cache.h"                  // for __read_mostly
#include "asm/current.h"                // for current
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/string_32.h"              // for strlen, memcpy
#include "asm/uaccess.h"                // for strncpy_from_user
#include "internal.h"                   // for open_flags, vfs_open, lookup_mnt
#include "linux/audit.h"                // for AUDIT_ANOM_LINK, AUDIT_ANOM_C...
#include "linux/capability.h"           // for CAP_DAC_READ_SEARCH, CAP_DAC_...
#include "linux/compiler.h"             // for unlikely, likely
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for __user, inline, __randomize_l...
#include "linux/cred.h"                 // for cred, current_fsuid, in_group_p
#include "linux/dcache.h"               // for dentry, dput, qstr, dget, d_i...
#include "linux/delayed_call.h"         // for do_delayed_call, clear_delaye...
#include "linux/err.h"                  // for ERR_PTR, IS_ERR, PTR_ERR, ERR...
#include "linux/errno.h"                // for EOPENSTALE
#include "linux/fcntl.h"                // for AT_FDCWD, AT_EMPTY_PATH, AT_R...
#include "linux/fs.h"                   // for inode (ptr only), filename (p...
#include "linux/gfp.h"                  // for GFP_KERNEL, GFP_ATOMIC, __GFP_FS
#include "linux/kdev_t.h"               // for new_decode_dev
#include "linux/limits.h"               // for PATH_MAX
#include "linux/lockref.h"              // for lockref_get_not_dead
#include "linux/mm.h"                   // for put_page, page_address
#include "linux/mutex.h"                // for mutex_lock, mutex_unlock
#include "linux/path.h"                 // for path, path_equal, path_get
#include "linux/rcupdate.h"             // for rcu_read_unlock, rcu_read_lock
#include "linux/sched.h"                // for task_struct, cond_resched
#include "linux/seqlock.h"              // for __seqprop_mutex_ptr, __seqpro...
#include "linux/spinlock.h"             // for spin_lock, spin_unlock
#include "linux/stat.h"                 // for S_IFREG, S_ISREG, S_ISVTX
#include "linux/stddef.h"               // for false, true, offsetof
#include "linux/stringhash.h"           // for hashlen_create, hashlen_len
#include "linux/types.h"                // for umode_t, bool
#include "linux/uidgid.h"               // for uid_eq, uid_valid, gid_valid
#include "linux/utsname.h"              // for init_user_ns
#include "linux/wait.h"                 // for wait_queue_head, DECLARE_WAIT...
#include "mount.h"                      // for mount_lock, is_local_mountpoint
struct user_namespace;
---
  ./scripts/check-local-export fs/namei.o
  iwyu2 -Wp,-MMD,fs/.fcntl.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/fcntl"' -DKBUILD_BASENAME='"fcntl"' -DKBUILD_MODNAME='"fcntl"' -D__KBUILD_MODNAME=kmod_fcntl -c -o fs/fcntl.o fs/fcntl.c  
In file included from fs/fcntl.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/fcntl.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/fcntl.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/fcntl.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from fs/fcntl.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/fcntl.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/fcntl.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/fcntl.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/fcntl.c should add these lines:
#include <asm/bug.h>                           // for BUG_ON, WARN_ON
#include <asm/signal.h>                        // for SIGURG, SIGIO, SIGPOLL
#include <linux/spinlock.h>                    // for read_lock_irqsave, rea...
#include <ctime>                               // for NULL, pid_t
#include "asm-generic/bitops/const_hweight.h"  // for HWEIGHT32
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm-generic/errno-base.h"            // for EFAULT, EINVAL, EBADF
#include "asm-generic/fcntl.h"                 // for f_owner_ex, O_NDELAY
#include "asm-generic/int-ll64.h"              // for u64
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "asm-generic/siginfo.h"               // for POLL_IN, NSIGPOLL, si_...
#include "asm/cache.h"                         // for __read_mostly
#include "asm/ptrace.h"                        // for pt_regs
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/compiler.h"                    // for unlikely
#include "linux/compiler_attributes.h"         // for fallthrough
#include "linux/compiler_types.h"              // for __user, inline
#include "linux/container_of.h"                // for container_of
#include "linux/cred.h"                        // for cred, __task_cred, cur...
#include "linux/eventpoll.h"                   // for EPOLLERR, EPOLLIN, EPO...
#include "linux/export.h"                      // for EXPORT_SYMBOL
#include "linux/fcntl.h"                       // for F_DUPFD_CLOEXEC, F_GET...
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/kern_levels.h"                 // for KERN_ERR
#include "linux/pid.h"                         // for pid_task, pid_type
#include "linux/printk.h"                      // for printk
#include "linux/sched.h"                       // for task_struct
#include "linux/sched/signal.h"                // for SEND_SIG_PRIV
#include "linux/signal_types.h"                // for kernel_siginfo_t, kern...
#include "linux/spinlock.h"                    // for spin_lock, spin_unlock
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK
#include "linux/stat.h"                        // for S_ISFIFO
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for __poll_t, bool, rcu_head
#include "linux/uidgid.h"                      // for uid_eq, GLOBAL_ROOT_UID
#include "vdso/limits.h"                       // for INT_MIN

fs/fcntl.c should remove these lines:
- #include <asm/siginfo.h>  // lines 31-31
- #include <linux/capability.h>  // lines 15-15
- #include <linux/compat.h>  // lines 27-27
- #include <linux/fdtable.h>  // lines 14-14
- #include <linux/mm.h>  // lines 10-10
- #include <linux/mount.h>  // lines 28-28
- #include <linux/pid_namespace.h>  // lines 24-24
- #include <linux/user_namespace.h>  // lines 25-25

The full include-list for fs/fcntl.c:
#include <asm/bug.h>                           // for BUG_ON, WARN_ON
#include <asm/signal.h>                        // for SIGURG, SIGIO, SIGPOLL
#include <linux/dnotify.h>                     // for fcntl_dirnotify
#include <linux/file.h>                        // for fd, f_dupfd, fdget_raw
#include <linux/fs.h>                          // for file, fown_struct, fas...
#include <linux/init.h>                        // for __init
#include <linux/memfd.h>                       // for memfd_fcntl
#include <linux/module.h>                      // for module_init
#include <linux/pipe_fs_i.h>                   // for pipe_fcntl
#include <linux/poll.h>                        // for mangle_poll
#include <linux/ptrace.h>                      // for force_successful_sysca...
#include <linux/rcupdate.h>                    // for rcu_read_lock, rcu_rea...
#include <linux/sched/task.h>                  // for tasklist_lock
#include <linux/security.h>                    // for security_file_fcntl
#include <linux/signal.h>                      // for do_send_sig_info, clea...
#include <linux/slab.h>                        // for kmem_cache_free, kmem_...
#include <linux/spinlock.h>                    // for read_lock_irqsave, rea...
#include <linux/syscalls.h>                    // for __MAP3, SYSCALL_DEFINE3
#include <linux/uaccess.h>                     // for copy_from_user, copy_t...
#include <ctime>                               // for NULL, pid_t
#include "asm-generic/bitops/const_hweight.h"  // for HWEIGHT32
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm-generic/errno-base.h"            // for EFAULT, EINVAL, EBADF
#include "asm-generic/fcntl.h"                 // for f_owner_ex, O_NDELAY
#include "asm-generic/int-ll64.h"              // for u64
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "asm-generic/siginfo.h"               // for POLL_IN, NSIGPOLL, si_...
#include "asm/cache.h"                         // for __read_mostly
#include "asm/ptrace.h"                        // for pt_regs
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/compiler.h"                    // for unlikely
#include "linux/compiler_attributes.h"         // for fallthrough
#include "linux/compiler_types.h"              // for __user, inline
#include "linux/container_of.h"                // for container_of
#include "linux/cred.h"                        // for cred, __task_cred, cur...
#include "linux/eventpoll.h"                   // for EPOLLERR, EPOLLIN, EPO...
#include "linux/export.h"                      // for EXPORT_SYMBOL
#include "linux/fcntl.h"                       // for F_DUPFD_CLOEXEC, F_GET...
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/kern_levels.h"                 // for KERN_ERR
#include "linux/pid.h"                         // for pid_task, pid_type
#include "linux/printk.h"                      // for printk
#include "linux/sched.h"                       // for task_struct
#include "linux/sched/signal.h"                // for SEND_SIG_PRIV
#include "linux/signal_types.h"                // for kernel_siginfo_t, kern...
#include "linux/spinlock.h"                    // for spin_lock, spin_unlock
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK
#include "linux/stat.h"                        // for S_ISFIFO
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for __poll_t, bool, rcu_head
#include "linux/uidgid.h"                      // for uid_eq, GLOBAL_ROOT_UID
#include "vdso/limits.h"                       // for INT_MIN
---
  ./scripts/check-local-export fs/fcntl.o
  iwyu2 -Wp,-MMD,fs/.ioctl.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/ioctl"' -DKBUILD_BASENAME='"ioctl"' -DKBUILD_MODNAME='"ioctl"' -D__KBUILD_MODNAME=kmod_ioctl -c -o fs/ioctl.o fs/ioctl.c  
In file included from fs/ioctl.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/ioctl.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/ioctl.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/ioctl.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from fs/ioctl.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/ioctl.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/ioctl.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/ioctl.c:8:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/ioctl.c should add these lines:
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL, EFAULT, EPERM, ENOTTY
#include "asm-generic/errno.h"       // for EOPNOTSUPP, EBADR
#include "asm-generic/fcntl.h"       // for FASYNC, O_NONBLOCK
#include "asm-generic/int-ll64.h"    // for u64, __u16, u32, u16
#include "asm-generic/ioctls.h"      // for FIOASYNC, FIOCLEX, FIONBIO, FION...
#include "asm/current.h"             // for current
#include "asm/page_types.h"          // for PAGE_SIZE
#include "asm/ptrace.h"              // for pt_regs
#include "asm/string_32.h"           // for memset
#include "asm/uaccess.h"             // for get_user, put_user
#include "linux/capability.h"        // for CAP_SYS_ADMIN, CAP_LINUX_IMMUTABLE
#include "linux/compiler_types.h"    // for __user
#include "linux/cred.h"              // for current_user_ns
#include "linux/dcache.h"            // for d_inode, dentry (ptr only)
#include "linux/err.h"               // for IS_ERR, PTR_ERR
#include "linux/errno.h"             // for ENOIOCTLCMD
#include "linux/falloc.h"            // for FALLOC_FL_KEEP_SIZE, FALLOC_FL_P...
#include "linux/fiemap.h"            // for fiemap, fiemap_extent, FIEMAP_EX...
#include "linux/fs.h"                // for file (ptr only), fsxattr, file_d...
#include "linux/pagemap.h"           // for filemap_write_and_wait
#include "linux/path.h"              // for path
#include "linux/printk.h"            // for pr_warn_ratelimited
#include "linux/projid.h"            // for make_kprojid, projid_valid
#include "linux/sched.h"             // for task_pid_nr, task_struct
#include "linux/slab.h"              // for kfree
#include "linux/spinlock.h"          // for spin_lock, spin_unlock
#include "linux/stat.h"              // for S_ISREG, S_ISDIR, S_ISLNK
#include "linux/stddef.h"            // for true, offsetof
#include "linux/string.h"            // for memdup_user
#include "linux/types.h"             // for loff_t, sector_t
#include "linux/user_namespace.h"    // for init_user_ns, user_namespace (pt...
#include "vdso/limits.h"             // for UINT_MAX, INT_MAX

fs/ioctl.c should remove these lines:
- #include <asm/ioctls.h>  // lines 28-28
- #include <linux/buffer_head.h>  // lines 18-18
- #include <linux/compat.h>  // lines 11-11
- #include <linux/mm.h>  // lines 9-9
- #include <linux/sched/signal.h>  // lines 20-20
- #include <linux/writeback.h>  // lines 17-17
- #include "internal.h"  // lines 26-26

The full include-list for fs/ioctl.c:
#include <linux/capability.h>        // for capable, ns_capable
#include <linux/export.h>            // for EXPORT_SYMBOL
#include <linux/falloc.h>            // for space_resv, FS_IOC_RESVSP, FS_IO...
#include <linux/fiemap.h>            // for fiemap_extent_info, fiemap_fill_...
#include <linux/file.h>              // for fd, fdget, fdput, set_close_on_exec
#include <linux/fileattr.h>          // for fileattr, FS_COMMON_FL, FS_XFLAG...
#include <linux/fs.h>                // for inode, file_inode, file, super_b...
#include <linux/fscrypt.h>           // for fscrypt_prepare_setflags
#include <linux/mount.h>             // for mnt_drop_write_file, mnt_want_wr...
#include <linux/security.h>          // for security_file_ioctl
#include <linux/syscalls.h>          // for __MAP3, SYSCALL_DEFINE3
#include <linux/uaccess.h>           // for copy_to_user, copy_from_user
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL, EFAULT, EPERM, ENOTTY
#include "asm-generic/errno.h"       // for EOPNOTSUPP, EBADR
#include "asm-generic/fcntl.h"       // for FASYNC, O_NONBLOCK
#include "asm-generic/int-ll64.h"    // for u64, __u16, u32, u16
#include "asm-generic/ioctls.h"      // for FIOASYNC, FIOCLEX, FIONBIO, FION...
#include "asm/current.h"             // for current
#include "asm/page_types.h"          // for PAGE_SIZE
#include "asm/ptrace.h"              // for pt_regs
#include "asm/string_32.h"           // for memset
#include "asm/uaccess.h"             // for get_user, put_user
#include "linux/capability.h"        // for CAP_SYS_ADMIN, CAP_LINUX_IMMUTABLE
#include "linux/compiler_types.h"    // for __user
#include "linux/cred.h"              // for current_user_ns
#include "linux/dcache.h"            // for d_inode, dentry (ptr only)
#include "linux/err.h"               // for IS_ERR, PTR_ERR
#include "linux/errno.h"             // for ENOIOCTLCMD
#include "linux/falloc.h"            // for FALLOC_FL_KEEP_SIZE, FALLOC_FL_P...
#include "linux/fiemap.h"            // for fiemap, fiemap_extent, FIEMAP_EX...
#include "linux/fs.h"                // for file (ptr only), fsxattr, file_d...
#include "linux/pagemap.h"           // for filemap_write_and_wait
#include "linux/path.h"              // for path
#include "linux/printk.h"            // for pr_warn_ratelimited
#include "linux/projid.h"            // for make_kprojid, projid_valid
#include "linux/sched.h"             // for task_pid_nr, task_struct
#include "linux/slab.h"              // for kfree
#include "linux/spinlock.h"          // for spin_lock, spin_unlock
#include "linux/stat.h"              // for S_ISREG, S_ISDIR, S_ISLNK
#include "linux/stddef.h"            // for true, offsetof
#include "linux/string.h"            // for memdup_user
#include "linux/types.h"             // for loff_t, sector_t
#include "linux/user_namespace.h"    // for init_user_ns, user_namespace (pt...
#include "vdso/limits.h"             // for UINT_MAX, INT_MAX
---
  ./scripts/check-local-export fs/ioctl.o
  iwyu2 -Wp,-MMD,fs/.readdir.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/readdir"' -DKBUILD_BASENAME='"readdir"' -DKBUILD_MODNAME='"readdir"' -D__KBUILD_MODNAME=kmod_readdir -c -o fs/readdir.o fs/readdir.c  
In file included from fs/readdir.c:17:
In file included from ./include/linux/fsnotify.h:16:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^
In file included from fs/readdir.c:20:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/readdir.c:20:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/readdir.c:20:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/readdir.c:20:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
5 warnings generated.
In file included from fs/readdir.c:17:
In file included from ./include/linux/fsnotify.h:16:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^
In file included from fs/readdir.c:20:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/readdir.c:20:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/readdir.c:20:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/readdir.c:20:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/readdir.c should add these lines:
#include <stddef.h>                  // for size_t
#include "asm-generic/errno-base.h"  // for EFAULT, EINVAL, EBADF, EINTR, EIO
#include "asm-generic/errno.h"       // for EOVERFLOW
#include "asm-generic/int-ll64.h"    // for u64, s64
#include "asm/current.h"             // for current
#include "asm/ptrace.h"              // for pt_regs
#include "asm/string_32.h"           // for memchr
#include "asm/uaccess.h"             // for unsafe_put_user, unsafe_copy_to_...
#include "asm/unistd.h"              // for __ARCH_WANT_OLD_READDIR
#include "linux/align.h"             // for ALIGN
#include "linux/compiler.h"          // for unlikely
#include "linux/compiler_types.h"    // for __user
#include "linux/container_of.h"      // for container_of
#include "linux/limits.h"            // for PATH_MAX
#include "linux/rwsem.h"             // for down_read_killable, down_write_k...
#include "linux/sched/signal.h"      // for signal_pending
#include "linux/types.h"             // for loff_t, bool

fs/readdir.c should remove these lines:
- #include <asm/unaligned.h>  // lines 25-25
- #include <linux/compat.h>  // lines 22-22
- #include <linux/errno.h>  // lines 13-13
- #include <linux/kernel.h>  // lines 9-9
- #include <linux/mm.h>  // lines 12-12
- #include <linux/stat.h>  // lines 14-14
- #include <linux/time.h>  // lines 11-11
- #include <linux/unistd.h>  // lines 21-21

The full include-list for fs/readdir.c:
#include <linux/dirent.h>            // for linux_dirent64
#include <linux/export.h>            // for EXPORT_SYMBOL
#include <linux/file.h>              // for fd, fdget_pos, fdput_pos
#include <linux/fs.h>                // for dir_context, file, file_operations
#include <linux/fsnotify.h>          // for fsnotify_access
#include <linux/security.h>          // for security_file_permission
#include <linux/stddef.h>            // for offsetof, false, true
#include <linux/syscalls.h>          // for __MAP3, SYSCALL_DEFINE3
#include <linux/uaccess.h>           // for user_write_access_end, user_writ...
#include <stddef.h>                  // for size_t
#include "asm-generic/errno-base.h"  // for EFAULT, EINVAL, EBADF, EINTR, EIO
#include "asm-generic/errno.h"       // for EOVERFLOW
#include "asm-generic/int-ll64.h"    // for u64, s64
#include "asm/current.h"             // for current
#include "asm/ptrace.h"              // for pt_regs
#include "asm/string_32.h"           // for memchr
#include "asm/uaccess.h"             // for unsafe_put_user, unsafe_copy_to_...
#include "asm/unistd.h"              // for __ARCH_WANT_OLD_READDIR
#include "linux/align.h"             // for ALIGN
#include "linux/compiler.h"          // for unlikely
#include "linux/compiler_types.h"    // for __user
#include "linux/container_of.h"      // for container_of
#include "linux/limits.h"            // for PATH_MAX
#include "linux/rwsem.h"             // for down_read_killable, down_write_k...
#include "linux/sched/signal.h"      // for signal_pending
#include "linux/types.h"             // for loff_t, bool
---
  ./scripts/check-local-export fs/readdir.o
  iwyu2 -Wp,-MMD,fs/.select.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/select"' -DKBUILD_BASENAME='"select"' -DKBUILD_MODNAME='"select"' -D__KBUILD_MODNAME=kmod_select -c -o fs/select.o fs/select.c  
In file included from fs/select.c:22:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/select.c:22:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/select.c:22:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/select.c:22:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from fs/select.c:33:
In file included from ./include/net/busy_poll.h:15:
In file included from ./include/linux/netdevice.h:38:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from fs/select.c:33:
In file included from ./include/net/busy_poll.h:15:
./include/linux/netdevice.h:1243:17: warning: declaration of 'struct rtnl_link_stats64' will not be visible outside of this function [-Wvisibility]
                                                   struct rtnl_link_stats64 *storage);
                                                          ^
./include/linux/netdevice.h:1268:19: warning: declaration of 'struct ifla_vf_info' will not be visible outside of this function [-Wvisibility]
                                                     struct ifla_vf_info *ivf);
                                                            ^
./include/linux/netdevice.h:1273:18: warning: declaration of 'struct ifla_vf_stats' will not be visible outside of this function [-Wvisibility]
                                                    struct ifla_vf_stats
                                                           ^
./include/linux/netdevice.h:1282:17: warning: declaration of 'struct ifla_vf_guid' will not be visible outside of this function [-Wvisibility]
                                                   struct ifla_vf_guid *node_guid,
                                                          ^
In file included from fs/select.c:33:
In file included from ./include/net/busy_poll.h:18:
In file included from ./include/net/ip.h:30:
./include/net/route.h:134:17: warning: declaration of 'struct fib_result' will not be visible outside of this function [-Wvisibility]
                                            struct fib_result *res,
                                                   ^
./include/net/route.h:206:17: warning: declaration of 'struct fib_result' will not be visible outside of this function [-Wvisibility]
                       struct fib_result *res);
                              ^
./include/net/route.h:244:56: warning: declaration of 'struct rtentry' will not be visible outside of this function [-Wvisibility]
int ip_rt_ioctl(struct net *, unsigned int cmd, struct rtentry *rt);
                                                       ^
12 warnings generated.
In file included from fs/select.c:22:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/select.c:22:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/select.c:22:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/select.c:22:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from fs/select.c:33:
In file included from ./include/net/busy_poll.h:15:
In file included from ./include/linux/netdevice.h:38:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from fs/select.c:33:
In file included from ./include/net/busy_poll.h:15:
./include/linux/netdevice.h:1243:17: warning: declaration of 'struct rtnl_link_stats64' will not be visible outside of this function [-Wvisibility]
                                                   struct rtnl_link_stats64 *storage);
                                                          ^
./include/linux/netdevice.h:1268:19: warning: declaration of 'struct ifla_vf_info' will not be visible outside of this function [-Wvisibility]
                                                     struct ifla_vf_info *ivf);
                                                            ^
./include/linux/netdevice.h:1273:18: warning: declaration of 'struct ifla_vf_stats' will not be visible outside of this function [-Wvisibility]
                                                    struct ifla_vf_stats
                                                           ^
./include/linux/netdevice.h:1282:17: warning: declaration of 'struct ifla_vf_guid' will not be visible outside of this function [-Wvisibility]
                                                   struct ifla_vf_guid *node_guid,
                                                          ^
In file included from fs/select.c:33:
In file included from ./include/net/busy_poll.h:18:
In file included from ./include/net/ip.h:30:
./include/net/route.h:134:17: warning: declaration of 'struct fib_result' will not be visible outside of this function [-Wvisibility]
                                            struct fib_result *res,
                                                   ^
./include/net/route.h:206:17: warning: declaration of 'struct fib_result' will not be visible outside of this function [-Wvisibility]
                       struct fib_result *res);
                              ^
./include/net/route.h:244:56: warning: declaration of 'struct rtentry' will not be visible outside of this function [-Wvisibility]
int ip_rt_ioctl(struct net *, unsigned int cmd, struct rtentry *rt);
                                                       ^

fs/select.c should add these lines:
#include <asm/barrier.h>                // for smp_store_mb, smp_wmb
#include <asm/posix_types.h>            // for __kernel_long_t
#include <linux/ktime.h>                // for ktime_get_ts64
#include <stddef.h>                     // for NULL, size_t
#include <sys/select.h>                 // for fd_set, sigset_t
#include "asm-generic/bitsperlong.h"    // for BITS_PER_LONG
#include "asm-generic/errno-base.h"     // for EFAULT, EINVAL, ENOMEM, EBADF
#include "asm-generic/int-ll64.h"       // for u64
#include "asm-generic/poll.h"           // for pollfd, POLL_BUSY_LOOP
#include "asm-generic/resource.h"       // for RLIMIT_NOFILE
#include "asm/bug.h"                    // for BUG
#include "asm/current.h"                // for current
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/string_32.h"              // for memset
#include "asm/uaccess.h"                // for unsafe_get_user, unsafe_put_user
#include "asm/unistd.h"                 // for __ARCH_WANT_SYS_OLD_SELECT
#include "linux/compiler_attributes.h"  // for __must_check
#include "linux/compiler_types.h"       // for __user, inline
#include "linux/container_of.h"         // for container_of
#include "linux/errno.h"                // for ERESTARTNOHAND
#include "linux/eventpoll.h"            // for EPOLLNVAL, EPOLLERR, EPOLLHUP
#include "linux/gfp.h"                  // for GFP_KERNEL, __get_free_page
#include "linux/ktime.h"                // for timespec64_to_ktime, ktime_t
#include "linux/limits.h"               // for SIZE_MAX
#include "linux/minmax.h"               // for min, min_t
#include "linux/overflow.h"             // for struct_size
#include "linux/personality.h"          // for STICKY_TIMEOUTS
#include "linux/restart_block.h"        // for restart_block, restart_block:...
#include "linux/sched.h"                // for task_struct, need_resched
#include "linux/stddef.h"               // for false, true
#include "linux/thread_info.h"          // for set_restart_fn
#include "linux/time.h"                 // for get_timespec64, put_timespec64
#include "linux/time32.h"               // for get_old_timespec32, put_old_t...
#include "linux/time64.h"               // for timespec64, timespec64_sub
#include "linux/time_types.h"           // for __kernel_old_timeval, __kerne...
#include "linux/types.h"                // for __poll_t, bool
#include "linux/wait.h"                 // for wait_queue_entry_t, add_wait_...
#include "vdso/time32.h"                // for old_timeval32
#include "vdso/time64.h"                // for NSEC_PER_MSEC, NSEC_PER_USEC

fs/select.c should remove these lines:
- #include <linux/compat.h>  // lines 18-18
- #include <linux/freezer.h>  // lines 32-32
- #include <linux/kernel.h>  // lines 19-19
- #include <linux/personality.h>  // lines 26-26
- #include <linux/vmalloc.h>  // lines 34-34

The full include-list for fs/select.c:
#include <asm/barrier.h>                // for smp_store_mb, smp_wmb
#include <asm/posix_types.h>            // for __kernel_long_t
#include <linux/export.h>               // for EXPORT_SYMBOL
#include <linux/fdtable.h>              // for fdtable, files_fdtable
#include <linux/file.h>                 // for fd, fdget, fdput, fput
#include <linux/fs.h>                   // for get_file
#include <linux/hrtimer.h>              // for schedule_hrtimeout_range, HRT...
#include <linux/ktime.h>                // for ktime_get_ts64
#include <linux/poll.h>                 // for poll_wqueues, poll_table, pol...
#include <linux/rcupdate.h>             // for rcu_read_lock, rcu_read_unlock
#include <linux/sched/rt.h>             // for rt_task
#include <linux/sched/signal.h>         // for signal_pending, set_user_sigmask
#include <linux/slab.h>                 // for kfree, kmalloc, kvfree, kvmalloc
#include <linux/syscalls.h>             // for __MAP5, __MAP1, __MAP3, __MAP6
#include <linux/uaccess.h>              // for copy_from_user, copy_to_user
#include <net/busy_poll.h>              // for busy_loop_current_time, busy_...
#include <stddef.h>                     // for NULL, size_t
#include <sys/select.h>                 // for fd_set, sigset_t
#include "asm-generic/bitsperlong.h"    // for BITS_PER_LONG
#include "asm-generic/errno-base.h"     // for EFAULT, EINVAL, ENOMEM, EBADF
#include "asm-generic/int-ll64.h"       // for u64
#include "asm-generic/poll.h"           // for pollfd, POLL_BUSY_LOOP
#include "asm-generic/resource.h"       // for RLIMIT_NOFILE
#include "asm/bug.h"                    // for BUG
#include "asm/current.h"                // for current
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/string_32.h"              // for memset
#include "asm/uaccess.h"                // for unsafe_get_user, unsafe_put_user
#include "asm/unistd.h"                 // for __ARCH_WANT_SYS_OLD_SELECT
#include "linux/compiler_attributes.h"  // for __must_check
#include "linux/compiler_types.h"       // for __user, inline
#include "linux/container_of.h"         // for container_of
#include "linux/errno.h"                // for ERESTARTNOHAND
#include "linux/eventpoll.h"            // for EPOLLNVAL, EPOLLERR, EPOLLHUP
#include "linux/gfp.h"                  // for GFP_KERNEL, __get_free_page
#include "linux/ktime.h"                // for timespec64_to_ktime, ktime_t
#include "linux/limits.h"               // for SIZE_MAX
#include "linux/minmax.h"               // for min, min_t
#include "linux/overflow.h"             // for struct_size
#include "linux/personality.h"          // for STICKY_TIMEOUTS
#include "linux/restart_block.h"        // for restart_block, restart_block:...
#include "linux/sched.h"                // for task_struct, need_resched
#include "linux/stddef.h"               // for false, true
#include "linux/thread_info.h"          // for set_restart_fn
#include "linux/time.h"                 // for get_timespec64, put_timespec64
#include "linux/time32.h"               // for get_old_timespec32, put_old_t...
#include "linux/time64.h"               // for timespec64, timespec64_sub
#include "linux/time_types.h"           // for __kernel_old_timeval, __kerne...
#include "linux/types.h"                // for __poll_t, bool
#include "linux/wait.h"                 // for wait_queue_entry_t, add_wait_...
#include "vdso/time32.h"                // for old_timeval32
#include "vdso/time64.h"                // for NSEC_PER_MSEC, NSEC_PER_USEC
---
  ./scripts/check-local-export fs/select.o
  iwyu2 -Wp,-MMD,fs/.dcache.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/dcache"' -DKBUILD_BASENAME='"dcache"' -DKBUILD_MODNAME='"dcache"' -D__KBUILD_MODNAME=kmod_dcache -c -o fs/dcache.o fs/dcache.c  
In file included from fs/dcache.c:23:
In file included from ./include/linux/fsnotify.h:16:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^
1 warning generated.
In file included from fs/dcache.c:23:
In file included from ./include/linux/fsnotify.h:16:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^

fs/dcache.c should add these lines:
#include <asm-generic/percpu.h>                // for this_cpu_dec, this_cpu...
#include <asm/barrier.h>                       // for smp_store_release, smp...
#include <asm/bug.h>                           // for WARN_ON, WARN_ON_ONCE
#include <asm/percpu.h>                        // for this_cpu_add_8
#include <linux/build_bug.h>                   // for unlikely, likely
#include <stddef.h>                            // for NULL, size_t
#include "asm-generic/errno-base.h"            // for ENOMEM, EBUSY, ENOENT
#include "asm-generic/errno.h"                 // for ESTALE, ELOOP
#include "asm-generic/int-ll64.h"              // for u64
#include "asm-generic/rwonce.h"                // for READ_ONCE, read_word_a...
#include "asm/cache.h"                         // for __read_mostly, L1_CACH...
#include "asm/current.h"                       // for current
#include "asm/percpu.h"                        // for __pcpu_op1_1, __pcpu_o...
#include "asm/string_32.h"                     // for memcpy
#include "asm/vdso/processor.h"                // for cpu_relax
#include "linux/align.h"                       // for IS_ALIGNED
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec_and_test
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/compiler_types.h"              // for inline, __releases
#include "linux/container_of.h"                // for container_of
#include "linux/dcache.h"                      // for dentry, d_lock, qstr
#include "linux/err.h"                         // for ERR_PTR, IS_ERR, ERR_CAST
#include "linux/fsnotify_backend.h"            // for fsnotify_update_flags
#include "linux/gfp.h"                         // for GFP_KERNEL, GFP_KERNEL...
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/kern_levels.h"                 // for KERN_ERR
#include "linux/kernel.h"                      // for sprintf, ARRAY_SIZE
#include "linux/kstrtox.h"                     // for simple_strtoul
#include "linux/limits.h"                      // for PATH_MAX
#include "linux/list.h"                        // for list_empty, INIT_LIST_...
#include "linux/list_bl.h"                     // for hlist_bl_node, hlist_b...
#include "linux/lockdep.h"                     // for spin_acquire, spin_rel...
#include "linux/lockref.h"                     // for lockref, lockref::(ano...
#include "linux/minmax.h"                      // for swap
#include "linux/mutex.h"                       // for mutex_trylock, mutex_u...
#include "linux/path.h"                        // for path
#include "linux/printk.h"                      // for pr_warn_ratelimited
#include "linux/rcupdate.h"                    // for rcu_read_unlock, rcu_r...
#include "linux/rwsem.h"                       // for down_read_trylock, up_...
#include "linux/sched.h"                       // for task_struct, need_resched
#include "linux/spinlock.h"                    // for spin_unlock, spin_lock
#include "linux/spinlock_types.h"              // for spinlock_t
#include "linux/stat.h"                        // for S_ISDIR, S_ISREG
#include "linux/stddef.h"                      // for false, true, offsetof
#include "linux/stringhash.h"                  // for full_name_hash, hashle...
#include "linux/types.h"                       // for bool, list_head, hlist...
#include "linux/wait.h"                        // for add_wait_queue, DECLAR...
#include "linux/wait_bit.h"                    // for wake_up_bit
struct shrink_control;

fs/dcache.c should remove these lines:
- #include <linux/bit_spinlock.h>  // lines 32-32
- #include <linux/mm.h>  // lines 20-20
- #include <linux/ratelimit.h>  // lines 18-18
- #include <linux/string.h>  // lines 19-19

The full include-list for fs/dcache.c:
#include <asm-generic/percpu.h>                // for this_cpu_dec, this_cpu...
#include <asm/barrier.h>                       // for smp_store_release, smp...
#include <asm/bug.h>                           // for WARN_ON, WARN_ON_ONCE
#include <asm/percpu.h>                        // for this_cpu_add_8
#include <asm/word-at-a-time.h>                // for load_unaligned_zeropad
#include <linux/build_bug.h>                   // for unlikely, likely
#include <linux/cache.h>                       // for __cacheline_aligned_in...
#include <linux/export.h>                      // for EXPORT_SYMBOL, EXPORT_...
#include <linux/fs.h>                          // for inode, inode::(anonymous)
#include <linux/fscrypt.h>                     // for fscrypt_handle_d_move
#include <linux/fsnotify.h>                    // for fsnotify_inoderemove
#include <linux/hash.h>                        // for hash_32
#include <linux/init.h>                        // for __init, __initdata
#include <linux/list_lru.h>                    // for LRU_REMOVED, list_lru_add
#include <linux/memblock.h>                    // for alloc_large_system_hash
#include <linux/rculist_bl.h>                  // for hlist_bl_add_head_rcu
#include <linux/security.h>                    // for security_d_instantiate
#include <linux/seqlock.h>                     // for __seqprop_mutex_ptr
#include <linux/slab.h>                        // for kmem_cache_free, kfree
#include <stddef.h>                            // for NULL, size_t
#include "asm-generic/errno-base.h"            // for ENOMEM, EBUSY, ENOENT
#include "asm-generic/errno.h"                 // for ESTALE, ELOOP
#include "asm-generic/int-ll64.h"              // for u64
#include "asm-generic/rwonce.h"                // for READ_ONCE, read_word_a...
#include "asm/cache.h"                         // for __read_mostly, L1_CACH...
#include "asm/current.h"                       // for current
#include "asm/percpu.h"                        // for __pcpu_op1_1, __pcpu_o...
#include "asm/string_32.h"                     // for memcpy
#include "asm/vdso/processor.h"                // for cpu_relax
#include "internal.h"                          // for bdev_cache_init, chrde...
#include "linux/align.h"                       // for IS_ALIGNED
#include "linux/atomic/atomic-instrumented.h"  // for atomic_dec_and_test
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/compiler_types.h"              // for inline, __releases
#include "linux/container_of.h"                // for container_of
#include "linux/dcache.h"                      // for dentry, d_lock, qstr
#include "linux/err.h"                         // for ERR_PTR, IS_ERR, ERR_CAST
#include "linux/fsnotify_backend.h"            // for fsnotify_update_flags
#include "linux/gfp.h"                         // for GFP_KERNEL, GFP_KERNEL...
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/kern_levels.h"                 // for KERN_ERR
#include "linux/kernel.h"                      // for sprintf, ARRAY_SIZE
#include "linux/kstrtox.h"                     // for simple_strtoul
#include "linux/limits.h"                      // for PATH_MAX
#include "linux/list.h"                        // for list_empty, INIT_LIST_...
#include "linux/list_bl.h"                     // for hlist_bl_node, hlist_b...
#include "linux/lockdep.h"                     // for spin_acquire, spin_rel...
#include "linux/lockref.h"                     // for lockref, lockref::(ano...
#include "linux/minmax.h"                      // for swap
#include "linux/mutex.h"                       // for mutex_trylock, mutex_u...
#include "linux/path.h"                        // for path
#include "linux/printk.h"                      // for pr_warn_ratelimited
#include "linux/rcupdate.h"                    // for rcu_read_unlock, rcu_r...
#include "linux/rwsem.h"                       // for down_read_trylock, up_...
#include "linux/sched.h"                       // for task_struct, need_resched
#include "linux/spinlock.h"                    // for spin_unlock, spin_lock
#include "linux/spinlock_types.h"              // for spinlock_t
#include "linux/stat.h"                        // for S_ISDIR, S_ISREG
#include "linux/stddef.h"                      // for false, true, offsetof
#include "linux/stringhash.h"                  // for full_name_hash, hashle...
#include "linux/types.h"                       // for bool, list_head, hlist...
#include "linux/wait.h"                        // for add_wait_queue, DECLAR...
#include "linux/wait_bit.h"                    // for wake_up_bit
#include "mount.h"                             // for __path_is_mountpoint
struct shrink_control;
---
  ./scripts/check-local-export fs/dcache.o
  iwyu2 -Wp,-MMD,fs/.inode.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/inode"' -DKBUILD_BASENAME='"inode"' -DKBUILD_MODNAME='"inode"' -D__KBUILD_MODNAME=kmod_inode -c -o fs/inode.o fs/inode.c  
In file included from fs/inode.c:9:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/inode.c:9:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/inode.c:9:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/inode.c:11:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from fs/inode.c:9:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/inode.c:9:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/inode.c:9:
In file included from ./include/linux/backing-dev.h:15:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/inode.c:11:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/inode.c should add these lines:
#include <asm-generic/percpu.h>                // for this_cpu_dec, DEFINE_P...
#include <asm/barrier.h>                       // for smp_mb
#include <asm/bug.h>                           // for BUG_ON, WARN_ON, WARN
#include <asm/percpu.h>                        // for this_cpu_add_8
#include <linux/ktime.h>                       // for ktime_get_coarse_real_...
#include <stddef.h>                            // for NULL
#include <sys/types.h>                         // for ino_t, dev_t
#include "asm-generic/errno-base.h"            // for EBUSY, ENOMEM, ENXIO
#include "asm-generic/errno.h"                 // for ESTALE
#include "asm-generic/rwonce.h"                // for READ_ONCE, WRITE_ONCE
#include "asm/cache.h"                         // for __read_mostly, L1_CACH...
#include "asm/current.h"                       // for current
#include "asm/percpu.h"                        // for __pcpu_op1_1, __pcpu_o...
#include "asm/processor.h"                     // for spin_lock_prefetch
#include "asm/string_32.h"                     // for memset
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_set
#include "linux/bitops.h"                      // for set_mask_bits
#include "linux/cache.h"                       // for __cacheline_aligned_in...
#include "linux/capability.h"                  // for capable, capable_wrt_i...
#include "linux/compiler.h"                    // for unlikely, likely
#include "linux/compiler_types.h"              // for inline
#include "linux/container_of.h"                // for container_of
#include "linux/cpumask.h"                     // for for_each_possible_cpu
#include "linux/cred.h"                        // for current_user_ns, in_gr...
#include "linux/dcache.h"                      // for d_inode, dentry, dentr...
#include "linux/err.h"                         // for IS_ERR, ERR_PTR
#include "linux/gfp.h"                         // for GFP_HIGHUSER_MOVABLE
#include "linux/init.h"                        // for __init, __initdata
#include "linux/kern_levels.h"                 // for KERN_DEBUG
#include "linux/kstrtox.h"                     // for simple_strtoul
#include "linux/list.h"                        // for list_empty, INIT_LIST_...
#include "linux/lockdep.h"                     // for lockdep_set_class, loc...
#include "linux/minmax.h"                      // for clamp, swap
#include "linux/pagemap.h"                     // for mapping_set_gfp_mask
#include "linux/path.h"                        // for path
#include "linux/printk.h"                      // for pr_warn, printk
#include "linux/rbtree_types.h"                // for RB_ROOT_CACHED
#include "linux/rculist.h"                     // for hlist_add_head_rcu
#include "linux/rcupdate.h"                    // for rcu_read_lock_held
#include "linux/rwsem.h"                       // for init_rwsem
#include "linux/sched.h"                       // for need_resched, schedule
#include "linux/slab.h"                        // for kmem_cache_create, kme...
#include "linux/spinlock.h"                    // for spin_unlock, spin_lock
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK, spinl...
#include "linux/stat.h"                        // for S_ISDIR, S_ISGID, S_IXGRP
#include "linux/stddef.h"                      // for false, true
#include "linux/time64.h"                      // for timespec64, timespec64...
#include "linux/types.h"                       // for hlist_head, list_head
#include "linux/uaccess.h"                     // for get_kernel_nofault
#include "linux/uidgid.h"                      // for kuid_has_mapping, uid_eq
#include "linux/vm_event_item.h"               // for KSWAPD_INODESTEAL, PGI...
#include "linux/vmstat.h"                      // for __count_vm_events
#include "linux/wait.h"                        // for finish_wait, prepare_t...
#include "linux/wait_bit.h"                    // for wake_up_bit, bit_waitq...
#include "linux/writeback.h"                   // for wait_on_inode, inode_d...
#include "linux/xarray.h"                      // for xa_init_flags, XA_FLAG...
#include "vdso/time64.h"                       // for NSEC_PER_SEC
struct shrink_control;
struct user_namespace;

fs/inode.c should remove these lines:
- #include <linux/backing-dev.h>  // lines 9-9
- #include <linux/ratelimit.h>  // lines 20-20

The full include-list for fs/inode.c:
#include <asm-generic/percpu.h>                // for this_cpu_dec, DEFINE_P...
#include <asm/barrier.h>                       // for smp_mb
#include <asm/bug.h>                           // for BUG_ON, WARN_ON, WARN
#include <asm/percpu.h>                        // for this_cpu_add_8
#include <linux/buffer_head.h>                 // for inode_has_buffers, rem...
#include <linux/cdev.h>                        // for cd_forget
#include <linux/export.h>                      // for EXPORT_SYMBOL, EXPORT_...
#include <linux/fs.h>                          // for inode, super_block
#include <linux/fsnotify.h>                    // for fsnotify_inode_delete
#include <linux/hash.h>                        // for GOLDEN_RATIO_PRIME
#include <linux/iversion.h>                    // for inode_iversion_need_inc
#include <linux/ktime.h>                       // for ktime_get_coarse_real_...
#include <linux/list_lru.h>                    // for list_lru_add, list_lru...
#include <linux/memblock.h>                    // for alloc_large_system_hash
#include <linux/mm.h>                          // for truncate_inode_pages_f...
#include <linux/mount.h>                       // for __mnt_drop_write, __mn...
#include <linux/security.h>                    // for security_inode_alloc
#include <linux/swap.h>                        // for current_is_kswapd, rec...
#include <stddef.h>                            // for NULL
#include <sys/types.h>                         // for ino_t, dev_t
#include <trace/events/writeback.h>            // for trace_writeback_lazyti...
#include "asm-generic/errno-base.h"            // for EBUSY, ENOMEM, ENXIO
#include "asm-generic/errno.h"                 // for ESTALE
#include "asm-generic/rwonce.h"                // for READ_ONCE, WRITE_ONCE
#include "asm/cache.h"                         // for __read_mostly, L1_CACH...
#include "asm/current.h"                       // for current
#include "asm/percpu.h"                        // for __pcpu_op1_1, __pcpu_o...
#include "asm/processor.h"                     // for spin_lock_prefetch
#include "asm/string_32.h"                     // for memset
#include "internal.h"                          // for __mnt_drop_write_file
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_set
#include "linux/bitops.h"                      // for set_mask_bits
#include "linux/cache.h"                       // for __cacheline_aligned_in...
#include "linux/capability.h"                  // for capable, capable_wrt_i...
#include "linux/compiler.h"                    // for unlikely, likely
#include "linux/compiler_types.h"              // for inline
#include "linux/container_of.h"                // for container_of
#include "linux/cpumask.h"                     // for for_each_possible_cpu
#include "linux/cred.h"                        // for current_user_ns, in_gr...
#include "linux/dcache.h"                      // for d_inode, dentry, dentr...
#include "linux/err.h"                         // for IS_ERR, ERR_PTR
#include "linux/gfp.h"                         // for GFP_HIGHUSER_MOVABLE
#include "linux/init.h"                        // for __init, __initdata
#include "linux/kern_levels.h"                 // for KERN_DEBUG
#include "linux/kstrtox.h"                     // for simple_strtoul
#include "linux/list.h"                        // for list_empty, INIT_LIST_...
#include "linux/lockdep.h"                     // for lockdep_set_class, loc...
#include "linux/minmax.h"                      // for clamp, swap
#include "linux/pagemap.h"                     // for mapping_set_gfp_mask
#include "linux/path.h"                        // for path
#include "linux/printk.h"                      // for pr_warn, printk
#include "linux/rbtree_types.h"                // for RB_ROOT_CACHED
#include "linux/rculist.h"                     // for hlist_add_head_rcu
#include "linux/rcupdate.h"                    // for rcu_read_lock_held
#include "linux/rwsem.h"                       // for init_rwsem
#include "linux/sched.h"                       // for need_resched, schedule
#include "linux/slab.h"                        // for kmem_cache_create, kme...
#include "linux/spinlock.h"                    // for spin_unlock, spin_lock
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK, spinl...
#include "linux/stat.h"                        // for S_ISDIR, S_ISGID, S_IXGRP
#include "linux/stddef.h"                      // for false, true
#include "linux/time64.h"                      // for timespec64, timespec64...
#include "linux/types.h"                       // for hlist_head, list_head
#include "linux/uaccess.h"                     // for get_kernel_nofault
#include "linux/uidgid.h"                      // for kuid_has_mapping, uid_eq
#include "linux/vm_event_item.h"               // for KSWAPD_INODESTEAL, PGI...
#include "linux/vmstat.h"                      // for __count_vm_events
#include "linux/wait.h"                        // for finish_wait, prepare_t...
#include "linux/wait_bit.h"                    // for wake_up_bit, bit_waitq...
#include "linux/writeback.h"                   // for wait_on_inode, inode_d...
#include "linux/xarray.h"                      // for xa_init_flags, XA_FLAG...
#include "vdso/time64.h"                       // for NSEC_PER_SEC
struct shrink_control;
struct user_namespace;
---
  ./scripts/check-local-export fs/inode.o
  iwyu2 -Wp,-MMD,fs/.attr.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/attr"' -DKBUILD_BASENAME='"attr"' -DKBUILD_MODNAME='"attr"' -D__KBUILD_MODNAME=kmod_attr -c -o fs/attr.o fs/attr.c  
In file included from fs/attr.c:15:
In file included from ./include/linux/fsnotify.h:16:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^
1 warning generated.
In file included from fs/attr.c:15:
In file included from ./include/linux/fsnotify.h:16:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^

fs/attr.c should add these lines:
#include <asm/bug.h>                 // for WARN_ON_ONCE
#include <asm/signal.h>              // for SIGXFSZ
#include "asm-generic/errno-base.h"  // for EPERM, EFBIG, ETXTBSY
#include "asm-generic/errno.h"       // for EOVERFLOW
#include "asm-generic/resource.h"    // for RLIMIT_FSIZE, RLIM_INFINITY
#include "asm/bug.h"                 // for BUG
#include "asm/current.h"             // for current
#include "linux/capability.h"        // for CAP_CHOWN, CAP_FSETID
#include "linux/cred.h"              // for in_group_p, cred, current_fsuid
#include "linux/dcache.h"            // for d_inode, dentry
#include "linux/fs.h"                // for iattr, inode, i_gid_into_mnt
#include "linux/mnt_idmapping.h"     // for mapped_kgid_fs
#include "linux/sched.h"             // for task_struct
#include "linux/stat.h"              // for S_ISGID, S_ISUID, S_IXGRP
#include "linux/stddef.h"            // for true, false
#include "linux/time64.h"            // for timespec64
#include "linux/types.h"             // for umode_t, bool, loff_t
#include "linux/uidgid.h"            // for uid_eq, gid_eq, kgid_t, gid_valid
struct user_namespace;

fs/attr.c should remove these lines:
- #include <linux/fcntl.h>  // lines 16-16
- #include <linux/mm.h>  // lines 11-11
- #include <linux/string.h>  // lines 12-12
- #include <linux/time.h>  // lines 10-10

The full include-list for fs/attr.c:
#include <asm/bug.h>                 // for WARN_ON_ONCE
#include <asm/signal.h>              // for SIGXFSZ
#include <linux/capability.h>        // for capable_wrt_inode_uidgid, ns_cap...
#include <linux/evm.h>               // for evm_inode_post_setattr
#include <linux/export.h>            // for EXPORT_SYMBOL
#include <linux/fsnotify.h>          // for fsnotify_change
#include <linux/ima.h>               // for ima_inode_post_setattr
#include <linux/sched/signal.h>      // for rlimit, send_sig
#include <linux/security.h>          // for security_inode_killpriv, securit...
#include "asm-generic/errno-base.h"  // for EPERM, EFBIG, ETXTBSY
#include "asm-generic/errno.h"       // for EOVERFLOW
#include "asm-generic/resource.h"    // for RLIMIT_FSIZE, RLIM_INFINITY
#include "asm/bug.h"                 // for BUG
#include "asm/current.h"             // for current
#include "linux/capability.h"        // for CAP_CHOWN, CAP_FSETID
#include "linux/cred.h"              // for in_group_p, cred, current_fsuid
#include "linux/dcache.h"            // for d_inode, dentry
#include "linux/fs.h"                // for iattr, inode, i_gid_into_mnt
#include "linux/mnt_idmapping.h"     // for mapped_kgid_fs
#include "linux/sched.h"             // for task_struct
#include "linux/stat.h"              // for S_ISGID, S_ISUID, S_IXGRP
#include "linux/stddef.h"            // for true, false
#include "linux/time64.h"            // for timespec64
#include "linux/types.h"             // for umode_t, bool, loff_t
#include "linux/uidgid.h"            // for uid_eq, gid_eq, kgid_t, gid_valid
struct user_namespace;
---
  ./scripts/check-local-export fs/attr.o
  iwyu2 -Wp,-MMD,fs/.bad_inode.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/bad_inode"' -DKBUILD_BASENAME='"bad_inode"' -DKBUILD_MODNAME='"bad_inode"' -D__KBUILD_MODNAME=kmod_bad_inode -c -o fs/bad_inode.o fs/bad_inode.c  

fs/bad_inode.c should add these lines:
#include <sys/types.h>               // for dev_t, size_t, ssize_t
#include "asm-generic/errno-base.h"  // for EIO
#include "asm-generic/int-ll64.h"    // for u64, u32
#include "linux/compiler_types.h"    // for __user
#include "linux/err.h"               // for ERR_PTR
#include "linux/stat.h"              // for S_IFREG
#include "linux/types.h"             // for umode_t, bool
struct delayed_call;
struct dentry;
struct fiemap_extent_info;
struct kstat;
struct path;
struct posix_acl;
struct timespec64;
struct user_namespace;

fs/bad_inode.c should remove these lines:
- #include <linux/fiemap.h>  // lines 18-18
- #include <linux/namei.h>  // lines 16-16
- #include <linux/poll.h>  // lines 17-17
- #include <linux/stat.h>  // lines 14-14
- #include <linux/time.h>  // lines 15-15

The full include-list for fs/bad_inode.c:
#include <linux/export.h>            // for EXPORT_SYMBOL
#include <linux/fs.h>                // for inode, current_time, iput, remov...
#include <sys/types.h>               // for dev_t, size_t, ssize_t
#include "asm-generic/errno-base.h"  // for EIO
#include "asm-generic/int-ll64.h"    // for u64, u32
#include "linux/compiler_types.h"    // for __user
#include "linux/err.h"               // for ERR_PTR
#include "linux/stat.h"              // for S_IFREG
#include "linux/types.h"             // for umode_t, bool
struct delayed_call;
struct dentry;
struct fiemap_extent_info;
struct kstat;
struct path;
struct posix_acl;
struct timespec64;
struct user_namespace;
---
  ./scripts/check-local-export fs/bad_inode.o
  iwyu2 -Wp,-MMD,fs/.file.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/file"' -DKBUILD_BASENAME='"file"' -DKBUILD_MODNAME='"file"' -D__KBUILD_MODNAME=kmod_file -c -o fs/file.o fs/file.c  
In file included from fs/file.c:10:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/file.c:10:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/file.c:10:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/file.c:10:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from fs/file.c:23:
In file included from ./include/net/sock.h:46:
In file included from ./include/linux/netdevice.h:38:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from fs/file.c:23:
In file included from ./include/net/sock.h:46:
./include/linux/netdevice.h:1243:17: warning: declaration of 'struct rtnl_link_stats64' will not be visible outside of this function [-Wvisibility]
                                                   struct rtnl_link_stats64 *storage);
                                                          ^
./include/linux/netdevice.h:1268:19: warning: declaration of 'struct ifla_vf_info' will not be visible outside of this function [-Wvisibility]
                                                     struct ifla_vf_info *ivf);
                                                            ^
./include/linux/netdevice.h:1273:18: warning: declaration of 'struct ifla_vf_stats' will not be visible outside of this function [-Wvisibility]
                                                    struct ifla_vf_stats
                                                           ^
./include/linux/netdevice.h:1282:17: warning: declaration of 'struct ifla_vf_guid' will not be visible outside of this function [-Wvisibility]
                                                   struct ifla_vf_guid *node_guid,
                                                          ^
9 warnings generated.
In file included from fs/file.c:10:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/file.c:10:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/file.c:10:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/file.c:10:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from fs/file.c:23:
In file included from ./include/net/sock.h:46:
In file included from ./include/linux/netdevice.h:38:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from fs/file.c:23:
In file included from ./include/net/sock.h:46:
./include/linux/netdevice.h:1243:17: warning: declaration of 'struct rtnl_link_stats64' will not be visible outside of this function [-Wvisibility]
                                                   struct rtnl_link_stats64 *storage);
                                                          ^
./include/linux/netdevice.h:1268:19: warning: declaration of 'struct ifla_vf_info' will not be visible outside of this function [-Wvisibility]
                                                     struct ifla_vf_info *ivf);
                                                            ^
./include/linux/netdevice.h:1273:18: warning: declaration of 'struct ifla_vf_stats' will not be visible outside of this function [-Wvisibility]
                                                    struct ifla_vf_stats
                                                           ^
./include/linux/netdevice.h:1282:17: warning: declaration of 'struct ifla_vf_guid' will not be visible outside of this function [-Wvisibility]
                                                   struct ifla_vf_guid *node_guid,
                                                          ^

fs/file.c should add these lines:
#include <asm/barrier.h>                       // for smp_rmb, smp_wmb
#include <asm/bitops.h>                        // for __clear_bit, __set_bit
#include <asm/bug.h>                           // for BUG_ON
#include <linux/bitmap.h>                      // for find_next_zero_bit
#include <stddef.h>                            // for NULL, size_t
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm-generic/errno-base.h"            // for EBADF, EINVAL, EMFILE
#include "asm-generic/fcntl.h"                 // for O_CLOEXEC
#include "asm-generic/resource.h"              // for RLIMIT_NOFILE
#include "asm/cache.h"                         // for L1_CACHE_BYTES, __read...
#include "asm/cmpxchg.h"                       // for __xchg_wrong_size
#include "asm/current.h"                       // for current
#include "asm/ptrace.h"                        // for pt_regs
#include "asm/string_32.h"                     // for memset, memcpy
#include "asm/uaccess.h"                       // for put_user
#include "linux/align.h"                       // for ALIGN
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_de...
#include "linux/bitmap.h"                      // for bitmap_set
#include "linux/bits.h"                        // for BITS_PER_BYTE
#include "linux/compiler.h"                    // for unlikely
#include "linux/compiler_types.h"              // for inline, __releases
#include "linux/container_of.h"                // for container_of
#include "linux/gfp.h"                         // for GFP_KERNEL_ACCOUNT
#include "linux/kern_levels.h"                 // for KERN_WARNING
#include "linux/log2.h"                        // for roundup_pow_of_two
#include "linux/minmax.h"                      // for min, max_t, swap
#include "linux/mutex.h"                       // for mutex_lock, mutex_unlock
#include "linux/nospec.h"                      // for array_index_nospec
#include "linux/printk.h"                      // for printk
#include "linux/sched.h"                       // for task_struct, cond_resched
#include "linux/sched/task.h"                  // for task_lock, task_unlock
#include "linux/security.h"                    // for security_file_receive
#include "linux/spinlock_types.h"              // for __SPIN_LOCK_UNLOCKED
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for fmode_t, bool, ATOMIC_...
#include "linux/wait.h"                        // for wait_queue_head_t, __W...
#include "vdso/limits.h"                       // for INT_MAX

fs/file.c should remove these lines:
- #include <linux/kernel.h>  // lines 13-13
- #include <linux/mm.h>  // lines 14-14

The full include-list for fs/file.c:
#include <asm/barrier.h>                       // for smp_rmb, smp_wmb
#include <asm/bitops.h>                        // for __clear_bit, __set_bit
#include <asm/bug.h>                           // for BUG_ON
#include <linux/bitmap.h>                      // for find_next_zero_bit
#include <linux/bitops.h>                      // for BITS_TO_LONGS
#include <linux/close_range.h>                 // for CLOSE_RANGE_CLOEXEC
#include <linux/export.h>                      // for EXPORT_SYMBOL, EXPORT_...
#include <linux/fdtable.h>                     // for fdtable, files_struct
#include <linux/file.h>                        // for fput, FDPUT_FPUT, FDPU...
#include <linux/fs.h>                          // for filp_close, get_file
#include <linux/rcupdate.h>                    // for rcu_read_lock, rcu_rea...
#include <linux/sched/signal.h>                // for rlimit
#include <linux/slab.h>                        // for kvfree, kfree, kmem_ca...
#include <linux/spinlock.h>                    // for spin_unlock, spin_lock
#include <linux/syscalls.h>                    // for __MAP1, __MAP2, __MAP3
#include <net/sock.h>                          // for __receive_sock
#include <stddef.h>                            // for NULL, size_t
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm-generic/errno-base.h"            // for EBADF, EINVAL, EMFILE
#include "asm-generic/fcntl.h"                 // for O_CLOEXEC
#include "asm-generic/resource.h"              // for RLIMIT_NOFILE
#include "asm/cache.h"                         // for L1_CACHE_BYTES, __read...
#include "asm/cmpxchg.h"                       // for __xchg_wrong_size
#include "asm/current.h"                       // for current
#include "asm/ptrace.h"                        // for pt_regs
#include "asm/string_32.h"                     // for memset, memcpy
#include "asm/uaccess.h"                       // for put_user
#include "internal.h"                          // for __close_fd_get_file
#include "linux/align.h"                       // for ALIGN
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_de...
#include "linux/bitmap.h"                      // for bitmap_set
#include "linux/bits.h"                        // for BITS_PER_BYTE
#include "linux/compiler.h"                    // for unlikely
#include "linux/compiler_types.h"              // for inline, __releases
#include "linux/container_of.h"                // for container_of
#include "linux/gfp.h"                         // for GFP_KERNEL_ACCOUNT
#include "linux/kern_levels.h"                 // for KERN_WARNING
#include "linux/log2.h"                        // for roundup_pow_of_two
#include "linux/minmax.h"                      // for min, max_t, swap
#include "linux/mutex.h"                       // for mutex_lock, mutex_unlock
#include "linux/nospec.h"                      // for array_index_nospec
#include "linux/printk.h"                      // for printk
#include "linux/sched.h"                       // for task_struct, cond_resched
#include "linux/sched/task.h"                  // for task_lock, task_unlock
#include "linux/security.h"                    // for security_file_receive
#include "linux/spinlock_types.h"              // for __SPIN_LOCK_UNLOCKED
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for fmode_t, bool, ATOMIC_...
#include "linux/wait.h"                        // for wait_queue_head_t, __W...
#include "vdso/limits.h"                       // for INT_MAX
---
  ./scripts/check-local-export fs/file.o
  iwyu2 -Wp,-MMD,fs/.filesystems.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/filesystems"' -DKBUILD_BASENAME='"filesystems"' -DKBUILD_MODNAME='"filesystems"' -D__KBUILD_MODNAME=kmod_filesystems -c -o fs/filesystems.o fs/filesystems.c  
In file included from fs/filesystems.c:10:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/filesystems.c:10:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/filesystems.c:10:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/filesystems.c:10:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from fs/filesystems.c:10:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/filesystems.c:10:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/filesystems.c:10:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/filesystems.c:10:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/filesystems.c should add these lines:
#include <asm/bug.h>                 // for BUG_ON
#include <linux/spinlock.h>          // for write_unlock, read_lock, read_un...
#include <linux/spinlock_types.h>    // for DEFINE_RWLOCK
#include <stddef.h>                  // for NULL, size_t
#include "asm-generic/errno-base.h"  // for EBUSY, EINVAL
#include "asm/string_32.h"           // for strlen, strchr, strncmp, memcpy
#include "linux/export.h"            // for EXPORT_SYMBOL
#include "linux/printk.h"            // for pr_warn, pr_warn_once
#include "linux/rcupdate.h"          // for synchronize_rcu

fs/filesystems.c should remove these lines:
- #include <linux/proc_fs.h>  // lines 12-12
- #include <linux/seq_file.h>  // lines 13-13
- #include <linux/slab.h>  // lines 17-17
- #include <linux/syscalls.h>  // lines 10-10
- #include <linux/uaccess.h>  // lines 18-18

The full include-list for fs/filesystems.c:
#include <asm/bug.h>                 // for BUG_ON
#include <linux/fs.h>                // for file_system_type, FS_HAS_SUBTYPE
#include <linux/fs_parser.h>         // for fs_validate_description
#include <linux/init.h>              // for __init
#include <linux/kmod.h>              // for request_module
#include <linux/module.h>            // for __module_get, module_put, try_mo...
#include <linux/spinlock.h>          // for write_unlock, read_lock, read_un...
#include <linux/spinlock_types.h>    // for DEFINE_RWLOCK
#include <stddef.h>                  // for NULL, size_t
#include "asm-generic/errno-base.h"  // for EBUSY, EINVAL
#include "asm/string_32.h"           // for strlen, strchr, strncmp, memcpy
#include "linux/export.h"            // for EXPORT_SYMBOL
#include "linux/printk.h"            // for pr_warn, pr_warn_once
#include "linux/rcupdate.h"          // for synchronize_rcu
---
  ./scripts/check-local-export fs/filesystems.o
  iwyu2 -Wp,-MMD,fs/.namespace.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/namespace"' -DKBUILD_BASENAME='"namespace"' -DKBUILD_MODNAME='"namespace"' -D__KBUILD_MODNAME=kmod_namespace -c -o fs/namespace.o fs/namespace.c  
In file included from fs/namespace.c:11:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/namespace.c:11:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/namespace.c:11:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/namespace.c:11:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from fs/namespace.c:11:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/namespace.c:11:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/namespace.c:11:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/namespace.c:11:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/namespace.c should add these lines:
#include <asm/barrier.h>                       // for smp_mb, smp_rmb, smp_wmb
#include <asm/bug.h>                           // for BUG_ON, WARN_ON, WARN_...
#include <linux/ktime.h>                       // for ktime_get_real_seconds
#include <linux/rcupdate.h>                    // for synchronize_rcu_expedited
#include <stddef.h>                            // for NULL, size_t
#include "asm-generic/bitops/const_hweight.h"  // for hweight32
#include "asm-generic/errno-base.h"            // for EINVAL, EPERM, EBUSY
#include "asm-generic/errno.h"                 // for ELOOP
#include "asm-generic/fcntl.h"                 // for O_CLOEXEC, O_PATH
#include "asm-generic/int-ll64.h"              // for u64
#include "asm-generic/rwonce.h"                // for READ_ONCE, WRITE_ONCE
#include "asm/atomic64_32.h"                   // for ATOMIC64_INIT, atomic64_t
#include "asm/cache.h"                         // for __read_mostly, L1_CACH...
#include "asm/cmpxchg.h"                       // for __xchg_wrong_size
#include "asm/current.h"                       // for current
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/ptrace.h"                        // for pt_regs
#include "asm/string_32.h"                     // for strlen, strchr
#include "asm/uaccess.h"                       // for get_user
#include "asm/unistd.h"                        // for __ARCH_WANT_SYS_OLDUMOUNT
#include "asm/vdso/processor.h"                // for cpu_relax
#include "linux/atomic/atomic-instrumented.h"  // for atomic_inc, atomic_lon...
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/cache.h"                       // for __cacheline_aligned_in...
#include "linux/capability.h"                  // for CAP_SYS_ADMIN, CAP_SYS...
#include "linux/compiler.h"                    // for unlikely, likely
#include "linux/compiler_types.h"              // for __user, inline, __late...
#include "linux/container_of.h"                // for container_of
#include "linux/dcache.h"                      // for dentry, dget, d_is_dir
#include "linux/err.h"                         // for IS_ERR, ERR_PTR, PTR_ERR
#include "linux/fcntl.h"                       // for AT_RECURSIVE, AT_EMPTY...
#include "linux/fs.h"                          // for super_block, inode_unlock
#include "linux/gfp.h"                         // for GFP_KERNEL, GFP_KERNEL...
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/kern_levels.h"                 // for KERN_WARNING
#include "linux/kernfs.h"                      // for kernfs_init
#include "linux/kobject.h"                     // for kobject_create_and_add
#include "linux/kstrtox.h"                     // for simple_strtoul
#include "linux/limits.h"                      // for PATH_MAX
#include "linux/list.h"                        // for list_empty, INIT_LIST_...
#include "linux/llist.h"                       // for llist_add, llist_del_all
#include "linux/lockdep.h"                     // for might_lock
#include "linux/log2.h"                        // for is_power_of_2
#include "linux/mount.h"                       // for vfsmount, MNT_LOCKED
#include "linux/mutex.h"                       // for mutex_lock_interruptible
#include "linux/ns_common.h"                   // for ns_common
#include "linux/nsproxy.h"                     // for nsproxy, nsset
#include "linux/panic.h"                       // for panic
#include "linux/path.h"                        // for path, path_put, path_e...
#include "linux/preempt.h"                     // for preempt_disable, preem...
#include "linux/printk.h"                      // for pr_warn, printk, pr_wa...
#include "linux/rculist.h"                     // for hlist_del_init_rcu
#include "linux/rcupdate.h"                    // for rcu_read_unlock, rcu_r...
#include "linux/refcount.h"                    // for refcount_dec_and_test
#include "linux/rwsem.h"                       // for up_read, down_read
#include "linux/sched.h"                       // for task_struct, CLONE_NEWNS
#include "linux/seqlock.h"                     // for read_seqlock_excl, rea...
#include "linux/slab.h"                        // for kfree, kmalloc, kmem_c...
#include "linux/spinlock.h"                    // for spin_lock, spin_unlock
#include "linux/stddef.h"                      // for false, true
#include "linux/string.h"                      // for kfree_const, kstrdup_c...
#include "linux/sysfs.h"                       // for sysfs_init
#include "linux/time.h"                        // for time64_to_tm, tm
#include "linux/time64.h"                      // for TIME_UPTIME_SEC_MAX
#include "linux/types.h"                       // for list_head, bool, hlist...
#include "linux/wait.h"                        // for wake_up_interruptible
#include "linux/workqueue.h"                   // for work_struct, schedule_...
#include "mount.h"                             // for mount, real_mount, mnt...
#include "vdso/limits.h"                       // for INT_MAX

fs/namespace.c should remove these lines:
- #include <linux/magic.h>  // lines 26-26

The full include-list for fs/namespace.c:
#include <asm/barrier.h>                       // for smp_mb, smp_rmb, smp_wmb
#include <asm/bug.h>                           // for BUG_ON, WARN_ON, WARN_...
#include <linux/capability.h>                  // for ns_capable, capable
#include <linux/cred.h>                        // for cred, current_cred
#include <linux/export.h>                      // for EXPORT_SYMBOL, EXPORT_...
#include <linux/file.h>                        // for fd_install, fput, get_...
#include <linux/fs_context.h>                  // for fs_context, put_fs_con...
#include <linux/fs_struct.h>                   // for fs_struct, get_fs_root
#include <linux/fsnotify.h>                    // for fsnotify_vfsmount_delete
#include <linux/idr.h>                         // for ida_free, ida_alloc
#include <linux/init.h>                        // for __init, init_rootfs
#include <linux/ktime.h>                       // for ktime_get_real_seconds
#include <linux/memblock.h>                    // for alloc_large_system_hash
#include <linux/mnt_idmapping.h>               // for initial_idmapping
#include <linux/mnt_namespace.h>               // for copy_mnt_ns, from_mnt_ns
#include <linux/namei.h>                       // for user_path_at, LOOKUP_F...
#include <linux/proc_fs.h>                     // for proc_ns_file
#include <linux/proc_ns.h>                     // for ns_alloc_inum, get_pro...
#include <linux/rcupdate.h>                    // for synchronize_rcu_expedited
#include <linux/sched/task.h>                  // for task_lock, task_unlock
#include <linux/security.h>                    // for security_move_mount
#include <linux/shmem_fs.h>                    // for shmem_init
#include <linux/syscalls.h>                    // for __MAP5, __MAP2, __MAP3
#include <linux/task_work.h>                   // for init_task_work, task_w...
#include <linux/uaccess.h>                     // for copy_from_user, copy_s...
#include <linux/user_namespace.h>              // for get_user_ns, put_user_ns
#include <stddef.h>                            // for NULL, size_t
#include <uapi/linux/mount.h>                  // for mount_attr, MOUNT_ATTR...
#include "asm-generic/bitops/const_hweight.h"  // for hweight32
#include "asm-generic/errno-base.h"            // for EINVAL, EPERM, EBUSY
#include "asm-generic/errno.h"                 // for ELOOP
#include "asm-generic/fcntl.h"                 // for O_CLOEXEC, O_PATH
#include "asm-generic/int-ll64.h"              // for u64
#include "asm-generic/rwonce.h"                // for READ_ONCE, WRITE_ONCE
#include "asm/atomic64_32.h"                   // for ATOMIC64_INIT, atomic64_t
#include "asm/cache.h"                         // for __read_mostly, L1_CACH...
#include "asm/cmpxchg.h"                       // for __xchg_wrong_size
#include "asm/current.h"                       // for current
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/ptrace.h"                        // for pt_regs
#include "asm/string_32.h"                     // for strlen, strchr
#include "asm/uaccess.h"                       // for get_user
#include "asm/unistd.h"                        // for __ARCH_WANT_SYS_OLDUMOUNT
#include "asm/vdso/processor.h"                // for cpu_relax
#include "internal.h"                          // for parse_monolithic_mount...
#include "linux/atomic/atomic-instrumented.h"  // for atomic_inc, atomic_lon...
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/cache.h"                       // for __cacheline_aligned_in...
#include "linux/capability.h"                  // for CAP_SYS_ADMIN, CAP_SYS...
#include "linux/compiler.h"                    // for unlikely, likely
#include "linux/compiler_types.h"              // for __user, inline, __late...
#include "linux/container_of.h"                // for container_of
#include "linux/dcache.h"                      // for dentry, dget, d_is_dir
#include "linux/err.h"                         // for IS_ERR, ERR_PTR, PTR_ERR
#include "linux/fcntl.h"                       // for AT_RECURSIVE, AT_EMPTY...
#include "linux/fs.h"                          // for super_block, inode_unlock
#include "linux/gfp.h"                         // for GFP_KERNEL, GFP_KERNEL...
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/kern_levels.h"                 // for KERN_WARNING
#include "linux/kernfs.h"                      // for kernfs_init
#include "linux/kobject.h"                     // for kobject_create_and_add
#include "linux/kstrtox.h"                     // for simple_strtoul
#include "linux/limits.h"                      // for PATH_MAX
#include "linux/list.h"                        // for list_empty, INIT_LIST_...
#include "linux/llist.h"                       // for llist_add, llist_del_all
#include "linux/lockdep.h"                     // for might_lock
#include "linux/log2.h"                        // for is_power_of_2
#include "linux/mount.h"                       // for vfsmount, MNT_LOCKED
#include "linux/mutex.h"                       // for mutex_lock_interruptible
#include "linux/ns_common.h"                   // for ns_common
#include "linux/nsproxy.h"                     // for nsproxy, nsset
#include "linux/panic.h"                       // for panic
#include "linux/path.h"                        // for path, path_put, path_e...
#include "linux/preempt.h"                     // for preempt_disable, preem...
#include "linux/printk.h"                      // for pr_warn, printk, pr_wa...
#include "linux/rculist.h"                     // for hlist_del_init_rcu
#include "linux/rcupdate.h"                    // for rcu_read_unlock, rcu_r...
#include "linux/refcount.h"                    // for refcount_dec_and_test
#include "linux/rwsem.h"                       // for up_read, down_read
#include "linux/sched.h"                       // for task_struct, CLONE_NEWNS
#include "linux/seqlock.h"                     // for read_seqlock_excl, rea...
#include "linux/slab.h"                        // for kfree, kmalloc, kmem_c...
#include "linux/spinlock.h"                    // for spin_lock, spin_unlock
#include "linux/stddef.h"                      // for false, true
#include "linux/string.h"                      // for kfree_const, kstrdup_c...
#include "linux/sysfs.h"                       // for sysfs_init
#include "linux/time.h"                        // for time64_to_tm, tm
#include "linux/time64.h"                      // for TIME_UPTIME_SEC_MAX
#include "linux/types.h"                       // for list_head, bool, hlist...
#include "linux/wait.h"                        // for wake_up_interruptible
#include "linux/workqueue.h"                   // for work_struct, schedule_...
#include "mount.h"                             // for mount, real_mount, mnt...
#include "pnode.h"                             // for IS_MNT_SHARED, propaga...
#include "vdso/limits.h"                       // for INT_MAX
---
  ./scripts/check-local-export fs/namespace.o
  iwyu2 -Wp,-MMD,fs/.seq_file.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/seq_file"' -DKBUILD_BASENAME='"seq_file"' -DKBUILD_MODNAME='"seq_file"' -D__KBUILD_MODNAME=kmod_seq_file -c -o fs/seq_file.o fs/seq_file.c  

fs/seq_file.c should add these lines:
#include <asm-generic/percpu.h>         // for per_cpu_ptr
#include <asm/bug.h>                    // for WARN_ON
#include <cstdio>                       // for NULL, size_t, ssize_t, va_list
#include "asm-generic/errno-base.h"     // for ENOMEM, EAGAIN, EFAULT, EINVAL
#include "asm-generic/errno.h"          // for ENAMETOOLONG
#include "asm-generic/int-ll64.h"       // for u8
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/string_32.h"              // for strchr, strlen, memcpy, memset
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for __percpu, __user
#include "linux/cpumask.h"              // for cpumask_next, cpu_possible_mask
#include "linux/dcache.h"               // for __d_path, d_path, dentry_path
#include "linux/err.h"                  // for IS_ERR, PTR_ERR
#include "linux/fs.h"                   // for file (ptr only), inode (ptr o...
#include "linux/gfp.h"                  // for GFP_KERNEL_ACCOUNT, GFP_KERNEL
#include "linux/init.h"                 // for __init
#include "linux/kernel.h"               // for num_to_str, vsnprintf, READ
#include "linux/list.h"                 // for hlist_empty, hlist_for_each
#include "linux/minmax.h"               // for min
#include "linux/mutex.h"                // for mutex_lock, mutex_unlock, mut...
#include "linux/rculist.h"              // for __hlist_for_each_rcu, list_ne...
#include "linux/rcupdate.h"             // for rcu_dereference
#include "linux/stdarg.h"               // for va_end, va_start
#include "linux/types.h"                // for loff_t, hlist_node, hlist_head
#include "linux/uio.h"                  // for iov_iter (ptr only), iovec
struct path;

fs/seq_file.c should remove these lines:
- #include <asm/page.h>  // lines 24-24
- #include <linux/cred.h>  // lines 17-17
- #include <linux/mm.h>  // lines 18-18
- #include <linux/uaccess.h>  // lines 23-23
- #include <linux/vmalloc.h>  // lines 15-15

The full include-list for fs/seq_file.c:
#include <asm-generic/percpu.h>         // for per_cpu_ptr
#include <asm/bug.h>                    // for WARN_ON
#include <linux/cache.h>                // for __ro_after_init
#include <linux/export.h>               // for EXPORT_SYMBOL
#include <linux/fs.h>                   // for file, kiocb, init_sync_kiocb
#include <linux/printk.h>               // for hex_dump_to_buffer, DUMP_PREF...
#include <linux/seq_file.h>             // for seq_file, seq_operations, seq...
#include <linux/slab.h>                 // for kfree, kvfree, kmalloc, kmem_...
#include <linux/string_helpers.h>       // for string_escape_mem
#include <linux/uio.h>                  // for copy_to_iter, iov_iter_count
#include <cstdio>                       // for NULL, size_t, ssize_t, va_list
#include "asm-generic/errno-base.h"     // for ENOMEM, EAGAIN, EFAULT, EINVAL
#include "asm-generic/errno.h"          // for ENAMETOOLONG
#include "asm-generic/int-ll64.h"       // for u8
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/string_32.h"              // for strchr, strlen, memcpy, memset
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for __percpu, __user
#include "linux/cpumask.h"              // for cpumask_next, cpu_possible_mask
#include "linux/dcache.h"               // for __d_path, d_path, dentry_path
#include "linux/err.h"                  // for IS_ERR, PTR_ERR
#include "linux/fs.h"                   // for file (ptr only), inode (ptr o...
#include "linux/gfp.h"                  // for GFP_KERNEL_ACCOUNT, GFP_KERNEL
#include "linux/init.h"                 // for __init
#include "linux/kernel.h"               // for num_to_str, vsnprintf, READ
#include "linux/list.h"                 // for hlist_empty, hlist_for_each
#include "linux/minmax.h"               // for min
#include "linux/mutex.h"                // for mutex_lock, mutex_unlock, mut...
#include "linux/rculist.h"              // for __hlist_for_each_rcu, list_ne...
#include "linux/rcupdate.h"             // for rcu_dereference
#include "linux/stdarg.h"               // for va_end, va_start
#include "linux/types.h"                // for loff_t, hlist_node, hlist_head
#include "linux/uio.h"                  // for iov_iter (ptr only), iovec
struct path;
---
  ./scripts/check-local-export fs/seq_file.o
  iwyu2 -Wp,-MMD,fs/.xattr.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/xattr"' -DKBUILD_BASENAME='"xattr"' -DKBUILD_MODNAME='"xattr"' -D__KBUILD_MODNAME=kmod_xattr -c -o fs/xattr.o fs/xattr.c  
In file included from fs/xattr.c:19:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/xattr.c:19:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/xattr.c:19:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/xattr.c:19:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from fs/xattr.c:19:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/xattr.c:19:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/xattr.c:19:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/xattr.c:19:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/xattr.c should add these lines:
#include <cstdio>                    // for size_t, ssize_t, NULL
#include "asm-generic/errno-base.h"  // for ERANGE, ENOMEM, EPERM, EBADF, E2BIG
#include "asm-generic/errno.h"       // for EOPNOTSUPP, ENODATA
#include "asm/ptrace.h"              // for pt_regs
#include "asm/string_32.h"           // for strncmp, strcmp, strlen, memcpy
#include "asm/uaccess.h"             // for strncpy_from_user
#include "linux/capability.h"        // for capable, cap_convert_nscap, CAP_...
#include "linux/compiler.h"          // for unlikely
#include "linux/compiler_types.h"    // for __user
#include "linux/dcache.h"            // for d_inode, dentry
#include "linux/err.h"               // for IS_ERR, PTR_ERR, ERR_PTR
#include "linux/fcntl.h"             // for AT_FDCWD
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/limits.h"            // for XATTR_SIZE_MAX, XATTR_LIST_MAX
#include "linux/list.h"              // for list_add, list_del, list_for_eac...
#include "linux/path.h"              // for path, path_put
#include "linux/spinlock.h"          // for spin_lock, spin_unlock
#include "linux/stat.h"              // for S_ISDIR, S_ISREG, S_ISVTX
#include "linux/stddef.h"            // for false, true
#include "linux/string.h"            // for kstrdup, vmemdup_user
#include "linux/types.h"             // for list_head, bool, gfp_t
#include "linux/xattr.h"             // for XATTR_SECURITY_PREFIX_LEN, simpl...
struct user_namespace;

fs/xattr.c should remove these lines:
- #include <linux/vmalloc.h>  // lines 23-23

The full include-list for fs/xattr.c:
#include <linux/audit.h>             // for audit_file
#include <linux/evm.h>               // for evm_inode_post_removexattr
#include <linux/export.h>            // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/file.h>              // for fd, fdget, fdput
#include <linux/fs.h>                // for inode, file_mnt_user_ns, is_bad_...
#include <linux/fsnotify.h>          // for fsnotify_xattr
#include <linux/mount.h>             // for mnt_user_ns, mnt_drop_write, mnt...
#include <linux/namei.h>             // for retry_estale, user_path_at, LOOK...
#include <linux/posix_acl_xattr.h>   // for posix_acl_fix_xattr_from_user
#include <linux/security.h>          // for security_inode_getsecurity, secu...
#include <linux/slab.h>              // for kvfree, kfree, kvmalloc, krealloc
#include <linux/syscalls.h>          // for __MAP2, __MAP3, __MAP4, __MAP5
#include <linux/uaccess.h>           // for copy_to_user
#include <linux/xattr.h>             // for simple_xattr, simple_xattrs, xat...
#include <cstdio>                    // for size_t, ssize_t, NULL
#include "asm-generic/errno-base.h"  // for ERANGE, ENOMEM, EPERM, EBADF, E2BIG
#include "asm-generic/errno.h"       // for EOPNOTSUPP, ENODATA
#include "asm/ptrace.h"              // for pt_regs
#include "asm/string_32.h"           // for strncmp, strcmp, strlen, memcpy
#include "asm/uaccess.h"             // for strncpy_from_user
#include "internal.h"                // for xattr_ctx, xattr_name, xattr_ctx...
#include "linux/capability.h"        // for capable, cap_convert_nscap, CAP_...
#include "linux/compiler.h"          // for unlikely
#include "linux/compiler_types.h"    // for __user
#include "linux/dcache.h"            // for d_inode, dentry
#include "linux/err.h"               // for IS_ERR, PTR_ERR, ERR_PTR
#include "linux/fcntl.h"             // for AT_FDCWD
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/limits.h"            // for XATTR_SIZE_MAX, XATTR_LIST_MAX
#include "linux/list.h"              // for list_add, list_del, list_for_eac...
#include "linux/path.h"              // for path, path_put
#include "linux/spinlock.h"          // for spin_lock, spin_unlock
#include "linux/stat.h"              // for S_ISDIR, S_ISREG, S_ISVTX
#include "linux/stddef.h"            // for false, true
#include "linux/string.h"            // for kstrdup, vmemdup_user
#include "linux/types.h"             // for list_head, bool, gfp_t
#include "linux/xattr.h"             // for XATTR_SECURITY_PREFIX_LEN, simpl...
struct user_namespace;
---
  ./scripts/check-local-export fs/xattr.o
  iwyu2 -Wp,-MMD,fs/.libfs.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/libfs"' -DKBUILD_BASENAME='"libfs"' -DKBUILD_MODNAME='"libfs"' -D__KBUILD_MODNAME=kmod_libfs -c -o fs/libfs.o fs/libfs.c  
In file included from fs/libfs.c:7:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/libfs.c:7:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/libfs.c:7:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/libfs.c:7:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
4 warnings generated.
In file included from fs/libfs.c:7:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/libfs.c:7:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/libfs.c:7:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/libfs.c:7:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^

fs/libfs.c should add these lines:
#include <asm/barrier.h>                // for smp_mb
#include <asm/bug.h>                    // for BUG_ON
#include <linux/mm.h>                   // for PageUptodate, SetPageUptodate
#include <cstdio>                       // for NULL, size_t, ssize_t
#include "asm-generic/errno-base.h"     // for ENOMEM, EINVAL, EFAULT, EACCES
#include "asm-generic/errno.h"          // for ENOTEMPTY, ENAMETOOLONG, EOPN...
#include "asm-generic/int-ll64.h"       // for u64, u32
#include "asm/page_types.h"             // for PAGE_SHIFT, PAGE_SIZE
#include "asm/string_32.h"              // for strlen, memcpy
#include "linux/cacheflush.h"           // for flush_dcache_folio
#include "linux/compiler.h"             // for likely, unlikely
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for __user, inline
#include "linux/container_of.h"         // for container_of
#include "linux/dcache.h"               // for dentry, d_inode, dput, d_lock
#include "linux/err.h"                  // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/fs.h"                   // for inode, current_time, drop_nlink
#include "linux/gfp.h"                  // for GFP_KERNEL, get_zeroed_page
#include "linux/highmem.h"              // for folio_zero_range, zero_user
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_WARNING
#include "linux/kernel.h"               // for scnprintf
#include "linux/kstrtox.h"              // for kstrtoull
#include "linux/limits.h"               // for NAME_MAX
#include "linux/list.h"                 // for list_del_init, list_move, lis...
#include "linux/minmax.h"               // for min
#include "linux/mm.h"                   // for folio_size, put_page, set_pag...
#include "linux/mm_types.h"             // for folio (ptr only), page, page:...
#include "linux/path.h"                 // for path
#include "linux/printk.h"               // for printk
#include "linux/sched.h"                // for task_struct, need_resched
#include "linux/spinlock.h"             // for spin_unlock, spin_lock, spin_...
#include "linux/spinlock_types.h"       // for DEFINE_SPINLOCK
#include "linux/stat.h"                 // for S_IFDIR, S_IRUSR, S_IWUSR
#include "linux/statfs.h"               // for kstatfs
#include "linux/stddef.h"               // for true
#include "linux/string.h"               // for memory_read_from_buffer
#include "linux/types.h"                // for loff_t, list_head, bool, pgoff_t
#include "linux/uidgid.h"               // for GLOBAL_ROOT_GID, GLOBAL_ROOT_UID
#include "linux/user_namespace.h"       // for user_namespace (ptr only)
struct delayed_call;
struct iov_iter;

fs/libfs.c should remove these lines:
- #include <linux/fscrypt.h>  // lines 24-24
- #include <linux/namei.h>  // lines 16-16
- #include <linux/vfs.h>  // lines 13-13
- #include <linux/writeback.h>  // lines 18-18

The full include-list for fs/libfs.c:
#include <asm/barrier.h>                // for smp_mb
#include <asm/bug.h>                    // for BUG_ON
#include <linux/blkdev.h>               // for blkdev_issue_flush
#include <linux/buffer_head.h>          // for sync_mapping_buffers
#include <linux/cred.h>                 // for cred, current_fsgid, current_...
#include <linux/export.h>               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/exportfs.h>             // for fid, fid::(anonymous union)::...
#include <linux/fs_context.h>           // for fs_context, get_tree_nodev
#include <linux/fsnotify.h>             // for fsnotify_rmdir, fsnotify_unlink
#include <linux/mm.h>                   // for PageUptodate, SetPageUptodate
#include <linux/mount.h>                // for mntput, mntget, vfs_kern_mount
#include <linux/mutex.h>                // for mutex_lock_interruptible, mut...
#include <linux/pagemap.h>              // for noop_dirty_folio, folio_unlock
#include <linux/pseudo_fs.h>            // for pseudo_fs_context, init_pseudo
#include <linux/slab.h>                 // for kfree, kzalloc
#include <linux/uaccess.h>              // for copy_from_user, copy_to_user
#include <cstdio>                       // for NULL, size_t, ssize_t
#include "asm-generic/errno-base.h"     // for ENOMEM, EINVAL, EFAULT, EACCES
#include "asm-generic/errno.h"          // for ENOTEMPTY, ENAMETOOLONG, EOPN...
#include "asm-generic/int-ll64.h"       // for u64, u32
#include "asm/page_types.h"             // for PAGE_SHIFT, PAGE_SIZE
#include "asm/string_32.h"              // for strlen, memcpy
#include "internal.h"                   // for d_alloc_cursor
#include "linux/cacheflush.h"           // for flush_dcache_folio
#include "linux/compiler.h"             // for likely, unlikely
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for __user, inline
#include "linux/container_of.h"         // for container_of
#include "linux/dcache.h"               // for dentry, d_inode, dput, d_lock
#include "linux/err.h"                  // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/fs.h"                   // for inode, current_time, drop_nlink
#include "linux/gfp.h"                  // for GFP_KERNEL, get_zeroed_page
#include "linux/highmem.h"              // for folio_zero_range, zero_user
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kern_levels.h"          // for KERN_WARNING
#include "linux/kernel.h"               // for scnprintf
#include "linux/kstrtox.h"              // for kstrtoull
#include "linux/limits.h"               // for NAME_MAX
#include "linux/list.h"                 // for list_del_init, list_move, lis...
#include "linux/minmax.h"               // for min
#include "linux/mm.h"                   // for folio_size, put_page, set_pag...
#include "linux/mm_types.h"             // for folio (ptr only), page, page:...
#include "linux/path.h"                 // for path
#include "linux/printk.h"               // for printk
#include "linux/sched.h"                // for task_struct, need_resched
#include "linux/spinlock.h"             // for spin_unlock, spin_lock, spin_...
#include "linux/spinlock_types.h"       // for DEFINE_SPINLOCK
#include "linux/stat.h"                 // for S_IFDIR, S_IRUSR, S_IWUSR
#include "linux/statfs.h"               // for kstatfs
#include "linux/stddef.h"               // for true
#include "linux/string.h"               // for memory_read_from_buffer
#include "linux/types.h"                // for loff_t, list_head, bool, pgoff_t
#include "linux/uidgid.h"               // for GLOBAL_ROOT_GID, GLOBAL_ROOT_UID
#include "linux/user_namespace.h"       // for user_namespace (ptr only)
struct delayed_call;
struct iov_iter;
---
  ./scripts/check-local-export fs/libfs.o
  iwyu2 -Wp,-MMD,fs/.fs-writeback.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/fs-writeback"' -DKBUILD_BASENAME='"fs_writeback"' -DKBUILD_MODNAME='"fs_writeback"' -D__KBUILD_MODNAME=kmod_fs_writeback -c -o fs/fs-writeback.o fs/fs-writeback.c  
In file included from fs/fs-writeback.c:26:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/fs-writeback.c:26:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/fs-writeback.c:26:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/fs-writeback.c:27:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from fs/fs-writeback.c:31:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
5 warnings generated.
In file included from fs/fs-writeback.c:26:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/fs-writeback.c:26:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/fs-writeback.c:26:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/fs-writeback.c:27:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from fs/fs-writeback.c:31:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/fs-writeback.c should add these lines:
#include <asm/barrier.h>                             // for smp_mb
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON, WARN_ON...
#include <stddef.h>                                  // for NULL, size_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/param.h"                       // for HZ
#include "asm/current.h"                             // for current
#include "asm/page_types.h"                          // for PAGE_SHIFT
#include "linux/atomic/atomic-instrumented.h"        // for atomic_read, ato...
#include "linux/backing-dev-defs.h"                  // for bdi_writeback
#include "linux/compiler.h"                          // for unlikely, likely
#include "linux/compiler_types.h"                    // for __acquires, __re...
#include "linux/container_of.h"                      // for container_of
#include "linux/init.h"                              // for __init, __initcall
#include "linux/jiffies.h"                           // for jiffies, msecs_t...
#include "linux/list.h"                              // for list_empty, list...
#include "linux/math.h"                              // for round_down
#include "linux/minmax.h"                            // for min
#include "linux/mmzone.h"                            // for NR_FILE_DIRTY
#include "linux/mutex.h"                             // for mutex_lock, mute...
#include "linux/rculist.h"                           // for list_for_each_en...
#include "linux/rcupdate.h"                          // for rcu_read_lock
#include "linux/rwsem.h"                             // for rwsem_is_locked
#include "linux/stat.h"                              // for S_ISBLK
#include "linux/stddef.h"                            // for false, true
#include "linux/sysctl.h"                            // for proc_dointvec_mi...
#include "linux/types.h"                             // for list_head, bool
#include "linux/vmstat.h"                            // for global_node_page...
#include "linux/wait.h"                              // for finish_wait, pre...
#include "linux/wait_bit.h"                          // for bit_waitqueue
#include "linux/workqueue.h"                         // for work_struct, mod...
#include "vdso/limits.h"                             // for LONG_MAX, LLONG_MAX

fs/fs-writeback.c should remove these lines:
- #include <linux/device.h>  // lines 30-30
- #include <linux/kthread.h>  // lines 25-25
- #include <linux/memcontrol.h>  // lines 31-31
- #include <linux/mm.h>  // lines 23-23

The full include-list for fs/fs-writeback.c:
#include <asm/barrier.h>                             // for smp_mb
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON, WARN_ON...
#include <linux/backing-dev.h>                       // for bdi_list, wb_has...
#include <linux/blkdev.h>                            // for blk_finish_plug
#include <linux/export.h>                            // for EXPORT_SYMBOL
#include <linux/fs.h>                                // for inode, super_block
#include <linux/kernel.h>                            // for might_sleep
#include <linux/pagemap.h>                           // for filemap_fdatawait
#include <linux/sched.h>                             // for need_resched
#include <linux/slab.h>                              // for kfree
#include <linux/spinlock.h>                          // for spin_unlock, spi...
#include <linux/tracepoint.h>                        // for EXPORT_TRACEPOIN...
#include <linux/writeback.h>                         // for writeback_control
#include <stddef.h>                                  // for NULL, size_t
#include <trace/events/writeback.h>                  // for trace_writeback_...
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/param.h"                       // for HZ
#include "asm/current.h"                             // for current
#include "asm/page_types.h"                          // for PAGE_SHIFT
#include "internal.h"                                // for get_nr_dirty_inodes
#include "linux/atomic/atomic-instrumented.h"        // for atomic_read, ato...
#include "linux/backing-dev-defs.h"                  // for bdi_writeback
#include "linux/compiler.h"                          // for unlikely, likely
#include "linux/compiler_types.h"                    // for __acquires, __re...
#include "linux/container_of.h"                      // for container_of
#include "linux/init.h"                              // for __init, __initcall
#include "linux/jiffies.h"                           // for jiffies, msecs_t...
#include "linux/list.h"                              // for list_empty, list...
#include "linux/math.h"                              // for round_down
#include "linux/minmax.h"                            // for min
#include "linux/mmzone.h"                            // for NR_FILE_DIRTY
#include "linux/mutex.h"                             // for mutex_lock, mute...
#include "linux/rculist.h"                           // for list_for_each_en...
#include "linux/rcupdate.h"                          // for rcu_read_lock
#include "linux/rwsem.h"                             // for rwsem_is_locked
#include "linux/stat.h"                              // for S_ISBLK
#include "linux/stddef.h"                            // for false, true
#include "linux/sysctl.h"                            // for proc_dointvec_mi...
#include "linux/types.h"                             // for list_head, bool
#include "linux/vmstat.h"                            // for global_node_page...
#include "linux/wait.h"                              // for finish_wait, pre...
#include "linux/wait_bit.h"                          // for bit_waitqueue
#include "linux/workqueue.h"                         // for work_struct, mod...
#include "vdso/limits.h"                             // for LONG_MAX, LLONG_MAX
---
  ./scripts/check-local-export fs/fs-writeback.o
  iwyu2 -Wp,-MMD,fs/.pnode.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/pnode"' -DKBUILD_BASENAME='"pnode"' -DKBUILD_MODNAME='"pnode"' -D__KBUILD_MODNAME=kmod_pnode -c -o fs/pnode.o fs/pnode.c  

fs/pnode.h should add these lines:
#include "linux/compiler_types.h"  // for inline
#include "linux/mount.h"           // for vfsmount, MNT_MARKED, MNT_SHARED
#include "linux/types.h"           // for bool, hlist_head (ptr only), list_...
struct dentry;
struct path;

fs/pnode.h should remove these lines:
- #include <linux/list.h>  // lines 10-10

The full include-list for fs/pnode.h:
#include "linux/compiler_types.h"  // for inline
#include "linux/mount.h"           // for vfsmount, MNT_MARKED, MNT_SHARED
#include "linux/types.h"           // for bool, hlist_head (ptr only), list_...
#include "mount.h"                 // for mount, is_anon_ns
struct dentry;
struct path;
---

fs/pnode.c should add these lines:
#include <asm/bug.h>           // for BUG_ON
#include <stddef.h>            // for NULL
#include "linux/err.h"         // for IS_ERR, PTR_ERR
#include "linux/list.h"        // for list_empty, list_del_init, list_move_tail
#include "linux/seqlock.h"     // for read_seqlock_excl, read_sequnlock_excl
#include "linux/stddef.h"      // for false, true
struct path;

fs/pnode.c should remove these lines:
- #include <linux/mnt_namespace.h>  // lines 8-8
- #include <linux/nsproxy.h>  // lines 11-11
- #include "internal.h"  // lines 13-13

The full include-list for fs/pnode.c:
#include "pnode.h"
#include <asm/bug.h>           // for BUG_ON
#include <linux/fs.h>          // for is_subdir
#include <linux/mount.h>       // for vfsmount, MNT_UMOUNT, MNT_UNBINDABLE
#include <stddef.h>            // for NULL
#include <uapi/linux/mount.h>  // for MS_SHARED, MS_SLAVE, MS_UNBINDABLE
#include "linux/err.h"         // for IS_ERR, PTR_ERR
#include "linux/list.h"        // for list_empty, list_del_init, list_move_tail
#include "linux/seqlock.h"     // for read_seqlock_excl, read_sequnlock_excl
#include "linux/stddef.h"      // for false, true
struct path;
---
  ./scripts/check-local-export fs/pnode.o
  iwyu2 -Wp,-MMD,fs/.splice.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/splice"' -DKBUILD_BASENAME='"splice"' -DKBUILD_MODNAME='"splice"' -D__KBUILD_MODNAME=kmod_splice -c -o fs/splice.o fs/splice.c  
In file included from fs/splice.c:26:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from fs/splice.c:26:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/splice.c:26:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/splice.c:26:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from fs/splice.c:26:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from fs/splice.c:26:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/splice.c:26:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/splice.c:26:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

fs/splice.c should add these lines:
#include <asm/barrier.h>             // for smp_mb
#include <asm/bug.h>                 // for WARN_ON, WARN_ON_ONCE
#include <asm/signal.h>              // for SIGPIPE, SIGIO
#include <linux/build_bug.h>         // for unlikely, likely
#include <linux/mm.h>                // for PageUptodate, folio_has_private
#include <cstdio>                    // for size_t, ssize_t, NULL
#include "asm-generic/errno-base.h"  // for EINVAL, EBADF, EAGAIN, EFAULT
#include "asm-generic/errno.h"       // for ENODATA
#include "asm-generic/fcntl.h"       // for O_NONBLOCK, O_APPEND
#include "asm-generic/rwonce.h"      // for READ_ONCE
#include "asm-generic/siginfo.h"     // for POLL_IN, POLL_OUT
#include "asm/current.h"             // for current
#include "asm/page_types.h"          // for PAGE_SHIFT, PAGE_SIZE
#include "asm/ptrace.h"              // for pt_regs
#include "linux/compiler_types.h"    // for __user, inline
#include "linux/errno.h"             // for ERESTARTSYS
#include "linux/kernel.h"            // for WRITE, READ, ARRAY_SIZE
#include "linux/minmax.h"            // for min_t, min
#include "linux/mm.h"                // for put_page
#include "linux/mm_types.h"          // for page, page::(anonymous union)::(...
#include "linux/pipe_fs_i.h"         // for pipe_inode_info, pipe_buffer
#include "linux/printk.h"            // for pr_debug_ratelimited
#include "linux/sched.h"             // for task_struct, cond_resched
#include "linux/slab.h"              // for kfree, kcalloc, kmalloc_array
#include "linux/stat.h"              // for S_ISBLK, S_ISREG
#include "linux/stddef.h"            // for true, false
#include "linux/types.h"             // for loff_t, bool, umode_t
#include "linux/uaccess.h"           // for copy_from_user, copy_to_user
#include "linux/uio.h"               // for iov_iter (ptr only), UIO_FASTIOV
#include "linux/wait.h"              // for waitqueue_active, wake_up_interr...

fs/splice.c should remove these lines:
- #include <linux/memcontrol.h>  // lines 26-26
- #include <linux/mm_inline.h>  // lines 27-27
- #include <linux/security.h>  // lines 33-33
- #include <linux/writeback.h>  // lines 29-29

The full include-list for fs/splice.c:
#include <asm/barrier.h>             // for smp_mb
#include <asm/bug.h>                 // for WARN_ON, WARN_ON_ONCE
#include <asm/signal.h>              // for SIGPIPE, SIGIO
#include <linux/build_bug.h>         // for unlikely, likely
#include <linux/bvec.h>              // for bio_vec
#include <linux/export.h>            // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/file.h>              // for fd, fdput, fdget
#include <linux/fs.h>                // for file, rw_verify_area, file_accessed
#include <linux/gfp.h>               // for GFP_KERNEL
#include <linux/mm.h>                // for PageUptodate, folio_has_private
#include <linux/pagemap.h>           // for unlock_page, filemap_release_folio
#include <linux/sched/signal.h>      // for send_sig, signal_pending
#include <linux/socket.h>            // for MSG_MORE, MSG_SENDPAGE_NOTLAST
#include <linux/splice.h>            // for splice_desc, splice_pipe_desc
#include <linux/swap.h>              // for remove_mapping
#include <linux/syscalls.h>          // for __MAP4, __MAP6, SYSCALL_DEFINE4
#include <linux/uio.h>               // for iov_iter_count, iov_iter, iov_it...
#include <cstdio>                    // for size_t, ssize_t, NULL
#include "asm-generic/errno-base.h"  // for EINVAL, EBADF, EAGAIN, EFAULT
#include "asm-generic/errno.h"       // for ENODATA
#include "asm-generic/fcntl.h"       // for O_NONBLOCK, O_APPEND
#include "asm-generic/rwonce.h"      // for READ_ONCE
#include "asm-generic/siginfo.h"     // for POLL_IN, POLL_OUT
#include "asm/current.h"             // for current
#include "asm/page_types.h"          // for PAGE_SHIFT, PAGE_SIZE
#include "asm/ptrace.h"              // for pt_regs
#include "internal.h"                // for splice_file_to_pipe
#include "linux/compiler_types.h"    // for __user, inline
#include "linux/errno.h"             // for ERESTARTSYS
#include "linux/kernel.h"            // for WRITE, READ, ARRAY_SIZE
#include "linux/minmax.h"            // for min_t, min
#include "linux/mm.h"                // for put_page
#include "linux/mm_types.h"          // for page, page::(anonymous union)::(...
#include "linux/pipe_fs_i.h"         // for pipe_inode_info, pipe_buffer
#include "linux/printk.h"            // for pr_debug_ratelimited
#include "linux/sched.h"             // for task_struct, cond_resched
#include "linux/slab.h"              // for kfree, kcalloc, kmalloc_array
#include "linux/stat.h"              // for S_ISBLK, S_ISREG
#include "linux/stddef.h"            // for true, false
#include "linux/types.h"             // for loff_t, bool, umode_t
#include "linux/uaccess.h"           // for copy_from_user, copy_to_user
#include "linux/uio.h"               // for iov_iter (ptr only), UIO_FASTIOV
#include "linux/wait.h"              // for waitqueue_active, wake_up_interr...
---
  ./scripts/check-local-export fs/splice.o
  iwyu2 -Wp,-MMD,fs/.sync.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/sync"' -DKBUILD_BASENAME='"sync"' -DKBUILD_MODNAME='"sync"' -D__KBUILD_MODNAME=kmod_sync -c -o fs/sync.o fs/sync.c  
In file included from fs/sync.c:6:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/sync.c:6:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/sync.c:6:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/sync.c:6:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from fs/sync.c:15:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
5 warnings generated.
In file included from fs/sync.c:6:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/sync.c:6:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/sync.c:6:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/sync.c:6:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from fs/sync.c:15:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/sync.c should add these lines:
#include <asm/bug.h>                 // for WARN_ON
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EBADF, EINVAL, ESPIPE
#include "asm-generic/int-ll64.h"    // for s64
#include "asm/page_types.h"          // for PAGE_SHIFT
#include "asm/ptrace.h"              // for pt_regs
#include "linux/backing-dev-defs.h"  // for WB_REASON_SYNC
#include "linux/compiler.h"          // for unlikely
#include "linux/dcache.h"            // for dentry
#include "linux/errseq.h"            // for errseq_check_and_advance
#include "linux/fs.h"                // for SYNC_FILE_RANGE_WAIT_AFTER, SYNC...
#include "linux/gfp.h"               // for GFP_ATOMIC
#include "linux/path.h"              // for path
#include "linux/printk.h"            // for printk
#include "linux/rwsem.h"             // for down_read, rwsem_is_locked, up_read
#include "linux/stat.h"              // for S_ISBLK, S_ISDIR, S_ISLNK, S_ISREG
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for loff_t, pgoff_t, umode_t
#include "linux/workqueue.h"         // for work_struct, schedule_work, INIT...
#include "vdso/limits.h"             // for LLONG_MAX

fs/sync.c should remove these lines:
- #include <linux/backing-dev.h>  // lines 19-19
- #include <linux/kernel.h>  // lines 7-7
- #include <linux/linkage.h>  // lines 16-16
- #include <linux/namei.h>  // lines 12-12
- #include <linux/sched.h>  // lines 13-13
- #include "internal.h"  // lines 20-20

The full include-list for fs/sync.c:
#include <asm/bug.h>                 // for WARN_ON
#include <linux/blkdev.h>            // for sync_bdevs, sync_blockdev, sync_...
#include <linux/export.h>            // for EXPORT_SYMBOL
#include <linux/file.h>              // for fd, fdget, fdput
#include <linux/fs.h>                // for iterate_supers, super_block, sb_...
#include <linux/pagemap.h>           // for __filemap_fdatawrite_range
#include <linux/slab.h>              // for kfree, kmalloc
#include <linux/syscalls.h>          // for __MAP1, __MAP4, SYSCALL_DEFINE1
#include <linux/writeback.h>         // for sync_inodes_sb, laptop_sync_comp...
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EBADF, EINVAL, ESPIPE
#include "asm-generic/int-ll64.h"    // for s64
#include "asm/page_types.h"          // for PAGE_SHIFT
#include "asm/ptrace.h"              // for pt_regs
#include "linux/backing-dev-defs.h"  // for WB_REASON_SYNC
#include "linux/compiler.h"          // for unlikely
#include "linux/dcache.h"            // for dentry
#include "linux/errseq.h"            // for errseq_check_and_advance
#include "linux/fs.h"                // for SYNC_FILE_RANGE_WAIT_AFTER, SYNC...
#include "linux/gfp.h"               // for GFP_ATOMIC
#include "linux/path.h"              // for path
#include "linux/printk.h"            // for printk
#include "linux/rwsem.h"             // for down_read, rwsem_is_locked, up_read
#include "linux/stat.h"              // for S_ISBLK, S_ISDIR, S_ISLNK, S_ISREG
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for loff_t, pgoff_t, umode_t
#include "linux/workqueue.h"         // for work_struct, schedule_work, INIT...
#include "vdso/limits.h"             // for LLONG_MAX
---
  ./scripts/check-local-export fs/sync.o
  iwyu2 -Wp,-MMD,fs/.utimes.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/utimes"' -DKBUILD_BASENAME='"utimes"' -DKBUILD_MODNAME='"utimes"' -D__KBUILD_MODNAME=kmod_utimes -c -o fs/utimes.o fs/utimes.c  
In file included from fs/utimes.c:6:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/utimes.c:6:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/utimes.c:6:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/utimes.c:6:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from fs/utimes.c:6:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/utimes.c:6:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/utimes.c:6:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/utimes.c:6:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/utimes.c should add these lines:
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL, EBADF, EFAULT
#include "asm/ptrace.h"              // for pt_regs
#include "linux/compiler_types.h"    // for __user
#include "linux/dcache.h"            // for dentry
#include "linux/fcntl.h"             // for AT_EMPTY_PATH, AT_SYMLINK_NOFOLLOW
#include "linux/fs.h"                // for iattr, break_deleg_wait, inode_lock
#include "linux/path.h"              // for path, path_put
#include "linux/stat.h"              // for UTIME_NOW, UTIME_OMIT
#include "linux/stddef.h"            // for true
#include "linux/time.h"              // for get_timespec64, do_utimes
#include "linux/time64.h"            // for timespec64
#include "linux/time_types.h"        // for __kernel_timespec
#include "linux/types.h"             // for bool

fs/utimes.c should remove these lines:
- #include <asm/unistd.h>  // lines 9-9
- #include <linux/compat.h>  // lines 8-8
- #include <linux/uaccess.h>  // lines 7-7
- #include <linux/utime.h>  // lines 5-5

The full include-list for fs/utimes.c:
#include <linux/file.h>              // for fd, fdget, fdput
#include <linux/mount.h>             // for mnt_drop_write, mnt_user_ns, mnt...
#include <linux/namei.h>             // for retry_estale, user_path_at, LOOK...
#include <linux/syscalls.h>          // for __MAP4, SYSCALL_DEFINE4
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL, EBADF, EFAULT
#include "asm/ptrace.h"              // for pt_regs
#include "linux/compiler_types.h"    // for __user
#include "linux/dcache.h"            // for dentry
#include "linux/fcntl.h"             // for AT_EMPTY_PATH, AT_SYMLINK_NOFOLLOW
#include "linux/fs.h"                // for iattr, break_deleg_wait, inode_lock
#include "linux/path.h"              // for path, path_put
#include "linux/stat.h"              // for UTIME_NOW, UTIME_OMIT
#include "linux/stddef.h"            // for true
#include "linux/time.h"              // for get_timespec64, do_utimes
#include "linux/time64.h"            // for timespec64
#include "linux/time_types.h"        // for __kernel_timespec
#include "linux/types.h"             // for bool
---
  ./scripts/check-local-export fs/utimes.o
  iwyu2 -Wp,-MMD,fs/.d_path.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/d_path"' -DKBUILD_BASENAME='"d_path"' -DKBUILD_MODNAME='"d_path"' -D__KBUILD_MODNAME=kmod_d_path -c -o fs/d_path.o fs/d_path.c  
In file included from fs/d_path.c:2:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/d_path.c:2:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/d_path.c:2:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/d_path.c:2:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from fs/d_path.c:2:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/d_path.c:2:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/d_path.c:2:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/d_path.c:2:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/d_path.c should add these lines:
#include <asm/barrier.h>             // for smp_load_acquire
#include <cstdio>                    // for NULL, va_list
#include "asm-generic/errno-base.h"  // for EFAULT, EINVAL, ENOENT, ENOMEM
#include "asm-generic/errno.h"       // for ENAMETOOLONG
#include "asm-generic/int-ll64.h"    // for u32
#include "asm-generic/rwonce.h"      // for READ_ONCE
#include "asm/current.h"             // for current
#include "asm/processor.h"           // for prefetch
#include "asm/ptrace.h"              // for pt_regs
#include "asm/string_32.h"           // for memcpy, memset
#include "linux/compiler.h"          // for unlikely, likely
#include "linux/compiler_types.h"    // for __user
#include "linux/dcache.h"            // for qstr, dentry, d_unlinked, qstr::...
#include "linux/err.h"               // for ERR_PTR, IS_ERR_OR_NULL
#include "linux/kernel.h"            // for vsnprintf
#include "linux/limits.h"            // for PATH_MAX
#include "linux/mount.h"             // for vfsmount
#include "linux/path.h"              // for path
#include "linux/rcupdate.h"          // for rcu_read_unlock, rcu_read_lock
#include "linux/sched.h"             // for task_struct
#include "linux/seqlock.h"           // for done_seqretry, need_seqretry
#include "linux/stdarg.h"            // for va_end, va_start
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool

fs/d_path.c should remove these lines:
- #include <linux/slab.h>  // lines 7-7

The full include-list for fs/d_path.c:
#include <asm/barrier.h>             // for smp_load_acquire
#include <linux/export.h>            // for EXPORT_SYMBOL
#include <linux/fs.h>                // for __getname, __putname
#include <linux/fs_struct.h>         // for fs_struct
#include <linux/syscalls.h>          // for __MAP2, SYSCALL_DEFINE2
#include <linux/uaccess.h>           // for copy_from_kernel_nofault, copy_t...
#include <cstdio>                    // for NULL, va_list
#include "asm-generic/errno-base.h"  // for EFAULT, EINVAL, ENOENT, ENOMEM
#include "asm-generic/errno.h"       // for ENAMETOOLONG
#include "asm-generic/int-ll64.h"    // for u32
#include "asm-generic/rwonce.h"      // for READ_ONCE
#include "asm/current.h"             // for current
#include "asm/processor.h"           // for prefetch
#include "asm/ptrace.h"              // for pt_regs
#include "asm/string_32.h"           // for memcpy, memset
#include "linux/compiler.h"          // for unlikely, likely
#include "linux/compiler_types.h"    // for __user
#include "linux/dcache.h"            // for qstr, dentry, d_unlinked, qstr::...
#include "linux/err.h"               // for ERR_PTR, IS_ERR_OR_NULL
#include "linux/kernel.h"            // for vsnprintf
#include "linux/limits.h"            // for PATH_MAX
#include "linux/mount.h"             // for vfsmount
#include "linux/path.h"              // for path
#include "linux/rcupdate.h"          // for rcu_read_unlock, rcu_read_lock
#include "linux/sched.h"             // for task_struct
#include "linux/seqlock.h"           // for done_seqretry, need_seqretry
#include "linux/stdarg.h"            // for va_end, va_start
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool
#include "mount.h"                   // for mount, is_anon_ns, mount_lock
---
  ./scripts/check-local-export fs/d_path.o
  iwyu2 -Wp,-MMD,fs/.stack.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/stack"' -DKBUILD_BASENAME='"stack"' -DKBUILD_MODNAME='"stack"' -D__KBUILD_MODNAME=kmod_stack -c -o fs/stack.o fs/stack.c  

fs/stack.c should add these lines:
#include <sys/types.h>       // for blkcnt_t
#include "linux/spinlock.h"  // for spin_lock, spin_unlock
#include "linux/types.h"     // for loff_t

fs/stack.c should remove these lines:

The full include-list for fs/stack.c:
#include <linux/export.h>    // for EXPORT_SYMBOL_GPL
#include <linux/fs.h>        // for inode, i_size_read, i_size_write, set_nlink
#include <sys/types.h>       // for blkcnt_t
#include "linux/spinlock.h"  // for spin_lock, spin_unlock
#include "linux/types.h"     // for loff_t
---
  ./scripts/check-local-export fs/stack.o
  iwyu2 -Wp,-MMD,fs/.fs_struct.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/fs_struct"' -DKBUILD_BASENAME='"fs_struct"' -DKBUILD_MODNAME='"fs_struct"' -D__KBUILD_MODNAME=kmod_fs_struct -c -o fs/fs_struct.o fs/fs_struct.c  

fs/fs_struct.c should add these lines:
#include <linux/spinlock.h>          // for read_lock, read_unlock
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for ENOMEM
#include "asm/current.h"             // for current
#include "linux/compiler.h"          // for likely
#include "linux/compiler_types.h"    // for inline
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/sched.h"             // for task_struct
#include "linux/seqlock.h"           // for __seqprop_mutex_preemptible, __s...
#include "linux/spinlock.h"          // for spin_lock, spin_unlock, spin_loc...
#include "linux/spinlock_types.h"    // for __SPIN_LOCK_UNLOCKED

fs/fs_struct.c should remove these lines:

The full include-list for fs/fs_struct.c:
#include <linux/export.h>            // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/fs.h>                // for current_umask
#include <linux/fs_struct.h>         // for fs_struct, fs_cachep, copy_fs_st...
#include <linux/path.h>              // for path_get, path_put, path
#include <linux/sched/signal.h>      // for do_each_thread, while_each_thread
#include <linux/sched/task.h>        // for task_lock, task_unlock, tasklist...
#include <linux/slab.h>              // for kmem_cache_alloc, kmem_cache_free
#include <linux/spinlock.h>          // for read_lock, read_unlock
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for ENOMEM
#include "asm/current.h"             // for current
#include "internal.h"                // for chroot_fs_refs
#include "linux/compiler.h"          // for likely
#include "linux/compiler_types.h"    // for inline
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/sched.h"             // for task_struct
#include "linux/seqlock.h"           // for __seqprop_mutex_preemptible, __s...
#include "linux/spinlock.h"          // for spin_lock, spin_unlock, spin_loc...
#include "linux/spinlock_types.h"    // for __SPIN_LOCK_UNLOCKED
---
  ./scripts/check-local-export fs/fs_struct.o
  iwyu2 -Wp,-MMD,fs/.statfs.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/statfs"' -DKBUILD_BASENAME='"statfs"' -DKBUILD_MODNAME='"statfs"' -D__KBUILD_MODNAME=kmod_statfs -c -o fs/statfs.o fs/statfs.c  
In file included from fs/statfs.c:2:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/statfs.c:2:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/statfs.c:2:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/statfs.c:2:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from fs/statfs.c:2:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/statfs.c:2:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/statfs.c:2:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/statfs.c:2:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/statfs.c should add these lines:
#include <asm/posix_types.h>         // for __kernel_fsid_t
#include <sys/types.h>               // for size_t, dev_t
#include "asm-generic/errno-base.h"  // for EFAULT, EINVAL, EBADF
#include "asm-generic/errno.h"       // for EOVERFLOW, ENOSYS
#include "asm-generic/int-ll64.h"    // for u64, __u32
#include "asm-generic/statfs.h"      // for statfs64, statfs
#include "asm/ptrace.h"              // for pt_regs
#include "asm/string_32.h"           // for memset, memcpy
#include "linux/compiler_types.h"    // for __user
#include "linux/dcache.h"            // for dentry
#include "linux/fcntl.h"             // for AT_FDCWD
#include "linux/kconfig.h"           // for IS_ENABLED
#include "linux/kdev_t.h"            // for new_decode_dev
#include "linux/minmax.h"            // for min_t
#include "linux/path.h"              // for path, path_put
#include "linux/stddef.h"            // for false
#include "linux/types.h"             // for ustat
#include "vdso/limits.h"             // for UINT_MAX

fs/statfs.c should remove these lines:
- #include <linux/compat.h>  // lines 11-11

The full include-list for fs/statfs.c:
#include <asm/posix_types.h>         // for __kernel_fsid_t
#include <linux/export.h>            // for EXPORT_SYMBOL
#include <linux/file.h>              // for fd, fdget_raw, fdput
#include <linux/fs.h>                // for super_block, drop_super, super_o...
#include <linux/mount.h>             // for vfsmount, MNT_NOATIME, MNT_NODEV
#include <linux/namei.h>             // for retry_estale, user_path_at, LOOK...
#include <linux/security.h>          // for security_sb_statfs
#include <linux/statfs.h>            // for kstatfs, ST_RDONLY, ST_MANDLOCK
#include <linux/syscalls.h>          // for __MAP2, __MAP3, SYSCALL_DEFINE2
#include <linux/uaccess.h>           // for copy_to_user
#include <sys/types.h>               // for size_t, dev_t
#include "asm-generic/errno-base.h"  // for EFAULT, EINVAL, EBADF
#include "asm-generic/errno.h"       // for EOVERFLOW, ENOSYS
#include "asm-generic/int-ll64.h"    // for u64, __u32
#include "asm-generic/statfs.h"      // for statfs64, statfs
#include "asm/ptrace.h"              // for pt_regs
#include "asm/string_32.h"           // for memset, memcpy
#include "internal.h"                // for user_get_super
#include "linux/compiler_types.h"    // for __user
#include "linux/dcache.h"            // for dentry
#include "linux/fcntl.h"             // for AT_FDCWD
#include "linux/kconfig.h"           // for IS_ENABLED
#include "linux/kdev_t.h"            // for new_decode_dev
#include "linux/minmax.h"            // for min_t
#include "linux/path.h"              // for path, path_put
#include "linux/stddef.h"            // for false
#include "linux/types.h"             // for ustat
#include "vdso/limits.h"             // for UINT_MAX
---
  ./scripts/check-local-export fs/statfs.o
  iwyu2 -Wp,-MMD,fs/.fs_pin.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/fs_pin"' -DKBUILD_BASENAME='"fs_pin"' -DKBUILD_MODNAME='"fs_pin"' -D__KBUILD_MODNAME=kmod_fs_pin -c -o fs/fs_pin.o fs/fs_pin.c  

fs/fs_pin.c should add these lines:
#include "asm-generic/rwonce.h"    // for READ_ONCE
#include "linux/compiler.h"        // for likely
#include "linux/fs_pin.h"          // for fs_pin, pin_insert, pin_kill, pin_...
#include "linux/list.h"            // for hlist_add_head, hlist_del_init
#include "linux/mount.h"           // for vfsmount
#include "linux/rcupdate.h"        // for rcu_read_unlock, rcu_read_lock
#include "linux/spinlock.h"        // for spin_unlock_irq, spin_lock_irq
#include "linux/spinlock_types.h"  // for DEFINE_SPINLOCK
#include "linux/types.h"           // for hlist_head, hlist_node (ptr only)
#include "linux/wait.h"            // for wait_queue_head_t, __add_wait_queue

fs/fs_pin.c should remove these lines:
- #include <linux/slab.h>  // lines 4-4

The full include-list for fs/fs_pin.c:
#include <linux/fs.h>              // for super_block
#include <linux/sched.h>           // for task_struct, schedule, TASK_UNINTE...
#include "asm-generic/rwonce.h"    // for READ_ONCE
#include "internal.h"              // for group_pin_kill, mnt_pin_kill
#include "linux/compiler.h"        // for likely
#include "linux/fs_pin.h"          // for fs_pin, pin_insert, pin_kill, pin_...
#include "linux/list.h"            // for hlist_add_head, hlist_del_init
#include "linux/mount.h"           // for vfsmount
#include "linux/rcupdate.h"        // for rcu_read_unlock, rcu_read_lock
#include "linux/spinlock.h"        // for spin_unlock_irq, spin_lock_irq
#include "linux/spinlock_types.h"  // for DEFINE_SPINLOCK
#include "linux/types.h"           // for hlist_head, hlist_node (ptr only)
#include "linux/wait.h"            // for wait_queue_head_t, __add_wait_queue
#include "mount.h"                 // for mount, real_mount
---
  ./scripts/check-local-export fs/fs_pin.o
  iwyu2 -Wp,-MMD,fs/.nsfs.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/nsfs"' -DKBUILD_BASENAME='"nsfs"' -DKBUILD_MODNAME='"nsfs"' -D__KBUILD_MODNAME=kmod_nsfs -c -o fs/nsfs.o fs/nsfs.c  

fs/nsfs.c should add these lines:
#include <sys/types.h>                         // for uid_t, dev_t, ino_t
#include "asm-generic/errno-base.h"            // for EAGAIN, EINVAL, ENOMEM
#include "asm-generic/fcntl.h"                 // for O_CLOEXEC, O_RDONLY
#include "asm/uaccess.h"                       // for put_user
#include "asm/vdso/processor.h"                // for cpu_relax
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_cmpxchg
#include "linux/compiler_types.h"              // for __user
#include "linux/container_of.h"                // for container_of
#include "linux/cred.h"                        // for current_user_ns, curre...
#include "linux/dcache.h"                      // for d_inode, dentry, d_all...
#include "linux/err.h"                         // for IS_ERR, ERR_PTR, PTR_ERR
#include "linux/export.h"                      // for EXPORT_SYMBOL_GPL
#include "linux/init.h"                        // for __init
#include "linux/kernel.h"                      // for snprintf
#include "linux/lockref.h"                     // for lockref_get_not_dead
#include "linux/ns_common.h"                   // for ns_common
#include "linux/panic.h"                       // for panic
#include "linux/path.h"                        // for path, path_put
#include "linux/rcupdate.h"                    // for rcu_read_unlock, rcu_r...
#include "linux/sched.h"                       // for task_struct, CLONE_NEW...
#include "linux/stat.h"                        // for S_IFREG, S_IRUGO
#include "linux/types.h"                       // for bool
#include "linux/uidgid.h"                      // for from_kuid_munged
struct fs_context;

fs/nsfs.c should remove these lines:
- #include <linux/ktime.h>  // lines 9-9
- #include <linux/uaccess.h>  // lines 13-13
- #include "internal.h"  // lines 15-15

The full include-list for fs/nsfs.c:
#include <linux/file.h>                        // for put_unused_fd, fd_install
#include <linux/fs.h>                          // for inode, always_delete_d...
#include <linux/magic.h>                       // for NSFS_MAGIC
#include <linux/mount.h>                       // for vfsmount, kern_mount
#include <linux/nsfs.h>                        // for NS_GET_NSTYPE, NS_GET_...
#include <linux/proc_fs.h>                     // for open_related_ns, proc_...
#include <linux/proc_ns.h>                     // for proc_ns_operations
#include <linux/pseudo_fs.h>                   // for init_pseudo, pseudo_fs...
#include <linux/seq_file.h>                    // for seq_printf
#include <linux/user_namespace.h>              // for user_namespace, ns_get...
#include <sys/types.h>                         // for uid_t, dev_t, ino_t
#include "asm-generic/errno-base.h"            // for EAGAIN, EINVAL, ENOMEM
#include "asm-generic/fcntl.h"                 // for O_CLOEXEC, O_RDONLY
#include "asm/uaccess.h"                       // for put_user
#include "asm/vdso/processor.h"                // for cpu_relax
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_cmpxchg
#include "linux/compiler_types.h"              // for __user
#include "linux/container_of.h"                // for container_of
#include "linux/cred.h"                        // for current_user_ns, curre...
#include "linux/dcache.h"                      // for d_inode, dentry, d_all...
#include "linux/err.h"                         // for IS_ERR, ERR_PTR, PTR_ERR
#include "linux/export.h"                      // for EXPORT_SYMBOL_GPL
#include "linux/init.h"                        // for __init
#include "linux/kernel.h"                      // for snprintf
#include "linux/lockref.h"                     // for lockref_get_not_dead
#include "linux/ns_common.h"                   // for ns_common
#include "linux/panic.h"                       // for panic
#include "linux/path.h"                        // for path, path_put
#include "linux/rcupdate.h"                    // for rcu_read_unlock, rcu_r...
#include "linux/sched.h"                       // for task_struct, CLONE_NEW...
#include "linux/stat.h"                        // for S_IFREG, S_IRUGO
#include "linux/types.h"                       // for bool
#include "linux/uidgid.h"                      // for from_kuid_munged
struct fs_context;
---
  ./scripts/check-local-export fs/nsfs.o
  iwyu2 -Wp,-MMD,fs/.fs_types.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/fs_types"' -DKBUILD_BASENAME='"fs_types"' -DKBUILD_MODNAME='"fs_types"' -D__KBUILD_MODNAME=kmod_fs_types -c -o fs/fs_types.o fs/fs_types.c  

fs/fs_types.c should add these lines:
#include "linux/fs_types.h"  // for DT_BLK, DT_CHR, DT_DIR, DT_FIFO, DT_LNK
#include "linux/types.h"     // for umode_t

fs/fs_types.c should remove these lines:
- #include <linux/fs.h>  // lines 2-2

The full include-list for fs/fs_types.c:
#include <linux/export.h>    // for EXPORT_SYMBOL_GPL
#include "linux/fs_types.h"  // for DT_BLK, DT_CHR, DT_DIR, DT_FIFO, DT_LNK
#include "linux/types.h"     // for umode_t
---
  ./scripts/check-local-export fs/fs_types.o
  iwyu2 -Wp,-MMD,fs/.fs_context.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/fs_context"' -DKBUILD_BASENAME='"fs_context"' -DKBUILD_MODNAME='"fs_context"' -D__KBUILD_MODNAME=kmod_fs_context -c -o fs/fs_context.o fs/fs_context.c  
In file included from fs/fs_context.c:22:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/fs_context.c:22:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/fs_context.c:22:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/fs_context.c:22:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
4 warnings generated.
In file included from fs/fs_context.c:22:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/fs_context.c:22:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/fs_context.c:22:
In file included from ./include/net/net_namespace.h:40:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/fs_context.c:22:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^

fs/fs_context.c should add these lines:
#include <asm/bug.h>                           // for BUG_ON
#include <linux/build_bug.h>                   // for unlikely
#include <cstdio>                              // for NULL, size_t, va_list
#include "asm-generic/errno-base.h"            // for ENOMEM, EINVAL
#include "asm-generic/errno.h"                 // for EOPNOTSUPP
#include "asm-generic/int-ll64.h"              // for u8
#include "asm/current.h"                       // for current
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/string_32.h"                     // for strlen, strchr, memchr
#include "linux/atomic/atomic-instrumented.h"  // for atomic_inc
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/compiler_attributes.h"         // for fallthrough
#include "linux/cred.h"                        // for get_cred, put_cred, cred
#include "linux/dcache.h"                      // for dentry, dput, dget
#include "linux/err.h"                         // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/errno.h"                       // for ENOPARAM
#include "linux/export.h"                      // for EXPORT_SYMBOL
#include "linux/gfp.h"                         // for GFP_KERNEL, GFP_KERNEL...
#include "linux/kern_levels.h"                 // for KERN_ERR, KERN_NOTICE
#include "linux/kernel.h"                      // for kasprintf, ARRAY_SIZE
#include "linux/mutex.h"                       // for mutex_init
#include "linux/printk.h"                      // for printk, pr_warn, va_fo...
#include "linux/refcount.h"                    // for refcount_dec_and_test
#include "linux/sched.h"                       // for task_struct
#include "linux/stdarg.h"                      // for va_end, va_start
#include "linux/stddef.h"                      // for true, false
#include "linux/string.h"                      // for kmemdup, kmemdup_nul

fs/fs_context.c should remove these lines:
- #include <asm/sections.h>  // lines 23-23
- #include <linux/magic.h>  // lines 17-17
- #include <linux/mnt_namespace.h>  // lines 19-19
- #include <linux/module.h>  // lines 10-10
- #include <linux/mount.h>  // lines 14-14
- #include <linux/pid_namespace.h>  // lines 20-20
- #include "mount.h"  // lines 24-24

The full include-list for fs/fs_context.c:
#include <asm/bug.h>                           // for BUG_ON
#include <linux/build_bug.h>                   // for unlikely
#include <linux/fs.h>                          // for file_system_type, get_...
#include <linux/fs_context.h>                  // for fs_context, fs_parameter
#include <linux/fs_parser.h>                   // for lookup_constant, const...
#include <linux/nsproxy.h>                     // for nsproxy
#include <linux/security.h>                    // for security_free_mnt_opts
#include <linux/slab.h>                        // for kfree, kzalloc, kmalloc
#include <linux/user_namespace.h>              // for get_user_ns, put_user_ns
#include <net/net_namespace.h>                 // for get_net, put_net
#include <cstdio>                              // for NULL, size_t, va_list
#include "asm-generic/errno-base.h"            // for ENOMEM, EINVAL
#include "asm-generic/errno.h"                 // for EOPNOTSUPP
#include "asm-generic/int-ll64.h"              // for u8
#include "asm/current.h"                       // for current
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/string_32.h"                     // for strlen, strchr, memchr
#include "internal.h"                          // for finish_clean_context
#include "linux/atomic/atomic-instrumented.h"  // for atomic_inc
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/compiler_attributes.h"         // for fallthrough
#include "linux/cred.h"                        // for get_cred, put_cred, cred
#include "linux/dcache.h"                      // for dentry, dput, dget
#include "linux/err.h"                         // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/errno.h"                       // for ENOPARAM
#include "linux/export.h"                      // for EXPORT_SYMBOL
#include "linux/gfp.h"                         // for GFP_KERNEL, GFP_KERNEL...
#include "linux/kern_levels.h"                 // for KERN_ERR, KERN_NOTICE
#include "linux/kernel.h"                      // for kasprintf, ARRAY_SIZE
#include "linux/mutex.h"                       // for mutex_init
#include "linux/printk.h"                      // for printk, pr_warn, va_fo...
#include "linux/refcount.h"                    // for refcount_dec_and_test
#include "linux/sched.h"                       // for task_struct
#include "linux/stdarg.h"                      // for va_end, va_start
#include "linux/stddef.h"                      // for true, false
#include "linux/string.h"                      // for kmemdup, kmemdup_nul
---
  ./scripts/check-local-export fs/fs_context.o
  iwyu2 -Wp,-MMD,fs/.fs_parser.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/fs_parser"' -DKBUILD_BASENAME='"fs_parser"' -DKBUILD_MODNAME='"fs_parser"' -D__KBUILD_MODNAME=kmod_fs_parser -c -o fs/fs_parser.o fs/fs_parser.c  

fs/fs_parser.c should add these lines:
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for ENOTBLK
#include "asm/string_32.h"           // for strcmp
#include "linux/compiler.h"          // for likely
#include "linux/compiler_types.h"    // for inline
#include "linux/dcache.h"            // for d_backing_inode
#include "linux/err.h"               // for IS_ERR, PTR_ERR
#include "linux/errno.h"             // for ENOPARAM
#include "linux/fs.h"                // for getname_kernel, putname, filename
#include "linux/kstrtox.h"           // for kstrtouint, kstrtoint, kstrtoull
#include "linux/path.h"              // for path, path_put
#include "linux/stat.h"              // for S_ISBLK
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool
#include "vdso/limits.h"             // for INT_MAX

fs/fs_parser.c should remove these lines:
- #include <linux/namei.h>  // lines 13-13
- #include <linux/security.h>  // lines 12-12
- #include <linux/slab.h>  // lines 11-11

The full include-list for fs/fs_parser.c:
#include <linux/export.h>            // for EXPORT_SYMBOL
#include <linux/fs_context.h>        // for fs_parameter, fs_parameter::(ano...
#include <linux/fs_parser.h>         // for fs_parameter_spec, fs_parse_result
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for ENOTBLK
#include "asm/string_32.h"           // for strcmp
#include "internal.h"                // for filename_lookup
#include "linux/compiler.h"          // for likely
#include "linux/compiler_types.h"    // for inline
#include "linux/dcache.h"            // for d_backing_inode
#include "linux/err.h"               // for IS_ERR, PTR_ERR
#include "linux/errno.h"             // for ENOPARAM
#include "linux/fs.h"                // for getname_kernel, putname, filename
#include "linux/kstrtox.h"           // for kstrtouint, kstrtoint, kstrtoull
#include "linux/path.h"              // for path, path_put
#include "linux/stat.h"              // for S_ISBLK
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool
#include "vdso/limits.h"             // for INT_MAX
---
  ./scripts/check-local-export fs/fs_parser.o
  iwyu2 -Wp,-MMD,fs/.fsopen.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/fsopen"' -DKBUILD_BASENAME='"fsopen"' -DKBUILD_MODNAME='"fsopen"' -D__KBUILD_MODNAME=kmod_fsopen -c -o fs/fsopen.o fs/fsopen.c  
In file included from fs/fsopen.c:12:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/fsopen.c:12:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/fsopen.c:12:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/fsopen.c:12:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from fs/fsopen.c:12:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/fsopen.c:12:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/fsopen.c:12:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/fsopen.c:12:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/fsopen.c should add these lines:
#include <linux/build_bug.h>            // for unlikely
#include <cstdio>                       // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"     // for EINVAL, EPERM, EBUSY, EBADF
#include "asm-generic/errno.h"          // for EOPNOTSUPP, EMSGSIZE, ENODATA
#include "asm-generic/fcntl.h"          // for O_CLOEXEC, O_RDWR
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/string_32.h"              // for strlen
#include "linux/capability.h"           // for ns_capable, CAP_SYS_ADMIN
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for __user
#include "linux/dcache.h"               // for dentry
#include "linux/err.h"                  // for IS_ERR, PTR_ERR
#include "linux/fcntl.h"                // for AT_FDCWD
#include "linux/fs.h"                   // for file, no_llseek, super_block
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/kernel.h"               // for ARRAY_SIZE
#include "linux/mount.h"                // for vfsmount
#include "linux/mutex.h"                // for mutex_unlock, mutex_lock_inte...
#include "linux/path.h"                 // for path_put, path
#include "linux/refcount.h"             // for refcount_set
#include "linux/rwsem.h"                // for up_write, down_write
#include "linux/string.h"               // for strndup_user, memdup_user_nul
#include "linux/types.h"                // for bool, loff_t

fs/fsopen.c should remove these lines:
- #include <linux/fs_parser.h>  // lines 9-9
- #include "mount.h"  // lines 19-19

The full include-list for fs/fsopen.c:
#include <linux/anon_inodes.h>          // for anon_inode_getfd
#include <linux/build_bug.h>            // for unlikely
#include <linux/file.h>                 // for fd, fdget, fdput, fget, fput
#include <linux/fs_context.h>           // for fs_parameter, fs_context, fs_...
#include <linux/namei.h>                // for user_path_at, LOOKUP_AUTOMOUNT
#include <linux/security.h>             // for security_sb_kern_mount
#include <linux/slab.h>                 // for kfree, kzalloc
#include <linux/syscalls.h>             // for __MAP2, __MAP3, __MAP5, SYSCA...
#include <linux/uaccess.h>              // for copy_to_user
#include <uapi/linux/mount.h>           // for FSCONFIG_SET_BINARY, FSCONFIG...
#include <cstdio>                       // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"     // for EINVAL, EPERM, EBUSY, EBADF
#include "asm-generic/errno.h"          // for EOPNOTSUPP, EMSGSIZE, ENODATA
#include "asm-generic/fcntl.h"          // for O_CLOEXEC, O_RDWR
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/string_32.h"              // for strlen
#include "internal.h"                   // for may_mount, finish_clean_context
#include "linux/capability.h"           // for ns_capable, CAP_SYS_ADMIN
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for __user
#include "linux/dcache.h"               // for dentry
#include "linux/err.h"                  // for IS_ERR, PTR_ERR
#include "linux/fcntl.h"                // for AT_FDCWD
#include "linux/fs.h"                   // for file, no_llseek, super_block
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/kernel.h"               // for ARRAY_SIZE
#include "linux/mount.h"                // for vfsmount
#include "linux/mutex.h"                // for mutex_unlock, mutex_lock_inte...
#include "linux/path.h"                 // for path_put, path
#include "linux/refcount.h"             // for refcount_set
#include "linux/rwsem.h"                // for up_write, down_write
#include "linux/string.h"               // for strndup_user, memdup_user_nul
#include "linux/types.h"                // for bool, loff_t
---
  ./scripts/check-local-export fs/fsopen.o
  iwyu2 -Wp,-MMD,fs/.init.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/init"' -DKBUILD_BASENAME='"init"' -DKBUILD_MODNAME='"init"' -D__KBUILD_MODNAME=kmod_init -c -o fs/init.o fs/init.c  

include/linux/init.h should add these lines:
#include <linux/linkage.h>              // for notrace
#include <stddef.h>                     // for NULL
#include "linux/compiler-clang.h"       // for __nocfi
#include "linux/compiler_attributes.h"  // for __section, __cold, __used
#include "linux/compiler_types.h"       // for __latent_entropy, __PASTE
#include "linux/kconfig.h"              // for IS_ENABLED

include/linux/init.h should remove these lines:
- struct file_system_type;  // lines 131-131

The full include-list for include/linux/init.h:
#include <linux/compiler.h>             // for offset_to_ptr, __ADDRESSABLE
#include <linux/linkage.h>              // for notrace
#include <linux/types.h>                // for bool
#include <stddef.h>                     // for NULL
#include "linux/compiler-clang.h"       // for __nocfi
#include "linux/compiler_attributes.h"  // for __section, __cold, __used
#include "linux/compiler_types.h"       // for __latent_entropy, __PASTE
#include "linux/kconfig.h"              // for IS_ENABLED
---

fs/init.c should add these lines:
#include <sys/types.h>               // for gid_t, uid_t
#include "asm-generic/errno-base.h"  // for EINVAL, EPERM, EXDEV
#include "asm/current.h"             // for current
#include "linux/capability.h"        // for ns_capable, CAP_SYS_CHROOT
#include "linux/compiler.h"          // for unlikely
#include "linux/cred.h"              // for current_user_ns
#include "linux/dcache.h"            // for dentry
#include "linux/err.h"               // for IS_ERR, PTR_ERR
#include "linux/fcntl.h"             // for AT_FDCWD, AT_SYMLINK_NOFOLLOW
#include "linux/kdev_t.h"            // for new_decode_dev
#include "linux/path.h"              // for path, path_put
#include "linux/sched.h"             // for task_struct
#include "linux/stat.h"              // for STATX_BASIC_STATS, S_ISBLK, S_ISCHR
#include "linux/types.h"             // for umode_t
struct timespec64;

fs/init.c should remove these lines:

The full include-list for fs/init.c:
#include <linux/init.h>
#include <linux/file.h>              // for fd_install, get_unused_fd_flags
#include <linux/fs.h>                // for path_permission, current_umask
#include <linux/fs_struct.h>         // for set_fs_pwd, set_fs_root
#include <linux/init_syscalls.h>     // for init_chdir, init_chmod, init_chown
#include <linux/mount.h>             // for mnt_user_ns, mnt_drop_write, mnt...
#include <linux/namei.h>             // for kern_path, done_path_create, ker...
#include <linux/security.h>          // for security_path_chroot, security_p...
#include <sys/types.h>               // for gid_t, uid_t
#include "asm-generic/errno-base.h"  // for EINVAL, EPERM, EXDEV
#include "asm/current.h"             // for current
#include "internal.h"                // for chmod_common, chown_common, do_r...
#include "linux/capability.h"        // for ns_capable, CAP_SYS_CHROOT
#include "linux/compiler.h"          // for unlikely
#include "linux/cred.h"              // for current_user_ns
#include "linux/dcache.h"            // for dentry
#include "linux/err.h"               // for IS_ERR, PTR_ERR
#include "linux/fcntl.h"             // for AT_FDCWD, AT_SYMLINK_NOFOLLOW
#include "linux/kdev_t.h"            // for new_decode_dev
#include "linux/path.h"              // for path, path_put
#include "linux/sched.h"             // for task_struct
#include "linux/stat.h"              // for STATX_BASIC_STATS, S_ISBLK, S_ISCHR
#include "linux/types.h"             // for umode_t
struct timespec64;
---
  ./scripts/check-local-export fs/init.o
  iwyu2 -Wp,-MMD,fs/.kernel_read_file.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/kernel_read_file"' -DKBUILD_BASENAME='"kernel_read_file"' -DKBUILD_MODNAME='"kernel_read_file"' -D__KBUILD_MODNAME=kmod_kernel_read_file -c -o fs/kernel_read_file.o fs/kernel_read_file.c  

fs/kernel_read_file.c should add these lines:
#include <cstdio>                    // for size_t, NULL, ssize_t
#include "asm-generic/errno-base.h"  // for EINVAL, EFBIG, EBADF, EIO, ENOMEM
#include "asm-generic/fcntl.h"       // for O_RDONLY
#include "linux/err.h"               // for IS_ERR, PTR_ERR
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/file.h"              // for fput, fd, fdget, fdput
#include "linux/minmax.h"            // for min_t
#include "linux/path.h"              // for path_put, path
#include "linux/sched.h"             // for task_struct
#include "linux/sched/task.h"        // for init_task, task_lock, task_unlock
#include "linux/stat.h"              // for S_ISREG
#include "linux/types.h"             // for loff_t, bool
#include "vdso/limits.h"             // for INT_MAX

fs/kernel_read_file.c should remove these lines:

The full include-list for fs/kernel_read_file.c:
#include <linux/fs.h>                // for file_inode, allow_write_access
#include <linux/fs_struct.h>         // for get_fs_root
#include <linux/kernel_read_file.h>  // for kernel_read_file_id, kernel_read...
#include <linux/security.h>          // for security_kernel_post_read_file
#include <linux/vmalloc.h>           // for vfree, vmalloc
#include <cstdio>                    // for size_t, NULL, ssize_t
#include "asm-generic/errno-base.h"  // for EINVAL, EFBIG, EBADF, EIO, ENOMEM
#include "asm-generic/fcntl.h"       // for O_RDONLY
#include "linux/err.h"               // for IS_ERR, PTR_ERR
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/file.h"              // for fput, fd, fdget, fdput
#include "linux/minmax.h"            // for min_t
#include "linux/path.h"              // for path_put, path
#include "linux/sched.h"             // for task_struct
#include "linux/sched/task.h"        // for init_task, task_lock, task_unlock
#include "linux/stat.h"              // for S_ISREG
#include "linux/types.h"             // for loff_t, bool
#include "vdso/limits.h"             // for INT_MAX
---
  ./scripts/check-local-export fs/kernel_read_file.o
  iwyu2 -Wp,-MMD,fs/.remap_range.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/remap_range"' -DKBUILD_BASENAME='"remap_range"' -DKBUILD_MODNAME='"remap_range"' -D__KBUILD_MODNAME=kmod_remap_range -c -o fs/remap_range.o fs/remap_range.c  
In file included from fs/remap_range.c:8:
In file included from ./include/linux/fsnotify.h:16:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^
In file included from fs/remap_range.c:11:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/remap_range.c:11:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/remap_range.c:11:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/remap_range.c:11:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
5 warnings generated.
In file included from fs/remap_range.c:8:
In file included from ./include/linux/fsnotify.h:16:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^
In file included from fs/remap_range.c:11:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from fs/remap_range.c:11:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from fs/remap_range.c:11:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:5:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from fs/remap_range.c:11:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/remap_range.c should add these lines:
#include <asm/bug.h>                 // for WARN_ON_ONCE
#include <linux/mm.h>                // for folio_test_uptodate
#include <stdint.h>                  // for uint64_t
#include "asm-generic/errno-base.h"  // for EINVAL, EISDIR, EPERM, EXDEV, EBADF
#include "asm-generic/errno.h"       // for EBADE, EOPNOTSUPP
#include "asm-generic/int-ll64.h"    // for u64, u16
#include "asm/current.h"             // for current
#include "asm/page_types.h"          // for PAGE_SIZE, PAGE_SHIFT
#include "asm/string_32.h"           // for memcmp
#include "linux/align.h"             // for IS_ALIGNED, ALIGN, ALIGN_DOWN
#include "linux/cacheflush.h"        // for flush_dcache_folio
#include "linux/capability.h"        // for capable, CAP_SYS_ADMIN
#include "linux/compiler.h"          // for unlikely
#include "linux/cred.h"              // for cred, current_fsuid
#include "linux/err.h"               // for IS_ERR, PTR_ERR, ERR_PTR
#include "linux/fs.h"                // for file (ptr only), file_dedupe_ran...
#include "linux/highmem-internal.h"  // for kmap_local_folio, kunmap_local
#include "linux/minmax.h"            // for min, min_t, swap
#include "linux/mm.h"                // for folio_put, offset_in_folio, offs...
#include "linux/mm_types.h"          // for folio, folio::(anonymous union):...
#include "linux/sched.h"             // for task_struct
#include "linux/sched/signal.h"      // for fatal_signal_pending
#include "linux/stat.h"              // for S_ISDIR, S_ISREG
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for loff_t, bool
#include "linux/uidgid.h"            // for uid_eq

fs/remap_range.c should remove these lines:
- #include <asm/unistd.h>  // lines 20-20
- #include <linux/compat.h>  // lines 14-14
- #include <linux/fcntl.h>  // lines 5-5
- #include <linux/sched/xacct.h>  // lines 4-4
- #include <linux/slab.h>  // lines 2-2
- #include <linux/splice.h>  // lines 13-13
- #include <linux/stat.h>  // lines 3-3
- #include <linux/syscalls.h>  // lines 11-11
- #include <linux/uaccess.h>  // lines 19-19
- #include <linux/uio.h>  // lines 7-7
- #include "internal.h"  // lines 17-17

The full include-list for fs/remap_range.c:
#include <asm/bug.h>                 // for WARN_ON_ONCE
#include <linux/export.h>            // for EXPORT_SYMBOL
#include <linux/file.h>              // for fdget, fdput, fd
#include <linux/fs.h>                // for file_inode, i_size_read, inode
#include <linux/fsnotify.h>          // for fsnotify_access, fsnotify_modify
#include <linux/mm.h>                // for folio_test_uptodate
#include <linux/mount.h>             // for mnt_drop_write_file, mnt_want_wr...
#include <linux/pagemap.h>           // for filemap_write_and_wait_range
#include <linux/security.h>          // for security_file_permission
#include <stdint.h>                  // for uint64_t
#include "asm-generic/errno-base.h"  // for EINVAL, EISDIR, EPERM, EXDEV, EBADF
#include "asm-generic/errno.h"       // for EBADE, EOPNOTSUPP
#include "asm-generic/int-ll64.h"    // for u64, u16
#include "asm/current.h"             // for current
#include "asm/page_types.h"          // for PAGE_SIZE, PAGE_SHIFT
#include "asm/string_32.h"           // for memcmp
#include "linux/align.h"             // for IS_ALIGNED, ALIGN, ALIGN_DOWN
#include "linux/cacheflush.h"        // for flush_dcache_folio
#include "linux/capability.h"        // for capable, CAP_SYS_ADMIN
#include "linux/compiler.h"          // for unlikely
#include "linux/cred.h"              // for cred, current_fsuid
#include "linux/err.h"               // for IS_ERR, PTR_ERR, ERR_PTR
#include "linux/fs.h"                // for file (ptr only), file_dedupe_ran...
#include "linux/highmem-internal.h"  // for kmap_local_folio, kunmap_local
#include "linux/minmax.h"            // for min, min_t, swap
#include "linux/mm.h"                // for folio_put, offset_in_folio, offs...
#include "linux/mm_types.h"          // for folio, folio::(anonymous union):...
#include "linux/sched.h"             // for task_struct
#include "linux/sched/signal.h"      // for fatal_signal_pending
#include "linux/stat.h"              // for S_ISDIR, S_ISREG
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for loff_t, bool
#include "linux/uidgid.h"            // for uid_eq
---
  ./scripts/check-local-export fs/remap_range.o
  iwyu2 -Wp,-MMD,fs/.no-block.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/no-block"' -DKBUILD_BASENAME='"no_block"' -DKBUILD_MODNAME='"no_block"' -D__KBUILD_MODNAME=kmod_no_block -c -o fs/no-block.o fs/no-block.c  

fs/no-block.c should add these lines:
#include "asm-generic/errno-base.h"  // for ENODEV

fs/no-block.c should remove these lines:
- #include <linux/kernel.h>  // lines 8-8

The full include-list for fs/no-block.c:
#include <linux/fs.h>                // for noop_llseek, file_operations
#include "asm-generic/errno-base.h"  // for ENODEV
---
  ./scripts/check-local-export fs/no-block.o
  iwyu2 -Wp,-MMD,fs/.anon_inodes.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/anon_inodes"' -DKBUILD_BASENAME='"anon_inodes"' -DKBUILD_MODNAME='"anon_inodes"' -D__KBUILD_MODNAME=kmod_anon_inodes -c -o fs/anon_inodes.o fs/anon_inodes.c  

fs/anon_inodes.c should add these lines:
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for ENODEV, ENOENT, ENOMEM
#include "asm-generic/fcntl.h"       // for O_ACCMODE, O_NONBLOCK
#include "asm/cache.h"               // for __read_mostly
#include "asm/string_32.h"           // for strlen
#include "linux/dcache.h"            // for dynamic_dname, qstr, QSTR_INIT
#include "linux/err.h"               // for IS_ERR, ERR_PTR, PTR_ERR, ERR_CAST
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/panic.h"             // for panic
#include "linux/security.h"          // for security_inode_init_security_anon
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool
struct fs_context;

fs/anon_inodes.c should remove these lines:
- #include <linux/cred.h>  // lines 12-12
- #include <linux/kernel.h>  // lines 20-20
- #include <linux/poll.h>  // lines 14-14
- #include <linux/sched.h>  // lines 15-15
- #include <linux/uaccess.h>  // lines 25-25

The full include-list for fs/anon_inodes.c:
#include <linux/anon_inodes.h>       // for anon_inode_getfd, anon_inode_get...
#include <linux/file.h>              // for alloc_file_pseudo, fd_install
#include <linux/fs.h>                // for alloc_anon_inode, iput, kill_ano...
#include <linux/init.h>              // for __init, fs_initcall
#include <linux/magic.h>             // for ANON_INODE_FS_MAGIC
#include <linux/module.h>            // for module_put, try_module_get
#include <linux/mount.h>             // for kern_mount, vfsmount
#include <linux/pseudo_fs.h>         // for init_pseudo, pseudo_fs_context
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for ENODEV, ENOENT, ENOMEM
#include "asm-generic/fcntl.h"       // for O_ACCMODE, O_NONBLOCK
#include "asm/cache.h"               // for __read_mostly
#include "asm/string_32.h"           // for strlen
#include "linux/dcache.h"            // for dynamic_dname, qstr, QSTR_INIT
#include "linux/err.h"               // for IS_ERR, ERR_PTR, PTR_ERR, ERR_CAST
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/panic.h"             // for panic
#include "linux/security.h"          // for security_inode_init_security_anon
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool
struct fs_context;
---
  ./scripts/check-local-export fs/anon_inodes.o
  iwyu2 -Wp,-MMD,fs/.binfmt_elf.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"fs/binfmt_elf"' -DKBUILD_BASENAME='"binfmt_elf"' -DKBUILD_MODNAME='"binfmt_elf"' -D__KBUILD_MODNAME=kmod_binfmt_elf -c -o fs/binfmt_elf.o fs/binfmt_elf.c  
In file included from fs/binfmt_elf.c:31:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
1 warning generated.
In file included from fs/binfmt_elf.c:31:
In file included from ./include/linux/hugetlb.h:9:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

fs/binfmt_elf.c should add these lines:
#include <asm/bug.h>                    // for WARN_ON_ONCE
#include <asm/page_types.h>             // for TASK_SIZE, STACK_TOP
#include <cstdio>                       // for NULL, size_t, ssize_t
#include "asm-generic/errno-base.h"     // for EFAULT, ENOEXEC, EINVAL, EIO
#include "asm-generic/errno.h"          // for ELIBBAD
#include "asm-generic/int-ll64.h"       // for u32
#include "asm-generic/mman-common.h"    // for PROT_EXEC, MAP_FIXED, MAP_FIX...
#include "asm-generic/param.h"          // for CLOCKS_PER_SEC
#include "asm/current.h"                // for current
#include "asm/elf.h"                    // for elf_check_arch, ARCH_DLINFO
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/processor.h"              // for arch_align_stack
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/string_32.h"              // for strlen, strncmp, memcmp, memset
#include "asm/uaccess.h"                // for clear_user, strnlen_user, put...
#include "generated/autoconf.h"         // for CONFIG_ARCH_HAS_ELF_RANDOMIZE
#include "linux/auxvec.h"               // for AT_BASE, AT_BASE_PLATFORM
#include "linux/binfmts.h"              // for MAX_ARG_STRLEN, linux_binprm ...
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/compiler_attributes.h"  // for __maybe_unused
#include "linux/compiler_types.h"       // for __user, inline
#include "linux/elf.h"                  // for elf32_phdr, elf32_hdr, Elf32_Off
#include "linux/err.h"                  // for IS_ERR, PTR_ERR
#include "linux/export.h"               // for THIS_MODULE
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/kconfig.h"              // for IS_ENABLED, __ARG_PLACEHOLDER_1
#include "linux/limits.h"               // for PATH_MAX
#include "linux/math.h"                 // for round_up
#include "linux/minmax.h"               // for max, min
#include "linux/mm_types.h"             // for mm_struct, mm_struct::(anonym...
#include "linux/mman.h"                 // for MAP_PRIVATE
#include "linux/mmap_lock.h"            // for mmap_read_lock_killable, mmap...
#include "linux/personality.h"          // for ADDR_NO_RANDOMIZE, MMAP_PAGE_...
#include "linux/printk.h"               // for pr_info
#include "linux/ptrace.h"               // for current_pt_regs
#include "linux/stddef.h"               // for false, true
#include "linux/uidgid.h"               // for from_kgid_munged, from_kuid_m...

fs/binfmt_elf.c should remove these lines:
- #include <asm/page.h>  // lines 50-50
- #include <asm/param.h>  // lines 49-49
- #include <linux/coredump.h>  // lines 39-39
- #include <linux/dax.h>  // lines 47-47
- #include <linux/elfcore.h>  // lines 26-26
- #include <linux/errno.h>  // lines 19-19
- #include <linux/highmem.h>  // lines 30-30
- #include <linux/highuid.h>  // lines 28-28
- #include <linux/hugetlb.h>  // lines 31-31
- #include <linux/kernel.h>  // lines 14-14
- #include <linux/mman.h>  // lines 18-18
- #include <linux/pagemap.h>  // lines 32-32
- #include <linux/personality.h>  // lines 25-25
- #include <linux/sched/coredump.h>  // lines 41-41
- #include <linux/sched/cputime.h>  // lines 43-43
- #include <linux/sched/task_stack.h>  // lines 42-42
- #include <linux/security.h>  // lines 34-34
- #include <linux/signal.h>  // lines 20-20
- #include <linux/string.h>  // lines 22-22
- #include <linux/utsname.h>  // lines 38-38
- #include <linux/vmalloc.h>  // lines 33-33

The full include-list for fs/binfmt_elf.c:
#include <asm/bug.h>                    // for WARN_ON_ONCE
#include <asm/page_types.h>             // for TASK_SIZE, STACK_TOP
#include <linux/binfmts.h>              // for linux_binprm, begin_new_exec
#include <linux/compiler.h>             // for unlikely, likely
#include <linux/cred.h>                 // for cred, current_cred
#include <linux/elf-randomize.h>        // for arch_mmap_rnd, arch_randomize...
#include <linux/elf.h>                  // for elf_addr_t, elf_phdr, gnu_pro...
#include <linux/file.h>                 // for fput
#include <linux/fs.h>                   // for allow_write_access, kernel_read
#include <linux/init.h>                 // for __exit, __init, core_initcall
#include <linux/log2.h>                 // for is_power_of_2
#include <linux/mm.h>                   // for vm_mmap, vm_brk_flags, find_e...
#include <linux/module.h>               // for MODULE_LICENSE, module_exit
#include <linux/random.h>               // for get_random_bytes
#include <linux/sched.h>                // for task_struct, PF_RANDOMIZE
#include <linux/sizes.h>                // for SZ_1K
#include <linux/slab.h>                 // for kfree, kmalloc
#include <linux/types.h>                // for bool, loff_t
#include <linux/uaccess.h>              // for copy_to_user
#include <cstdio>                       // for NULL, size_t, ssize_t
#include "asm-generic/errno-base.h"     // for EFAULT, ENOEXEC, EINVAL, EIO
#include "asm-generic/errno.h"          // for ELIBBAD
#include "asm-generic/int-ll64.h"       // for u32
#include "asm-generic/mman-common.h"    // for PROT_EXEC, MAP_FIXED, MAP_FIX...
#include "asm-generic/param.h"          // for CLOCKS_PER_SEC
#include "asm/current.h"                // for current
#include "asm/elf.h"                    // for elf_check_arch, ARCH_DLINFO
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/processor.h"              // for arch_align_stack
#include "asm/ptrace.h"                 // for pt_regs
#include "asm/string_32.h"              // for strlen, strncmp, memcmp, memset
#include "asm/uaccess.h"                // for clear_user, strnlen_user, put...
#include "generated/autoconf.h"         // for CONFIG_ARCH_HAS_ELF_RANDOMIZE
#include "linux/auxvec.h"               // for AT_BASE, AT_BASE_PLATFORM
#include "linux/binfmts.h"              // for MAX_ARG_STRLEN, linux_binprm ...
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/compiler_attributes.h"  // for __maybe_unused
#include "linux/compiler_types.h"       // for __user, inline
#include "linux/elf.h"                  // for elf32_phdr, elf32_hdr, Elf32_Off
#include "linux/err.h"                  // for IS_ERR, PTR_ERR
#include "linux/export.h"               // for THIS_MODULE
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/kconfig.h"              // for IS_ENABLED, __ARG_PLACEHOLDER_1
#include "linux/limits.h"               // for PATH_MAX
#include "linux/math.h"                 // for round_up
#include "linux/minmax.h"               // for max, min
#include "linux/mm_types.h"             // for mm_struct, mm_struct::(anonym...
#include "linux/mman.h"                 // for MAP_PRIVATE
#include "linux/mmap_lock.h"            // for mmap_read_lock_killable, mmap...
#include "linux/personality.h"          // for ADDR_NO_RANDOMIZE, MMAP_PAGE_...
#include "linux/printk.h"               // for pr_info
#include "linux/ptrace.h"               // for current_pt_regs
#include "linux/stddef.h"               // for false, true
#include "linux/uidgid.h"               // for from_kgid_munged, from_kuid_m...
---
  ./scripts/check-local-export fs/binfmt_elf.o
  rm -f fs/built-in.a; echo open.o read_write.o file_table.o super.o char_dev.o stat.o exec.o pipe.o namei.o fcntl.o ioctl.o readdir.o select.o dcache.o inode.o attr.o bad_inode.o file.o filesystems.o namespace.o seq_file.o xattr.o libfs.o fs-writeback.o pnode.o splice.o sync.o utimes.o d_path.o stack.o fs_struct.o statfs.o fs_pin.o nsfs.o fs_types.o fs_context.o fs_parser.o fsopen.o init.o kernel_read_file.o remap_range.o no-block.o anon_inodes.o binfmt_elf.o ramfs/built-in.a | sed -E 's:([^ ]+):fs/:g' | xargs llvm-ar cDPrST fs/built-in.a
make -f ./scripts/Makefile.build obj=security \
single-build= \
need-builtin=1 need-modorder=1
  iwyu2 -Wp,-MMD,security/.commoncap.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"security/commoncap"' -DKBUILD_BASENAME='"commoncap"' -DKBUILD_MODNAME='"commoncap"' -D__KBUILD_MODNAME=kmod_commoncap -c -o security/commoncap.o security/commoncap.c  
In file included from security/commoncap.c:6:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^
In file included from security/commoncap.c:14:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from security/commoncap.c:14:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from security/commoncap.c:14:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from security/commoncap.c:14:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from security/commoncap.c:15:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
6 warnings generated.
In file included from security/commoncap.c:6:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^
In file included from security/commoncap.c:14:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from security/commoncap.c:14:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from security/commoncap.c:14:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from security/commoncap.c:14:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from security/commoncap.c:15:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^

security/commoncap.c should add these lines:
#include <asm/bug.h>                  // for WARN_ON
#include <stddef.h>                   // for NULL
#include <sys/types.h>                // for size_t, uid_t
#include "asm-generic/errno-base.h"   // for EPERM, EINVAL, ENOMEM
#include "asm-generic/errno.h"        // for ENODATA, EOPNOTSUPP, ENOSYS
#include "asm-generic/int-ll64.h"     // for __u32, u32
#include "asm/current.h"              // for current
#include "asm/string_32.h"            // for strcmp, strncmp, memcpy, memset
#include "linux/byteorder/generic.h"  // for le32_to_cpu, cpu_to_le32
#include "linux/capability.h"         // for vfs_ns_cap_data, vfs_cap_data
#include "linux/compiler_types.h"     // for inline
#include "linux/cred.h"               // for cred, commit_creds, current_cred
#include "linux/dcache.h"             // for d_backing_inode, d_find_any_alias
#include "linux/fs.h"                 // for super_block, inode, file, file_...
#include "linux/gfp.h"                // for GFP_ATOMIC, GFP_NOFS
#include "linux/kern_levels.h"        // for KERN_INFO, KERN_NOTICE
#include "linux/path.h"               // for path
#include "linux/personality.h"        // for PER_CLEAR_ON_SETID
#include "linux/printk.h"             // for printk
#include "linux/rcupdate.h"           // for rcu_read_lock, rcu_read_unlock
#include "linux/securebits.h"         // for SECURE_KEEP_CAPS, SECURE_ALL_LOCKS
#include "linux/security.h"           // for CAP_OPT_NONE, CAP_OPT_NOAUDIT
#include "linux/slab.h"               // for kzalloc, kfree, kmalloc
#include "linux/stddef.h"             // for false, true
#include "linux/types.h"              // for bool, __le32
#include "linux/uidgid.h"             // for uid_eq, make_kuid, kuid_t, from...
#include "linux/xattr.h"              // for XATTR_NAME_CAPS, XATTR_SECURITY...
struct mm_struct;
struct timespec64;
struct timezone;

security/commoncap.c should remove these lines:
- #include <linux/file.h>  // lines 10-10
- #include <linux/hugetlb.h>  // lines 19-19
- #include <linux/init.h>  // lines 7-7
- #include <linux/kernel.h>  // lines 8-8
- #include <linux/mm.h>  // lines 11-11
- #include <linux/mman.h>  // lines 12-12
- #include <linux/netlink.h>  // lines 16-16
- #include <linux/pagemap.h>  // lines 13-13
- #include <linux/personality.h>  // lines 26-26
- #include <linux/skbuff.h>  // lines 15-15
- #include <linux/swap.h>  // lines 14-14

The full include-list for security/commoncap.c:
#include <asm/bug.h>                  // for WARN_ON
#include <linux/audit.h>              // for audit_log_bprm_fcaps
#include <linux/binfmts.h>            // for linux_binprm
#include <linux/capability.h>         // for cap_issubset, ns_capable, kerne...
#include <linux/mnt_idmapping.h>      // for mapped_kuid_fs, mapped_kuid_user
#include <linux/mount.h>              // for mnt_may_suid, vfsmount
#include <linux/prctl.h>              // for PR_CAP_AMBIENT_RAISE, PR_CAPBSE...
#include <linux/ptrace.h>             // for PTRACE_MODE_FSCREDS
#include <linux/sched.h>              // for task_struct, PF_SUPERPRIV
#include <linux/securebits.h>         // for issecure
#include <linux/user_namespace.h>     // for user_namespace, current_in_userns
#include <linux/xattr.h>              // for __vfs_getxattr, __vfs_removexattr
#include <stddef.h>                   // for NULL
#include <sys/types.h>                // for size_t, uid_t
#include "asm-generic/errno-base.h"   // for EPERM, EINVAL, ENOMEM
#include "asm-generic/errno.h"        // for ENODATA, EOPNOTSUPP, ENOSYS
#include "asm-generic/int-ll64.h"     // for __u32, u32
#include "asm/current.h"              // for current
#include "asm/string_32.h"            // for strcmp, strncmp, memcpy, memset
#include "linux/byteorder/generic.h"  // for le32_to_cpu, cpu_to_le32
#include "linux/capability.h"         // for vfs_ns_cap_data, vfs_cap_data
#include "linux/compiler_types.h"     // for inline
#include "linux/cred.h"               // for cred, commit_creds, current_cred
#include "linux/dcache.h"             // for d_backing_inode, d_find_any_alias
#include "linux/fs.h"                 // for super_block, inode, file, file_...
#include "linux/gfp.h"                // for GFP_ATOMIC, GFP_NOFS
#include "linux/kern_levels.h"        // for KERN_INFO, KERN_NOTICE
#include "linux/path.h"               // for path
#include "linux/personality.h"        // for PER_CLEAR_ON_SETID
#include "linux/printk.h"             // for printk
#include "linux/rcupdate.h"           // for rcu_read_lock, rcu_read_unlock
#include "linux/securebits.h"         // for SECURE_KEEP_CAPS, SECURE_ALL_LOCKS
#include "linux/security.h"           // for CAP_OPT_NONE, CAP_OPT_NOAUDIT
#include "linux/slab.h"               // for kzalloc, kfree, kmalloc
#include "linux/stddef.h"             // for false, true
#include "linux/types.h"              // for bool, __le32
#include "linux/uidgid.h"             // for uid_eq, make_kuid, kuid_t, from...
#include "linux/xattr.h"              // for XATTR_NAME_CAPS, XATTR_SECURITY...
struct mm_struct;
struct timespec64;
struct timezone;
---
  ./scripts/check-local-export security/commoncap.o
  iwyu2 -Wp,-MMD,security/.min_addr.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"security/min_addr"' -DKBUILD_BASENAME='"min_addr"' -DKBUILD_MODNAME='"min_addr"' -D__KBUILD_MODNAME=kmod_min_addr -c -o security/min_addr.o security/min_addr.c  

security/min_addr.c should add these lines:
#include <stddef.h>                  // for size_t
#include "asm-generic/errno-base.h"  // for EPERM
#include "generated/autoconf.h"      // for CONFIG_DEFAULT_MMAP_MIN_ADDR
#include "linux/capability.h"        // for capable, CAP_SYS_RAWIO
#include "linux/types.h"             // for loff_t

security/min_addr.c should remove these lines:
- #include <linux/mm.h>  // lines 3-3

The full include-list for security/min_addr.c:
#include <linux/init.h>              // for __init, pure_initcall
#include <linux/security.h>          // for mmap_min_addr_handler
#include <linux/sysctl.h>            // for proc_doulongvec_minmax
#include <stddef.h>                  // for size_t
#include "asm-generic/errno-base.h"  // for EPERM
#include "generated/autoconf.h"      // for CONFIG_DEFAULT_MMAP_MIN_ADDR
#include "linux/capability.h"        // for capable, CAP_SYS_RAWIO
#include "linux/types.h"             // for loff_t
---
  ./scripts/check-local-export security/min_addr.o
  rm -f security/built-in.a; echo commoncap.o min_addr.o | sed -E 's:([^ ]+):security/:g' | xargs llvm-ar cDPrST security/built-in.a
make -f ./scripts/Makefile.build obj=drivers \
single-build= \
need-builtin=1 need-modorder=1
make -f ./scripts/Makefile.build obj=drivers/video \
 \
need-builtin=1 \
need-modorder=1
make -f ./scripts/Makefile.build obj=drivers/video/console \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,drivers/video/console/.dummycon.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/video/console/dummycon"' -DKBUILD_BASENAME='"dummycon"' -DKBUILD_MODNAME='"dummycon"' -D__KBUILD_MODNAME=kmod_dummycon -c -o drivers/video/console/dummycon.o drivers/video/console/dummycon.c  
In file included from drivers/video/console/dummycon.c:12:
In file included from ./include/linux/vt_kern.h:12:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/video/console/dummycon.c:12:
In file included from ./include/linux/vt_kern.h:12:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/video/console/dummycon.c:12:
In file included from ./include/linux/vt_kern.h:12:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/video/console/dummycon.c:12:
In file included from ./include/linux/vt_kern.h:12:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/video/console/dummycon.c:12:
In file included from ./include/linux/vt_kern.h:12:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/video/console/dummycon.c:12:
In file included from ./include/linux/vt_kern.h:12:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/video/console/dummycon.c should add these lines:
#include "generated/autoconf.h"    // for CONFIG_DUMMY_CONSOLE_COLUMNS, CONF...
#include "linux/console_struct.h"  // for vc_data
#include "linux/export.h"          // for EXPORT_SYMBOL_GPL, THIS_MODULE
#include "linux/stddef.h"          // for false

drivers/video/console/dummycon.c should remove these lines:
- #include <linux/init.h>  // lines 14-14
- #include <linux/kdev_t.h>  // lines 10-10
- #include <linux/module.h>  // lines 15-15
- #include <linux/screen_info.h>  // lines 13-13

The full include-list for drivers/video/console/dummycon.c:
#include <linux/console.h>         // for con_scroll, consw
#include <linux/types.h>           // for bool
#include <linux/vt_kern.h>         // for vc_resize
#include "generated/autoconf.h"    // for CONFIG_DUMMY_CONSOLE_COLUMNS, CONF...
#include "linux/console_struct.h"  // for vc_data
#include "linux/export.h"          // for EXPORT_SYMBOL_GPL, THIS_MODULE
#include "linux/stddef.h"          // for false
---
  ./scripts/check-local-export drivers/video/console/dummycon.o
  iwyu2 -Wp,-MMD,drivers/video/console/.vgacon.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/video/console/vgacon"' -DKBUILD_BASENAME='"vgacon"' -DKBUILD_MODNAME='"vgacon"' -D__KBUILD_MODNAME=kmod_vgacon -c -o drivers/video/console/vgacon.o drivers/video/console/vgacon.c  
In file included from drivers/video/console/vgacon.c:44:
In file included from ./include/linux/vt_kern.h:12:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/video/console/vgacon.c:44:
In file included from ./include/linux/vt_kern.h:12:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/video/console/vgacon.c:44:
In file included from ./include/linux/vt_kern.h:12:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/video/console/vgacon.c:44:
In file included from ./include/linux/vt_kern.h:12:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/video/console/vgacon.c:44:
In file included from ./include/linux/vt_kern.h:12:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/video/console/vgacon.c:44:
In file included from ./include/linux/vt_kern.h:12:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/video/console/vgacon.c should add these lines:
#include <stddef.h>                    // for NULL
#include "asm-generic/errno-base.h"    // for EINVAL
#include "asm-generic/int-ll64.h"      // for u16, u8, u32
#include "asm/cache.h"                 // for __read_mostly
#include "asm/shared/io.h"             // for outw
#include "asm/vga.h"                   // for VGA_MAP_MEM, vga_readb, vga_wr...
#include "linux/compiler_types.h"      // for inline
#include "linux/console_struct.h"      // for vc_data, con_is_visible, vc_state
#include "linux/export.h"              // for EXPORT_SYMBOL, THIS_MODULE
#include "linux/screen_info.h"         // for screen_info, VIDEO_TYPE_VGAC
#include "linux/spinlock_types_raw.h"  // for DEFINE_RAW_SPINLOCK
#include "linux/stddef.h"              // for false, true
#include "linux/vt.h"                  // for MAX_NR_CONSOLES
#include "linux/vt_buffer.h"           // for scr_writew, scr_memcpyw, scr_m...

drivers/video/console/vgacon.c should remove these lines:
- #include <linux/fs.h>  // lines 38-38
- #include <linux/kernel.h>  // lines 39-39
- #include <linux/slab.h>  // lines 43-43
- #include <linux/string.h>  // lines 41-41

The full include-list for drivers/video/console/vgacon.c:
#include <asm/io.h>                    // for outb_p, inb_p
#include <linux/console.h>             // for consw, CM_DRAW, conswitchp
#include <linux/init.h>                // for __init, __setup
#include <linux/ioport.h>              // for request_resource, IORESOURCE_IO
#include <linux/kd.h>                  // for console_font, KD_TEXT, KD_FONT...
#include <linux/module.h>              // for MODULE_LICENSE
#include <linux/sched.h>               // for cond_resched
#include <linux/screen_info.h>         // for screen_info
#include <linux/selection.h>           // for color_table, console_blanked
#include <linux/spinlock.h>            // for raw_spin_lock_irq, raw_spin_un...
#include <linux/types.h>               // for bool
#include <linux/vt_kern.h>             // for con_free_unimap, con_set_defau...
#include <stddef.h>                    // for NULL
#include <video/vga.h>                 // for vga_w, vgastate, vga_wseq, vga...
#include "asm-generic/errno-base.h"    // for EINVAL
#include "asm-generic/int-ll64.h"      // for u16, u8, u32
#include "asm/cache.h"                 // for __read_mostly
#include "asm/shared/io.h"             // for outw
#include "asm/vga.h"                   // for VGA_MAP_MEM, vga_readb, vga_wr...
#include "linux/compiler_types.h"      // for inline
#include "linux/console_struct.h"      // for vc_data, con_is_visible, vc_state
#include "linux/export.h"              // for EXPORT_SYMBOL, THIS_MODULE
#include "linux/screen_info.h"         // for screen_info, VIDEO_TYPE_VGAC
#include "linux/spinlock_types_raw.h"  // for DEFINE_RAW_SPINLOCK
#include "linux/stddef.h"              // for false, true
#include "linux/vt.h"                  // for MAX_NR_CONSOLES
#include "linux/vt_buffer.h"           // for scr_writew, scr_memcpyw, scr_m...
---
  ./scripts/check-local-export drivers/video/console/vgacon.o
  rm -f drivers/video/console/built-in.a; echo dummycon.o vgacon.o | sed -E 's:([^ ]+):drivers/video/console/:g' | xargs llvm-ar cDPrST drivers/video/console/built-in.a
  rm -f drivers/video/built-in.a; echo console/built-in.a | sed -E 's:([^ ]+):drivers/video/:g' | xargs llvm-ar cDPrST drivers/video/built-in.a
make -f ./scripts/Makefile.build obj=drivers/tty \
 \
need-builtin=1 \
need-modorder=1
make -f ./scripts/Makefile.build obj=drivers/tty/vt \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,drivers/tty/vt/.vt_ioctl.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/tty/vt/vt_ioctl"' -DKBUILD_BASENAME='"vt_ioctl"' -DKBUILD_MODNAME='"vt_ioctl"' -D__KBUILD_MODNAME=kmod_vt_ioctl -c -o drivers/tty/vt/vt_ioctl.o drivers/tty/vt/vt_ioctl.c  
In file included from drivers/tty/vt/vt_ioctl.c:15:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/vt/vt_ioctl.c:15:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/vt/vt_ioctl.c:15:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/tty/vt/vt_ioctl.c:29:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from drivers/tty/vt/vt_ioctl.c:15:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/vt/vt_ioctl.c:15:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/vt/vt_ioctl.c:15:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/tty/vt/vt_ioctl.c:29:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

drivers/tty/vt/vt_ioctl.c should add these lines:
#include <asm/signal.h>                 // for SIGKILL
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EPERM, EFAULT, EINVAL, ENXIO
#include "asm-generic/ioctls.h"         // for TIOCLINUX
#include "asm/current.h"                // for current
#include "asm/string_32.h"              // for memcpy
#include "asm/uaccess.h"                // for put_user, get_user
#include "linux/capability.h"           // for capable, CAP_SYS_TTY_CONFIG
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for __user, inline
#include "linux/console_struct.h"       // for vc_data, vc, vc_cons, vc_SAK
#include "linux/container_of.h"         // for container_of
#include "linux/export.h"               // for EXPORT_SYMBOL
#include "linux/jiffies.h"              // for msecs_to_jiffies
#include "linux/kref.h"                 // for kref_read
#include "linux/list.h"                 // for INIT_LIST_HEAD, list_add, lis...
#include "linux/pid.h"                  // for put_pid, get_pid
#include "linux/printk.h"               // for pr_debug
#include "linux/sched.h"                // for task_pid, task_struct
#include "linux/spinlock.h"             // for spin_unlock_irqrestore, spin_...
#include "linux/spinlock_types.h"       // for DEFINE_SPINLOCK
#include "linux/stddef.h"               // for true, false
#include "linux/tty_ldisc.h"            // for tty_ldisc_flush
#include "linux/tty_port.h"             // for tty_port_put, tty_port
#include "linux/vt.h"                   // for vt_consize, vt_mode, MAX_NR_C...
#include "linux/wait.h"                 // for wait_queue_head, DECLARE_WAIT...
struct work_struct;

drivers/tty/vt/vt_ioctl.c should remove these lines:
- #include <asm/io.h>  // lines 32-32
- #include <linux/compat.h>  // lines 18-18
- #include <linux/consolemap.h>  // lines 27-27
- #include <linux/fs.h>  // lines 25-25
- #include <linux/kbd_diacr.h>  // lines 39-39
- #include <linux/kernel.h>  // lines 17-17
- #include <linux/major.h>  // lines 24-24
- #include <linux/module.h>  // lines 19-19
- #include <linux/slab.h>  // lines 23-23
- #include <linux/string.h>  // lines 22-22
- #include <linux/timer.h>  // lines 16-16
- #include <linux/vt.h>  // lines 21-21

The full include-list for drivers/tty/vt/vt_ioctl.c:
#include <asm/signal.h>                 // for SIGKILL
#include <asm/syscalls.h>               // for ksys_ioperm
#include <linux/console.h>              // for console_unlock, console_lock
#include <linux/errno.h>                // for ENOIOCTLCMD
#include <linux/kbd_kern.h>             // for set_console
#include <linux/kd.h>                   // for unimapdesc, KD_TEXT, console_...
#include <linux/nospec.h>               // for array_index_nospec
#include <linux/sched/signal.h>         // for kill_pid, signal_struct
#include <linux/selection.h>            // for vc_is_sel
#include <linux/signal.h>               // for valid_signal
#include <linux/suspend.h>              // for pm_set_vt_switch
#include <linux/timex.h>                // for PIT_TICK_RATE
#include <linux/tty.h>                  // for __do_SAK, tty_struct, vt_ioctl
#include <linux/types.h>                // for bool, list_head, ushort
#include <linux/uaccess.h>              // for copy_from_user, copy_to_user
#include <linux/vt_kern.h>              // for vc_allocate, fg_console, do_b...
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EPERM, EFAULT, EINVAL, ENXIO
#include "asm-generic/ioctls.h"         // for TIOCLINUX
#include "asm/current.h"                // for current
#include "asm/string_32.h"              // for memcpy
#include "asm/uaccess.h"                // for put_user, get_user
#include "linux/capability.h"           // for capable, CAP_SYS_TTY_CONFIG
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for __user, inline
#include "linux/console_struct.h"       // for vc_data, vc, vc_cons, vc_SAK
#include "linux/container_of.h"         // for container_of
#include "linux/export.h"               // for EXPORT_SYMBOL
#include "linux/jiffies.h"              // for msecs_to_jiffies
#include "linux/kref.h"                 // for kref_read
#include "linux/list.h"                 // for INIT_LIST_HEAD, list_add, lis...
#include "linux/pid.h"                  // for put_pid, get_pid
#include "linux/printk.h"               // for pr_debug
#include "linux/sched.h"                // for task_pid, task_struct
#include "linux/spinlock.h"             // for spin_unlock_irqrestore, spin_...
#include "linux/spinlock_types.h"       // for DEFINE_SPINLOCK
#include "linux/stddef.h"               // for true, false
#include "linux/tty_ldisc.h"            // for tty_ldisc_flush
#include "linux/tty_port.h"             // for tty_port_put, tty_port
#include "linux/vt.h"                   // for vt_consize, vt_mode, MAX_NR_C...
#include "linux/wait.h"                 // for wait_queue_head, DECLARE_WAIT...
struct work_struct;
---
  ./scripts/check-local-export drivers/tty/vt/vt_ioctl.o
  iwyu2 -Wp,-MMD,drivers/tty/vt/.vc_screen.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/tty/vt/vc_screen"' -DKBUILD_BASENAME='"vc_screen"' -DKBUILD_MODNAME='"vc_screen"' -D__KBUILD_MODNAME=kmod_vc_screen -c -o drivers/tty/vt/vc_screen.o drivers/tty/vt/vc_screen.c  
In file included from drivers/tty/vt/vc_screen.c:33:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/vt/vc_screen.c:33:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/vt/vc_screen.c:33:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/tty/vt/vc_screen.c:33:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/vt/vc_screen.c:33:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/vt/vc_screen.c:33:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/tty/vt/vc_screen.c should add these lines:
#include <asm/signal.h>              // for SIGIO
#include <cstdio>                    // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"  // for ENXIO, ENOMEM, EFAULT, EINVAL
#include "asm-generic/errno.h"       // for EOPNOTSUPP
#include "asm-generic/int-ll64.h"    // for u16, u8
#include "asm-generic/siginfo.h"     // for POLL_HUP, POLL_PRI
#include "asm-generic/unaligned.h"   // for get_unaligned
#include "asm/page_types.h"          // for PAGE_SIZE
#include "generated/autoconf.h"      // for CONFIG_BASE_SMALL
#include "linux/compiler_types.h"    // for __user, inline
#include "linux/console_struct.h"    // for vc_data, vc, vc_cons
#include "linux/container_of.h"      // for container_of
#include "linux/device/class.h"      // for class_create
#include "linux/eventpoll.h"         // for EPOLLERR, EPOLLHUP, EPOLLPRI
#include "linux/gfp.h"               // for GFP_KERNEL, __get_free_page, fre...
#include "linux/kdev_t.h"            // for MKDEV
#include "linux/minmax.h"            // for min
#include "linux/panic.h"             // for panic
#include "linux/spinlock.h"          // for spin_lock, spin_unlock
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool, loff_t, __poll_t
#include "linux/vt.h"                // for VT_UPDATE, VT_DEALLOCATE, MAX_NR...
#include "linux/wait.h"              // for init_waitqueue_head, wait_queue_...

drivers/tty/vt/vc_screen.c should remove these lines:
- #include <asm/byteorder.h>  // lines 50-50
- #include <asm/unaligned.h>  // lines 51-51
- #include <linux/errno.h>  // lines 31-31
- #include <linux/interrupt.h>  // lines 34-34
- #include <linux/kbd_kern.h>  // lines 39-39
- #include <linux/kernel.h>  // lines 29-29
- #include <linux/mm.h>  // lines 35-35
- #include <linux/sched.h>  // lines 42-42
- #include <linux/signal.h>  // lines 45-45

The full include-list for drivers/tty/vt/vc_screen.c:
#include <asm/signal.h>              // for SIGIO
#include <linux/console.h>           // for console_unlock, console_lock
#include <linux/device.h>            // for device_create, device_destroy
#include <linux/export.h>            // for THIS_MODULE
#include <linux/fs.h>                // for iminor, file_inode, file, fasync...
#include <linux/init.h>              // for __init
#include <linux/major.h>             // for VCS_MAJOR
#include <linux/notifier.h>          // for NOTIFY_DONE, notifier_block, NOT...
#include <linux/poll.h>              // for DEFAULT_POLLMASK, poll_wait, pol...
#include <linux/selection.h>         // for screen_pos, vcs_scr_readw, vcs_s...
#include <linux/slab.h>              // for kfree, kzalloc
#include <linux/tty.h>               // for vcs_init
#include <linux/uaccess.h>           // for copy_from_user, copy_to_user
#include <linux/vt_kern.h>           // for register_vt_notifier, unregister...
#include <cstdio>                    // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"  // for ENXIO, ENOMEM, EFAULT, EINVAL
#include "asm-generic/errno.h"       // for EOPNOTSUPP
#include "asm-generic/int-ll64.h"    // for u16, u8
#include "asm-generic/siginfo.h"     // for POLL_HUP, POLL_PRI
#include "asm-generic/unaligned.h"   // for get_unaligned
#include "asm/page_types.h"          // for PAGE_SIZE
#include "generated/autoconf.h"      // for CONFIG_BASE_SMALL
#include "linux/compiler_types.h"    // for __user, inline
#include "linux/console_struct.h"    // for vc_data, vc, vc_cons
#include "linux/container_of.h"      // for container_of
#include "linux/device/class.h"      // for class_create
#include "linux/eventpoll.h"         // for EPOLLERR, EPOLLHUP, EPOLLPRI
#include "linux/gfp.h"               // for GFP_KERNEL, __get_free_page, fre...
#include "linux/kdev_t.h"            // for MKDEV
#include "linux/minmax.h"            // for min
#include "linux/panic.h"             // for panic
#include "linux/spinlock.h"          // for spin_lock, spin_unlock
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool, loff_t, __poll_t
#include "linux/vt.h"                // for VT_UPDATE, VT_DEALLOCATE, MAX_NR...
#include "linux/wait.h"              // for init_waitqueue_head, wait_queue_...
---
  ./scripts/check-local-export drivers/tty/vt/vc_screen.o
  iwyu2 -Wp,-MMD,drivers/tty/vt/.selection.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/tty/vt/selection"' -DKBUILD_BASENAME='"selection"' -DKBUILD_MODNAME='"selection"' -D__KBUILD_MODNAME=kmod_selection -c -o drivers/tty/vt/selection.o drivers/tty/vt/selection.c  
In file included from drivers/tty/vt/selection.c:16:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/vt/selection.c:16:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/vt/selection.c:16:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/tty/vt/selection.c:16:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/vt/selection.c:16:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/vt/selection.c:16:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/tty/vt/selection.c should add these lines:
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EFAULT, EINTR, EINVAL, EIO, ENOMEM
#include "asm-generic/int-ll64.h"    // for u16, u32
#include "asm/current.h"             // for current
#include "asm/string_32.h"           // for memcpy
#include "linux/compiler_types.h"    // for inline, __user
#include "linux/console_struct.h"    // for vc_data, vc, vc_cons
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"               // for GFP_KERNEL, __GFP_NOWARN
#include "linux/kd.h"                // for K_UNICODE
#include "linux/kern_levels.h"       // for KERN_WARNING
#include "linux/kernel.h"            // for ARRAY_SIZE
#include "linux/math.h"              // for rounddown
#include "linux/minmax.h"            // for min_t, swap
#include "linux/printk.h"            // for printk
#include "linux/stddef.h"            // for true
#include "linux/tty_ldisc.h"         // for tty_ldisc_deref, tty_ldisc_ref_wait
#include "linux/wait.h"              // for add_wait_queue, remove_wait_queue

drivers/tty/vt/selection.c should remove these lines:
- #include <linux/kbd_kern.h>  // lines 25-25
- #include <linux/mm.h>  // lines 18-18
- #include <linux/module.h>  // lines 15-15

The full include-list for drivers/tty/vt/selection.c:
#include <linux/console.h>           // for console_lock, console_unlock
#include <linux/consolemap.h>        // for inverse_translate
#include <linux/mutex.h>             // for mutex, mutex_lock, mutex_unlock
#include <linux/sched.h>             // for task_struct, schedule, TASK_RUNNING
#include <linux/sched/signal.h>      // for signal_pending
#include <linux/selection.h>         // for complement_pos, invert_screen
#include <linux/slab.h>              // for kfree, kmalloc_array
#include <linux/tiocl.h>             // for tiocl_selection, TIOCL_SELBUTTON...
#include <linux/tty.h>               // for tty_throttled, tty_struct
#include <linux/tty_flip.h>          // for tty_buffer_lock_exclusive, tty_b...
#include <linux/types.h>             // for bool
#include <linux/uaccess.h>           // for copy_from_user
#include <linux/vt_kern.h>           // for poke_blanked_console, vt_do_kdgk...
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EFAULT, EINTR, EINVAL, EIO, ENOMEM
#include "asm-generic/int-ll64.h"    // for u16, u32
#include "asm/current.h"             // for current
#include "asm/string_32.h"           // for memcpy
#include "linux/compiler_types.h"    // for inline, __user
#include "linux/console_struct.h"    // for vc_data, vc, vc_cons
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"               // for GFP_KERNEL, __GFP_NOWARN
#include "linux/kd.h"                // for K_UNICODE
#include "linux/kern_levels.h"       // for KERN_WARNING
#include "linux/kernel.h"            // for ARRAY_SIZE
#include "linux/math.h"              // for rounddown
#include "linux/minmax.h"            // for min_t, swap
#include "linux/printk.h"            // for printk
#include "linux/stddef.h"            // for true
#include "linux/tty_ldisc.h"         // for tty_ldisc_deref, tty_ldisc_ref_wait
#include "linux/wait.h"              // for add_wait_queue, remove_wait_queue
---
  ./scripts/check-local-export drivers/tty/vt/selection.o
  iwyu2 -Wp,-MMD,drivers/tty/vt/.keyboard.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/tty/vt/keyboard"' -DKBUILD_BASENAME='"keyboard"' -DKBUILD_MODNAME='"keyboard"' -D__KBUILD_MODNAME=kmod_keyboard -c -o drivers/tty/vt/keyboard.o drivers/tty/vt/keyboard.c  
In file included from drivers/tty/vt/keyboard.c:30:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/vt/keyboard.c:30:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/vt/keyboard.c:30:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/tty/vt/keyboard.c:30:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/vt/keyboard.c:30:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/vt/keyboard.c:30:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/tty/vt/keyboard.c should add these lines:
#include <asm/bitops.h>               // for test_bit, __test_and_set_bit
#include <linux/bitmap.h>             // for find_next_bit, for_each_set_bit
#include <cstdio>                     // for NULL, ssize_t
#include "asm-generic/errno-base.h"   // for EFAULT, EPERM, EINVAL, ENOMEM
#include "asm-generic/irq_regs.h"     // for get_irq_regs
#include "asm/string_32.h"            // for strlen, memcpy, strcpy, memset
#include "asm/uaccess.h"              // for put_user, get_user
#include "generated/autoconf.h"       // for CONFIG_KEYBOARD_ATKBD, CONFIG_X86
#include "linux/bitops.h"             // for assign_bit
#include "linux/bits.h"               // for BIT_MASK
#include "linux/capability.h"         // for capable, CAP_SYS_TTY_CONFIG
#include "linux/compiler_types.h"     // for __user, inline
#include "linux/console_struct.h"     // for vc_data, vc, vc_cons
#include "linux/err.h"                // for IS_ERR, PTR_ERR
#include "linux/errno.h"              // for ENOIOCTLCMD
#include "linux/export.h"             // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include "linux/gfp.h"                // for GFP_KERNEL
#include "linux/input-event-codes.h"  // for EV_SND, EV_LED, BTN_MISC, EV_KEY
#include "linux/input.h"              // for input_handle (ptr only), input_...
#include "linux/interrupt.h"          // for tasklet_schedule, tasklet_enable
#include "linux/kconfig.h"            // for IS_ENABLED
#include "linux/kd.h"                 // for kbdiacruc, kbdiacr, kbd_repeat
#include "linux/kernel.h"             // for ARRAY_SIZE
#include "linux/keyboard.h"           // for KVAL, key_maps, KTYP, keyboard_...
#include "linux/minmax.h"             // for min
#include "linux/mod_devicetable.h"    // for INPUT_DEVICE_ID_MATCH_EVBIT
#include "linux/moduleparam.h"        // for kernel_param, param_ops_uint
#include "linux/pid.h"                // for put_pid
#include "linux/printk.h"             // for printk_ratelimit, pr_err, pr_warn
#include "linux/spinlock_types.h"     // for DEFINE_SPINLOCK, __SPIN_LOCK_UN...
#include "linux/stddef.h"             // for true, false
#include "linux/timer.h"              // for mod_timer, DEFINE_TIMER, del_ti...
#include "linux/tty_buffer.h"         // for TTY_BREAK
#include "linux/tty_port.h"           // for tty_port
#include "linux/types.h"              // for bool, DECLARE_BITMAP, uint
#include "linux/vt.h"                 // for MAX_NR_CONSOLES
#include "linux/workqueue.h"          // for schedule_work
#include "vdso/bits.h"                // for BIT

drivers/tty/vt/keyboard.c should remove these lines:
- #include <asm/irq_regs.h>  // lines 50-50

The full include-list for drivers/tty/vt/keyboard.c:
#include <asm/bitops.h>               // for test_bit, __test_and_set_bit
#include <asm/kbdleds.h>              // for kbd_defleds
#include <linux/bitmap.h>             // for find_next_bit, for_each_set_bit
#include <linux/consolemap.h>         // for conv_uni_to_8bit, conv_8bit_to_uni
#include <linux/init.h>               // for __init
#include <linux/input.h>              // for input_inject_event, input_handl...
#include <linux/jiffies.h>            // for msecs_to_jiffies, jiffies, time...
#include <linux/kbd_diacr.h>          // for accent_table, accent_table_size
#include <linux/kbd_kern.h>           // for kbd_struct, vc_kbd_mode, clr_vc...
#include <linux/mm.h>                 // for show_mem
#include <linux/module.h>             // for MODULE_DEVICE_TABLE
#include <linux/nospec.h>             // for array_index_nospec
#include <linux/notifier.h>           // for atomic_notifier_call_chain, NOT...
#include <linux/reboot.h>             // for ctrl_alt_del
#include <linux/sched/debug.h>        // for show_regs, show_state
#include <linux/sched/signal.h>       // for kill_pid
#include <linux/slab.h>               // for kfree, kmalloc, kmalloc_array
#include <linux/spinlock.h>           // for spin_unlock_irqrestore, spin_lo...
#include <linux/string.h>             // for memdup_user, strlcpy, strndup_user
#include <linux/tty.h>                // for start_tty, stop_tty, tty_chars_...
#include <linux/tty_flip.h>           // for tty_flip_buffer_push, tty_inser...
#include <linux/uaccess.h>            // for copy_to_user, copy_from_user
#include <linux/vt_kern.h>            // for vt_spawn_console, fg_console
#include <cstdio>                     // for NULL, ssize_t
#include "asm-generic/errno-base.h"   // for EFAULT, EPERM, EINVAL, ENOMEM
#include "asm-generic/irq_regs.h"     // for get_irq_regs
#include "asm/string_32.h"            // for strlen, memcpy, strcpy, memset
#include "asm/uaccess.h"              // for put_user, get_user
#include "generated/autoconf.h"       // for CONFIG_KEYBOARD_ATKBD, CONFIG_X86
#include "linux/bitops.h"             // for assign_bit
#include "linux/bits.h"               // for BIT_MASK
#include "linux/capability.h"         // for capable, CAP_SYS_TTY_CONFIG
#include "linux/compiler_types.h"     // for __user, inline
#include "linux/console_struct.h"     // for vc_data, vc, vc_cons
#include "linux/err.h"                // for IS_ERR, PTR_ERR
#include "linux/errno.h"              // for ENOIOCTLCMD
#include "linux/export.h"             // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include "linux/gfp.h"                // for GFP_KERNEL
#include "linux/input-event-codes.h"  // for EV_SND, EV_LED, BTN_MISC, EV_KEY
#include "linux/input.h"              // for input_handle (ptr only), input_...
#include "linux/interrupt.h"          // for tasklet_schedule, tasklet_enable
#include "linux/kconfig.h"            // for IS_ENABLED
#include "linux/kd.h"                 // for kbdiacruc, kbdiacr, kbd_repeat
#include "linux/kernel.h"             // for ARRAY_SIZE
#include "linux/keyboard.h"           // for KVAL, key_maps, KTYP, keyboard_...
#include "linux/minmax.h"             // for min
#include "linux/mod_devicetable.h"    // for INPUT_DEVICE_ID_MATCH_EVBIT
#include "linux/moduleparam.h"        // for kernel_param, param_ops_uint
#include "linux/pid.h"                // for put_pid
#include "linux/printk.h"             // for printk_ratelimit, pr_err, pr_warn
#include "linux/spinlock_types.h"     // for DEFINE_SPINLOCK, __SPIN_LOCK_UN...
#include "linux/stddef.h"             // for true, false
#include "linux/timer.h"              // for mod_timer, DEFINE_TIMER, del_ti...
#include "linux/tty_buffer.h"         // for TTY_BREAK
#include "linux/tty_port.h"           // for tty_port
#include "linux/types.h"              // for bool, DECLARE_BITMAP, uint
#include "linux/vt.h"                 // for MAX_NR_CONSOLES
#include "linux/workqueue.h"          // for schedule_work
#include "vdso/bits.h"                // for BIT
---
  ./scripts/check-local-export drivers/tty/vt/keyboard.o
  iwyu2 -Wp,-MMD,drivers/tty/vt/.consolemap.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/tty/vt/consolemap"' -DKBUILD_BASENAME='"consolemap"' -DKBUILD_MODNAME='"consolemap"' -D__KBUILD_MODNAME=kmod_consolemap -c -o drivers/tty/vt/consolemap.o drivers/tty/vt/consolemap.c  
In file included from drivers/tty/vt/consolemap.c:32:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/vt/consolemap.c:32:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/vt/consolemap.c:32:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/tty/vt/consolemap.c:32:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/vt/consolemap.c:32:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/vt/consolemap.c:32:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/tty/vt/consolemap.c should add these lines:
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EFAULT, ENOMEM, EINVAL
#include "asm-generic/int-ll64.h"    // for u16, u32, u8
#include "asm/string_32.h"           // for memcpy, memset, memcmp
#include "asm/uaccess.h"             // for put_user
#include "linux/compiler_types.h"    // for __user
#include "linux/console_struct.h"    // for vc_data, vc, vc_cons
#include "linux/err.h"               // for IS_ERR, PTR_ERR
#include "linux/export.h"            // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/minmax.h"            // for min
#include "linux/overflow.h"          // for array_size
#include "linux/types.h"             // for ushort, u_short
#include "linux/vt.h"                // for MAX_NR_CONSOLES

drivers/tty/vt/consolemap.c should remove these lines:
- #include <linux/errno.h>  // lines 28-28
- #include <linux/mm.h>  // lines 29-29
- #include <linux/module.h>  // lines 26-26
- #include <linux/tty.h>  // lines 32-32

The full include-list for drivers/tty/vt/consolemap.c:
#include <linux/console.h>           // for console_lock, console_unlock
#include <linux/consolemap.h>        // for USER_MAP, console_map_init, conv...
#include <linux/init.h>              // for __init
#include <linux/kd.h>                // for E_TABSZ, unipair, UNI_DIRECT_BASE
#include <linux/slab.h>              // for kfree, kmalloc_array, kvfree
#include <linux/string.h>            // for vmemdup_user
#include <linux/uaccess.h>           // for copy_to_user, copy_from_user
#include <linux/vt_kern.h>           // for vc_cons_allocated, con_clear_unimap
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EFAULT, ENOMEM, EINVAL
#include "asm-generic/int-ll64.h"    // for u16, u32, u8
#include "asm/string_32.h"           // for memcpy, memset, memcmp
#include "asm/uaccess.h"             // for put_user
#include "linux/compiler_types.h"    // for __user
#include "linux/console_struct.h"    // for vc_data, vc, vc_cons
#include "linux/err.h"               // for IS_ERR, PTR_ERR
#include "linux/export.h"            // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/minmax.h"            // for min
#include "linux/overflow.h"          // for array_size
#include "linux/types.h"             // for ushort, u_short
#include "linux/vt.h"                // for MAX_NR_CONSOLES
---
  ./scripts/check-local-export drivers/tty/vt/consolemap.o
  clang -Wp,-MMD,drivers/tty/vt/.conmakehash.d -Wall -Wmissing-prototypes -Wstrict-prototypes -O2 -fomit-frame-pointer -std=gnu11 -Wdeclaration-after-statement         -o drivers/tty/vt/conmakehash drivers/tty/vt/conmakehash.c   
  drivers/tty/vt/conmakehash drivers/tty/vt/cp437.uni > drivers/tty/vt/consolemap_deftbl.c
  iwyu2 -Wp,-MMD,drivers/tty/vt/.consolemap_deftbl.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/tty/vt/consolemap_deftbl"' -DKBUILD_BASENAME='"consolemap_deftbl"' -DKBUILD_MODNAME='"consolemap_deftbl"' -D__KBUILD_MODNAME=kmod_consolemap_deftbl -c -o drivers/tty/vt/consolemap_deftbl.o drivers/tty/vt/consolemap_deftbl.c  

drivers/tty/vt/consolemap_deftbl.c should add these lines:
#include "asm-generic/int-ll64.h"  // for u16, u8

drivers/tty/vt/consolemap_deftbl.c should remove these lines:
- #include <linux/types.h>  // lines 8-8

The full include-list for drivers/tty/vt/consolemap_deftbl.c:
#include "asm-generic/int-ll64.h"  // for u16, u8
---
  ./scripts/check-local-export drivers/tty/vt/consolemap_deftbl.o
  iwyu2 -Wp,-MMD,drivers/tty/vt/.vt.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/tty/vt/vt"' -DKBUILD_BASENAME='"vt"' -DKBUILD_MODNAME='"vt"' -D__KBUILD_MODNAME=kmod_vt -c -o drivers/tty/vt/vt.o drivers/tty/vt/vt.c  
In file included from drivers/tty/vt/vt.c:77:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/vt/vt.c:77:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/vt/vt.c:77:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/tty/vt/vt.c:77:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/vt/vt.c:77:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/vt/vt.c:77:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/tty/vt/vt.c should add these lines:
#include <asm/bug.h>                                 // for BUG_ON, WARN_ON_...
#include <linux/bitmap.h>                            // for find_next_bit
#include <stddef.h>                                  // for ptrdiff_t
#include <stdint.h>                                  // for uint32_t
#include <cstdio>                                    // for NULL, ssize_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit
#include "asm-generic/errno-base.h"                  // for EINVAL, EFAULT
#include "asm-generic/errno.h"                       // for ENOSYS, ENODATA
#include "asm-generic/int-ll64.h"                    // for u16, s32, u8, u32
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/termbits.h"                    // for IUTF8, ktermios
#include "asm-generic/termios.h"                     // for winsize
#include "asm/cmpxchg.h"                             // for __xchg_wrong_size
#include "asm/current.h"                             // for current
#include "asm/page_types.h"                          // for PAGE_SIZE
#include "asm/string_32.h"                           // for memset32, strlen
#include "asm/uaccess.h"                             // for get_user, put_user
#include "generated/autoconf.h"                      // for CONFIG_CONSOLE_T...
#include "linux/atomic/atomic-instrumented.h"        // for xchg
#include "linux/bitmap.h"                            // for bitmap_zero
#include "linux/capability.h"                        // for capable, CAP_SYS...
#include "linux/cdev.h"                              // for cdev_add, cdev_init
#include "linux/compiler_attributes.h"               // for fallthrough
#include "linux/compiler_types.h"                    // for inline, __user
#include "linux/console_struct.h"                    // for vc_data, vc_state
#include "linux/container_of.h"                      // for container_of
#include "linux/device/class.h"                      // for class_create
#include "linux/err.h"                               // for IS_ERR, PTR_ERR
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/fs.h"                                // for file (ptr only)
#include "linux/gfp.h"                               // for GFP_KERNEL, GFP_...
#include "linux/jiffies.h"                           // for jiffies, msecs_t...
#include "linux/kconfig.h"                           // for __ARG_PLACEHOLDER_1
#include "linux/kdev_t.h"                            // for MKDEV
#include "linux/kstrtox.h"                           // for simple_strtoul
#include "linux/minmax.h"                            // for min, max, max3
#include "linux/moduleparam.h"                       // for kernel_param
#include "linux/panic.h"                             // for panic
#include "linux/pid.h"                               // for put_pid
#include "linux/preempt.h"                           // for in_interrupt
#include "linux/printk.h"                            // for pr_warn, pr_cont
#include "linux/sched.h"                             // for task_struct
#include "linux/spinlock.h"                          // for spin_trylock
#include "linux/spinlock_types.h"                    // for DEFINE_SPINLOCK
#include "linux/stat.h"                              // for S_IRUGO, S_IWUSR
#include "linux/stddef.h"                            // for true, false
#include "linux/sysfs.h"                             // for sysfs_notify
#include "linux/tty_driver.h"                        // for tty_driver, tty_...
#include "linux/tty_port.h"                          // for tty_port_init
#include "linux/vt.h"                                // for MAX_NR_CONSOLES
#include "linux/vt_buffer.h"                         // for scr_memsetw, scr...
#include "linux/wait.h"                              // for init_waitqueue_head
#include "vdso/bits.h"                               // for BIT
#include "vdso/limits.h"                             // for USHRT_MAX

drivers/tty/vt/vt.c should remove these lines:
- #include <linux/bitops.h>  // lines 100-100
- #include <linux/interrupt.h>  // lines 96-96
- #include <linux/io.h>  // lines 103-103
- #include <linux/mm.h>  // lines 86-86
- #include <linux/mutex.h>  // lines 89-89
- #include <linux/pm.h>  // lines 98-98

The full include-list for drivers/tty/vt/vt.c:
#include <asm/bug.h>                                 // for BUG_ON, WARN_ON_...
#include <linux/bitmap.h>                            // for find_next_bit
#include <linux/bsearch.h>                           // for bsearch
#include <linux/console.h>                           // for console_unlock
#include <linux/consolemap.h>                        // for set_translate
#include <linux/ctype.h>                             // for isxdigit
#include <linux/device.h>                            // for dev_get_drvdata
#include <linux/errno.h>                             // for ERESTARTSYS
#include <linux/font.h>                              // for MAX_FONT_NAME
#include <linux/gcd.h>                               // for gcd
#include <linux/init.h>                              // for __init, console_...
#include <linux/kbd_kern.h>                          // for VC_CRLF, VC_APPLIC
#include <linux/kd.h>                                // for console_font_op
#include <linux/kernel.h>                            // for sprintf, snprintf
#include <linux/major.h>                             // for TTY_MAJOR
#include <linux/module.h>                            // for module_put, __mo...
#include <linux/notifier.h>                          // for atomic_notifier_...
#include <linux/sched/signal.h>                      // for signal_struct
#include <linux/selection.h>                         // for clear_selection
#include <linux/slab.h>                              // for kfree, kzalloc
#include <linux/string.h>                            // for memdup_user
#include <linux/timer.h>                             // for mod_timer, del_t...
#include <linux/tiocl.h>                             // for TIOCL_BLANKEDSCREEN
#include <linux/tty.h>                               // for tty_struct, vt_i...
#include <linux/tty_flip.h>                          // for tty_flip_buffer_...
#include <linux/types.h>                             // for bool, ushort
#include <linux/uaccess.h>                           // for copy_to_user
#include <linux/vmalloc.h>                           // for vfree, vmalloc
#include <linux/vt_kern.h>                           // for vt_clr_kbd_mode_bit
#include <linux/workqueue.h>                         // for work_struct, sch...
#include <stddef.h>                                  // for ptrdiff_t
#include <stdint.h>                                  // for uint32_t
#include <cstdio>                                    // for NULL, ssize_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit
#include "asm-generic/errno-base.h"                  // for EINVAL, EFAULT
#include "asm-generic/errno.h"                       // for ENOSYS, ENODATA
#include "asm-generic/int-ll64.h"                    // for u16, s32, u8, u32
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/termbits.h"                    // for IUTF8, ktermios
#include "asm-generic/termios.h"                     // for winsize
#include "asm/cmpxchg.h"                             // for __xchg_wrong_size
#include "asm/current.h"                             // for current
#include "asm/page_types.h"                          // for PAGE_SIZE
#include "asm/string_32.h"                           // for memset32, strlen
#include "asm/uaccess.h"                             // for get_user, put_user
#include "generated/autoconf.h"                      // for CONFIG_CONSOLE_T...
#include "linux/atomic/atomic-instrumented.h"        // for xchg
#include "linux/bitmap.h"                            // for bitmap_zero
#include "linux/capability.h"                        // for capable, CAP_SYS...
#include "linux/cdev.h"                              // for cdev_add, cdev_init
#include "linux/compiler_attributes.h"               // for fallthrough
#include "linux/compiler_types.h"                    // for inline, __user
#include "linux/console_struct.h"                    // for vc_data, vc_state
#include "linux/container_of.h"                      // for container_of
#include "linux/device/class.h"                      // for class_create
#include "linux/err.h"                               // for IS_ERR, PTR_ERR
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/fs.h"                                // for file (ptr only)
#include "linux/gfp.h"                               // for GFP_KERNEL, GFP_...
#include "linux/jiffies.h"                           // for jiffies, msecs_t...
#include "linux/kconfig.h"                           // for __ARG_PLACEHOLDER_1
#include "linux/kdev_t.h"                            // for MKDEV
#include "linux/kstrtox.h"                           // for simple_strtoul
#include "linux/minmax.h"                            // for min, max, max3
#include "linux/moduleparam.h"                       // for kernel_param
#include "linux/panic.h"                             // for panic
#include "linux/pid.h"                               // for put_pid
#include "linux/preempt.h"                           // for in_interrupt
#include "linux/printk.h"                            // for pr_warn, pr_cont
#include "linux/sched.h"                             // for task_struct
#include "linux/spinlock.h"                          // for spin_trylock
#include "linux/spinlock_types.h"                    // for DEFINE_SPINLOCK
#include "linux/stat.h"                              // for S_IRUGO, S_IWUSR
#include "linux/stddef.h"                            // for true, false
#include "linux/sysfs.h"                             // for sysfs_notify
#include "linux/tty_driver.h"                        // for tty_driver, tty_...
#include "linux/tty_port.h"                          // for tty_port_init
#include "linux/vt.h"                                // for MAX_NR_CONSOLES
#include "linux/vt_buffer.h"                         // for scr_memsetw, scr...
#include "linux/wait.h"                              // for init_waitqueue_head
#include "vdso/bits.h"                               // for BIT
#include "vdso/limits.h"                             // for USHRT_MAX
---
  ./scripts/check-local-export drivers/tty/vt/vt.o
  cat drivers/tty/vt/defkeymap.c_shipped > drivers/tty/vt/defkeymap.c
  iwyu2 -Wp,-MMD,drivers/tty/vt/.defkeymap.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/tty/vt/defkeymap"' -DKBUILD_BASENAME='"defkeymap"' -DKBUILD_MODNAME='"defkeymap"' -D__KBUILD_MODNAME=kmod_defkeymap -c -o drivers/tty/vt/defkeymap.o drivers/tty/vt/defkeymap.c  

drivers/tty/vt/defkeymap.c should add these lines:
#include <stddef.h>          // for NULL
#include "linux/keyboard.h"  // for NR_KEYS, MAX_DIACR, MAX_NR_FUNC, MAX_NR_...

drivers/tty/vt/defkeymap.c should remove these lines:
- #include <linux/keyboard.h>  // lines 6-6

The full include-list for drivers/tty/vt/defkeymap.c:
#include <linux/kd.h>        // for kbdiacruc
#include <linux/types.h>     // for ushort
#include <stddef.h>          // for NULL
#include "linux/keyboard.h"  // for NR_KEYS, MAX_DIACR, MAX_NR_FUNC, MAX_NR_...
---
  ./scripts/check-local-export drivers/tty/vt/defkeymap.o
  rm -f drivers/tty/vt/built-in.a; echo vt_ioctl.o vc_screen.o selection.o keyboard.o consolemap.o consolemap_deftbl.o vt.o defkeymap.o | sed -E 's:([^ ]+):drivers/tty/vt/:g' | xargs llvm-ar cDPrST drivers/tty/vt/built-in.a
  iwyu2 -Wp,-MMD,drivers/tty/.tty_io.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/tty/tty_io"' -DKBUILD_BASENAME='"tty_io"' -DKBUILD_MODNAME='"tty_io"' -D__KBUILD_MODNAME=kmod_tty_io -c -o drivers/tty/tty_io.o drivers/tty/tty_io.c  
In file included from drivers/tty/tty_io.c:76:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/tty_io.c:76:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/tty_io.c:76:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/tty/tty_io.c:76:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/tty_io.c:76:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/tty_io.c:76:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/tty/tty_io.c should add these lines:
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON
#include <asm/signal.h>                              // for SIGKILL, SIGWINCH
#include <linux/build_bug.h>                         // for likely, unlikely
#include <linux/ktime.h>                             // for ktime_get_real_s...
#include <linux/spinlock.h>                          // for read_lock, read_...
#include <sys/types.h>                               // for dev_t
#include <cstdio>                                    // for NULL, ssize_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/errno-base.h"                  // for EIO, ENOTTY, ENOMEM
#include "asm-generic/errno.h"                       // for EOVERFLOW
#include "asm-generic/fcntl.h"                       // for O_NONBLOCK, O_ND...
#include "asm-generic/ioctls.h"                      // for TIOCCBRK, TCSBRK
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/termbits-common.h"             // for B38400, ICRNL
#include "asm-generic/termbits.h"                    // for ktermios, CREAD
#include "asm-generic/termios.h"                     // for winsize, TIOCM_DTR
#include "asm/current.h"                             // for current
#include "asm/string_32.h"                           // for strlen, strncmp
#include "asm/uaccess.h"                             // for put_user, get_user
#include "generated/autoconf.h"                      // for CONFIG_VT
#include "linux/capability.h"                        // for capable, CAP_SYS...
#include "linux/cdev.h"                              // for cdev_add, cdev_del
#include "linux/compiler_types.h"                    // for __user, inline
#include "linux/container_of.h"                      // for container_of
#include "linux/dev_printk.h"                        // for dev_dbg
#include "linux/device/class.h"                      // for class_find_devic...
#include "linux/err.h"                               // for ERR_PTR, IS_ERR
#include "linux/eventpoll.h"                         // for EPOLLOUT, EPOLLIN
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/fs.h"                                // for file, file_inode
#include "linux/gfp.h"                               // for GFP_KERNEL, GFP_...
#include "linux/kconfig.h"                           // for __ARG_PLACEHOLDER_1
#include "linux/kdev_t.h"                            // for MKDEV, new_encod...
#include "linux/kernel.h"                            // for sprintf, ARRAY_SIZE
#include "linux/kobject.h"                           // for kobject_put, kob...
#include "linux/kref.h"                              // for kref_init, kref_put
#include "linux/kstrtox.h"                           // for kstrtoint
#include "linux/list.h"                              // for list_del, list_add
#include "linux/mutex.h"                             // for mutex_unlock
#include "linux/panic.h"                             // for panic
#include "linux/pid.h"                               // for PIDTYPE_SID, put...
#include "linux/printk.h"                            // for pr_warn, pr_err
#include "linux/rwsem.h"                             // for down_read, up_read
#include "linux/sched.h"                             // for task_struct, tas...
#include "linux/serial.h"                            // for serial_struct
#include "linux/spinlock.h"                          // for spin_unlock, spi...
#include "linux/spinlock_types.h"                    // for DEFINE_SPINLOCK
#include "linux/stat.h"                              // for S_IRUGO
#include "linux/stddef.h"                            // for false, true
#include "linux/sysfs.h"                             // for sysfs_notify
#include "linux/time64.h"                            // for timespec64, time...
#include "linux/tty_flags.h"                         // for ASYNC_DEPRECATED
#include "linux/tty_ldisc.h"                         // for tty_ldisc_deref
#include "linux/tty_port.h"                          // for tty_port_kopened
#include "linux/types.h"                             // for __poll_t
#include "linux/uio.h"                               // for iov_iter (ptr only)
#include "linux/workqueue.h"                         // for flush_work, sche...
struct module;
struct seq_file;

drivers/tty/tty_io.c should remove these lines:
- #include <linux/bitops.h>  // lines 96-96
- #include <linux/compat.h>  // lines 101-101
- #include <linux/fcntl.h>  // lines 72-72
- #include <linux/interrupt.h>  // lines 75-75
- #include <linux/kbd_kern.h>  // lines 105-105
- #include <linux/kd.h>  // lines 85-85
- #include <linux/kmod.h>  // lines 109-109
- #include <linux/mm.h>  // lines 86-86
- #include <linux/nsproxy.h>  // lines 110-110
- #include <linux/ppp-ioctl.h>  // lines 90-90
- #include <linux/proc_fs.h>  // lines 91-91
- #include <linux/selection.h>  // lines 107-107
- #include <linux/seq_file.h>  // lines 98-98
- #include <linux/serial.h>  // lines 99-99
- #include <linux/timer.h>  // lines 83-83

The full include-list for drivers/tty/tty_io.c:
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON
#include <asm/signal.h>                              // for SIGKILL, SIGWINCH
#include <linux/build_bug.h>                         // for likely, unlikely
#include <linux/console.h>                           // for console, console...
#include <linux/ctype.h>                             // for isdigit
#include <linux/delay.h>                             // for msleep_interrupt...
#include <linux/device.h>                            // for device, dev_set_...
#include <linux/devpts_fs.h>                         // for ptm_open_peer
#include <linux/errno.h>                             // for ERESTARTSYS, ENO...
#include <linux/fdtable.h>                           // for iterate_fd
#include <linux/file.h>                              // for fput
#include <linux/init.h>                              // for __init, postcore...
#include <linux/ktime.h>                             // for ktime_get_real_s...
#include <linux/major.h>                             // for TTYAUX_MAJOR
#include <linux/module.h>                            // for module_put, try_...
#include <linux/poll.h>                              // for poll_table
#include <linux/ratelimit.h>                         // for WARN_RATELIMIT
#include <linux/sched/signal.h>                      // for signal_pending
#include <linux/sched/task.h>                        // for tasklist_lock
#include <linux/signal.h>                            // for group_send_sig_info
#include <linux/slab.h>                              // for kfree, kcalloc
#include <linux/spinlock.h>                          // for read_lock, read_...
#include <linux/string.h>                            // for memzero_explicit
#include <linux/tty.h>                               // for tty_struct, tty_...
#include <linux/tty_driver.h>                        // for tty_driver, tty_...
#include <linux/tty_flip.h>                          // for tty_buffer_lock_...
#include <linux/types.h>                             // for list_head, bool
#include <linux/uaccess.h>                           // for copy_to_user
#include <linux/vt_kern.h>                           // for vty_init, fg_con...
#include <linux/wait.h>                              // for waitqueue_active
#include <sys/types.h>                               // for dev_t
#include <cstdio>                                    // for NULL, ssize_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/errno-base.h"                  // for EIO, ENOTTY, ENOMEM
#include "asm-generic/errno.h"                       // for EOVERFLOW
#include "asm-generic/fcntl.h"                       // for O_NONBLOCK, O_ND...
#include "asm-generic/ioctls.h"                      // for TIOCCBRK, TCSBRK
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/termbits-common.h"             // for B38400, ICRNL
#include "asm-generic/termbits.h"                    // for ktermios, CREAD
#include "asm-generic/termios.h"                     // for winsize, TIOCM_DTR
#include "asm/current.h"                             // for current
#include "asm/string_32.h"                           // for strlen, strncmp
#include "asm/uaccess.h"                             // for put_user, get_user
#include "generated/autoconf.h"                      // for CONFIG_VT
#include "linux/capability.h"                        // for capable, CAP_SYS...
#include "linux/cdev.h"                              // for cdev_add, cdev_del
#include "linux/compiler_types.h"                    // for __user, inline
#include "linux/container_of.h"                      // for container_of
#include "linux/dev_printk.h"                        // for dev_dbg
#include "linux/device/class.h"                      // for class_find_devic...
#include "linux/err.h"                               // for ERR_PTR, IS_ERR
#include "linux/eventpoll.h"                         // for EPOLLOUT, EPOLLIN
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/fs.h"                                // for file, file_inode
#include "linux/gfp.h"                               // for GFP_KERNEL, GFP_...
#include "linux/kconfig.h"                           // for __ARG_PLACEHOLDER_1
#include "linux/kdev_t.h"                            // for MKDEV, new_encod...
#include "linux/kernel.h"                            // for sprintf, ARRAY_SIZE
#include "linux/kobject.h"                           // for kobject_put, kob...
#include "linux/kref.h"                              // for kref_init, kref_put
#include "linux/kstrtox.h"                           // for kstrtoint
#include "linux/list.h"                              // for list_del, list_add
#include "linux/mutex.h"                             // for mutex_unlock
#include "linux/panic.h"                             // for panic
#include "linux/pid.h"                               // for PIDTYPE_SID, put...
#include "linux/printk.h"                            // for pr_warn, pr_err
#include "linux/rwsem.h"                             // for down_read, up_read
#include "linux/sched.h"                             // for task_struct, tas...
#include "linux/serial.h"                            // for serial_struct
#include "linux/spinlock.h"                          // for spin_unlock, spi...
#include "linux/spinlock_types.h"                    // for DEFINE_SPINLOCK
#include "linux/stat.h"                              // for S_IRUGO
#include "linux/stddef.h"                            // for false, true
#include "linux/sysfs.h"                             // for sysfs_notify
#include "linux/time64.h"                            // for timespec64, time...
#include "linux/tty_flags.h"                         // for ASYNC_DEPRECATED
#include "linux/tty_ldisc.h"                         // for tty_ldisc_deref
#include "linux/tty_port.h"                          // for tty_port_kopened
#include "linux/types.h"                             // for __poll_t
#include "linux/uio.h"                               // for iov_iter (ptr only)
#include "linux/workqueue.h"                         // for flush_work, sche...
#include "tty.h"                                     // for tty_ldisc_unlock
struct module;
struct seq_file;
---
  ./scripts/check-local-export drivers/tty/tty_io.o
  iwyu2 -Wp,-MMD,drivers/tty/.n_tty.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/tty/n_tty"' -DKBUILD_BASENAME='"n_tty"' -DKBUILD_MODNAME='"n_tty"' -D__KBUILD_MODNAME=kmod_n_tty -c -o drivers/tty/n_tty.o drivers/tty/n_tty.c  
In file included from drivers/tty/n_tty.c:38:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/n_tty.c:38:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/n_tty.c:38:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/tty/n_tty.c:46:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^
4 warnings generated.
In file included from drivers/tty/n_tty.c:38:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/n_tty.c:38:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/n_tty.c:38:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/tty/n_tty.c:46:
./include/linux/audit.h:267:41: warning: declaration of 'struct kern_ipc_perm' will not be visible outside of this function [-Wvisibility]
static inline void audit_ipc_obj(struct kern_ipc_perm *ipcp)
                                        ^

drivers/tty/n_tty.c should add these lines:
#include <asm/barrier.h>                             // for smp_store_release
#include <asm/bitops.h>                              // for test_bit
#include <asm/signal.h>                              // for SIGIO, SIGINT
#include <linux/bitmap.h>                            // for find_first_bit
#include <cstdio>                                    // for size_t, ssize_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit, clear_bit
#include "asm-generic/errno-base.h"                  // for EAGAIN, EIO, ENOMEM
#include "asm-generic/fcntl.h"                       // for O_NONBLOCK
#include "asm-generic/int-ll64.h"                    // for u8
#include "asm-generic/ioctls.h"                      // for TIOCINQ, TIOCOUTQ
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/siginfo.h"                     // for POLL_IN, POLL_OUT
#include "asm-generic/termbits.h"                    // for ktermios, EXTPROC
#include "asm/current.h"                             // for current
#include "asm/string_32.h"                           // for memcpy, memset
#include "asm/uaccess.h"                             // for put_user
#include "linux/bitmap.h"                            // for bitmap_zero
#include "linux/compiler.h"                          // for likely, unlikely
#include "linux/compiler_types.h"                    // for inline, __user
#include "linux/eventpoll.h"                         // for EPOLLIN, EPOLLRD...
#include "linux/export.h"                            // for EXPORT_SYMBOL_GPL
#include "linux/fs.h"                                // for kill_fasync, file
#include "linux/init.h"                              // for __init
#include "linux/jiffies.h"                           // for jiffies, time_after
#include "linux/minmax.h"                            // for min, min_t
#include "linux/mutex.h"                             // for mutex_unlock
#include "linux/pid.h"                               // for put_pid
#include "linux/printk.h"                            // for no_printk
#include "linux/rwsem.h"                             // for up_read, down_read
#include "linux/sched/signal.h"                      // for signal_pending
#include "linux/spinlock.h"                          // for spin_lock_irq
#include "linux/stddef.h"                            // for false, true
#include "linux/tty.h"                               // for tty_struct (ptr ...
#include "linux/tty_buffer.h"                        // for TTY_NORMAL, TTY_...
#include "linux/tty_driver.h"                        // for tty_operations
#include "linux/tty_ldisc.h"                         // for tty_register_ldisc
#include "linux/tty_port.h"                          // for tty_port
#include "linux/types.h"                             // for __poll_t
#include "linux/wait.h"                              // for remove_wait_queue

drivers/tty/n_tty.c should remove these lines:
- #include <linux/audit.h>  // lines 46-46
- #include <linux/bitops.h>  // lines 45-45
- #include <linux/fcntl.h>  // lines 35-35
- #include <linux/file.h>  // lines 47-47
- #include <linux/interrupt.h>  // lines 37-37
- #include <linux/major.h>  // lines 32-32
- #include <linux/mm.h>  // lines 41-41
- #include <linux/module.h>  // lines 49-49
- #include <linux/signal.h>  // lines 34-34
- #include <linux/slab.h>  // lines 43-43
- #include <linux/string.h>  // lines 42-42
- #include <linux/timer.h>  // lines 39-39
- #include <linux/uaccess.h>  // lines 48-48

The full include-list for drivers/tty/n_tty.c:
#include <asm/barrier.h>                             // for smp_store_release
#include <asm/bitops.h>                              // for test_bit
#include <asm/signal.h>                              // for SIGIO, SIGINT
#include <linux/bitmap.h>                            // for find_first_bit
#include <linux/ctype.h>                             // for iscntrl, tolower
#include <linux/errno.h>                             // for ERESTARTSYS
#include <linux/poll.h>                              // for poll_wait, poll_...
#include <linux/ratelimit.h>                         // for WARN_RATELIMIT
#include <linux/sched.h>                             // for MAX_SCHEDULE_TIM...
#include <linux/tty.h>                               // for tty_struct, N_TT...
#include <linux/types.h>                             // for bool, DECLARE_BI...
#include <linux/vmalloc.h>                           // for vfree, vzalloc
#include <cstdio>                                    // for size_t, ssize_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit, clear_bit
#include "asm-generic/errno-base.h"                  // for EAGAIN, EIO, ENOMEM
#include "asm-generic/fcntl.h"                       // for O_NONBLOCK
#include "asm-generic/int-ll64.h"                    // for u8
#include "asm-generic/ioctls.h"                      // for TIOCINQ, TIOCOUTQ
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/siginfo.h"                     // for POLL_IN, POLL_OUT
#include "asm-generic/termbits.h"                    // for ktermios, EXTPROC
#include "asm/current.h"                             // for current
#include "asm/string_32.h"                           // for memcpy, memset
#include "asm/uaccess.h"                             // for put_user
#include "linux/bitmap.h"                            // for bitmap_zero
#include "linux/compiler.h"                          // for likely, unlikely
#include "linux/compiler_types.h"                    // for inline, __user
#include "linux/eventpoll.h"                         // for EPOLLIN, EPOLLRD...
#include "linux/export.h"                            // for EXPORT_SYMBOL_GPL
#include "linux/fs.h"                                // for kill_fasync, file
#include "linux/init.h"                              // for __init
#include "linux/jiffies.h"                           // for jiffies, time_after
#include "linux/minmax.h"                            // for min, min_t
#include "linux/mutex.h"                             // for mutex_unlock
#include "linux/pid.h"                               // for put_pid
#include "linux/printk.h"                            // for no_printk
#include "linux/rwsem.h"                             // for up_read, down_read
#include "linux/sched/signal.h"                      // for signal_pending
#include "linux/spinlock.h"                          // for spin_lock_irq
#include "linux/stddef.h"                            // for false, true
#include "linux/tty.h"                               // for tty_struct (ptr ...
#include "linux/tty_buffer.h"                        // for TTY_NORMAL, TTY_...
#include "linux/tty_driver.h"                        // for tty_operations
#include "linux/tty_ldisc.h"                         // for tty_register_ldisc
#include "linux/tty_port.h"                          // for tty_port
#include "linux/types.h"                             // for __poll_t
#include "linux/wait.h"                              // for remove_wait_queue
#include "tty.h"                                     // for __tty_set_flow_c...
---
  ./scripts/check-local-export drivers/tty/n_tty.o
  iwyu2 -Wp,-MMD,drivers/tty/.tty_ioctl.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/tty/tty_ioctl"' -DKBUILD_BASENAME='"tty_ioctl"' -DKBUILD_MODNAME='"tty_ioctl"' -D__KBUILD_MODNAME=kmod_tty_ioctl -c -o drivers/tty/tty_ioctl.o drivers/tty/tty_ioctl.c  
In file included from drivers/tty/tty_ioctl.c:16:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/tty_ioctl.c:16:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/tty_ioctl.c:16:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/tty/tty_ioctl.c:16:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/tty_ioctl.c:16:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/tty_ioctl.c:16:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/tty/tty_ioctl.c should add these lines:
#include <asm/bug.h>                                 // for WARN_ON
#include <stddef.h>                                  // for NULL
#include <termios.h>                                 // for cc_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/errno-base.h"                  // for EFAULT, EINVAL
#include "asm-generic/ioctls.h"                      // for TCGETS2, TCGETX
#include "asm-generic/termbits-common.h"             // for TCIFLUSH, TCIOFF
#include "asm-generic/termbits.h"                    // for ktermios, CLOCAL
#include "asm-generic/termios.h"                     // for kernel_termios_t...
#include "asm/current.h"                             // for current
#include "asm/uaccess.h"                             // for get_user, put_user
#include "linux/capability.h"                        // for capable, CAP_SYS...
#include "linux/compiler_attributes.h"               // for fallthrough
#include "linux/compiler_types.h"                    // for __user
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/rwsem.h"                             // for down_write, up_w...
#include "linux/sched.h"                             // for MAX_SCHEDULE_TIM...
#include "linux/spinlock.h"                          // for spin_lock_irq
#include "linux/stddef.h"                            // for false, true
#include "linux/tty_driver.h"                        // for tty_operations
#include "linux/tty_ldisc.h"                         // for tty_ldisc_deref
#include "linux/wait.h"                              // for wait_event_inter...

drivers/tty/tty_ioctl.c should remove these lines:
- #include <asm/io.h>  // lines 26-26
- #include <linux/bitops.h>  // lines 21-21
- #include <linux/compat.h>  // lines 23-23
- #include <linux/fcntl.h>  // lines 17-17
- #include <linux/kernel.h>  // lines 14-14
- #include <linux/major.h>  // lines 15-15
- #include <linux/mm.h>  // lines 19-19
- #include <linux/module.h>  // lines 20-20
- #include <linux/string.h>  // lines 18-18
- #include <linux/termios.h>  // lines 11-11
- #include <linux/types.h>  // lines 10-10
- #include <linux/uaccess.h>  // lines 27-27

The full include-list for drivers/tty/tty_ioctl.c:
#include <asm/bug.h>                                 // for WARN_ON
#include <linux/errno.h>                             // for ENOIOCTLCMD, ERE...
#include <linux/mutex.h>                             // for mutex_lock, mute...
#include <linux/sched/signal.h>                      // for signal_pending
#include <linux/tty.h>                               // for tty_struct, tty_...
#include <stddef.h>                                  // for NULL
#include <termios.h>                                 // for cc_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/errno-base.h"                  // for EFAULT, EINVAL
#include "asm-generic/ioctls.h"                      // for TCGETS2, TCGETX
#include "asm-generic/termbits-common.h"             // for TCIFLUSH, TCIOFF
#include "asm-generic/termbits.h"                    // for ktermios, CLOCAL
#include "asm-generic/termios.h"                     // for kernel_termios_t...
#include "asm/current.h"                             // for current
#include "asm/uaccess.h"                             // for get_user, put_user
#include "linux/capability.h"                        // for capable, CAP_SYS...
#include "linux/compiler_attributes.h"               // for fallthrough
#include "linux/compiler_types.h"                    // for __user
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/rwsem.h"                             // for down_write, up_w...
#include "linux/sched.h"                             // for MAX_SCHEDULE_TIM...
#include "linux/spinlock.h"                          // for spin_lock_irq
#include "linux/stddef.h"                            // for false, true
#include "linux/tty_driver.h"                        // for tty_operations
#include "linux/tty_ldisc.h"                         // for tty_ldisc_deref
#include "linux/wait.h"                              // for wait_event_inter...
#include "tty.h"                                     // for tty_check_change
---
  ./scripts/check-local-export drivers/tty/tty_ioctl.o
  iwyu2 -Wp,-MMD,drivers/tty/.tty_ldisc.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/tty/tty_ldisc"' -DKBUILD_BASENAME='"tty_ldisc"' -DKBUILD_MODNAME='"tty_ldisc"' -D__KBUILD_MODNAME=kmod_tty_ldisc -c -o drivers/tty/tty_ldisc.o drivers/tty/tty_ldisc.c  
In file included from drivers/tty/tty_ldisc.c:7:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/tty_ldisc.c:7:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/tty_ldisc.c:7:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/tty/tty_ldisc.c:7:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/tty_ldisc.c:7:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/tty_ldisc.c:7:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/tty/tty_ldisc.c should add these lines:
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON, WARN_ON...
#include <stddef.h>                                  // for NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/errno-base.h"                  // for EINVAL, EBUSY, EIO
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/termbits.h"                    // for ktermios
#include "linux/capability.h"                        // for capable, CAP_SYS...
#include "linux/compiler_types.h"                    // for inline
#include "linux/err.h"                               // for IS_ERR, ERR_PTR
#include "linux/eventpoll.h"                         // for EPOLLIN, EPOLLOUT
#include "linux/export.h"                            // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                               // for GFP_KERNEL, __GF...
#include "linux/kconfig.h"                           // for IS_BUILTIN
#include "linux/lockdep.h"                           // for lockdep_assert_h...
#include "linux/panic.h"                             // for panic
#include "linux/printk.h"                            // for pr_warn
#include "linux/rwsem.h"                             // for down_write, up_w...
#include "linux/spinlock.h"                          // for raw_spin_lock_ir...
#include "linux/spinlock_types_raw.h"                // for DEFINE_RAW_SPINLOCK
#include "linux/sysctl.h"                            // for proc_dointvec
#include "linux/tty.h"                               // for tty_struct (ptr ...
#include "linux/tty_ldisc.h"                         // for tty_ldisc_ops

drivers/tty/tty_ldisc.c should remove these lines:
- #include <linux/bitops.h>  // lines 18-18
- #include <linux/device.h>  // lines 16-16
- #include <linux/errno.h>  // lines 3-3
- #include <linux/file.h>  // lines 9-9
- #include <linux/interrupt.h>  // lines 6-6
- #include <linux/mm.h>  // lines 10-10
- #include <linux/poll.h>  // lines 13-13
- #include <linux/proc_fs.h>  // lines 14-14
- #include <linux/ratelimit.h>  // lines 21-21
- #include <linux/string.h>  // lines 11-11
- #include <linux/uaccess.h>  // lines 20-20

The full include-list for drivers/tty/tty_ldisc.c:
#include <asm/bitops.h>                              // for test_bit
#include <asm/bug.h>                                 // for WARN_ON, WARN_ON...
#include <linux/kmod.h>                              // for request_module
#include <linux/module.h>                            // for module_put, try_...
#include <linux/sched.h>                             // for MAX_SCHEDULE_TIM...
#include <linux/seq_file.h>                          // for seq_printf, seq_...
#include <linux/slab.h>                              // for kfree, kmalloc
#include <linux/tty.h>                               // for tty_struct, TTY_...
#include <linux/tty_driver.h>                        // for tty_driver, tty_...
#include <linux/types.h>                             // for loff_t, bool
#include <linux/wait.h>                              // for wake_up_interrup...
#include <stddef.h>                                  // for NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/errno-base.h"                  // for EINVAL, EBUSY, EIO
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/termbits.h"                    // for ktermios
#include "linux/capability.h"                        // for capable, CAP_SYS...
#include "linux/compiler_types.h"                    // for inline
#include "linux/err.h"                               // for IS_ERR, ERR_PTR
#include "linux/eventpoll.h"                         // for EPOLLIN, EPOLLOUT
#include "linux/export.h"                            // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                               // for GFP_KERNEL, __GF...
#include "linux/kconfig.h"                           // for IS_BUILTIN
#include "linux/lockdep.h"                           // for lockdep_assert_h...
#include "linux/panic.h"                             // for panic
#include "linux/printk.h"                            // for pr_warn
#include "linux/rwsem.h"                             // for down_write, up_w...
#include "linux/spinlock.h"                          // for raw_spin_lock_ir...
#include "linux/spinlock_types_raw.h"                // for DEFINE_RAW_SPINLOCK
#include "linux/sysctl.h"                            // for proc_dointvec
#include "linux/tty.h"                               // for tty_struct (ptr ...
#include "linux/tty_ldisc.h"                         // for tty_ldisc_ops
#include "tty.h"                                     // for tty_buffer_flush
---
  ./scripts/check-local-export drivers/tty/tty_ldisc.o
  iwyu2 -Wp,-MMD,drivers/tty/.tty_buffer.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/tty/tty_buffer"' -DKBUILD_BASENAME='"tty_buffer"' -DKBUILD_MODNAME='"tty_buffer"' -D__KBUILD_MODNAME=kmod_tty_buffer -c -o drivers/tty/tty_buffer.o drivers/tty/tty_buffer.c  
In file included from drivers/tty/tty_buffer.c:8:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/tty_buffer.c:8:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/tty_buffer.c:8:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/tty/tty_buffer.c:8:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/tty_buffer.c:8:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/tty_buffer.c:8:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/tty/tty_buffer.c should add these lines:
#include <asm/barrier.h>                       // for smp_load_acquire, smp_...
#include <asm/bug.h>                           // for WARN, WARN_ON
#include <stddef.h>                            // for size_t, NULL
#include "asm-generic/errno-base.h"            // for EINVAL
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/string_32.h"                     // for memcpy, memset
#include "linux/align.h"                       // for __ALIGN_MASK
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_dec
#include "linux/compiler.h"                    // for unlikely, likely
#include "linux/compiler_types.h"              // for inline
#include "linux/container_of.h"                // for container_of
#include "linux/export.h"                      // for EXPORT_SYMBOL_GPL, EXP...
#include "linux/gfp.h"                         // for GFP_ATOMIC, __GFP_NOWARN
#include "linux/llist.h"                       // for init_llist_head, llist...
#include "linux/lockdep.h"                     // for lockdep_set_subclass
#include "linux/minmax.h"                      // for min_t, max
#include "linux/mutex.h"                       // for mutex_lock, mutex_unlock
#include "linux/spinlock.h"                    // for spin_unlock_irqrestore
#include "linux/tty_buffer.h"                  // for tty_buffer, tty_bufhead
#include "linux/tty_ldisc.h"                   // for tty_ldisc, tty_ldisc_ops
#include "linux/tty_port.h"                    // for tty_port, tty_port_cli...
#include "linux/workqueue.h"                   // for queue_work, system_unb...

drivers/tty/tty_buffer.c should remove these lines:
- #include <linux/bitops.h>  // lines 16-16
- #include <linux/delay.h>  // lines 17-17
- #include <linux/errno.h>  // lines 7-7
- #include <linux/module.h>  // lines 18-18
- #include <linux/ratelimit.h>  // lines 19-19
- #include <linux/string.h>  // lines 12-12
- #include <linux/timer.h>  // lines 11-11
- #include <linux/tty_driver.h>  // lines 9-9
- #include <linux/wait.h>  // lines 15-15

The full include-list for drivers/tty/tty_buffer.c:
#include <asm/barrier.h>                       // for smp_load_acquire, smp_...
#include <asm/bug.h>                           // for WARN, WARN_ON
#include <linux/sched.h>                       // for need_resched, cond_res...
#include <linux/slab.h>                        // for kfree, kmalloc
#include <linux/tty.h>                         // for tty_struct
#include <linux/tty_flip.h>                    // for tty_insert_flip_string
#include <linux/types.h>                       // for bool
#include <stddef.h>                            // for size_t, NULL
#include "asm-generic/errno-base.h"            // for EINVAL
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/string_32.h"                     // for memcpy, memset
#include "linux/align.h"                       // for __ALIGN_MASK
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_dec
#include "linux/compiler.h"                    // for unlikely, likely
#include "linux/compiler_types.h"              // for inline
#include "linux/container_of.h"                // for container_of
#include "linux/export.h"                      // for EXPORT_SYMBOL_GPL, EXP...
#include "linux/gfp.h"                         // for GFP_ATOMIC, __GFP_NOWARN
#include "linux/llist.h"                       // for init_llist_head, llist...
#include "linux/lockdep.h"                     // for lockdep_set_subclass
#include "linux/minmax.h"                      // for min_t, max
#include "linux/mutex.h"                       // for mutex_lock, mutex_unlock
#include "linux/spinlock.h"                    // for spin_unlock_irqrestore
#include "linux/tty_buffer.h"                  // for tty_buffer, tty_bufhead
#include "linux/tty_ldisc.h"                   // for tty_ldisc, tty_ldisc_ops
#include "linux/tty_port.h"                    // for tty_port, tty_port_cli...
#include "linux/workqueue.h"                   // for queue_work, system_unb...
#include "tty.h"                               // for tty_buffer_cancel_work
---
  ./scripts/check-local-export drivers/tty/tty_buffer.o
  iwyu2 -Wp,-MMD,drivers/tty/.tty_port.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/tty/tty_port"' -DKBUILD_BASENAME='"tty_port"' -DKBUILD_MODNAME='"tty_port"' -D__KBUILD_MODNAME=kmod_tty_port -c -o drivers/tty/tty_port.o drivers/tty/tty_port.c  
In file included from drivers/tty/tty_port.c:8:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/tty_port.c:8:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/tty_port.c:8:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/tty/tty_port.c:8:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/tty_port.c:8:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/tty_port.c:8:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/tty/tty_port.c should add these lines:
#include <asm/bug.h>                                 // for WARN_ON
#include <stddef.h>                                  // for NULL, size_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit, clear_bit
#include "asm-generic/errno-base.h"                  // for EAGAIN, ENODEV
#include "asm-generic/fcntl.h"                       // for O_NONBLOCK
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/rwonce.h"                      // for READ_ONCE
#include "asm/current.h"                             // for current
#include "asm/page_types.h"                          // for PAGE_SIZE
#include "asm/string_32.h"                           // for memset
#include "linux/container_of.h"                      // for container_of
#include "linux/err.h"                               // for PTR_ERR
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/fs.h"                                // for file
#include "linux/gfp.h"                               // for get_zeroed_page
#include "linux/jiffies.h"                           // for jiffies_to_msecs
#include "linux/kfifo.h"                             // for INIT_KFIFO, kfif...
#include "linux/kref.h"                              // for kref_init, kref_put
#include "linux/minmax.h"                            // for max_t
#include "linux/mutex.h"                             // for mutex_unlock
#include "linux/sched.h"                             // for schedule, schedu...
#include "linux/serial.h"                            // for ASYNC_CLOSING_WA...
#include "linux/spinlock.h"                          // for spin_unlock_irqr...
#include "linux/tty_flags.h"                         // for ASYNC_HUP_NOTIFY
#include "linux/tty_ldisc.h"                         // for tty_ldisc_flush
#include "linux/tty_port.h"                          // for tty_port, tty_po...
struct attribute_group;
struct device;

drivers/tty/tty_port.c should remove these lines:
- #include <linux/bitops.h>  // lines 17-17
- #include <linux/module.h>  // lines 19-19
- #include <linux/serial.h>  // lines 11-11
- #include <linux/string.h>  // lines 13-13
- #include <linux/timer.h>  // lines 12-12

The full include-list for drivers/tty/tty_port.c:
#include <asm/bug.h>                                 // for WARN_ON
#include <linux/delay.h>                             // for msleep_interrupt...
#include <linux/errno.h>                             // for ERESTARTSYS
#include <linux/sched/signal.h>                      // for signal_pending
#include <linux/serdev.h>                            // for serdev_tty_port_...
#include <linux/slab.h>                              // for kfree
#include <linux/tty.h>                               // for tty_kref_put
#include <linux/tty_driver.h>                        // for tty_register_dev...
#include <linux/tty_flip.h>                          // for tty_ldisc_receiv...
#include <linux/types.h>                             // for bool
#include <linux/wait.h>                              // for finish_wait, pre...
#include <stddef.h>                                  // for NULL, size_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit, clear_bit
#include "asm-generic/errno-base.h"                  // for EAGAIN, ENODEV
#include "asm-generic/fcntl.h"                       // for O_NONBLOCK
#include "asm-generic/param.h"                       // for HZ
#include "asm-generic/rwonce.h"                      // for READ_ONCE
#include "asm/current.h"                             // for current
#include "asm/page_types.h"                          // for PAGE_SIZE
#include "asm/string_32.h"                           // for memset
#include "linux/container_of.h"                      // for container_of
#include "linux/err.h"                               // for PTR_ERR
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/fs.h"                                // for file
#include "linux/gfp.h"                               // for get_zeroed_page
#include "linux/jiffies.h"                           // for jiffies_to_msecs
#include "linux/kfifo.h"                             // for INIT_KFIFO, kfif...
#include "linux/kref.h"                              // for kref_init, kref_put
#include "linux/minmax.h"                            // for max_t
#include "linux/mutex.h"                             // for mutex_unlock
#include "linux/sched.h"                             // for schedule, schedu...
#include "linux/serial.h"                            // for ASYNC_CLOSING_WA...
#include "linux/spinlock.h"                          // for spin_unlock_irqr...
#include "linux/tty_flags.h"                         // for ASYNC_HUP_NOTIFY
#include "linux/tty_ldisc.h"                         // for tty_ldisc_flush
#include "linux/tty_port.h"                          // for tty_port, tty_po...
#include "tty.h"                                     // for tty_buffer_cance...
struct attribute_group;
struct device;
---
  ./scripts/check-local-export drivers/tty/tty_port.o
  iwyu2 -Wp,-MMD,drivers/tty/.tty_mutex.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/tty/tty_mutex"' -DKBUILD_BASENAME='"tty_mutex"' -DKBUILD_MODNAME='"tty_mutex"' -D__KBUILD_MODNAME=kmod_tty_mutex -c -o drivers/tty/tty_mutex.o drivers/tty/tty_mutex.c  
In file included from drivers/tty/tty_mutex.c:2:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/tty_mutex.c:2:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/tty_mutex.c:2:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/tty/tty_mutex.c:2:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/tty_mutex.c:2:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/tty_mutex.c:2:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/tty/tty_mutex.c should add these lines:
#include <asm/bug.h>                 // for WARN
#include "asm-generic/errno-base.h"  // for EIO
#include "linux/export.h"            // for EXPORT_SYMBOL
#include "linux/lockdep.h"           // for lockdep_set_subclass
#include "linux/mutex.h"             // for mutex_lock, mutex_lock_interrupt...

drivers/tty/tty_mutex.c should remove these lines:
- #include <linux/kallsyms.h>  // lines 4-4
- #include <linux/module.h>  // lines 3-3
- #include <linux/sched.h>  // lines 6-6
- #include <linux/semaphore.h>  // lines 5-5
- #include "tty.h"  // lines 7-7

The full include-list for drivers/tty/tty_mutex.c:
#include <asm/bug.h>                 // for WARN
#include <linux/tty.h>               // for tty_struct, tty_kref_get, tty_kr...
#include "asm-generic/errno-base.h"  // for EIO
#include "linux/export.h"            // for EXPORT_SYMBOL
#include "linux/lockdep.h"           // for lockdep_set_subclass
#include "linux/mutex.h"             // for mutex_lock, mutex_lock_interrupt...
---
  ./scripts/check-local-export drivers/tty/tty_mutex.o
  iwyu2 -Wp,-MMD,drivers/tty/.tty_ldsem.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/tty/tty_ldsem"' -DKBUILD_BASENAME='"tty_ldsem"' -DKBUILD_MODNAME='"tty_ldsem"' -D__KBUILD_MODNAME=kmod_tty_ldsem -c -o drivers/tty/tty_ldsem.o drivers/tty/tty_ldsem.c  
In file included from drivers/tty/tty_ldsem.c:31:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/tty_ldsem.c:31:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/tty_ldsem.c:31:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/tty/tty_ldsem.c:31:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/tty_ldsem.c:31:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/tty_ldsem.c:31:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/tty/tty_ldsem.c should add these lines:
#include <asm/barrier.h>                       // for smp_load_acquire, smp_...
#include <stddef.h>                            // for NULL
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm/current.h"                       // for current
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_add_return
#include "linux/compiler_types.h"              // for inline
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/kernel.h"                      // for might_sleep
#include "linux/lockdep.h"                     // for lock_acquired, rwsem_r...
#include "linux/tty_ldisc.h"                   // for ld_semaphore, __init_l...
#include "linux/types.h"                       // for list_head
struct lock_class_key;

drivers/tty/tty_ldsem.c should remove these lines:
- #include <linux/atomic.h>  // lines 30-30
- #include <linux/tty.h>  // lines 31-31

The full include-list for drivers/tty/tty_ldsem.c:
#include <asm/barrier.h>                       // for smp_load_acquire, smp_...
#include <linux/list.h>                        // for INIT_LIST_HEAD, list_e...
#include <linux/sched.h>                       // for task_struct, schedule_...
#include <linux/sched/debug.h>                 // for __sched
#include <linux/sched/task.h>                  // for put_task_struct, get_t...
#include <linux/spinlock.h>                    // for raw_spin_unlock_irq
#include <stddef.h>                            // for NULL
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm/current.h"                       // for current
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_add_return
#include "linux/compiler_types.h"              // for inline
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/kernel.h"                      // for might_sleep
#include "linux/lockdep.h"                     // for lock_acquired, rwsem_r...
#include "linux/tty_ldisc.h"                   // for ld_semaphore, __init_l...
#include "linux/types.h"                       // for list_head
struct lock_class_key;
---
  ./scripts/check-local-export drivers/tty/tty_ldsem.o
  iwyu2 -Wp,-MMD,drivers/tty/.tty_baudrate.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/tty/tty_baudrate"' -DKBUILD_BASENAME='"tty_baudrate"' -DKBUILD_MODNAME='"tty_baudrate"' -D__KBUILD_MODNAME=kmod_tty_baudrate -c -o drivers/tty/tty_baudrate.o drivers/tty/tty_baudrate.c  
In file included from drivers/tty/tty_baudrate.c:9:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/tty_baudrate.c:9:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/tty_baudrate.c:9:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/tty/tty_baudrate.c:9:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/tty_baudrate.c:9:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/tty_baudrate.c:9:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/tty/tty_baudrate.c should add these lines:
#include "asm-generic/termbits-common.h"  // for speed_t, IBSHIFT, B0, B110
#include "asm-generic/termbits.h"         // for ktermios, CBAUD, BOTHER

drivers/tty/tty_baudrate.c should remove these lines:
- #include <linux/termios.h>  // lines 8-8
- #include <linux/types.h>  // lines 6-6

The full include-list for drivers/tty/tty_baudrate.c:
#include <linux/export.h>                 // for EXPORT_SYMBOL, EXPORT_SYMBO...
#include <linux/kernel.h>                 // for ARRAY_SIZE
#include <linux/tty.h>                    // for tty_encode_baud_rate, tty_s...
#include "asm-generic/termbits-common.h"  // for speed_t, IBSHIFT, B0, B110
#include "asm-generic/termbits.h"         // for ktermios, CBAUD, BOTHER
#include "tty.h"                          // for tty_termios_input_baud_rate
---
  ./scripts/check-local-export drivers/tty/tty_baudrate.o
  iwyu2 -Wp,-MMD,drivers/tty/.tty_jobctrl.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/tty/tty_jobctrl"' -DKBUILD_BASENAME='"tty_jobctrl"' -DKBUILD_MODNAME='"tty_jobctrl"' -D__KBUILD_MODNAME=kmod_tty_jobctrl -c -o drivers/tty/tty_jobctrl.o drivers/tty/tty_jobctrl.c  
In file included from drivers/tty/tty_jobctrl.c:11:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/tty_jobctrl.c:11:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/tty_jobctrl.c:11:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/tty/tty_jobctrl.c:11:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/tty_jobctrl.c:11:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/tty_jobctrl.c:11:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/tty/tty_jobctrl.c should add these lines:
#include <asm/signal.h>               // for SIGHUP, SIGCONT, SIGTTIN, SIGTTOU
#include <linux/spinlock.h>           // for read_lock, read_unlock
#include <ctime>                      // for NULL, pid_t
#include "asm-generic/errno-base.h"   // for ENOTTY, EPERM, EIO, EFAULT, EINVAL
#include "asm-generic/ioctls.h"       // for TIOCGPGRP, TIOCGSID, TIOCNOTTY
#include "asm-generic/signal-defs.h"  // for SIG_IGN
#include "asm/current.h"              // for current
#include "asm/thread_info.h"          // for TIF_SIGPENDING
#include "asm/uaccess.h"              // for put_user, get_user
#include "linux/capability.h"         // for capable, CAP_SYS_ADMIN
#include "linux/compiler_types.h"     // for __user
#include "linux/export.h"             // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include "linux/fs.h"                 // for FMODE_READ, file
#include "linux/pid.h"                // for PIDTYPE_SID, put_pid, get_pid
#include "linux/rcupdate.h"           // for rcu_read_lock, rcu_read_unlock
#include "linux/sched.h"              // for task_struct
#include "linux/signal_types.h"       // for k_sigaction, sigaction
#include "linux/spinlock.h"           // for spin_unlock_irqrestore, spin_un...
#include "linux/thread_info.h"        // for set_thread_flag
#include "linux/tty_driver.h"         // for TTY_DRIVER_TYPE_PTY, tty_driver

drivers/tty/tty_jobctrl.c should remove these lines:
- #include <linux/fcntl.h>  // lines 12-12
- #include <linux/types.h>  // lines 6-6
- #include <linux/uaccess.h>  // lines 13-13

The full include-list for drivers/tty/tty_jobctrl.c:
#include <asm/signal.h>               // for SIGHUP, SIGCONT, SIGTTIN, SIGTTOU
#include <linux/errno.h>              // for ENOIOCTLCMD, ERESTARTSYS
#include <linux/sched/signal.h>       // for signal_struct, kill_pgrp, task_...
#include <linux/sched/task.h>         // for tasklist_lock
#include <linux/signal.h>             // for send_signal_locked
#include <linux/spinlock.h>           // for read_lock, read_unlock
#include <linux/tty.h>                // for tty_struct, tty_struct::(anonym...
#include <ctime>                      // for NULL, pid_t
#include "asm-generic/errno-base.h"   // for ENOTTY, EPERM, EIO, EFAULT, EINVAL
#include "asm-generic/ioctls.h"       // for TIOCGPGRP, TIOCGSID, TIOCNOTTY
#include "asm-generic/signal-defs.h"  // for SIG_IGN
#include "asm/current.h"              // for current
#include "asm/thread_info.h"          // for TIF_SIGPENDING
#include "asm/uaccess.h"              // for put_user, get_user
#include "linux/capability.h"         // for capable, CAP_SYS_ADMIN
#include "linux/compiler_types.h"     // for __user
#include "linux/export.h"             // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include "linux/fs.h"                 // for FMODE_READ, file
#include "linux/pid.h"                // for PIDTYPE_SID, put_pid, get_pid
#include "linux/rcupdate.h"           // for rcu_read_lock, rcu_read_unlock
#include "linux/sched.h"              // for task_struct
#include "linux/signal_types.h"       // for k_sigaction, sigaction
#include "linux/spinlock.h"           // for spin_unlock_irqrestore, spin_un...
#include "linux/thread_info.h"        // for set_thread_flag
#include "linux/tty_driver.h"         // for TTY_DRIVER_TYPE_PTY, tty_driver
#include "tty.h"                      // for tty_vhangup_session, __tty_chec...
---
  ./scripts/check-local-export drivers/tty/tty_jobctrl.o
  iwyu2 -Wp,-MMD,drivers/tty/.n_null.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/tty/n_null"' -DKBUILD_BASENAME='"n_null"' -DKBUILD_MODNAME='"n_null"' -D__KBUILD_MODNAME=kmod_n_null -c -o drivers/tty/n_null.o drivers/tty/n_null.c  
In file included from drivers/tty/n_null.c:4:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/n_null.c:4:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/n_null.c:4:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/tty/n_null.c:4:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/tty/n_null.c:4:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/tty/n_null.c:4:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/tty/n_null.c should add these lines:
#include <asm/bug.h>            // for BUG_ON
#include <sys/types.h>          // for size_t, ssize_t
#include "asm-generic/errno.h"  // for EOPNOTSUPP
#include "linux/export.h"       // for THIS_MODULE
#include "linux/init.h"         // for __exit, __init
#include "linux/tty.h"          // for N_NULL
#include "linux/tty_ldisc.h"    // for tty_register_ldisc, tty_unregister_ldisc
struct file;
struct tty_struct;

drivers/tty/n_null.c should remove these lines:
- #include <linux/errno.h>  // lines 3-3
- #include <linux/tty.h>  // lines 4-4
- #include <linux/types.h>  // lines 2-2

The full include-list for drivers/tty/n_null.c:
#include <asm/bug.h>            // for BUG_ON
#include <linux/module.h>       // for MODULE_AUTHOR, MODULE_DESCRIPTION
#include <sys/types.h>          // for size_t, ssize_t
#include "asm-generic/errno.h"  // for EOPNOTSUPP
#include "linux/export.h"       // for THIS_MODULE
#include "linux/init.h"         // for __exit, __init
#include "linux/tty.h"          // for N_NULL
#include "linux/tty_ldisc.h"    // for tty_register_ldisc, tty_unregister_ldisc
struct file;
struct tty_struct;
---
  ./scripts/check-local-export drivers/tty/n_null.o
  rm -f drivers/tty/built-in.a; echo tty_io.o n_tty.o tty_ioctl.o tty_ldisc.o tty_buffer.o tty_port.o tty_mutex.o tty_ldsem.o tty_baudrate.o tty_jobctrl.o n_null.o vt/built-in.a | sed -E 's:([^ ]+):drivers/tty/:g' | xargs llvm-ar cDPrST drivers/tty/built-in.a
make -f ./scripts/Makefile.build obj=drivers/char \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,drivers/char/.mem.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/char/mem"' -DKBUILD_BASENAME='"mem"' -DKBUILD_MODNAME='"mem"' -D__KBUILD_MODNAME=kmod_mem -c -o drivers/char/mem.o drivers/char/mem.c  
In file included from drivers/char/mem.c:13:
In file included from ./include/linux/miscdevice.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/char/mem.c:13:
In file included from ./include/linux/miscdevice.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/char/mem.c:13:
In file included from ./include/linux/miscdevice.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/char/mem.c:25:
In file included from ./include/linux/shmem_fs.h:6:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from drivers/char/mem.c:13:
In file included from ./include/linux/miscdevice.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/char/mem.c:13:
In file included from ./include/linux/miscdevice.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/char/mem.c:13:
In file included from ./include/linux/miscdevice.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/char/mem.c:25:
In file included from ./include/linux/shmem_fs.h:6:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

drivers/char/mem.c should add these lines:
#include <linux/build_bug.h>            // for unlikely
#include <cstdio>                       // for size_t, ssize_t, NULL
#include "asm-generic/errno-base.h"     // for EFAULT, EINVAL, EPERM, EAGAIN
#include "asm-generic/errno.h"          // for ENOSYS, EOVERFLOW
#include "asm/current.h"                // for current
#include "asm/io.h"                     // for valid_phys_addr_range, unxlat...
#include "asm/page_types.h"             // for PAGE_SIZE, PAGE_SHIFT
#include "asm/pgtable_types.h"          // for phys_mem_access_prot, __HAVE_...
#include "asm/shared/io.h"              // for inb, outb
#include "asm/uaccess.h"                // for clear_user, access_ok, __get_...
#include "linux/capability.h"           // for CAP_SYS_RAWIO
#include "linux/compiler_attributes.h"  // for __maybe_unused, __weak, fallt...
#include "linux/compiler_types.h"       // for __user, inline
#include "linux/device/class.h"         // for class, class_create
#include "linux/err.h"                  // for IS_ERR, PTR_ERR, MAX_ERRNO
#include "linux/errno.h"                // for ERESTARTSYS
#include "linux/fs.h"                   // for file_operations, file, file_i...
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/ioport.h"               // for iomem_get_mapping
#include "linux/kdev_t.h"               // for MINOR, MKDEV
#include "linux/kernel.h"               // for ARRAY_SIZE
#include "linux/major.h"                // for MEM_MAJOR
#include "linux/minmax.h"               // for min, min_t
#include "linux/mm_types.h"             // for vm_area_struct, mm_struct
#include "linux/mman.h"                 // for MAP_SHARED
#include "linux/pgtable.h"              // for phys_mem_access_prot_allowed
#include "linux/printk.h"               // for printk
#include "linux/sched.h"                // for need_resched, cond_resched
#include "linux/sched/signal.h"         // for signal_pending
#include "linux/types.h"                // for loff_t, phys_addr_t, umode_t
struct pipe_buffer;
struct pipe_inode_info;

drivers/char/mem.c should remove these lines:
- #include <linux/backing-dev.h>  // lines 24-24
- #include <linux/highmem.h>  // lines 23-23
- #include <linux/miscdevice.h>  // lines 13-13
- #include <linux/mman.h>  // lines 16-16
- #include <linux/pfn.h>  // lines 27-27
- #include <linux/vmalloc.h>  // lines 15-15

The full include-list for drivers/char/mem.c:
#include <linux/build_bug.h>            // for unlikely
#include <linux/capability.h>           // for capable
#include <linux/device.h>               // for device_create, device
#include <linux/export.h>               // for THIS_MODULE
#include <linux/init.h>                 // for __init, fs_initcall
#include <linux/io.h>                   // for arch_has_dev_port
#include <linux/mm.h>                   // for generic_access_phys, remap_pf...
#include <linux/ptrace.h>               // for force_successful_syscall_return
#include <linux/random.h>               // for random_fops, urandom_fops
#include <linux/security.h>             // for security_locked_down, LOCKDOW...
#include <linux/shmem_fs.h>             // for shmem_get_unmapped_area, shme...
#include <linux/slab.h>                 // for kfree, kmalloc
#include <linux/splice.h>               // for splice_from_pipe, splice_desc
#include <linux/tty.h>                  // for tty_init
#include <linux/uaccess.h>              // for copy_from_kernel_nofault, cop...
#include <linux/uio.h>                  // for iov_iter_count, iov_iter_advance
#include <cstdio>                       // for size_t, ssize_t, NULL
#include "asm-generic/errno-base.h"     // for EFAULT, EINVAL, EPERM, EAGAIN
#include "asm-generic/errno.h"          // for ENOSYS, EOVERFLOW
#include "asm/current.h"                // for current
#include "asm/io.h"                     // for valid_phys_addr_range, unxlat...
#include "asm/page_types.h"             // for PAGE_SIZE, PAGE_SHIFT
#include "asm/pgtable_types.h"          // for phys_mem_access_prot, __HAVE_...
#include "asm/shared/io.h"              // for inb, outb
#include "asm/uaccess.h"                // for clear_user, access_ok, __get_...
#include "linux/capability.h"           // for CAP_SYS_RAWIO
#include "linux/compiler_attributes.h"  // for __maybe_unused, __weak, fallt...
#include "linux/compiler_types.h"       // for __user, inline
#include "linux/device/class.h"         // for class, class_create
#include "linux/err.h"                  // for IS_ERR, PTR_ERR, MAX_ERRNO
#include "linux/errno.h"                // for ERESTARTSYS
#include "linux/fs.h"                   // for file_operations, file, file_i...
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/ioport.h"               // for iomem_get_mapping
#include "linux/kdev_t.h"               // for MINOR, MKDEV
#include "linux/kernel.h"               // for ARRAY_SIZE
#include "linux/major.h"                // for MEM_MAJOR
#include "linux/minmax.h"               // for min, min_t
#include "linux/mm_types.h"             // for vm_area_struct, mm_struct
#include "linux/mman.h"                 // for MAP_SHARED
#include "linux/pgtable.h"              // for phys_mem_access_prot_allowed
#include "linux/printk.h"               // for printk
#include "linux/sched.h"                // for need_resched, cond_resched
#include "linux/sched/signal.h"         // for signal_pending
#include "linux/types.h"                // for loff_t, phys_addr_t, umode_t
struct pipe_buffer;
struct pipe_inode_info;
---
  ./scripts/check-local-export drivers/char/mem.o
  iwyu2 -Wp,-MMD,drivers/char/.random.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/char/random"' -DKBUILD_BASENAME='"random"' -DKBUILD_MODNAME='"random"' -D__KBUILD_MODNAME=kmod_random -c -o drivers/char/random.o drivers/char/random.c  
In file included from drivers/char/random.c:39:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/char/random.c:39:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/char/random.c:39:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/char/random.c:39:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from drivers/char/random.c:50:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
5 warnings generated.
In file included from drivers/char/random.c:39:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/char/random.c:39:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/char/random.c:39:
In file included from ./include/linux/blkdev.h:9:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/char/random.c:39:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from drivers/char/random.c:50:
In file included from ./include/linux/syscalls.h:88:
In file included from ./include/trace/syscall.h:7:
In file included from ./include/linux/trace_events.h:10:
In file included from ./include/linux/perf_event.h:55:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

drivers/char/random.c should add these lines:
#include <asm-generic/percpu.h>                // for DEFINE_PER_CPU, raw_cp...
#include <asm/bug.h>                           // for BUG_ON, WARN, WARN_ON
#include <asm/signal.h>                        // for SIGIO
#include <linux/bitops.h>                      // for fls
#include <linux/build_bug.h>                   // for unlikely
#include <linux/ktime.h>                       // for ktime_get_real, ktime_get
#include <linux/local_lock.h>                  // for INIT_LOCAL_LOCK, local...
#include <cstdio>                              // for size_t, ssize_t, NULL
#include "asm-generic/errno-base.h"            // for EFAULT, EINVAL, EPERM
#include "asm-generic/errno.h"                 // for ENODATA
#include "asm-generic/int-ll64.h"              // for u32, u8, u64
#include "asm-generic/irq_regs.h"              // for get_irq_regs
#include "asm-generic/param.h"                 // for HZ
#include "asm-generic/rwonce.h"                // for READ_ONCE, WRITE_ONCE
#include "asm-generic/siginfo.h"               // for POLL_IN
#include "asm/cache.h"                         // for __read_mostly
#include "asm/current.h"                       // for current
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/ptrace.h"                        // for instruction_pointer
#include "asm/string_32.h"                     // for memcpy, strlen, memset
#include "asm/timex.h"                         // for random_get_entropy
#include "asm/uaccess.h"                       // for get_user, put_user
#include "linux/atomic/atomic-instrumented.h"  // for cmpxchg
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/capability.h"                  // for capable, CAP_SYS_ADMIN
#include "linux/compiler_attributes.h"         // for __cold, __aligned
#include "linux/compiler_types.h"              // for __user
#include "linux/container_of.h"                // for container_of
#include "linux/eventpoll.h"                   // for EPOLLIN, EPOLLOUT, EPO...
#include "linux/export.h"                      // for EXPORT_SYMBOL, EXPORT_...
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/irqflags.h"                    // for local_irq_enable, loca...
#include "linux/jiffies.h"                     // for jiffies, time_is_befor...
#include "linux/jump_label.h"                  // for static_branch_likely
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/kern_levels.h"                 // for KERN_NOTICE
#include "linux/kstrtox.h"                     // for kstrtobool
#include "linux/ktime.h"                       // for ktime_t
#include "linux/limits.h"                      // for U16_MAX
#include "linux/local_lock.h"                  // for local_lock_irqsave
#include "linux/math.h"                        // for DIV_ROUND_UP
#include "linux/minmax.h"                      // for min_t, max, max_t, min
#include "linux/moduleparam.h"                 // for kernel_param, param_op...
#include "linux/notifier.h"                    // for notifier_block
#include "linux/preempt.h"                     // for in_hardirq
#include "linux/printk.h"                      // for pr_notice, printk_defe...
#include "linux/random.h"                      // for GRND_INSECURE, GRND_RA...
#include "linux/ratelimit_types.h"             // for ratelimit_state, RATEL...
#include "linux/sched.h"                       // for schedule, schedule_tim...
#include "linux/sched/signal.h"                // for signal_pending
#include "linux/smp.h"                         // for raw_smp_processor_id
#include "linux/spinlock_types.h"              // for __SPIN_LOCK_UNLOCKED
#include "linux/stddef.h"                      // for false, true
#include "linux/swab.h"                        // for swab
#include "linux/time64.h"                      // for time64_t
#include "linux/timer.h"                       // for destroy_timer_on_stack
#include "linux/types.h"                       // for bool, __poll_t
#include "linux/uio.h"                         // for iov_iter_count, copy_t...
#include "linux/utsname.h"                     // for new_utsname
#include "linux/wait.h"                        // for wait_queue_head, DECLA...
#include "vdso/limits.h"                       // for UINT_MAX, ULONG_MAX
struct batch_u32;
struct batch_u64;

drivers/char/random.c should remove these lines:
- #include <asm/io.h>  // lines 61-61
- #include <asm/irq.h>  // lines 59-59
- #include <asm/irq_regs.h>  // lines 60-60
- #include <asm/processor.h>  // lines 58-58
- #include <linux/blkdev.h>  // lines 39-39
- #include <linux/completion.h>  // lines 51-51
- #include <linux/fcntl.h>  // lines 33-33
- #include <linux/interrupt.h>  // lines 40-40
- #include <linux/irq.h>  // lines 48-48
- #include <linux/major.h>  // lines 31-31
- #include <linux/mm.h>  // lines 41-41
- #include <linux/module.h>  // lines 29-29
- #include <linux/nodemask.h>  // lines 42-42
- #include <linux/percpu.h>  // lines 45-45
- #include <linux/ptrace.h>  // lines 46-46
- #include <linux/ratelimit.h>  // lines 49-49
- #include <linux/slab.h>  // lines 34-34
- #include <linux/uaccess.h>  // lines 53-53
- #include <linux/uuid.h>  // lines 52-52

The full include-list for drivers/char/random.c:
#include <asm-generic/percpu.h>                // for DEFINE_PER_CPU, raw_cp...
#include <asm/bug.h>                           // for BUG_ON, WARN, WARN_ON
#include <asm/signal.h>                        // for SIGIO
#include <crypto/blake2s.h>                    // for BLAKE2S_HASH_SIZE, bla...
#include <crypto/chacha.h>                     // for chacha20_block, CHACHA...
#include <linux/bitops.h>                      // for fls
#include <linux/build_bug.h>                   // for unlikely
#include <linux/fs.h>                          // for generic_file_splice_read
#include <linux/init.h>                        // for __init, __initdata
#include <linux/kernel.h>                      // for ARRAY_SIZE, READ, WRITE
#include <linux/kthread.h>                     // for kthread_should_stop
#include <linux/ktime.h>                       // for ktime_get_real, ktime_get
#include <linux/local_lock.h>                  // for INIT_LOCAL_LOCK, local...
#include <linux/poll.h>                        // for poll_wait, poll_table
#include <linux/random.h>                      // for add_latent_entropy
#include <linux/siphash.h>                     // for HSIPHASH_PERMUTATION
#include <linux/spinlock.h>                    // for spin_unlock_irqrestore
#include <linux/string.h>                      // for memzero_explicit
#include <linux/suspend.h>                     // for register_pm_notifier
#include <linux/syscalls.h>                    // for __MAP3, SYSCALL_DEFINE3
#include <linux/utsname.h>                     // for utsname
#include <linux/workqueue.h>                   // for work_struct, execute_i...
#include <cstdio>                              // for size_t, ssize_t, NULL
#include "asm-generic/errno-base.h"            // for EFAULT, EINVAL, EPERM
#include "asm-generic/errno.h"                 // for ENODATA
#include "asm-generic/int-ll64.h"              // for u32, u8, u64
#include "asm-generic/irq_regs.h"              // for get_irq_regs
#include "asm-generic/param.h"                 // for HZ
#include "asm-generic/rwonce.h"                // for READ_ONCE, WRITE_ONCE
#include "asm-generic/siginfo.h"               // for POLL_IN
#include "asm/cache.h"                         // for __read_mostly
#include "asm/current.h"                       // for current
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/ptrace.h"                        // for instruction_pointer
#include "asm/string_32.h"                     // for memcpy, strlen, memset
#include "asm/timex.h"                         // for random_get_entropy
#include "asm/uaccess.h"                       // for get_user, put_user
#include "linux/atomic/atomic-instrumented.h"  // for cmpxchg
#include "linux/build_bug.h"                   // for BUILD_BUG_ON
#include "linux/capability.h"                  // for capable, CAP_SYS_ADMIN
#include "linux/compiler_attributes.h"         // for __cold, __aligned
#include "linux/compiler_types.h"              // for __user
#include "linux/container_of.h"                // for container_of
#include "linux/eventpoll.h"                   // for EPOLLIN, EPOLLOUT, EPO...
#include "linux/export.h"                      // for EXPORT_SYMBOL, EXPORT_...
#include "linux/instruction_pointer.h"         // for _RET_IP_
#include "linux/irqflags.h"                    // for local_irq_enable, loca...
#include "linux/jiffies.h"                     // for jiffies, time_is_befor...
#include "linux/jump_label.h"                  // for static_branch_likely
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/kern_levels.h"                 // for KERN_NOTICE
#include "linux/kstrtox.h"                     // for kstrtobool
#include "linux/ktime.h"                       // for ktime_t
#include "linux/limits.h"                      // for U16_MAX
#include "linux/local_lock.h"                  // for local_lock_irqsave
#include "linux/math.h"                        // for DIV_ROUND_UP
#include "linux/minmax.h"                      // for min_t, max, max_t, min
#include "linux/moduleparam.h"                 // for kernel_param, param_op...
#include "linux/notifier.h"                    // for notifier_block
#include "linux/preempt.h"                     // for in_hardirq
#include "linux/printk.h"                      // for pr_notice, printk_defe...
#include "linux/random.h"                      // for GRND_INSECURE, GRND_RA...
#include "linux/ratelimit_types.h"             // for ratelimit_state, RATEL...
#include "linux/sched.h"                       // for schedule, schedule_tim...
#include "linux/sched/signal.h"                // for signal_pending
#include "linux/smp.h"                         // for raw_smp_processor_id
#include "linux/spinlock_types.h"              // for __SPIN_LOCK_UNLOCKED
#include "linux/stddef.h"                      // for false, true
#include "linux/swab.h"                        // for swab
#include "linux/time64.h"                      // for time64_t
#include "linux/timer.h"                       // for destroy_timer_on_stack
#include "linux/types.h"                       // for bool, __poll_t
#include "linux/uio.h"                         // for iov_iter_count, copy_t...
#include "linux/utsname.h"                     // for new_utsname
#include "linux/wait.h"                        // for wait_queue_head, DECLA...
#include "vdso/limits.h"                       // for UINT_MAX, ULONG_MAX
struct batch_u32;
struct batch_u64;
---
  ./scripts/check-local-export drivers/char/random.o
  iwyu2 -Wp,-MMD,drivers/char/.misc.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/char/misc"' -DKBUILD_BASENAME='"misc"' -DKBUILD_MODNAME='"misc"' -D__KBUILD_MODNAME=kmod_misc -c -o drivers/char/misc.o drivers/char/misc.c  
In file included from drivers/char/misc.c:41:
In file included from ./include/linux/miscdevice.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/char/misc.c:41:
In file included from ./include/linux/miscdevice.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/char/misc.c:41:
In file included from ./include/linux/miscdevice.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/char/misc.c:41:
In file included from ./include/linux/miscdevice.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/char/misc.c:41:
In file included from ./include/linux/miscdevice.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/char/misc.c:41:
In file included from ./include/linux/miscdevice.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/char/misc.c should add these lines:
#include <asm/bug.h>                                 // for WARN_ON
#include <linux/bitmap.h>                            // for find_first_zero_bit
#include <stddef.h>                                  // for NULL
#include <sys/types.h>                               // for dev_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/errno-base.h"                  // for EBUSY, EIO, ENODEV
#include "linux/device/class.h"                      // for class_destroy
#include "linux/err.h"                               // for IS_ERR, PTR_ERR
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/kdev_t.h"                            // for MKDEV
#include "linux/list.h"                              // for INIT_LIST_HEAD
#include "linux/printk.h"                            // for pr_err
#include "linux/string.h"                            // for kstrdup
#include "linux/types.h"                             // for list_head, DECLA...

drivers/char/misc.c should remove these lines:
- #include <linux/errno.h>  // lines 40-40
- #include <linux/kernel.h>  // lines 42-42
- #include <linux/module.h>  // lines 37-37
- #include <linux/seq_file.h>  // lines 46-46
- #include <linux/stat.h>  // lines 47-47
- #include <linux/tty.h>  // lines 50-50

The full include-list for drivers/char/misc.c:
#include <asm/bug.h>                                 // for WARN_ON
#include <linux/bitmap.h>                            // for find_first_zero_bit
#include <linux/device.h>                            // for dev_get_drvdata
#include <linux/fs.h>                                // for noop_llseek, file
#include <linux/gfp.h>                               // for GFP_KERNEL
#include <linux/init.h>                              // for __init, subsys_i...
#include <linux/kmod.h>                              // for request_module
#include <linux/major.h>                             // for MISC_MAJOR
#include <linux/miscdevice.h>                        // for miscdevice, MISC...
#include <linux/mutex.h>                             // for mutex_lock, mute...
#include <linux/proc_fs.h>                           // for proc_create_seq
#include <stddef.h>                                  // for NULL
#include <sys/types.h>                               // for dev_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/errno-base.h"                  // for EBUSY, EIO, ENODEV
#include "linux/device/class.h"                      // for class_destroy
#include "linux/err.h"                               // for IS_ERR, PTR_ERR
#include "linux/export.h"                            // for EXPORT_SYMBOL
#include "linux/kdev_t.h"                            // for MKDEV
#include "linux/list.h"                              // for INIT_LIST_HEAD
#include "linux/printk.h"                            // for pr_err
#include "linux/string.h"                            // for kstrdup
#include "linux/types.h"                             // for list_head, DECLA...
---
  ./scripts/check-local-export drivers/char/misc.o
  rm -f drivers/char/built-in.a; echo mem.o random.o misc.o | sed -E 's:([^ ]+):drivers/char/:g' | xargs llvm-ar cDPrST drivers/char/built-in.a
make -f ./scripts/Makefile.build obj=drivers/base \
 \
need-builtin=1 \
need-modorder=1
make -f ./scripts/Makefile.build obj=drivers/base/power \
 \
need-builtin=1 \
need-modorder=1
  rm -f drivers/base/power/built-in.a; echo  | sed -E 's:([^ ]+):drivers/base/power/:g' | xargs llvm-ar cDPrST drivers/base/power/built-in.a
  iwyu2 -Wp,-MMD,drivers/base/.component.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/component"' -DKBUILD_BASENAME='"component"' -DKBUILD_MODNAME='"component"' -D__KBUILD_MODNAME=kmod_component -c -o drivers/base/component.o drivers/base/component.c  
In file included from drivers/base/component.c:6:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/component.c:6:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/component.c:6:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/base/component.c:6:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/component.c:6:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/component.c:6:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

include/linux/component.h should add these lines:
#include <stddef.h>                // for NULL
#include "linux/compiler_types.h"  // for inline

include/linux/component.h should remove these lines:
- #include <linux/stddef.h>  // lines 5-5
- struct aggregate_device;  // lines 44-44

The full include-list for include/linux/component.h:
#include <stddef.h>                // for NULL
#include "linux/compiler_types.h"  // for inline
struct component_match;  // lines 94-94
struct device;  // lines 8-8
---

drivers/base/component.c should add these lines:
#include <asm/bug.h>                 // for WARN_ON
#include "asm-generic/errno-base.h"  // for ENOMEM, EINVAL, ENXIO
#include "asm/string_32.h"           // for memcpy
#include "linux/dev_printk.h"        // for dev_dbg, dev_info, dev_err
#include "linux/device/bus.h"        // for device_match_name, device_match_...
#include "linux/err.h"               // for ERR_PTR, IS_ERR
#include "linux/errno.h"             // for EPROBE_DEFER
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/minmax.h"            // for min
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for list_head, bool

drivers/base/component.c should remove these lines:
- #include <linux/debugfs.h>  // lines 11-11
- struct component;  // lines 39-39

The full include-list for drivers/base/component.c:
#include <linux/component.h>
#include <asm/bug.h>                 // for WARN_ON
#include <linux/device.h>            // for devres_release_group, dev_name
#include <linux/list.h>              // for list_del, list_for_each_entry
#include <linux/mutex.h>             // for mutex_lock, mutex_unlock, mutex
#include <linux/of.h>                // for of_node_put
#include <linux/slab.h>              // for kfree, kzalloc, kmalloc_array
#include "asm-generic/errno-base.h"  // for ENOMEM, EINVAL, ENXIO
#include "asm/string_32.h"           // for memcpy
#include "linux/dev_printk.h"        // for dev_dbg, dev_info, dev_err
#include "linux/device/bus.h"        // for device_match_name, device_match_...
#include "linux/err.h"               // for ERR_PTR, IS_ERR
#include "linux/errno.h"             // for EPROBE_DEFER
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/minmax.h"            // for min
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for list_head, bool
---
  ./scripts/check-local-export drivers/base/component.o
  iwyu2 -Wp,-MMD,drivers/base/.core.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/core"' -DKBUILD_BASENAME='"core"' -DKBUILD_MODNAME='"core"' -D__KBUILD_MODNAME=kmod_core -c -o drivers/base/core.o drivers/base/core.c  
In file included from drivers/base/core.c:11:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
In file included from drivers/base/core.c:24:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from drivers/base/core.c:27:
In file included from ./include/linux/netdevice.h:38:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from drivers/base/core.c:27:
./include/linux/netdevice.h:1243:17: warning: declaration of 'struct rtnl_link_stats64' will not be visible outside of this function [-Wvisibility]
                                                   struct rtnl_link_stats64 *storage);
                                                          ^
./include/linux/netdevice.h:1268:19: warning: declaration of 'struct ifla_vf_info' will not be visible outside of this function [-Wvisibility]
                                                     struct ifla_vf_info *ivf);
                                                            ^
./include/linux/netdevice.h:1273:18: warning: declaration of 'struct ifla_vf_stats' will not be visible outside of this function [-Wvisibility]
                                                    struct ifla_vf_stats
                                                           ^
./include/linux/netdevice.h:1282:17: warning: declaration of 'struct ifla_vf_guid' will not be visible outside of this function [-Wvisibility]
                                                   struct ifla_vf_guid *node_guid,
                                                          ^
10 warnings generated.
In file included from drivers/base/core.c:11:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
In file included from drivers/base/core.c:24:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
In file included from drivers/base/core.c:27:
In file included from ./include/linux/netdevice.h:38:
In file included from ./include/net/net_namespace.h:40:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from drivers/base/core.c:27:
./include/linux/netdevice.h:1243:17: warning: declaration of 'struct rtnl_link_stats64' will not be visible outside of this function [-Wvisibility]
                                                   struct rtnl_link_stats64 *storage);
                                                          ^
./include/linux/netdevice.h:1268:19: warning: declaration of 'struct ifla_vf_info' will not be visible outside of this function [-Wvisibility]
                                                     struct ifla_vf_info *ivf);
                                                            ^
./include/linux/netdevice.h:1273:18: warning: declaration of 'struct ifla_vf_stats' will not be visible outside of this function [-Wvisibility]
                                                    struct ifla_vf_stats
                                                           ^
./include/linux/netdevice.h:1282:17: warning: declaration of 'struct ifla_vf_guid' will not be visible outside of this function [-Wvisibility]
                                                   struct ifla_vf_guid *node_guid,
                                                          ^

drivers/base/core.c should add these lines:
#include <asm/bug.h>                    // for WARN_ON, WARN, WARN_ON_ONCE
#include <linux/srcu.h>                 // for srcu_struct, DEFINE_STATIC_SRCU
#include <sys/types.h>                  // for dev_t
#include <cstdio>                       // for NULL, ssize_t, size_t, va_list
#include "asm-generic/errno-base.h"     // for EINVAL, ENOMEM, EAGAIN, EIO
#include "asm-generic/int-ll64.h"       // for u32
#include "asm-generic/rwonce.h"         // for WRITE_ONCE, READ_ONCE
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/string_32.h"              // for strlen, strcmp, strchr
#include "linux/compiler_attributes.h"  // for __printf
#include "linux/compiler_types.h"       // for inline, __acquires, __releases
#include "linux/container_of.h"         // for container_of
#include "linux/delay.h"                // for msleep
#include "linux/dev_printk.h"           // for dev_dbg, dev_info, dev_err
#include "linux/device/bus.h"           // for bus_type, BUS_NOTIFY_ADD_DEVICE
#include "linux/device/class.h"         // for class, class_interface, class...
#include "linux/device/driver.h"        // for device_driver, wait_for_devic...
#include "linux/errno.h"                // for EPROBE_DEFER
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/kern_levels.h"          // for KERN_ERR
#include "linux/kernel.h"               // for snprintf
#include "linux/kernfs.h"               // for kernfs_elem_dir, kernfs_node
#include "linux/klist.h"                // for klist_add_tail, klist_iter_exit
#include "linux/kobject.h"              // for kset, kobject, add_uevent_var
#include "linux/kref.h"                 // for kref_get, kref_put, kref_read
#include "linux/kstrtox.h"              // for strtobool, kstrtol, kstrtoul
#include "linux/list.h"                 // for INIT_LIST_HEAD, list_for_each...
#include "linux/lockdep.h"              // for lockdep_set_novalidate_class
#include "linux/minmax.h"               // for max
#include "linux/numa.h"                 // for NUMA_NO_NODE
#include "linux/pm.h"                   // for device_pm_lock, device_pm_unlock
#include "linux/printk.h"               // for pr_debug, va_format, printk
#include "linux/projid.h"               // for init_user_ns
#include "linux/property.h"             // for fwnode_get_next_available_chi...
#include "linux/rculist.h"              // for list_add_tail_rcu, list_del_rcu
#include "linux/refcount.h"             // for refcount_inc, refcount_set
#include "linux/spinlock.h"             // for spin_lock, spin_unlock, spin_...
#include "linux/srcu.h"                 // for srcu_read_lock, srcu_read_loc...
#include "linux/stat.h"                 // for S_IRUGO, S_IWUGO
#include "linux/stdarg.h"               // for va_end, va_start
#include "linux/stddef.h"               // for true, false
#include "linux/types.h"                // for list_head, bool, umode_t
#include "linux/uidgid.h"               // for kgid_t, kuid_t, from_kgid
#include "linux/workqueue.h"            // for work_struct, queue_work, INIT...
#include "vdso/limits.h"                // for INT_MAX, INT_MIN
struct module;

drivers/base/core.c should remove these lines:
- #include <linux/blkdev.h>  // lines 24-24
- #include <linux/dma-map-ops.h>  // lines 32-32
- #include <linux/module.h>  // lines 17-17
- #include <linux/netdevice.h>  // lines 27-27
- #include <linux/swiotlb.h>  // lines 30-30

The full include-list for drivers/base/core.c:
#include <asm/bug.h>                    // for WARN_ON, WARN, WARN_ON_ONCE
#include <linux/acpi.h>                 // for acpi_device_notify, acpi_devi...
#include <linux/cpufreq.h>              // for cpufreq_suspend
#include <linux/device.h>               // for device, device_link, dev_name
#include <linux/err.h>                  // for ERR_PTR, IS_ERR, PTR_ERR
#include <linux/fwnode.h>               // for fwnode_link, fwnode_handle
#include <linux/init.h>                 // for __init, initcall_debug, early...
#include <linux/kdev_t.h>               // for MAJOR, format_dev_t, MINOR
#include <linux/mutex.h>                // for mutex_unlock, mutex_lock, mutex
#include <linux/notifier.h>             // for blocking_notifier_call_chain
#include <linux/of.h>                   // for of_node_get, of_node_put, to_...
#include <linux/of_device.h>            // for of_device_uevent
#include <linux/pm_runtime.h>           // for pm_runtime_drop_link, pm_runt...
#include <linux/sched/mm.h>             // for memalloc_noio_restore, memall...
#include <linux/sched/signal.h>         // for restart_syscall
#include <linux/slab.h>                 // for kfree, kzalloc
#include <linux/srcu.h>                 // for srcu_struct, DEFINE_STATIC_SRCU
#include <linux/string.h>               // for kstrdup, sysfs_streq, strreplace
#include <linux/sysfs.h>                // for sysfs_remove_link, sysfs_crea...
#include <sys/types.h>                  // for dev_t
#include <cstdio>                       // for NULL, ssize_t, size_t, va_list
#include "asm-generic/errno-base.h"     // for EINVAL, ENOMEM, EAGAIN, EIO
#include "asm-generic/int-ll64.h"       // for u32
#include "asm-generic/rwonce.h"         // for WRITE_ONCE, READ_ONCE
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/string_32.h"              // for strlen, strcmp, strchr
#include "base.h"                       // for device_private, subsys_private
#include "linux/compiler_attributes.h"  // for __printf
#include "linux/compiler_types.h"       // for inline, __acquires, __releases
#include "linux/container_of.h"         // for container_of
#include "linux/delay.h"                // for msleep
#include "linux/dev_printk.h"           // for dev_dbg, dev_info, dev_err
#include "linux/device/bus.h"           // for bus_type, BUS_NOTIFY_ADD_DEVICE
#include "linux/device/class.h"         // for class, class_interface, class...
#include "linux/device/driver.h"        // for device_driver, wait_for_devic...
#include "linux/errno.h"                // for EPROBE_DEFER
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/kern_levels.h"          // for KERN_ERR
#include "linux/kernel.h"               // for snprintf
#include "linux/kernfs.h"               // for kernfs_elem_dir, kernfs_node
#include "linux/klist.h"                // for klist_add_tail, klist_iter_exit
#include "linux/kobject.h"              // for kset, kobject, add_uevent_var
#include "linux/kref.h"                 // for kref_get, kref_put, kref_read
#include "linux/kstrtox.h"              // for strtobool, kstrtol, kstrtoul
#include "linux/list.h"                 // for INIT_LIST_HEAD, list_for_each...
#include "linux/lockdep.h"              // for lockdep_set_novalidate_class
#include "linux/minmax.h"               // for max
#include "linux/numa.h"                 // for NUMA_NO_NODE
#include "linux/pm.h"                   // for device_pm_lock, device_pm_unlock
#include "linux/printk.h"               // for pr_debug, va_format, printk
#include "linux/projid.h"               // for init_user_ns
#include "linux/property.h"             // for fwnode_get_next_available_chi...
#include "linux/rculist.h"              // for list_add_tail_rcu, list_del_rcu
#include "linux/refcount.h"             // for refcount_inc, refcount_set
#include "linux/spinlock.h"             // for spin_lock, spin_unlock, spin_...
#include "linux/srcu.h"                 // for srcu_read_lock, srcu_read_loc...
#include "linux/stat.h"                 // for S_IRUGO, S_IWUGO
#include "linux/stdarg.h"               // for va_end, va_start
#include "linux/stddef.h"               // for true, false
#include "linux/types.h"                // for list_head, bool, umode_t
#include "linux/uidgid.h"               // for kgid_t, kuid_t, from_kgid
#include "linux/workqueue.h"            // for work_struct, queue_work, INIT...
#include "physical_location.h"          // for dev_add_physical_location
#include "power/power.h"                // for device_pm_initialized, device...
#include "vdso/limits.h"                // for INT_MAX, INT_MIN
struct module;
---
  ./scripts/check-local-export drivers/base/core.o
  iwyu2 -Wp,-MMD,drivers/base/.bus.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/bus"' -DKBUILD_BASENAME='"bus"' -DKBUILD_MODNAME='"bus"' -D__KBUILD_MODNAME=kmod_bus -c -o drivers/base/bus.o drivers/base/bus.c  
In file included from drivers/base/bus.c:11:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/bus.c:11:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/bus.c:11:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/base/bus.c:11:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/bus.c:11:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/bus.c:11:
In file included from ./include/linux/async.h:14:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/base/bus.c should add these lines:
#include <cstdio>                       // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"     // for ENOMEM, EINVAL, ENODEV, EIO
#include "linux/compiler_attributes.h"  // for __must_check
#include "linux/container_of.h"         // for container_of
#include "linux/device/driver.h"        // for device_driver, driver_remove_...
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/kern_levels.h"          // for KERN_ERR
#include "linux/klist.h"                // for klist_iter_exit, klist_node
#include "linux/kobject.h"              // for kset_unregister, kset, kset_c...
#include "linux/list.h"                 // for list_move_tail, INIT_LIST_HEAD
#include "linux/notifier.h"             // for blocking_notifier_chain_register
#include "linux/printk.h"               // for pr_debug, printk
#include "linux/spinlock.h"             // for spin_lock, spin_unlock
#include "linux/types.h"                // for list_head

drivers/base/bus.c should remove these lines:
- #include <linux/async.h>  // lines 11-11
- #include <linux/errno.h>  // lines 15-15
- #include <linux/module.h>  // lines 14-14
- #include <linux/string.h>  // lines 18-18
- #include "power/power.h"  // lines 22-22

The full include-list for drivers/base/bus.c:
#include <linux/device.h>               // for device, subsys_interface, dev...
#include <linux/device/bus.h>           // for bus_type, bus_attribute, bus_...
#include <linux/init.h>                 // for __init
#include <linux/mutex.h>                // for mutex_lock, mutex_unlock, __m...
#include <linux/slab.h>                 // for kfree, kzalloc
#include <linux/sysfs.h>                // for sysfs_remove_link, sysfs_crea...
#include <cstdio>                       // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"     // for ENOMEM, EINVAL, ENODEV, EIO
#include "base.h"                       // for subsys_private, device_private
#include "linux/compiler_attributes.h"  // for __must_check
#include "linux/container_of.h"         // for container_of
#include "linux/device/driver.h"        // for device_driver, driver_remove_...
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/kern_levels.h"          // for KERN_ERR
#include "linux/klist.h"                // for klist_iter_exit, klist_node
#include "linux/kobject.h"              // for kset_unregister, kset, kset_c...
#include "linux/list.h"                 // for list_move_tail, INIT_LIST_HEAD
#include "linux/notifier.h"             // for blocking_notifier_chain_register
#include "linux/printk.h"               // for pr_debug, printk
#include "linux/spinlock.h"             // for spin_lock, spin_unlock
#include "linux/types.h"                // for list_head
---
  ./scripts/check-local-export drivers/base/bus.o
  iwyu2 -Wp,-MMD,drivers/base/.dd.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/dd"' -DKBUILD_BASENAME='"dd"' -DKBUILD_MODNAME='"dd"' -D__KBUILD_MODNAME=kmod_dd -c -o drivers/base/dd.o drivers/base/dd.c  
In file included from drivers/base/dd.c:20:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/dd.c:20:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/dd.c:20:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/base/dd.c:20:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/dd.c:20:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/dd.c:20:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/base/dd.c should add these lines:
#include <linux/ktime.h>                       // for ktime_get
#include <cstdio>                              // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"            // for EBUSY, ENODEV, EAGAIN
#include "asm-generic/errno.h"                 // for ETIMEDOUT
#include "asm-generic/param.h"                 // for HZ
#include "asm/string_32.h"                     // for strlen
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_inc
#include "linux/compiler_types.h"              // for inline
#include "linux/dev_printk.h"                  // for dev_dbg, dev_err, dev_...
#include "linux/device/bus.h"                  // for bus_type, bus_for_each...
#include "linux/device/driver.h"               // for device_driver, PROBE_F...
#include "linux/errno.h"                       // for EPROBE_DEFER
#include "linux/export.h"                      // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/kernel.h"                      // for parse_option_str, kasp...
#include "linux/klist.h"                       // for klist, klist_add_tail
#include "linux/kobject.h"                     // for kobject_name, kobject_...
#include "linux/kstrtox.h"                     // for kstrtoint
#include "linux/ktime.h"                       // for ktime_us_delta, ktime_t
#include "linux/list.h"                        // for list_empty, list_del_init
#include "linux/mutex.h"                       // for mutex_lock, mutex_unlock
#include "linux/notifier.h"                    // for blocking_notifier_call...
#include "linux/pm.h"                          // for dev_pm_domain
#include "linux/printk.h"                      // for pr_debug, pr_warn, pr_err
#include "linux/seq_file.h"                    // for seq_printf, DEFINE_SHO...
#include "linux/spinlock.h"                    // for spin_unlock, spin_lock
#include "linux/stddef.h"                      // for true, false
#include "linux/string.h"                      // for strlcpy
#include "linux/sysfs.h"                       // for sysfs_remove_link, sys...
#include "linux/types.h"                       // for bool, list_head, ATOMI...
#include "linux/workqueue.h"                   // for work_struct, flush_work

drivers/base/dd.c should remove these lines:
- #include <linux/delay.h>  // lines 21-21
- #include <linux/kthread.h>  // lines 25-25

The full include-list for drivers/base/dd.c:
#include <linux/async.h>                       // for async_schedule_dev
#include <linux/debugfs.h>                     // for debugfs_create_file
#include <linux/device.h>                      // for device, dev_name, devi...
#include <linux/dma-map-ops.h>                 // for arch_teardown_dma_ops
#include <linux/init.h>                        // for __init, __setup, __exit
#include <linux/ktime.h>                       // for ktime_get
#include <linux/module.h>                      // for module_requested_async...
#include <linux/pinctrl/devinfo.h>             // for pinctrl_bind_pins, pin...
#include <linux/pm_runtime.h>                  // for pm_runtime_get_sync
#include <linux/slab.h>                        // for kfree
#include <linux/wait.h>                        // for wait_queue_head, DECLA...
#include <cstdio>                              // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"            // for EBUSY, ENODEV, EAGAIN
#include "asm-generic/errno.h"                 // for ETIMEDOUT
#include "asm-generic/param.h"                 // for HZ
#include "asm/string_32.h"                     // for strlen
#include "base.h"                              // for device_private, driver...
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read, atomic_inc
#include "linux/compiler_types.h"              // for inline
#include "linux/dev_printk.h"                  // for dev_dbg, dev_err, dev_...
#include "linux/device/bus.h"                  // for bus_type, bus_for_each...
#include "linux/device/driver.h"               // for device_driver, PROBE_F...
#include "linux/errno.h"                       // for EPROBE_DEFER
#include "linux/export.h"                      // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/kconfig.h"                     // for IS_ENABLED
#include "linux/kernel.h"                      // for parse_option_str, kasp...
#include "linux/klist.h"                       // for klist, klist_add_tail
#include "linux/kobject.h"                     // for kobject_name, kobject_...
#include "linux/kstrtox.h"                     // for kstrtoint
#include "linux/ktime.h"                       // for ktime_us_delta, ktime_t
#include "linux/list.h"                        // for list_empty, list_del_init
#include "linux/mutex.h"                       // for mutex_lock, mutex_unlock
#include "linux/notifier.h"                    // for blocking_notifier_call...
#include "linux/pm.h"                          // for dev_pm_domain
#include "linux/printk.h"                      // for pr_debug, pr_warn, pr_err
#include "linux/seq_file.h"                    // for seq_printf, DEFINE_SHO...
#include "linux/spinlock.h"                    // for spin_unlock, spin_lock
#include "linux/stddef.h"                      // for true, false
#include "linux/string.h"                      // for strlcpy
#include "linux/sysfs.h"                       // for sysfs_remove_link, sys...
#include "linux/types.h"                       // for bool, list_head, ATOMI...
#include "linux/workqueue.h"                   // for work_struct, flush_work
#include "power/power.h"                       // for device_pm_check_callbacks
---
  ./scripts/check-local-export drivers/base/dd.o
  iwyu2 -Wp,-MMD,drivers/base/.syscore.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/syscore"' -DKBUILD_BASENAME='"syscore"' -DKBUILD_MODNAME='"syscore"' -D__KBUILD_MODNAME=kmod_syscore -c -o drivers/base/syscore.o drivers/base/syscore.c  
In file included from drivers/base/syscore.c:11:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from drivers/base/syscore.c:11:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/syscore.c:11:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/syscore.c:11:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
4 warnings generated.
In file included from drivers/base/syscore.c:11:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
In file included from drivers/base/syscore.c:11:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/syscore.c:11:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/syscore.c:11:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:22:
In file included from ./include/linux/writeback.h:13:
In file included from ./include/linux/blk_types.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/base/syscore.c should add these lines:
#include "linux/export.h"       // for EXPORT_SYMBOL_GPL
#include "linux/init.h"         // for initcall_debug
#include "linux/list.h"         // for list_add_tail, list_del, LIST_HEAD
#include "linux/printk.h"       // for pr_info
#include "linux/types.h"        // for list_head

drivers/base/syscore.c should remove these lines:
- #include <linux/module.h>  // lines 10-10
- #include <linux/suspend.h>  // lines 11-11
- #include <trace/events/power.h>  // lines 12-12

The full include-list for drivers/base/syscore.c:
#include <linux/mutex.h>        // for mutex_lock, mutex_unlock, mutex, DEFI...
#include <linux/syscore_ops.h>  // for syscore_ops, register_syscore_ops
#include "linux/export.h"       // for EXPORT_SYMBOL_GPL
#include "linux/init.h"         // for initcall_debug
#include "linux/list.h"         // for list_add_tail, list_del, LIST_HEAD
#include "linux/printk.h"       // for pr_info
#include "linux/types.h"        // for list_head
---
  ./scripts/check-local-export drivers/base/syscore.o
  iwyu2 -Wp,-MMD,drivers/base/.driver.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/driver"' -DKBUILD_BASENAME='"driver"' -DKBUILD_MODNAME='"driver"' -D__KBUILD_MODNAME=kmod_driver -c -o drivers/base/driver.o drivers/base/driver.c  
In file included from drivers/base/driver.c:11:
In file included from ./include/linux/device/driver.h:20:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/driver.c:11:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/base/driver.c:12:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
3 warnings generated.
In file included from drivers/base/driver.c:11:
In file included from ./include/linux/device/driver.h:20:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/driver.c:11:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/base/driver.c:12:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^

include/linux/device/driver.h should add these lines:
#include <sys/types.h>                  // for dev_t
#include <cstdio>                       // for NULL, size_t, ssize_t
#include "linux/compiler_attributes.h"  // for __must_check
#include "linux/compiler_types.h"       // for inline
#include "linux/init.h"                 // for __init, __exit, device_initcall
#include "linux/sysfs.h"                // for __ATTR_RO, __ATTR_RW, __ATTR_WO
#include "linux/types.h"                // for bool
struct device;
struct driver_find_device_by_of_node::device_node;
struct fwnode_handle;

include/linux/device/driver.h should remove these lines:
- #include <linux/klist.h>  // lines 18-18
- #include <linux/kobject.h>  // lines 17-17

The full include-list for include/linux/device/driver.h:
#include <linux/device/bus.h>           // for device_match_any, device_matc...
#include <linux/module.h>               // for module_exit, module_init
#include <linux/pm.h>                   // for pm_message_t
#include <sys/types.h>                  // for dev_t
#include <cstdio>                       // for NULL, size_t, ssize_t
#include "linux/compiler_attributes.h"  // for __must_check
#include "linux/compiler_types.h"       // for inline
#include "linux/init.h"                 // for __init, __exit, device_initcall
#include "linux/sysfs.h"                // for __ATTR_RO, __ATTR_RW, __ATTR_WO
#include "linux/types.h"                // for bool
struct device;
struct driver_find_device_by_of_node::device_node;
struct fwnode_handle;
---

drivers/base/driver.c should add these lines:
#include <asm/bug.h>                 // for WARN
#include <stddef.h>                  // for NULL, size_t
#include "asm-generic/errno-base.h"  // for EINVAL, EBUSY, ENOMEM
#include "asm/page_types.h"          // for PAGE_SIZE
#include "linux/device/bus.h"        // for bus_type
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/klist.h"             // for klist_iter_exit, klist_iter_init...
#include "linux/kobject.h"           // for kobject_put, kobject_uevent, kse...
#include "linux/printk.h"            // for pr_err, pr_warn

drivers/base/driver.c should remove these lines:
- #include <linux/errno.h>  // lines 14-14
- #include <linux/module.h>  // lines 13-13

The full include-list for drivers/base/driver.c:
#include <linux/device/driver.h>
#include <asm/bug.h>                 // for WARN
#include <linux/device.h>            // for device_lock, device_unlock, get_...
#include <linux/slab.h>              // for kfree
#include <linux/string.h>            // for kstrndup, strnchr
#include <linux/sysfs.h>             // for sysfs_create_file, sysfs_create_...
#include <stddef.h>                  // for NULL, size_t
#include "asm-generic/errno-base.h"  // for EINVAL, EBUSY, ENOMEM
#include "asm/page_types.h"          // for PAGE_SIZE
#include "base.h"                    // for driver_private, bus_remove_driver
#include "linux/device/bus.h"        // for bus_type
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/klist.h"             // for klist_iter_exit, klist_iter_init...
#include "linux/kobject.h"           // for kobject_put, kobject_uevent, kse...
#include "linux/printk.h"            // for pr_err, pr_warn
---
  ./scripts/check-local-export drivers/base/driver.o
  iwyu2 -Wp,-MMD,drivers/base/.class.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/class"' -DKBUILD_BASENAME='"class"' -DKBUILD_MODNAME='"class"' -D__KBUILD_MODNAME=kmod_class -c -o drivers/base/class.o drivers/base/class.c  
In file included from drivers/base/class.c:11:
In file included from ./include/linux/device/class.h:20:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/class.c:11:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/class.c:12:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/base/class.c:19:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^
4 warnings generated.
In file included from drivers/base/class.c:11:
In file included from ./include/linux/device/class.h:20:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/class.c:11:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/class.c:12:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/base/class.c:19:
./include/linux/blkdev.h:281:39: warning: declaration of 'struct blk_zone' will not be visible outside of this function [-Wvisibility]
typedef int (*report_zones_cb)(struct blk_zone *zone, unsigned int idx,
                                      ^

include/linux/device/class.h should add these lines:
#include <sys/types.h>                  // for dev_t
#include <cstdio>                       // for NULL, ssize_t, size_t
#include "linux/compiler_attributes.h"  // for __must_check
#include "linux/compiler_types.h"       // for inline
#include "linux/sysfs.h"                // for __ATTR, __ATTR_RO, __ATTR_RW
#include "linux/types.h"                // for list_head, umode_t
#include "linux/uidgid.h"               // for kgid_t, kuid_t
struct class_find_device_by_of_node::device_node;
struct device_type;
struct kobj_uevent_env;
struct lock_class_key;
struct module;

include/linux/device/class.h should remove these lines:
- #include <linux/kobject.h>  // lines 17-17
- #include <linux/pm.h>  // lines 19-19

The full include-list for include/linux/device/class.h:
#include <linux/device/bus.h>           // for device_match_devt, device_mat...
#include <linux/klist.h>                // for klist_iter
#include <sys/types.h>                  // for dev_t
#include <cstdio>                       // for NULL, ssize_t, size_t
#include "linux/compiler_attributes.h"  // for __must_check
#include "linux/compiler_types.h"       // for inline
#include "linux/sysfs.h"                // for __ATTR, __ATTR_RO, __ATTR_RW
#include "linux/types.h"                // for list_head, umode_t
#include "linux/uidgid.h"               // for kgid_t, kuid_t
struct class_compat;  // lines 99-99
struct class_find_device_by_of_node::device_node;
struct device;  // lines 22-22
struct device_type;
struct fwnode_handle;  // lines 23-23
struct kobj_uevent_env;
struct lock_class_key;
struct module;
---

drivers/base/class.c should add these lines:
#include <asm/bug.h>                 // for WARN
#include "asm-generic/errno-base.h"  // for EINVAL, ENOMEM, EIO, ENODEV
#include "linux/container_of.h"      // for container_of
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/klist.h"             // for klist_init, klist_iter_exit, kli...
#include "linux/kobject.h"           // for kset, kobject_create_and_add
#include "linux/list.h"              // for INIT_LIST_HEAD, list_add_tail
#include "linux/printk.h"            // for pr_debug
struct lock_class_key;
struct module;

drivers/base/class.c should remove these lines:
- #include <linux/blkdev.h>  // lines 19-19
- #include <linux/kdev_t.h>  // lines 16-16
- #include <linux/module.h>  // lines 13-13
- #include <linux/string.h>  // lines 15-15

The full include-list for drivers/base/class.c:
#include <linux/device/class.h>
#include <asm/bug.h>                 // for WARN
#include <linux/device.h>            // for dev_name, device, get_device
#include <linux/err.h>               // for ERR_PTR, IS_ERR
#include <linux/init.h>              // for __init
#include <linux/mutex.h>             // for mutex_lock, mutex_unlock, __mute...
#include <linux/slab.h>              // for kfree, kzalloc, kmalloc
#include "asm-generic/errno-base.h"  // for EINVAL, ENOMEM, EIO, ENODEV
#include "base.h"                    // for subsys_private, to_subsys_private
#include "linux/container_of.h"      // for container_of
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/klist.h"             // for klist_init, klist_iter_exit, kli...
#include "linux/kobject.h"           // for kset, kobject_create_and_add
#include "linux/list.h"              // for INIT_LIST_HEAD, list_add_tail
#include "linux/printk.h"            // for pr_debug
struct lock_class_key;
struct module;
---
  ./scripts/check-local-export drivers/base/class.o
  iwyu2 -Wp,-MMD,drivers/base/.platform.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/platform"' -DKBUILD_BASENAME='"platform"' -DKBUILD_MODNAME='"platform"' -D__KBUILD_MODNAME=kmod_platform -c -o drivers/base/platform.o drivers/base/platform.c  
In file included from drivers/base/platform.c:13:
In file included from ./include/linux/platform_device.h:13:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/platform.c:13:
In file included from ./include/linux/platform_device.h:13:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/platform.c:13:
In file included from ./include/linux/platform_device.h:13:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/base/platform.c:27:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
In file included from drivers/base/platform.c:33:
./include/linux/iommu.h:52:49: warning: declaration of 'struct iommu_fault' will not be visible outside of this function [-Wvisibility]
typedef int (*iommu_dev_fault_handler_t)(struct iommu_fault *, void *);
                                                ^
./include/linux/iommu.h:387:18: warning: declaration of 'struct iommu_page_response' will not be visible outside of this function [-Wvisibility]
                                      struct iommu_page_response *msg)
                                             ^
9 warnings generated.
In file included from drivers/base/platform.c:13:
In file included from ./include/linux/platform_device.h:13:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/platform.c:13:
In file included from ./include/linux/platform_device.h:13:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/platform.c:13:
In file included from ./include/linux/platform_device.h:13:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/base/platform.c:27:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
In file included from drivers/base/platform.c:33:
./include/linux/iommu.h:52:49: warning: declaration of 'struct iommu_fault' will not be visible outside of this function [-Wvisibility]
typedef int (*iommu_dev_fault_handler_t)(struct iommu_fault *, void *);
                                                ^
./include/linux/iommu.h:387:18: warning: declaration of 'struct iommu_page_response' will not be visible outside of this function [-Wvisibility]
                                      struct iommu_page_response *msg)
                                             ^

drivers/base/platform.c should add these lines:
#include <asm/bug.h>                    // for WARN
#include <cstdio>                       // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"     // for ENOMEM, ENODEV, ENXIO, EINVAL
#include "asm-generic/int-ll64.h"       // for u32
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/string_32.h"              // for strcmp, strcpy, strlen
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/compiler_types.h"       // for __iomem, inline
#include "linux/container_of.h"         // for container_of
#include "linux/dev_printk.h"           // for dev_err, dev_warn
#include "linux/device.h"               // for device, dev_name, dev_set_name
#include "linux/device/bus.h"           // for bus_find_device, bus_register
#include "linux/device/driver.h"        // for device_driver, driver_register
#include "linux/errno.h"                // for EPROBE_DEFER
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/irq.h"                  // for irq_get_irq_data, irqd_set_tr...
#include "linux/irqdomain.h"            // for irq_dispose_mapping
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/klist.h"                // for klist
#include "linux/kobject.h"              // for add_uevent_var, kobj_uevent_e...
#include "linux/list.h"                 // for list_empty
#include "linux/mod_devicetable.h"      // for platform_device_id, PLATFORM_...
#include "linux/numa.h"                 // for NUMA_NO_NODE
#include "linux/of.h"                   // for of_node_get, of_node_put, to_...
#include "linux/of_platform.h"          // for of_platform_register_reconfig...
#include "linux/pm.h"                   // for SET_RUNTIME_PM_OPS, dev_pm_ops
#include "linux/printk.h"               // for pr_debug, pr_err
#include "linux/spinlock.h"             // for spin_lock, spin_unlock
#include "linux/stddef.h"               // for true, false
#include "linux/sysfs.h"                // for sysfs_emit, __ATTRIBUTE_GROUPS
struct module;

drivers/base/platform.c should remove these lines:
- #include <linux/kmemleak.h>  // lines 31-31
- #include <linux/limits.h>  // lines 29-29
- #include <linux/memblock.h>  // lines 21-21
- #include <linux/pm_runtime.h>  // lines 24-24
- #include "power/power.h"  // lines 37-37

The full include-list for drivers/base/platform.c:
#include <asm/bug.h>                    // for WARN
#include <linux/acpi.h>                 // for has_acpi_companion, acpi_dev_...
#include <linux/clk/clk-conf.h>         // for of_clk_set_defaults
#include <linux/dma-map-ops.h>          // for arch_teardown_dma_ops
#include <linux/dma-mapping.h>          // for DMA_BIT_MASK
#include <linux/err.h>                  // for ERR_PTR, IS_ERR_OR_NULL
#include <linux/idr.h>                  // for ida_free, ida_alloc, DEFINE_IDA
#include <linux/init.h>                 // for __init
#include <linux/interrupt.h>            // for irq_calc_affinity_vectors
#include <linux/iommu.h>                // for iommu_device_unuse_default_do...
#include <linux/ioport.h>               // for resource, resource_type, rele...
#include <linux/module.h>               // for __init_or_module
#include <linux/of_device.h>            // for of_device_modalias, of_device...
#include <linux/of_irq.h>               // for of_irq_get, of_irq_get_byname
#include <linux/platform_device.h>      // for platform_device, platform_driver
#include <linux/pm_domain.h>            // for dev_pm_domain_detach, dev_pm_...
#include <linux/property.h>             // for device_create_managed_softwar...
#include <linux/slab.h>                 // for kfree, kzalloc
#include <linux/string.h>               // for kmemdup
#include <linux/types.h>                // for umode_t
#include <cstdio>                       // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"     // for ENOMEM, ENODEV, ENXIO, EINVAL
#include "asm-generic/int-ll64.h"       // for u32
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/string_32.h"              // for strcmp, strcpy, strlen
#include "base.h"                       // for subsys_private, driver_private
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/compiler_types.h"       // for __iomem, inline
#include "linux/container_of.h"         // for container_of
#include "linux/dev_printk.h"           // for dev_err, dev_warn
#include "linux/device.h"               // for device, dev_name, dev_set_name
#include "linux/device/bus.h"           // for bus_find_device, bus_register
#include "linux/device/driver.h"        // for device_driver, driver_register
#include "linux/errno.h"                // for EPROBE_DEFER
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/irq.h"                  // for irq_get_irq_data, irqd_set_tr...
#include "linux/irqdomain.h"            // for irq_dispose_mapping
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/klist.h"                // for klist
#include "linux/kobject.h"              // for add_uevent_var, kobj_uevent_e...
#include "linux/list.h"                 // for list_empty
#include "linux/mod_devicetable.h"      // for platform_device_id, PLATFORM_...
#include "linux/numa.h"                 // for NUMA_NO_NODE
#include "linux/of.h"                   // for of_node_get, of_node_put, to_...
#include "linux/of_platform.h"          // for of_platform_register_reconfig...
#include "linux/pm.h"                   // for SET_RUNTIME_PM_OPS, dev_pm_ops
#include "linux/printk.h"               // for pr_debug, pr_err
#include "linux/spinlock.h"             // for spin_lock, spin_unlock
#include "linux/stddef.h"               // for true, false
#include "linux/sysfs.h"                // for sysfs_emit, __ATTRIBUTE_GROUPS
struct module;
---
  ./scripts/check-local-export drivers/base/platform.o
  iwyu2 -Wp,-MMD,drivers/base/.cpu.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/cpu"' -DKBUILD_BASENAME='"cpu"' -DKBUILD_MODNAME='"cpu"' -D__KBUILD_MODNAME=kmod_cpu -c -o drivers/base/cpu.o drivers/base/cpu.c  
In file included from drivers/base/cpu.c:10:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/cpu.c:10:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/cpu.c:10:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/base/cpu.c:17:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
7 warnings generated.
In file included from drivers/base/cpu.c:10:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/cpu.c:10:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/cpu.c:10:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/base/cpu.c:17:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^

drivers/base/cpu.c should add these lines:
#include <asm-generic/percpu.h>         // for per_cpu, DEFINE_PER_CPU
#include <asm/bug.h>                    // for WARN
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <cstdio>                       // for NULL, ssize_t, va_list
#include "asm-generic/errno-base.h"     // for ENOMEM
#include "asm-generic/int-ll64.h"       // for u32
#include "asm-generic/topology.h"       // for cpu_to_node
#include "asm/cpufeature.h"             // for CPU_FEATURE_TYPEFMT, CPU_FEAT...
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/string_32.h"              // for memset
#include "linux/compiler_attributes.h"  // for __weak, __printf
#include "linux/container_of.h"         // for container_of
#include "linux/cpumask.h"              // for alloc_cpumask_var, cpumask_an...
#include "linux/device/bus.h"           // for bus_type
#include "linux/err.h"                  // for ERR_PTR
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/kobject.h"              // for add_uevent_var, kobject_set_n...
#include "linux/panic.h"                // for panic
#include "linux/printk.h"               // for pr_err
#include "linux/stdarg.h"               // for va_end, va_start
#include "linux/stddef.h"               // for true
#include "linux/sysfs.h"                // for sysfs_emit, sysfs_emit_at
#include "linux/threads.h"              // for NR_CPUS
#include "linux/types.h"                // for bool
struct device_driver;

drivers/base/cpu.c should remove these lines:
- #include <linux/cpufeature.h>  // lines 19-19
- #include <linux/kernel.h>  // lines 6-6
- #include <linux/module.h>  // lines 7-7
- #include <linux/percpu.h>  // lines 16-16
- #include <linux/sched.h>  // lines 9-9
- #include <linux/tick.h>  // lines 20-20
- #include <linux/topology.h>  // lines 11-11

The full include-list for drivers/base/cpu.c:
#include <asm-generic/percpu.h>         // for per_cpu, DEFINE_PER_CPU
#include <asm/bug.h>                    // for WARN
#include <asm/cpufeatures.h>            // for REQUIRED_MASK0, REQUIRED_MASK1
#include <linux/acpi.h>                 // for acpi_driver_match_device
#include <linux/cpu.h>                  // for cpu, cpu_device_create, cpu_i...
#include <linux/device.h>               // for device_attribute, device, DEV...
#include <linux/gfp.h>                  // for GFP_KERNEL
#include <linux/init.h>                 // for __init
#include <linux/node.h>                 // for register_cpu_under_node
#include <linux/of.h>                   // for of_get_cpu_node
#include <linux/pm_qos.h>               // for dev_pm_qos_expose_latency_limit
#include <linux/sched/isolation.h>      // for housekeeping_cpumask, HK_TYPE...
#include <linux/slab.h>                 // for kfree, kzalloc
#include <cstdio>                       // for NULL, ssize_t, va_list
#include "asm-generic/errno-base.h"     // for ENOMEM
#include "asm-generic/int-ll64.h"       // for u32
#include "asm-generic/topology.h"       // for cpu_to_node
#include "asm/cpufeature.h"             // for CPU_FEATURE_TYPEFMT, CPU_FEAT...
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/string_32.h"              // for memset
#include "base.h"                       // for cpu_dev_init
#include "linux/compiler_attributes.h"  // for __weak, __printf
#include "linux/container_of.h"         // for container_of
#include "linux/cpumask.h"              // for alloc_cpumask_var, cpumask_an...
#include "linux/device/bus.h"           // for bus_type
#include "linux/err.h"                  // for ERR_PTR
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL
#include "linux/kobject.h"              // for add_uevent_var, kobject_set_n...
#include "linux/panic.h"                // for panic
#include "linux/printk.h"               // for pr_err
#include "linux/stdarg.h"               // for va_end, va_start
#include "linux/stddef.h"               // for true
#include "linux/sysfs.h"                // for sysfs_emit, sysfs_emit_at
#include "linux/threads.h"              // for NR_CPUS
#include "linux/types.h"                // for bool
struct device_driver;
---
  ./scripts/check-local-export drivers/base/cpu.o
  iwyu2 -Wp,-MMD,drivers/base/.firmware.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/firmware"' -DKBUILD_BASENAME='"firmware"' -DKBUILD_MODNAME='"firmware"' -D__KBUILD_MODNAME=kmod_firmware -c -o drivers/base/firmware.o drivers/base/firmware.c  
In file included from drivers/base/firmware.c:13:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/firmware.c:13:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/firmware.c:13:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/base/firmware.c:13:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/firmware.c:13:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/firmware.c:13:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/base/firmware.c should add these lines:
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for ENOMEM
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL

drivers/base/firmware.c should remove these lines:
- #include <linux/device.h>  // lines 13-13
- #include <linux/module.h>  // lines 11-11

The full include-list for drivers/base/firmware.c:
#include <linux/init.h>              // for __init
#include <linux/kobject.h>           // for kobject_create_and_add
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for ENOMEM
#include "base.h"                    // for firmware_init
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
---
  ./scripts/check-local-export drivers/base/firmware.o
  iwyu2 -Wp,-MMD,drivers/base/.init.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/init"' -DKBUILD_BASENAME='"init"' -DKBUILD_MODNAME='"init"' -D__KBUILD_MODNAME=kmod_init -c -o drivers/base/init.o drivers/base/init.c  
In file included from drivers/base/init.c:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/init.c:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/init.c:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/base/init.c:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/init.c:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/init.c:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/base/init.c should add these lines:
#include "linux/device/driver.h"  // for driver_init
#include "linux/node.h"           // for node_dev_init

drivers/base/init.c should remove these lines:
- #include <linux/device.h>  // lines 7-7

The full include-list for drivers/base/init.c:
#include <linux/backing-dev.h>    // for bdi_init, noop_backing_dev_info
#include <linux/init.h>           // for __init
#include <linux/memory.h>         // for memory_dev_init
#include <linux/of.h>             // for of_core_init
#include "base.h"                 // for auxiliary_bus_init, buses_init, cla...
#include "linux/device/driver.h"  // for driver_init
#include "linux/node.h"           // for node_dev_init
---
  ./scripts/check-local-export drivers/base/init.o
  iwyu2 -Wp,-MMD,drivers/base/.map.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/map"' -DKBUILD_BASENAME='"map"' -DKBUILD_MODNAME='"map"' -D__KBUILD_MODNAME=kmod_map -c -o drivers/base/map.o drivers/base/map.c  

drivers/base/map.c should add these lines:
#include <stddef.h>                  // for NULL
#include <sys/types.h>               // for dev_t
#include "asm-generic/errno-base.h"  // for ENOMEM
#include "linux/gfp.h"               // for GFP_KERNEL
struct module;

drivers/base/map.c should remove these lines:
- #include <linux/kobject.h>  // lines 16-16

The full include-list for drivers/base/map.c:
#include <linux/kdev_t.h>            // for MAJOR
#include <linux/kobj_map.h>          // for kobj_probe_t, kobj_lookup, kobj_map
#include <linux/module.h>            // for module_put, try_module_get
#include <linux/mutex.h>             // for mutex_unlock, mutex_lock
#include <linux/slab.h>              // for kfree, kmalloc, kmalloc_array
#include <stddef.h>                  // for NULL
#include <sys/types.h>               // for dev_t
#include "asm-generic/errno-base.h"  // for ENOMEM
#include "linux/gfp.h"               // for GFP_KERNEL
struct module;
---
  ./scripts/check-local-export drivers/base/map.o
  iwyu2 -Wp,-MMD,drivers/base/.devres.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/devres"' -DKBUILD_BASENAME='"devres"' -DKBUILD_MODNAME='"devres"' -D__KBUILD_MODNAME=kmod_devres -c -o drivers/base/devres.o drivers/base/devres.c  
In file included from drivers/base/devres.c:9:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/devres.c:9:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/devres.c:9:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/base/devres.c:9:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/devres.c:9:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/devres.c:9:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/base/devres.c should add these lines:
#include <asm/bug.h>                    // for WARN_ON, BUG_ON, WARN
#include <cstdio>                       // for NULL, size_t, va_list
#include "asm-generic/errno-base.h"     // for ENOENT, ENODEV, ENOMEM
#include "asm-generic/int-ll64.h"       // for u8
#include "asm-generic/sections.h"       // for is_kernel_rodata
#include "asm/string_32.h"              // for memcpy, strlen, memset
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __aligned, __always_inline
#include "linux/compiler_types.h"       // for __percpu, __force
#include "linux/container_of.h"         // for container_of
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include "linux/gfp.h"                  // for free_pages, GFP_KERNEL, __get...
#include "linux/kernel.h"               // for vsnprintf
#include "linux/list.h"                 // for list_empty, list_del_init
#include "linux/overflow.h"             // for check_add_overflow
#include "linux/spinlock.h"             // for spin_unlock_irqrestore, spin_...
#include "linux/stdarg.h"               // for va_end, va_copy, va_start
#include "linux/stddef.h"               // for offsetof, false, true
#include "linux/types.h"                // for list_head, gfp_t, bool

drivers/base/devres.c should remove these lines:
- #include <asm/sections.h>  // lines 14-14
- #include <linux/module.h>  // lines 10-10

The full include-list for drivers/base/devres.c:
#include <asm/bug.h>                    // for WARN_ON, BUG_ON, WARN
#include <linux/device.h>               // for device, dr_release_t, dr_match_t
#include <linux/percpu.h>               // for free_percpu, __alloc_percpu
#include <linux/slab.h>                 // for kfree, kmalloc, ksize, ZERO_O...
#include <cstdio>                       // for NULL, size_t, va_list
#include "asm-generic/errno-base.h"     // for ENOENT, ENODEV, ENOMEM
#include "asm-generic/int-ll64.h"       // for u8
#include "asm-generic/sections.h"       // for is_kernel_rodata
#include "asm/string_32.h"              // for memcpy, strlen, memset
#include "base.h"                       // for devres_release_all
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __aligned, __always_inline
#include "linux/compiler_types.h"       // for __percpu, __force
#include "linux/container_of.h"         // for container_of
#include "linux/export.h"               // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include "linux/gfp.h"                  // for free_pages, GFP_KERNEL, __get...
#include "linux/kernel.h"               // for vsnprintf
#include "linux/list.h"                 // for list_empty, list_del_init
#include "linux/overflow.h"             // for check_add_overflow
#include "linux/spinlock.h"             // for spin_unlock_irqrestore, spin_...
#include "linux/stdarg.h"               // for va_end, va_copy, va_start
#include "linux/stddef.h"               // for offsetof, false, true
#include "linux/types.h"                // for list_head, gfp_t, bool
#include "trace.h"                      // for trace_devres_log
---
  ./scripts/check-local-export drivers/base/devres.o
  iwyu2 -Wp,-MMD,drivers/base/.attribute_container.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/attribute_container"' -DKBUILD_BASENAME='"attribute_container"' -DKBUILD_MODNAME='"attribute_container"' -D__KBUILD_MODNAME=kmod_attribute_container -c -o drivers/base/attribute_container.o drivers/base/attribute_container.c  
In file included from drivers/base/attribute_container.c:14:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/attribute_container.c:14:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/attribute_container.c:14:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/base/attribute_container.c:14:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/attribute_container.c:14:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/attribute_container.c:14:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

include/linux/attribute_container.h should add these lines:
#include "linux/compiler_attributes.h"  // for __must_check
#include "linux/compiler_types.h"       // for inline
#include "linux/types.h"                // for list_head

include/linux/attribute_container.h should remove these lines:
- #include <linux/list.h>  // lines 11-11

The full include-list for include/linux/attribute_container.h:
#include <linux/klist.h>                // for klist
#include "linux/compiler_attributes.h"  // for __must_check
#include "linux/compiler_types.h"       // for inline
#include "linux/types.h"                // for list_head
struct device;  // lines 14-14
---

drivers/base/attribute_container.c should add these lines:
#include <asm/bug.h>                 // for BUG_ON, WARN_ON
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EBUSY
#include "linux/container_of.h"      // for container_of
#include "linux/dev_printk.h"        // for dev_err
#include "linux/device/class.h"      // for class
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/klist.h"             // for klist_iter_exit, klist_iter_init
#include "linux/spinlock.h"          // for spin_lock, spin_unlock
#include "linux/sysfs.h"             // for sysfs_create_group, sysfs_remove...

drivers/base/attribute_container.c should remove these lines:
- #include <linux/kernel.h>  // lines 15-15
- #include <linux/module.h>  // lines 18-18
- #include "base.h"  // lines 21-21

The full include-list for drivers/base/attribute_container.c:
#include <linux/attribute_container.h>
#include <asm/bug.h>                 // for BUG_ON, WARN_ON
#include <linux/device.h>            // for device, get_device, put_device
#include <linux/list.h>              // for list_for_each_entry, INIT_LIST_HEAD
#include <linux/mutex.h>             // for mutex_lock, mutex_unlock, mutex
#include <linux/slab.h>              // for kfree, kzalloc
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EBUSY
#include "linux/container_of.h"      // for container_of
#include "linux/dev_printk.h"        // for dev_err
#include "linux/device/class.h"      // for class
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/klist.h"             // for klist_iter_exit, klist_iter_init
#include "linux/spinlock.h"          // for spin_lock, spin_unlock
#include "linux/sysfs.h"             // for sysfs_create_group, sysfs_remove...
---
  ./scripts/check-local-export drivers/base/attribute_container.o
  iwyu2 -Wp,-MMD,drivers/base/.transport_class.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/transport_class"' -DKBUILD_BASENAME='"transport_class"' -DKBUILD_MODNAME='"transport_class"' -D__KBUILD_MODNAME=kmod_transport_class -c -o drivers/base/transport_class.o drivers/base/transport_class.c  
In file included from drivers/base/transport_class.c:31:
In file included from ./include/linux/transport_class.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/transport_class.c:31:
In file included from ./include/linux/transport_class.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/transport_class.c:31:
In file included from ./include/linux/transport_class.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/base/transport_class.c:31:
In file included from ./include/linux/transport_class.h:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/transport_class.c:31:
In file included from ./include/linux/transport_class.h:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/transport_class.c:31:
In file included from ./include/linux/transport_class.h:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/base/transport_class.c should add these lines:
#include "asm/bug.h"                    // for BUG
#include "linux/compiler.h"             // for unlikely
#include "linux/device.h"               // for put_device, device
#include "linux/device/class.h"         // for class_unregister, class_register
#include "linux/sysfs.h"                // for sysfs_create_group, sysfs_rem...

drivers/base/transport_class.c should remove these lines:

The full include-list for drivers/base/transport_class.c:
#include <linux/attribute_container.h>  // for attribute_container, attribut...
#include <linux/export.h>               // for EXPORT_SYMBOL_GPL
#include <linux/transport_class.h>      // for transport_class, transport_co...
#include "asm/bug.h"                    // for BUG
#include "linux/compiler.h"             // for unlikely
#include "linux/device.h"               // for put_device, device
#include "linux/device/class.h"         // for class_unregister, class_register
#include "linux/sysfs.h"                // for sysfs_create_group, sysfs_rem...
---
  ./scripts/check-local-export drivers/base/transport_class.o
  iwyu2 -Wp,-MMD,drivers/base/.topology.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/topology"' -DKBUILD_BASENAME='"topology"' -DKBUILD_MODNAME='"topology"' -D__KBUILD_MODNAME=kmod_topology -c -o drivers/base/topology.o drivers/base/topology.c  
In file included from drivers/base/topology.c:12:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/topology.c:12:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/topology.c:12:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/base/topology.c:12:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/topology.c:12:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/topology.c:12:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/base/topology.c should add these lines:
#include <cstdio>              // for ssize_t, size_t, NULL
#include "asm/processor.h"     // for cpuinfo_x86
#include "asm/topology.h"      // for topology_ppin, topology_core_id, topol...
#include "linux/cpuhotplug.h"  // for cpuhp_setup_state, CPUHP_TOPOLOGY_PREPARE
#include "linux/cpumask.h"     // for cpumap_print_bitmask_to_buf, cpumap_pr...
#include "linux/device.h"      // for kobj_to_dev, device, device_attribute
#include "linux/init.h"        // for __init, device_initcall
#include "linux/sysfs.h"       // for sysfs_emit, BIN_ATTR_RO, bin_attribute
#include "linux/types.h"       // for loff_t, umode_t
struct file;
struct kobject;

drivers/base/topology.c should remove these lines:
- #include <linux/hardirq.h>  // lines 14-14
- #include <linux/mm.h>  // lines 11-11
- #include <linux/module.h>  // lines 13-13

The full include-list for drivers/base/topology.c:
#include <linux/cpu.h>         // for get_cpu_device
#include <linux/topology.h>    // for topology_core_cpumask, topology_siblin...
#include <cstdio>              // for ssize_t, size_t, NULL
#include "asm/processor.h"     // for cpuinfo_x86
#include "asm/topology.h"      // for topology_ppin, topology_core_id, topol...
#include "linux/cpuhotplug.h"  // for cpuhp_setup_state, CPUHP_TOPOLOGY_PREPARE
#include "linux/cpumask.h"     // for cpumap_print_bitmask_to_buf, cpumap_pr...
#include "linux/device.h"      // for kobj_to_dev, device, device_attribute
#include "linux/init.h"        // for __init, device_initcall
#include "linux/sysfs.h"       // for sysfs_emit, BIN_ATTR_RO, bin_attribute
#include "linux/types.h"       // for loff_t, umode_t
struct file;
struct kobject;
---
  ./scripts/check-local-export drivers/base/topology.o
  iwyu2 -Wp,-MMD,drivers/base/.container.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/container"' -DKBUILD_BASENAME='"container"' -DKBUILD_MODNAME='"container"' -D__KBUILD_MODNAME=kmod_container -c -o drivers/base/container.o drivers/base/container.c  
In file included from drivers/base/container.c:9:
In file included from ./include/linux/container.h:12:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/container.c:9:
In file included from ./include/linux/container.h:12:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/container.c:9:
In file included from ./include/linux/container.h:12:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/base/container.c:9:
In file included from ./include/linux/container.h:12:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/container.c:9:
In file included from ./include/linux/container.h:12:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/container.c:9:
In file included from ./include/linux/container.h:12:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

include/linux/container.h should add these lines:
#include "linux/compiler_types.h"  // for inline
#include "linux/container_of.h"    // for container_of
#include "linux/device/bus.h"      // for bus_type

include/linux/container.h should remove these lines:

The full include-list for include/linux/container.h:
#include <linux/device.h>          // for device
#include "linux/compiler_types.h"  // for inline
#include "linux/container_of.h"    // for container_of
#include "linux/device/bus.h"      // for bus_type
---

drivers/base/container.c should add these lines:
#include <stddef.h>        // for NULL
#include "linux/device.h"  // for subsys_system_register, device (ptr only)
#include "linux/init.h"    // for __init
#include "linux/printk.h"  // for pr_err

drivers/base/container.c should remove these lines:

The full include-list for drivers/base/container.c:
#include <linux/container.h>
#include <stddef.h>        // for NULL
#include "base.h"          // for container_dev_init
#include "linux/device.h"  // for subsys_system_register, device (ptr only)
#include "linux/init.h"    // for __init
#include "linux/printk.h"  // for pr_err
---
  ./scripts/check-local-export drivers/base/container.o
  iwyu2 -Wp,-MMD,drivers/base/.property.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/property"' -DKBUILD_BASENAME='"property"' -DKBUILD_MODNAME='"property"' -D__KBUILD_MODNAME=kmod_property -c -o drivers/base/property.o drivers/base/property.c  
In file included from drivers/base/property.c:10:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
In file included from drivers/base/property.c:18:
In file included from ./include/linux/phy.h:16:
In file included from ./include/linux/ethtool.h:18:
In file included from ./include/linux/netlink.h:7:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
5 warnings generated.
In file included from drivers/base/property.c:10:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
In file included from drivers/base/property.c:18:
In file included from ./include/linux/phy.h:16:
In file included from ./include/linux/ethtool.h:18:
In file included from ./include/linux/netlink.h:7:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^

drivers/base/property.c should add these lines:
#include <stddef.h>                  // for NULL, size_t
#include "asm-generic/errno-base.h"  // for EINVAL, ENODEV, ENOENT, ENOMEM
#include "asm-generic/errno.h"       // for ENODATA
#include "asm-generic/int-ll64.h"    // for u32, u16, u64, u8
#include "asm/string_32.h"           // for memset
#include "linux/compiler_types.h"    // for __iomem
#include "linux/device.h"            // for device
#include "linux/err.h"               // for IS_ERR_OR_NULL, ERR_PTR, IS_ERR
#include "linux/fwnode.h"            // for fwnode_operations, fwnode_handle
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/kconfig.h"           // for IS_ENABLED
#include "linux/slab.h"              // for kcalloc, kfree
#include "linux/stddef.h"            // for false, true
#include "linux/string.h"            // for match_string, strcasecmp
#include "linux/types.h"             // for bool

drivers/base/property.c should remove these lines:
- #include <linux/acpi.h>  // lines 10-10
- #include <linux/kernel.h>  // lines 12-12
- #include <linux/of_address.h>  // lines 14-14
- #include <linux/of_irq.h>  // lines 16-16

The full include-list for drivers/base/property.c:
#include <linux/export.h>            // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include <linux/of.h>                // for of_fwnode_handle
#include <linux/phy.h>               // for phy_modes, PHY_INTERFACE_MODE_MAX
#include <linux/property.h>          // for devcon_match_fn_t, fwnode_for_ea...
#include <stddef.h>                  // for NULL, size_t
#include "asm-generic/errno-base.h"  // for EINVAL, ENODEV, ENOENT, ENOMEM
#include "asm-generic/errno.h"       // for ENODATA
#include "asm-generic/int-ll64.h"    // for u32, u16, u64, u8
#include "asm/string_32.h"           // for memset
#include "linux/compiler_types.h"    // for __iomem
#include "linux/device.h"            // for device
#include "linux/err.h"               // for IS_ERR_OR_NULL, ERR_PTR, IS_ERR
#include "linux/fwnode.h"            // for fwnode_operations, fwnode_handle
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/kconfig.h"           // for IS_ENABLED
#include "linux/slab.h"              // for kcalloc, kfree
#include "linux/stddef.h"            // for false, true
#include "linux/string.h"            // for match_string, strcasecmp
#include "linux/types.h"             // for bool
---
  ./scripts/check-local-export drivers/base/property.o
  iwyu2 -Wp,-MMD,drivers/base/.cacheinfo.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/cacheinfo"' -DKBUILD_BASENAME='"cacheinfo"' -DKBUILD_MODNAME='"cacheinfo"' -D__KBUILD_MODNAME=kmod_cacheinfo -c -o drivers/base/cacheinfo.o drivers/base/cacheinfo.c  
In file included from drivers/base/cacheinfo.c:10:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
4 warnings generated.
In file included from drivers/base/cacheinfo.c:10:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^

drivers/base/cacheinfo.c should add these lines:
#include <asm-generic/percpu.h>         // for per_cpu, DEFINE_PER_CPU
#include <cstdio>                       // for NULL, ssize_t
#include "asm-generic/errno-base.h"     // for ENOENT, ENOMEM, EINVAL
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/compiler_types.h"       // for inline
#include "linux/cpuhotplug.h"           // for cpuhp_setup_state, CPUHP_AP_B...
#include "linux/cpumask.h"              // for cpumask_set_cpu, cpumask_empty
#include "linux/err.h"                  // for IS_ERR, PTR_ERR
#include "linux/errno.h"                // for ENOTSUPP
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/printk.h"               // for pr_warn
#include "linux/types.h"                // for umode_t, bool
struct kobject;

drivers/base/cacheinfo.c should remove these lines:
- #include <linux/bitops.h>  // lines 11-11
- #include <linux/sched.h>  // lines 18-18
- #include <linux/smp.h>  // lines 20-20

The full include-list for drivers/base/cacheinfo.c:
#include <asm-generic/percpu.h>         // for per_cpu, DEFINE_PER_CPU
#include <linux/acpi.h>                 // for acpi_disabled
#include <linux/cacheinfo.h>            // for cacheinfo, cpu_cacheinfo, CAC...
#include <linux/compiler.h>             // for unlikely
#include <linux/cpu.h>                  // for cpu_device_create, get_cpu_de...
#include <linux/device.h>               // for dev_get_drvdata, device_attri...
#include <linux/init.h>                 // for __init, device_initcall
#include <linux/of.h>                   // for of_have_populated_dt, of_node...
#include <linux/slab.h>                 // for kcalloc, kfree
#include <linux/sysfs.h>                // for sysfs_emit, attribute, attrib...
#include <cstdio>                       // for NULL, ssize_t
#include "asm-generic/errno-base.h"     // for ENOENT, ENOMEM, EINVAL
#include "linux/compiler_attributes.h"  // for __weak
#include "linux/compiler_types.h"       // for inline
#include "linux/cpuhotplug.h"           // for cpuhp_setup_state, CPUHP_AP_B...
#include "linux/cpumask.h"              // for cpumask_set_cpu, cpumask_empty
#include "linux/err.h"                  // for IS_ERR, PTR_ERR
#include "linux/errno.h"                // for ENOTSUPP
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/printk.h"               // for pr_warn
#include "linux/types.h"                // for umode_t, bool
struct kobject;
---
  ./scripts/check-local-export drivers/base/cacheinfo.o
  iwyu2 -Wp,-MMD,drivers/base/.swnode.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/base/swnode"' -DKBUILD_BASENAME='"swnode"' -DKBUILD_MODNAME='"swnode"' -D__KBUILD_MODNAME=kmod_swnode -c -o drivers/base/swnode.o drivers/base/swnode.c  
In file included from drivers/base/swnode.c:9:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/swnode.c:9:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/swnode.c:9:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/base/swnode.c:9:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/base/swnode.c:9:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/base/swnode.c:9:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/base/swnode.c should add these lines:
#include <stddef.h>                  // for NULL, size_t
#include "asm-generic/errno-base.h"  // for EINVAL, ENOMEM, ENOENT, EBUSY
#include "asm-generic/errno.h"       // for ENODATA, EOVERFLOW
#include "asm-generic/int-ll64.h"    // for u64, u32
#include "asm/string_32.h"           // for strlen, strcmp, strncmp, memcpy
#include "linux/compiler_types.h"    // for inline
#include "linux/container_of.h"      // for container_of
#include "linux/err.h"               // for ERR_PTR, IS_ERR, ERR_CAST, PTR_ERR
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/fwnode.h"            // for fwnode_endpoint, fwnode_handle
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/idr.h"               // for ida_destroy, ida_init, ida_simpl...
#include "linux/init.h"              // for __exit, __exitcall, __init, post...
#include "linux/kobject.h"           // for kobject_put, kobject_get, kobject
#include "linux/kstrtox.h"           // for kstrtou32
#include "linux/list.h"              // for INIT_LIST_HEAD, list_empty, list...
#include "linux/log2.h"              // for is_power_of_2
#include "linux/minmax.h"            // for min_t
#include "linux/spinlock.h"          // for spin_lock, spin_unlock
#include "linux/stddef.h"            // for true, false
#include "linux/string.h"            // for kstrdup
#include "linux/sysfs.h"             // for sysfs_remove_link, sysfs_create_...
#include "linux/types.h"             // for list_head, bool

drivers/base/swnode.c should remove these lines:
- #include <linux/kernel.h>  // lines 10-10

The full include-list for drivers/base/swnode.c:
#include <linux/device.h>            // for set_secondary_fwnode, device_is_...
#include <linux/property.h>          // for property_entry, software_node
#include <linux/slab.h>              // for kfree, kzalloc, kcalloc, kmalloc
#include <stddef.h>                  // for NULL, size_t
#include "asm-generic/errno-base.h"  // for EINVAL, ENOMEM, ENOENT, EBUSY
#include "asm-generic/errno.h"       // for ENODATA, EOVERFLOW
#include "asm-generic/int-ll64.h"    // for u64, u32
#include "asm/string_32.h"           // for strlen, strcmp, strncmp, memcpy
#include "base.h"                    // for software_node_notify, software_n...
#include "linux/compiler_types.h"    // for inline
#include "linux/container_of.h"      // for container_of
#include "linux/err.h"               // for ERR_PTR, IS_ERR, ERR_CAST, PTR_ERR
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/fwnode.h"            // for fwnode_endpoint, fwnode_handle
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/idr.h"               // for ida_destroy, ida_init, ida_simpl...
#include "linux/init.h"              // for __exit, __exitcall, __init, post...
#include "linux/kobject.h"           // for kobject_put, kobject_get, kobject
#include "linux/kstrtox.h"           // for kstrtou32
#include "linux/list.h"              // for INIT_LIST_HEAD, list_empty, list...
#include "linux/log2.h"              // for is_power_of_2
#include "linux/minmax.h"            // for min_t
#include "linux/spinlock.h"          // for spin_lock, spin_unlock
#include "linux/stddef.h"            // for true, false
#include "linux/string.h"            // for kstrdup
#include "linux/sysfs.h"             // for sysfs_remove_link, sysfs_create_...
#include "linux/types.h"             // for list_head, bool
---
  ./scripts/check-local-export drivers/base/swnode.o
  rm -f drivers/base/built-in.a; echo component.o core.o bus.o dd.o syscore.o driver.o class.o platform.o cpu.o firmware.o init.o map.o devres.o attribute_container.o transport_class.o topology.o container.o property.o cacheinfo.o swnode.o power/built-in.a | sed -E 's:([^ ]+):drivers/base/:g' | xargs llvm-ar cDPrST drivers/base/built-in.a
make -f ./scripts/Makefile.build obj=drivers/input/serio \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,drivers/input/serio/.serio.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/input/serio/serio"' -DKBUILD_BASENAME='"serio"' -DKBUILD_MODNAME='"serio"' -D__KBUILD_MODNAME=kmod_serio -c -o drivers/input/serio/serio.o drivers/input/serio/serio.c  
In file included from drivers/input/serio/serio.c:17:
In file included from ./include/linux/serio.h:14:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/serio/serio.c:17:
In file included from ./include/linux/serio.h:14:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/serio/serio.c:17:
In file included from ./include/linux/serio.h:14:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/input/serio/serio.c:17:
In file included from ./include/linux/serio.h:14:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/serio/serio.c:17:
In file included from ./include/linux/serio.h:14:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/serio/serio.c:17:
In file included from ./include/linux/serio.h:14:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/input/serio/serio.c should add these lines:
#include <cstdio>                              // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"            // for EINVAL, ENODEV, ENOMEM
#include "asm/string_32.h"                     // for strncmp
#include "linux/atomic/atomic-instrumented.h"  // for atomic_inc_return
#include "linux/compiler.h"                    // for likely
#include "linux/dev_printk.h"                  // for dev_warn, dev_err
#include "linux/device.h"                      // for device_attribute, device
#include "linux/device/bus.h"                  // for bus_register, bus_unre...
#include "linux/device/driver.h"               // for driver_unregister, dev...
#include "linux/export.h"                      // for EXPORT_SYMBOL, THIS_MO...
#include "linux/gfp.h"                         // for GFP_ATOMIC
#include "linux/init.h"                        // for __exit, __init, subsys...
#include "linux/irqreturn.h"                   // for irqreturn_t, IRQ_HANDLED
#include "linux/kernel.h"                      // for sprintf
#include "linux/kobject.h"                     // for add_uevent_var, kobj_u...
#include "linux/list.h"                        // for list_del_init, list_empty
#include "linux/lockdep.h"                     // for lockdep_set_subclass
#include "linux/mod_devicetable.h"             // for serio_device_id, SERIO...
#include "linux/printk.h"                      // for pr_err, pr_warn
#include "linux/spinlock.h"                    // for spin_unlock_irqrestore
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK
#include "linux/stat.h"                        // for S_IRUGO, S_IWUSR
#include "linux/sysfs.h"                       // for attribute_group, ATTRI...
#include "linux/types.h"                       // for list_head, ATOMIC_INIT
struct module;

drivers/input/serio/serio.c should remove these lines:
- #include <linux/sched.h>  // lines 19-19

The full include-list for drivers/input/serio/serio.c:
#include <linux/errno.h>                       // for EPROBE_DEFER
#include <linux/module.h>                      // for module_put, __module_get
#include <linux/mutex.h>                       // for mutex_unlock, mutex_lock
#include <linux/serio.h>                       // for serio, serio_driver
#include <linux/slab.h>                        // for kfree, kmalloc
#include <linux/stddef.h>                      // for true, false
#include <linux/workqueue.h>                   // for work_struct, cancel_wo...
#include <cstdio>                              // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"            // for EINVAL, ENODEV, ENOMEM
#include "asm/string_32.h"                     // for strncmp
#include "linux/atomic/atomic-instrumented.h"  // for atomic_inc_return
#include "linux/compiler.h"                    // for likely
#include "linux/dev_printk.h"                  // for dev_warn, dev_err
#include "linux/device.h"                      // for device_attribute, device
#include "linux/device/bus.h"                  // for bus_register, bus_unre...
#include "linux/device/driver.h"               // for driver_unregister, dev...
#include "linux/export.h"                      // for EXPORT_SYMBOL, THIS_MO...
#include "linux/gfp.h"                         // for GFP_ATOMIC
#include "linux/init.h"                        // for __exit, __init, subsys...
#include "linux/irqreturn.h"                   // for irqreturn_t, IRQ_HANDLED
#include "linux/kernel.h"                      // for sprintf
#include "linux/kobject.h"                     // for add_uevent_var, kobj_u...
#include "linux/list.h"                        // for list_del_init, list_empty
#include "linux/lockdep.h"                     // for lockdep_set_subclass
#include "linux/mod_devicetable.h"             // for serio_device_id, SERIO...
#include "linux/printk.h"                      // for pr_err, pr_warn
#include "linux/spinlock.h"                    // for spin_unlock_irqrestore
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK
#include "linux/stat.h"                        // for S_IRUGO, S_IWUSR
#include "linux/sysfs.h"                       // for attribute_group, ATTRI...
#include "linux/types.h"                       // for list_head, ATOMIC_INIT
struct module;
---
  ./scripts/check-local-export drivers/input/serio/serio.o
  iwyu2 -Wp,-MMD,drivers/input/serio/.i8042.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/input/serio/i8042"' -DKBUILD_BASENAME='"i8042"' -DKBUILD_MODNAME='"i8042"' -D__KBUILD_MODNAME=kmod_i8042 -c -o drivers/input/serio/i8042.o drivers/input/serio/i8042.c  
In file included from drivers/input/serio/i8042.c:17:
In file included from ./include/linux/serio.h:14:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/serio/i8042.c:17:
In file included from ./include/linux/serio.h:14:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/serio/i8042.c:17:
In file included from ./include/linux/serio.h:14:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/input/serio/i8042.c:23:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
4 warnings generated.
In file included from drivers/input/serio/i8042.c:17:
In file included from ./include/linux/serio.h:14:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/serio/i8042.c:17:
In file included from ./include/linux/serio.h:14:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/serio/i8042.c:17:
In file included from ./include/linux/serio.h:14:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/input/serio/i8042.c:23:
In file included from ./include/linux/suspend.h:5:
In file included from ./include/linux/swap.h:9:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

drivers/input/serio/i8042.h should add these lines:
#include "linux/jiffies.h"      // for jiffies
#include "linux/kern_levels.h"  // for KERN_DEBUG
#include "linux/printk.h"       // for printk

drivers/input/serio/i8042.h should remove these lines:
- #include "i8042-x86ia64io.h"  // lines 21-21

The full include-list for drivers/input/serio/i8042.h:
#include "linux/jiffies.h"      // for jiffies
#include "linux/kern_levels.h"  // for KERN_DEBUG
#include "linux/printk.h"       // for printk
---

drivers/input/serio/i8042.c should add these lines:
#include <linux/device.h>               // for device_set_wakeup_capable
#include <stddef.h>                     // for NULL
#include "asm-generic/delay.h"          // for udelay
#include "asm-generic/errno-base.h"     // for EIO, ENODEV, ENOMEM, EBUSY
#include "asm-generic/param.h"          // for HZ
#include "i8042-x86ia64io.h"            // for i8042_read_status, i8042_read...
#include "linux/compiler.h"             // for unlikely, likely
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/completion.h"           // for complete, init_completion
#include "linux/device.h"               // for set_primary_fwnode, device
#include "linux/device/bus.h"           // for bus_register_notifier, bus_un...
#include "linux/errno.h"                // for EPROBE_DEFER
#include "linux/export.h"               // for EXPORT_SYMBOL
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/hardirq.h"              // for synchronize_irq
#include "linux/irqreturn.h"            // for irqreturn_t, IRQ_RETVAL
#include "linux/kernel.h"               // for snprintf
#include "linux/kstrtox.h"              // for kstrtobool
#include "linux/mod_devicetable.h"      // for serio_device_id
#include "linux/moduleparam.h"          // for kernel_param, param_ops_bool
#include "linux/mutex.h"                // for mutex, mutex_lock, mutex_unlock
#include "linux/notifier.h"             // for notifier_block
#include "linux/panic.h"                // for panic_blink
#include "linux/serio.h"                // for serio (ptr only), SERIO_PARITY
#include "linux/spinlock.h"             // for spin_unlock_irqrestore, spin_...
#include "linux/spinlock_types.h"       // for DEFINE_SPINLOCK
#include "linux/stddef.h"               // for true, false
#include "linux/string.h"               // for strlcpy

drivers/input/serio/i8042.c should remove these lines:
- #include <asm/io.h>  // lines 26-26
- #include <linux/err.h>  // lines 18-18
- #include <linux/ioport.h>  // lines 15-15
- #include <linux/property.h>  // lines 24-24
- #include <linux/rcupdate.h>  // lines 19-19

The full include-list for drivers/input/serio/i8042.c:
#include "i8042.h"
#include <linux/delay.h>                // for mdelay, msleep
#include <linux/device.h>               // for device_set_wakeup_capable
#include <linux/i8042.h>                // for I8042_CMD_CTL_WCTR, I8042_CMD...
#include <linux/init.h>                 // for __exit, __init
#include <linux/interrupt.h>            // for free_irq, request_irq, IRQF_S...
#include <linux/module.h>               // for MODULE_AUTHOR, MODULE_DESCRIP...
#include <linux/platform_device.h>      // for platform_driver_unregister
#include <linux/serio.h>                // for serio, serio_interrupt, serio...
#include <linux/slab.h>                 // for kfree, kzalloc
#include <linux/suspend.h>              // for pm_suspend_default_s2idle
#include <linux/types.h>                // for bool
#include <stddef.h>                     // for NULL
#include "asm-generic/delay.h"          // for udelay
#include "asm-generic/errno-base.h"     // for EIO, ENODEV, ENOMEM, EBUSY
#include "asm-generic/param.h"          // for HZ
#include "i8042-x86ia64io.h"            // for i8042_read_status, i8042_read...
#include "linux/compiler.h"             // for unlikely, likely
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/completion.h"           // for complete, init_completion
#include "linux/device.h"               // for set_primary_fwnode, device
#include "linux/device/bus.h"           // for bus_register_notifier, bus_un...
#include "linux/errno.h"                // for EPROBE_DEFER
#include "linux/export.h"               // for EXPORT_SYMBOL
#include "linux/gfp.h"                  // for GFP_KERNEL
#include "linux/hardirq.h"              // for synchronize_irq
#include "linux/irqreturn.h"            // for irqreturn_t, IRQ_RETVAL
#include "linux/kernel.h"               // for snprintf
#include "linux/kstrtox.h"              // for kstrtobool
#include "linux/mod_devicetable.h"      // for serio_device_id
#include "linux/moduleparam.h"          // for kernel_param, param_ops_bool
#include "linux/mutex.h"                // for mutex, mutex_lock, mutex_unlock
#include "linux/notifier.h"             // for notifier_block
#include "linux/panic.h"                // for panic_blink
#include "linux/serio.h"                // for serio (ptr only), SERIO_PARITY
#include "linux/spinlock.h"             // for spin_unlock_irqrestore, spin_...
#include "linux/spinlock_types.h"       // for DEFINE_SPINLOCK
#include "linux/stddef.h"               // for true, false
#include "linux/string.h"               // for strlcpy
---
  ./scripts/check-local-export drivers/input/serio/i8042.o
  iwyu2 -Wp,-MMD,drivers/input/serio/.serport.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/input/serio/serport"' -DKBUILD_BASENAME='"serport"' -DKBUILD_MODNAME='"serport"' -D__KBUILD_MODNAME=kmod_serport -c -o drivers/input/serio/serport.o drivers/input/serio/serport.c  
In file included from drivers/input/serio/serport.c:18:
In file included from ./include/linux/serio.h:14:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/serio/serport.c:18:
In file included from ./include/linux/serio.h:14:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/serio/serport.c:18:
In file included from ./include/linux/serio.h:14:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/input/serio/serport.c:18:
In file included from ./include/linux/serio.h:14:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/serio/serport.c:18:
In file included from ./include/linux/serio.h:14:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/serio/serport.c:18:
In file included from ./include/linux/serio.h:14:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/input/serio/serport.c should add these lines:
#include <asm/bitops.h>                              // for test_bit
#include <cstdio>                                    // for NULL, size_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/errno-base.h"                  // for ENOMEM, EBUSY
#include "asm/uaccess.h"                             // for get_user
#include "linux/capability.h"                        // for capable, CAP_SYS...
#include "linux/compiler_types.h"                    // for __user
#include "linux/device.h"                            // for device
#include "linux/export.h"                            // for THIS_MODULE
#include "linux/gfp.h"                               // for GFP_KERNEL
#include "linux/kern_levels.h"                       // for KERN_ERR, KERN_INFO
#include "linux/mod_devicetable.h"                   // for serio_device_id
#include "linux/printk.h"                            // for printk
#include "linux/serio.h"                             // for serio (ptr only)
#include "linux/spinlock.h"                          // for spin_unlock_irqr...
#include "linux/spinlock_types.h"                    // for spinlock_t
#include "linux/string.h"                            // for strlcpy
#include "linux/tty.h"                               // for tty_struct (ptr ...
#include "linux/tty_buffer.h"                        // for TTY_FRAME, TTY_P...
#include "linux/tty_driver.h"                        // for tty_operations
#include "linux/tty_ldisc.h"                         // for tty_register_ldisc
#include "linux/wait.h"                              // for init_waitqueue_head
struct file;

drivers/input/serio/serport.c should remove these lines:
- #include <linux/compat.h>  // lines 20-20
- #include <linux/sched.h>  // lines 14-14
- #include <linux/uaccess.h>  // lines 12-12

The full include-list for drivers/input/serio/serport.c:
#include <asm/bitops.h>                              // for test_bit
#include <linux/init.h>                              // for __exit, __init
#include <linux/kernel.h>                            // for snprintf
#include <linux/module.h>                            // for MODULE_AUTHOR
#include <linux/serio.h>                             // for serio, serio_drv...
#include <linux/slab.h>                              // for kzalloc, kfree
#include <linux/tty.h>                               // for tty_struct, tty_...
#include <cstdio>                                    // for NULL, size_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/errno-base.h"                  // for ENOMEM, EBUSY
#include "asm/uaccess.h"                             // for get_user
#include "linux/capability.h"                        // for capable, CAP_SYS...
#include "linux/compiler_types.h"                    // for __user
#include "linux/device.h"                            // for device
#include "linux/export.h"                            // for THIS_MODULE
#include "linux/gfp.h"                               // for GFP_KERNEL
#include "linux/kern_levels.h"                       // for KERN_ERR, KERN_INFO
#include "linux/mod_devicetable.h"                   // for serio_device_id
#include "linux/printk.h"                            // for printk
#include "linux/serio.h"                             // for serio (ptr only)
#include "linux/spinlock.h"                          // for spin_unlock_irqr...
#include "linux/spinlock_types.h"                    // for spinlock_t
#include "linux/string.h"                            // for strlcpy
#include "linux/tty.h"                               // for tty_struct (ptr ...
#include "linux/tty_buffer.h"                        // for TTY_FRAME, TTY_P...
#include "linux/tty_driver.h"                        // for tty_operations
#include "linux/tty_ldisc.h"                         // for tty_register_ldisc
#include "linux/wait.h"                              // for init_waitqueue_head
struct file;
---
  ./scripts/check-local-export drivers/input/serio/serport.o
  iwyu2 -Wp,-MMD,drivers/input/serio/.libps2.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/input/serio/libps2"' -DKBUILD_BASENAME='"libps2"' -DKBUILD_MODNAME='"libps2"' -D__KBUILD_MODNAME=kmod_libps2 -c -o drivers/input/serio/libps2.o drivers/input/serio/libps2.c  
In file included from drivers/input/serio/libps2.c:14:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/serio/libps2.c:14:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/serio/libps2.c:14:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/input/serio/libps2.c:14:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/serio/libps2.c:14:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/serio/libps2.c:14:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/input/serio/libps2.c should add these lines:
#include <asm/bug.h>                    // for WARN_ON
#include <stddef.h>                     // for NULL, size_t
#include "asm-generic/errno-base.h"     // for EAGAIN, EINVAL, EIO
#include "asm-generic/errno.h"          // for EPROTO
#include "asm-generic/int-ll64.h"       // for u8
#include "asm/string_32.h"              // for memchr, memcpy
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for __acquires, __releases
#include "linux/dev_printk.h"           // for dev_dbg
#include "linux/export.h"               // for EXPORT_SYMBOL
#include "linux/jiffies.h"              // for msecs_to_jiffies
#include "linux/lockdep.h"              // for lockdep_assert_held, lockdep_...
#include "linux/mutex.h"                // for mutex_lock, mutex_unlock, mut...
#include "linux/stddef.h"               // for true
#include "linux/types.h"                // for bool
#include "linux/wait.h"                 // for wait_event_timeout, wake_up

drivers/input/serio/libps2.c should remove these lines:
- #include <linux/delay.h>  // lines 10-10
- #include <linux/i8042.h>  // lines 16-16
- #include <linux/input.h>  // lines 14-14
- #include <linux/interrupt.h>  // lines 13-13
- #include <linux/sched.h>  // lines 12-12

The full include-list for drivers/input/serio/libps2.c:
#include <asm/bug.h>                    // for WARN_ON
#include <linux/libps2.h>               // for ps2dev, PS2_FLAG_ACK, PS2_FLA...
#include <linux/module.h>               // for MODULE_AUTHOR, MODULE_DESCRIP...
#include <linux/serio.h>                // for serio_continue_rx, serio_paus...
#include <stddef.h>                     // for NULL, size_t
#include "asm-generic/errno-base.h"     // for EAGAIN, EINVAL, EIO
#include "asm-generic/errno.h"          // for EPROTO
#include "asm-generic/int-ll64.h"       // for u8
#include "asm/string_32.h"              // for memchr, memcpy
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for __acquires, __releases
#include "linux/dev_printk.h"           // for dev_dbg
#include "linux/export.h"               // for EXPORT_SYMBOL
#include "linux/jiffies.h"              // for msecs_to_jiffies
#include "linux/lockdep.h"              // for lockdep_assert_held, lockdep_...
#include "linux/mutex.h"                // for mutex_lock, mutex_unlock, mut...
#include "linux/stddef.h"               // for true
#include "linux/types.h"                // for bool
#include "linux/wait.h"                 // for wait_event_timeout, wake_up
---
  ./scripts/check-local-export drivers/input/serio/libps2.o
  rm -f drivers/input/serio/built-in.a; echo serio.o i8042.o serport.o libps2.o | sed -E 's:([^ ]+):drivers/input/serio/:g' | xargs llvm-ar cDPrST drivers/input/serio/built-in.a
make -f ./scripts/Makefile.build obj=drivers/input \
 \
need-builtin=1 \
need-modorder=1
make -f ./scripts/Makefile.build obj=drivers/input/keyboard \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,drivers/input/keyboard/.atkbd.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/input/keyboard/atkbd"' -DKBUILD_BASENAME='"atkbd"' -DKBUILD_MODNAME='"atkbd"' -D__KBUILD_MODNAME=kmod_atkbd -c -o drivers/input/keyboard/atkbd.o drivers/input/keyboard/atkbd.c  
In file included from drivers/input/keyboard/atkbd.c:21:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/keyboard/atkbd.c:21:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/keyboard/atkbd.c:21:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/input/keyboard/atkbd.c:21:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/keyboard/atkbd.c:21:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/keyboard/atkbd.c:21:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/input/keyboard/atkbd.c should add these lines:
#include <asm/bitops.h>                              // for test_bit, __set_bit
#include <linux/build_bug.h>                         // for unlikely
#include <linux/device.h>                            // for pm_wakeup_event
#include <cstdio>                                    // for ssize_t, size_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for test_and_clear_bit
#include "asm-generic/errno-base.h"                  // for ENOMEM, EINVAL, EIO
#include "asm-generic/int-ll64.h"                    // for u32, u16
#include "asm/barrier.h"                             // for mb
#include "asm/page_types.h"                          // for PAGE_SIZE
#include "asm/string_32.h"                           // for memcpy, memset
#include "linux/bitmap.h"                            // for bitmap_parselist
#include "linux/bits.h"                              // for BIT_MASK
#include "linux/compiler_attributes.h"               // for fallthrough
#include "linux/compiler_types.h"                    // for inline
#include "linux/container_of.h"                      // for container_of
#include "linux/dev_printk.h"                        // for dev_dbg, dev_err
#include "linux/device.h"                            // for device_attribute
#include "linux/gfp.h"                               // for GFP_KERNEL
#include "linux/input-event-codes.h"                 // for EV_MSC, MSC_SCAN
#include "linux/input.h"                             // for input_id, BUS_I8042
#include "linux/irqreturn.h"                         // for IRQ_HANDLED, irq...
#include "linux/jiffies.h"                           // for msecs_to_jiffies
#include "linux/kernel.h"                            // for sprintf, snprintf
#include "linux/kstrtox.h"                           // for kstrtouint
#include "linux/mod_devicetable.h"                   // for DMI_SYS_VENDOR
#include "linux/moduleparam.h"                       // for kernel_param
#include "linux/printk.h"                            // for printk_ratelimit
#include "linux/serio.h"                             // for serio (ptr only)
#include "linux/stat.h"                              // for S_IRUGO, S_IWUSR
#include "linux/stddef.h"                            // for true, false
#include "linux/sysfs.h"                             // for __ATTR, sysfs_re...
#include "linux/types.h"                             // for bool, DECLARE_BI...
struct kobject;

drivers/input/keyboard/atkbd.c should remove these lines:
- #include <linux/delay.h>  // lines 16-16
- #include <linux/interrupt.h>  // lines 19-19

The full include-list for drivers/input/keyboard/atkbd.c:
#include <asm/bitops.h>                              // for test_bit, __set_bit
#include <linux/build_bug.h>                         // for unlikely
#include <linux/device.h>                            // for pm_wakeup_event
#include <linux/dmi.h>                               // for dmi_check_system
#include <linux/init.h>                              // for __init, __exit
#include <linux/input.h>                             // for input_dev, input...
#include <linux/input/vivaldi-fmap.h>                // for vivaldi_data
#include <linux/libps2.h>                            // for ps2_command, ps2dev
#include <linux/module.h>                            // for MODULE_AUTHOR
#include <linux/mutex.h>                             // for mutex_unlock
#include <linux/property.h>                          // for device_property_...
#include <linux/serio.h>                             // for serio, serio_get...
#include <linux/slab.h>                              // for kfree, kcalloc
#include <linux/workqueue.h>                         // for schedule_delayed...
#include <cstdio>                                    // for ssize_t, size_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for test_and_clear_bit
#include "asm-generic/errno-base.h"                  // for ENOMEM, EINVAL, EIO
#include "asm-generic/int-ll64.h"                    // for u32, u16
#include "asm/barrier.h"                             // for mb
#include "asm/page_types.h"                          // for PAGE_SIZE
#include "asm/string_32.h"                           // for memcpy, memset
#include "linux/bitmap.h"                            // for bitmap_parselist
#include "linux/bits.h"                              // for BIT_MASK
#include "linux/compiler_attributes.h"               // for fallthrough
#include "linux/compiler_types.h"                    // for inline
#include "linux/container_of.h"                      // for container_of
#include "linux/dev_printk.h"                        // for dev_dbg, dev_err
#include "linux/device.h"                            // for device_attribute
#include "linux/gfp.h"                               // for GFP_KERNEL
#include "linux/input-event-codes.h"                 // for EV_MSC, MSC_SCAN
#include "linux/input.h"                             // for input_id, BUS_I8042
#include "linux/irqreturn.h"                         // for IRQ_HANDLED, irq...
#include "linux/jiffies.h"                           // for msecs_to_jiffies
#include "linux/kernel.h"                            // for sprintf, snprintf
#include "linux/kstrtox.h"                           // for kstrtouint
#include "linux/mod_devicetable.h"                   // for DMI_SYS_VENDOR
#include "linux/moduleparam.h"                       // for kernel_param
#include "linux/printk.h"                            // for printk_ratelimit
#include "linux/serio.h"                             // for serio (ptr only)
#include "linux/stat.h"                              // for S_IRUGO, S_IWUSR
#include "linux/stddef.h"                            // for true, false
#include "linux/sysfs.h"                             // for __ATTR, sysfs_re...
#include "linux/types.h"                             // for bool, DECLARE_BI...
struct kobject;
---
  ./scripts/check-local-export drivers/input/keyboard/atkbd.o
  rm -f drivers/input/keyboard/built-in.a; echo atkbd.o | sed -E 's:([^ ]+):drivers/input/keyboard/:g' | xargs llvm-ar cDPrST drivers/input/keyboard/built-in.a
  iwyu2 -Wp,-MMD,drivers/input/.input.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/input/input-core"' -DKBUILD_BASENAME='"input"' -DKBUILD_MODNAME='"input_core"' -D__KBUILD_MODNAME=kmod_input_core -c -o drivers/input/input.o drivers/input/input.c  
In file included from drivers/input/input.c:14:
In file included from ./include/linux/input/mt.h:11:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/input.c:14:
In file included from ./include/linux/input/mt.h:11:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/input.c:14:
In file included from ./include/linux/input/mt.h:11:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/input/input.c:14:
In file included from ./include/linux/input/mt.h:11:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/input.c:14:
In file included from ./include/linux/input/mt.h:11:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/input.c:14:
In file included from ./include/linux/input/mt.h:11:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/input/input.c should add these lines:
#include <asm/bitops.h>                        // for test_bit, __set_bit
#include <asm/bug.h>                           // for WARN_ON
#include <linux/bitmap.h>                      // for for_each_set_bit
#include <linux/ktime.h>                       // for ktime_get, ktime_mono_...
#include <cstdio>                              // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"            // for EINVAL, ENOMEM, ENODEV
#include "asm-generic/int-ll64.h"              // for u16, u32, u8, __u32
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/string_32.h"                     // for memset, memcpy
#include "linux/atomic/atomic-instrumented.h"  // for atomic_inc_return
#include "linux/bitmap.h"                      // for bitmap_subset, bitmap_...
#include "linux/bitops.h"                      // for BITS_TO_LONGS
#include "linux/bits.h"                        // for BIT_MASK, BIT_WORD
#include "linux/compiler_types.h"              // for inline
#include "linux/dev_printk.h"                  // for dev_dbg, dev_err, dev_...
#include "linux/device/class.h"                // for class_unregister, class
#include "linux/export.h"                      // for EXPORT_SYMBOL, EXPORT_...
#include "linux/fs.h"                          // for register_chrdev_region
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/input-event-codes.h"           // for EV_KEY, EV_ABS, KEY_MAX
#include "linux/input.h"                       // for input_dev, input_handle
#include "linux/jiffies.h"                     // for msecs_to_jiffies, jiffies
#include "linux/kdev_t.h"                      // for MKDEV
#include "linux/kernel.h"                      // for scnprintf, snprintf
#include "linux/kobject.h"                     // for add_uevent_var, kobj_u...
#include "linux/kstrtox.h"                     // for strtobool
#include "linux/ktime.h"                       // for ktime_t, ktime_set
#include "linux/list.h"                        // for INIT_LIST_HEAD, list_a...
#include "linux/lockdep.h"                     // for lockdep_is_held, lockd...
#include "linux/minmax.h"                      // for min_t, max, clamp
#include "linux/mod_devicetable.h"             // for input_device_id, INPUT...
#include "linux/printk.h"                      // for dump_stack, pr_err
#include "linux/rculist.h"                     // for list_add_tail_rcu, lis...
#include "linux/spinlock.h"                    // for spin_unlock_irqrestore
#include "linux/stat.h"                        // for S_IRUGO
#include "linux/stddef.h"                      // for true, false
#include "linux/sysfs.h"                       // for attribute_group
#include "linux/timer.h"                       // for mod_timer, del_timer

drivers/input/input.c should remove these lines:
- #include <linux/poll.h>  // lines 22-22
- #include <linux/proc_fs.h>  // lines 19-19
- #include <linux/sched.h>  // lines 20-20
- #include <linux/seq_file.h>  // lines 21-21
- #include "input-compat.h"  // lines 26-26

The full include-list for drivers/input/input.c:
#include <asm/bitops.h>                        // for test_bit, __set_bit
#include <asm/bug.h>                           // for WARN_ON
#include <linux/bitmap.h>                      // for for_each_set_bit
#include <linux/device.h>                      // for device_attribute, DEVI...
#include <linux/idr.h>                         // for ida_simple_get, DEFINE...
#include <linux/init.h>                        // for __exit, __init, subsys...
#include <linux/input/mt.h>                    // for input_mt, input_is_mt_...
#include <linux/ktime.h>                       // for ktime_get, ktime_mono_...
#include <linux/major.h>                       // for INPUT_MAJOR
#include <linux/module.h>                      // for __module_get, module_put
#include <linux/mutex.h>                       // for mutex_unlock, mutex_lock
#include <linux/random.h>                      // for add_input_randomness
#include <linux/rcupdate.h>                    // for synchronize_rcu, rcu_r...
#include <linux/slab.h>                        // for kfree, kcalloc, kzalloc
#include <linux/types.h>                       // for list_head, bool, ATOMI...
#include <cstdio>                              // for NULL, ssize_t, size_t
#include "asm-generic/errno-base.h"            // for EINVAL, ENOMEM, ENODEV
#include "asm-generic/int-ll64.h"              // for u16, u32, u8, __u32
#include "asm/page_types.h"                    // for PAGE_SIZE
#include "asm/string_32.h"                     // for memset, memcpy
#include "input-poller.h"                      // for input_dev_poller_start
#include "linux/atomic/atomic-instrumented.h"  // for atomic_inc_return
#include "linux/bitmap.h"                      // for bitmap_subset, bitmap_...
#include "linux/bitops.h"                      // for BITS_TO_LONGS
#include "linux/bits.h"                        // for BIT_MASK, BIT_WORD
#include "linux/compiler_types.h"              // for inline
#include "linux/dev_printk.h"                  // for dev_dbg, dev_err, dev_...
#include "linux/device/class.h"                // for class_unregister, class
#include "linux/export.h"                      // for EXPORT_SYMBOL, EXPORT_...
#include "linux/fs.h"                          // for register_chrdev_region
#include "linux/gfp.h"                         // for GFP_KERNEL
#include "linux/input-event-codes.h"           // for EV_KEY, EV_ABS, KEY_MAX
#include "linux/input.h"                       // for input_dev, input_handle
#include "linux/jiffies.h"                     // for msecs_to_jiffies, jiffies
#include "linux/kdev_t.h"                      // for MKDEV
#include "linux/kernel.h"                      // for scnprintf, snprintf
#include "linux/kobject.h"                     // for add_uevent_var, kobj_u...
#include "linux/kstrtox.h"                     // for strtobool
#include "linux/ktime.h"                       // for ktime_t, ktime_set
#include "linux/list.h"                        // for INIT_LIST_HEAD, list_a...
#include "linux/lockdep.h"                     // for lockdep_is_held, lockd...
#include "linux/minmax.h"                      // for min_t, max, clamp
#include "linux/mod_devicetable.h"             // for input_device_id, INPUT...
#include "linux/printk.h"                      // for dump_stack, pr_err
#include "linux/rculist.h"                     // for list_add_tail_rcu, lis...
#include "linux/spinlock.h"                    // for spin_unlock_irqrestore
#include "linux/stat.h"                        // for S_IRUGO
#include "linux/stddef.h"                      // for true, false
#include "linux/sysfs.h"                       // for attribute_group
#include "linux/timer.h"                       // for mod_timer, del_timer
---
  ./scripts/check-local-export drivers/input/input.o
  iwyu2 -Wp,-MMD,drivers/input/.input-compat.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/input/input-core"' -DKBUILD_BASENAME='"input_compat"' -DKBUILD_MODNAME='"input_core"' -D__KBUILD_MODNAME=kmod_input_core -c -o drivers/input/input-compat.o drivers/input/input-compat.c  
In file included from drivers/input/input-compat.c:10:
In file included from drivers/input/input-compat.h:13:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/input-compat.c:10:
In file included from drivers/input/input-compat.h:13:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/input-compat.c:10:
In file included from drivers/input/input-compat.h:13:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/input/input-compat.c:10:
In file included from drivers/input/input-compat.h:13:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/input-compat.c:10:
In file included from drivers/input/input-compat.h:13:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/input-compat.c:10:
In file included from drivers/input/input-compat.h:13:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/input/input-compat.h should add these lines:
#include <stddef.h>                // for size_t
#include "linux/compiler_types.h"  // for __user, inline
#include "linux/input.h"           // for ff_effect (ptr only), input_event

drivers/input/input-compat.h should remove these lines:
- #include <linux/compat.h>  // lines 12-12
- #include <linux/compiler.h>  // lines 11-11
- #include <linux/input.h>  // lines 13-13

The full include-list for drivers/input/input-compat.h:
#include <stddef.h>                // for size_t
#include "linux/compiler_types.h"  // for __user, inline
#include "linux/input.h"           // for ff_effect (ptr only), input_event
---

drivers/input/input-compat.c should add these lines:
#include "asm-generic/errno-base.h"  // for EFAULT, EINVAL

drivers/input/input-compat.c should remove these lines:

The full include-list for drivers/input/input-compat.c:
#include "input-compat.h"
#include <linux/export.h>            // for EXPORT_SYMBOL_GPL
#include <linux/uaccess.h>           // for copy_from_user, copy_to_user
#include "asm-generic/errno-base.h"  // for EFAULT, EINVAL
---
  ./scripts/check-local-export drivers/input/input-compat.o
  iwyu2 -Wp,-MMD,drivers/input/.input-mt.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/input/input-core"' -DKBUILD_BASENAME='"input_mt"' -DKBUILD_MODNAME='"input_core"' -D__KBUILD_MODNAME=kmod_input_core -c -o drivers/input/input-mt.o drivers/input/input-mt.c  
In file included from drivers/input/input-mt.c:8:
In file included from ./include/linux/input/mt.h:11:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/input-mt.c:8:
In file included from ./include/linux/input/mt.h:11:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/input-mt.c:8:
In file included from ./include/linux/input/mt.h:11:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/input/input-mt.c:8:
In file included from ./include/linux/input/mt.h:11:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/input-mt.c:8:
In file included from ./include/linux/input/mt.h:11:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/input-mt.c:8:
In file included from ./include/linux/input/mt.h:11:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/input/input-mt.c should add these lines:
#include <asm/bitops.h>               // for __set_bit, test_bit
#include <stddef.h>                   // for NULL
#include "asm-generic/errno-base.h"   // for EINVAL, ENOMEM, ENXIO
#include "linux/gfp.h"                // for GFP_KERNEL
#include "linux/input-event-codes.h"  // for EV_ABS, ABS_MT_TRACKING_ID, EV_KEY
#include "linux/input.h"              // for input_event, input_dev, input_s...
#include "linux/overflow.h"           // for struct_size
#include "linux/stddef.h"             // for false, true
#include "linux/types.h"              // for bool

drivers/input/input-mt.c should remove these lines:

The full include-list for drivers/input/input-mt.c:
#include <asm/bitops.h>               // for __set_bit, test_bit
#include <linux/export.h>             // for EXPORT_SYMBOL
#include <linux/input/mt.h>           // for input_mt, input_mt_slot, input_...
#include <linux/slab.h>               // for kfree, kcalloc, kzalloc
#include <stddef.h>                   // for NULL
#include "asm-generic/errno-base.h"   // for EINVAL, ENOMEM, ENXIO
#include "linux/gfp.h"                // for GFP_KERNEL
#include "linux/input-event-codes.h"  // for EV_ABS, ABS_MT_TRACKING_ID, EV_KEY
#include "linux/input.h"              // for input_event, input_dev, input_s...
#include "linux/overflow.h"           // for struct_size
#include "linux/stddef.h"             // for false, true
#include "linux/types.h"              // for bool
---
  ./scripts/check-local-export drivers/input/input-mt.o
  iwyu2 -Wp,-MMD,drivers/input/.input-poller.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/input/input-core"' -DKBUILD_BASENAME='"input_poller"' -DKBUILD_MODNAME='"input_core"' -D__KBUILD_MODNAME=kmod_input_core -c -o drivers/input/input-poller.o drivers/input/input-poller.c  
In file included from drivers/input/input-poller.c:6:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/input-poller.c:6:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/input-poller.c:6:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/input/input-poller.c:6:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/input-poller.c:6:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/input-poller.c:6:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

(drivers/input/input-poller.h has correct #includes/fwd-decls)

drivers/input/input-poller.c should add these lines:
#include <cstdio>                    // for ssize_t, NULL, size_t
#include "asm-generic/errno-base.h"  // for EINVAL, ENOMEM
#include "asm-generic/param.h"       // for HZ
#include "linux/container_of.h"      // for container_of
#include "linux/dev_printk.h"        // for dev_err
#include "linux/export.h"            // for EXPORT_SYMBOL
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/kernel.h"            // for sprintf
#include "linux/kstrtox.h"           // for kstrtouint
#include "linux/stddef.h"            // for false, true
#include "linux/sysfs.h"             // for attribute, attribute_group
#include "linux/timer.h"             // for round_jiffies_relative
struct kobject;

drivers/input/input-poller.c should remove these lines:

The full include-list for drivers/input/input-poller.c:
#include "input-poller.h"
#include <linux/device.h>            // for device_attribute, DEVICE_ATTR
#include <linux/input.h>             // for input_dev, to_input_dev, input_d...
#include <linux/jiffies.h>           // for msecs_to_jiffies
#include <linux/mutex.h>             // for mutex_lock, mutex_unlock
#include <linux/slab.h>              // for kzalloc
#include <linux/types.h>             // for bool, umode_t
#include <linux/workqueue.h>         // for cancel_delayed_work_sync, queue_...
#include <cstdio>                    // for ssize_t, NULL, size_t
#include "asm-generic/errno-base.h"  // for EINVAL, ENOMEM
#include "asm-generic/param.h"       // for HZ
#include "linux/container_of.h"      // for container_of
#include "linux/dev_printk.h"        // for dev_err
#include "linux/export.h"            // for EXPORT_SYMBOL
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/kernel.h"            // for sprintf
#include "linux/kstrtox.h"           // for kstrtouint
#include "linux/stddef.h"            // for false, true
#include "linux/sysfs.h"             // for attribute, attribute_group
#include "linux/timer.h"             // for round_jiffies_relative
struct kobject;
---
  ./scripts/check-local-export drivers/input/input-poller.o
  iwyu2 -Wp,-MMD,drivers/input/.ff-core.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/input/input-core"' -DKBUILD_BASENAME='"ff_core"' -DKBUILD_MODNAME='"input_core"' -D__KBUILD_MODNAME=kmod_input_core -c -o drivers/input/ff-core.o drivers/input/ff-core.c  
In file included from drivers/input/ff-core.c:14:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/ff-core.c:14:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/ff-core.c:14:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/input/ff-core.c:14:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/ff-core.c:14:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/ff-core.c:14:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/input/ff-core.c should add these lines:
#include <asm/bitops.h>               // for test_bit, __set_bit, __clear_bit
#include <linux/bitmap.h>             // for for_each_set_bit
#include <stddef.h>                   // for NULL, size_t
#include "asm-generic/errno-base.h"   // for EINVAL, ENOMEM, EACCES, ENOSPC
#include "asm-generic/errno.h"        // for ENOSYS
#include "linux/compiler_types.h"     // for inline
#include "linux/dev_printk.h"         // for dev_dbg, dev_err
#include "linux/export.h"             // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                // for GFP_KERNEL
#include "linux/input-event-codes.h"  // for EV_FF
#include "linux/input.h"              // for ff_effect, ff_effect::(anonymous)
#include "linux/spinlock.h"           // for spin_lock_irq, spin_unlock_irq
struct file;

drivers/input/ff-core.c should remove these lines:
- #include <linux/module.h>  // lines 15-15
- #include <linux/sched.h>  // lines 17-17

The full include-list for drivers/input/ff-core.c:
#include <asm/bitops.h>               // for test_bit, __set_bit, __clear_bit
#include <linux/bitmap.h>             // for for_each_set_bit
#include <linux/input.h>              // for ff_device, input_dev, input_ff_...
#include <linux/mutex.h>              // for mutex_lock, mutex_unlock, mutex...
#include <linux/slab.h>               // for kfree, kcalloc, kzalloc
#include <stddef.h>                   // for NULL, size_t
#include "asm-generic/errno-base.h"   // for EINVAL, ENOMEM, EACCES, ENOSPC
#include "asm-generic/errno.h"        // for ENOSYS
#include "linux/compiler_types.h"     // for inline
#include "linux/dev_printk.h"         // for dev_dbg, dev_err
#include "linux/export.h"             // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"                // for GFP_KERNEL
#include "linux/input-event-codes.h"  // for EV_FF
#include "linux/input.h"              // for ff_effect, ff_effect::(anonymous)
#include "linux/spinlock.h"           // for spin_lock_irq, spin_unlock_irq
struct file;
---
  ./scripts/check-local-export drivers/input/ff-core.o
  iwyu2 -Wp,-MMD,drivers/input/.touchscreen.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/input/input-core"' -DKBUILD_BASENAME='"touchscreen"' -DKBUILD_MODNAME='"input_core"' -D__KBUILD_MODNAME=kmod_input_core -c -o drivers/input/touchscreen.o drivers/input/touchscreen.c  
In file included from drivers/input/touchscreen.c:10:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/touchscreen.c:10:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/touchscreen.c:10:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from drivers/input/touchscreen.c:10:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/input/touchscreen.c:10:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/input/touchscreen.c:10:
In file included from ./include/linux/input.h:19:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

drivers/input/touchscreen.c should add these lines:
#include <asm/bitops.h>               // for test_bit
#include "asm-generic/int-ll64.h"     // for u32
#include "linux/dev_printk.h"         // for dev_warn
#include "linux/device.h"             // for device
#include "linux/export.h"             // for EXPORT_SYMBOL
#include "linux/input-event-codes.h"  // for ABS_MT_POSITION_X, ABS_MT_POSIT...
#include "linux/input.h"              // for input_absinfo, input_dev (ptr o...
#include "linux/minmax.h"             // for swap
#include "linux/stddef.h"             // for false, true
#include "linux/types.h"              // for bool

drivers/input/touchscreen.c should remove these lines:

The full include-list for drivers/input/touchscreen.c:
#include <asm/bitops.h>               // for test_bit
#include <linux/input.h>              // for input_abs_get_max, input_dev
#include <linux/input/mt.h>           // for input_mt_pos
#include <linux/input/touchscreen.h>  // for touchscreen_properties, touchsc...
#include <linux/module.h>             // for MODULE_DESCRIPTION, MODULE_LICENSE
#include <linux/property.h>           // for device_property_read_bool, devi...
#include "asm-generic/int-ll64.h"     // for u32
#include "linux/dev_printk.h"         // for dev_warn
#include "linux/device.h"             // for device
#include "linux/export.h"             // for EXPORT_SYMBOL
#include "linux/input-event-codes.h"  // for ABS_MT_POSITION_X, ABS_MT_POSIT...
#include "linux/input.h"              // for input_absinfo, input_dev (ptr o...
#include "linux/minmax.h"             // for swap
#include "linux/stddef.h"             // for false, true
#include "linux/types.h"              // for bool
---
  ./scripts/check-local-export drivers/input/touchscreen.o
  iwyu2 -Wp,-MMD,drivers/input/.vivaldi-fmap.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/input/vivaldi-fmap"' -DKBUILD_BASENAME='"vivaldi_fmap"' -DKBUILD_MODNAME='"vivaldi_fmap"' -D__KBUILD_MODNAME=kmod_vivaldi_fmap -c -o drivers/input/vivaldi-fmap.o drivers/input/vivaldi-fmap.c  

drivers/input/vivaldi-fmap.c should add these lines:
#include <sys/types.h>                 // for ssize_t
#include "asm-generic/int-ll64.h"      // for u32
#include "asm/page_types.h"            // for PAGE_SIZE

drivers/input/vivaldi-fmap.c should remove these lines:
- #include <linux/types.h>  // lines 12-12

The full include-list for drivers/input/vivaldi-fmap.c:
#include <linux/export.h>              // for EXPORT_SYMBOL_GPL
#include <linux/input/vivaldi-fmap.h>  // for vivaldi_data, vivaldi_function...
#include <linux/kernel.h>              // for scnprintf
#include <linux/module.h>              // for MODULE_LICENSE
#include <sys/types.h>                 // for ssize_t
#include "asm-generic/int-ll64.h"      // for u32
#include "asm/page_types.h"            // for PAGE_SIZE
---
  ./scripts/check-local-export drivers/input/vivaldi-fmap.o
  rm -f drivers/input/built-in.a; echo input.o input-compat.o input-mt.o input-poller.o ff-core.o touchscreen.o vivaldi-fmap.o keyboard/built-in.a | sed -E 's:([^ ]+):drivers/input/:g' | xargs llvm-ar cDPrST drivers/input/built-in.a
make -f ./scripts/Makefile.build obj=drivers/rtc \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,drivers/rtc/.lib.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/rtc/lib"' -DKBUILD_BASENAME='"lib"' -DKBUILD_MODNAME='"lib"' -D__KBUILD_MODNAME=kmod_lib -c -o drivers/rtc/lib.o drivers/rtc/lib.c  
In file included from drivers/rtc/lib.c:14:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/rtc/lib.c:14:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/rtc/lib.c:14:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/rtc/lib.c:14:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
4 warnings generated.
In file included from drivers/rtc/lib.c:14:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/rtc/lib.c:14:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/rtc/lib.c:14:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/rtc/lib.c:14:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^

drivers/rtc/lib.c should add these lines:
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm-generic/int-ll64.h"    // for u32, u16, u64
#include "linux/kernel.h"            // for lower_32_bits, upper_32_bits
#include "linux/ktime.h"             // for ktime_set, ktime_t, ktime_to_tim...
#include "linux/math64.h"            // for div_s64_rem
#include "linux/rtc.h"               // for rtc_time
#include "linux/time.h"              // for mktime64
#include "linux/time64.h"            // for timespec64, time64_t
#include "linux/types.h"             // for bool
#include "vdso/limits.h"             // for INT_MAX

drivers/rtc/lib.c should remove these lines:

The full include-list for drivers/rtc/lib.c:
#include <linux/export.h>            // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/rtc.h>               // for is_leap_year, rtc_ktime_to_tm
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm-generic/int-ll64.h"    // for u32, u16, u64
#include "linux/kernel.h"            // for lower_32_bits, upper_32_bits
#include "linux/ktime.h"             // for ktime_set, ktime_t, ktime_to_tim...
#include "linux/math64.h"            // for div_s64_rem
#include "linux/rtc.h"               // for rtc_time
#include "linux/time.h"              // for mktime64
#include "linux/time64.h"            // for timespec64, time64_t
#include "linux/types.h"             // for bool
#include "vdso/limits.h"             // for INT_MAX
---
  ./scripts/check-local-export drivers/rtc/lib.o
  iwyu2 -Wp,-MMD,drivers/rtc/.rtc-mc146818-lib.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/rtc/rtc-mc146818-lib"' -DKBUILD_BASENAME='"rtc_mc146818_lib"' -DKBUILD_MODNAME='"rtc_mc146818_lib"' -D__KBUILD_MODNAME=kmod_rtc_mc146818_lib -c -o drivers/rtc/rtc-mc146818-lib.o drivers/rtc/rtc-mc146818-lib.c  
In file included from drivers/rtc/rtc-mc146818-lib.c:5:
In file included from ./include/linux/mc146818rtc.h:15:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/rtc/rtc-mc146818-lib.c:5:
In file included from ./include/linux/mc146818rtc.h:15:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/rtc/rtc-mc146818-lib.c:5:
In file included from ./include/linux/mc146818rtc.h:15:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/rtc/rtc-mc146818-lib.c:5:
In file included from ./include/linux/mc146818rtc.h:15:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
4 warnings generated.
In file included from drivers/rtc/rtc-mc146818-lib.c:5:
In file included from ./include/linux/mc146818rtc.h:15:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from drivers/rtc/rtc-mc146818-lib.c:5:
In file included from ./include/linux/mc146818rtc.h:15:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from drivers/rtc/rtc-mc146818-lib.c:5:
In file included from ./include/linux/mc146818rtc.h:15:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from drivers/rtc/rtc-mc146818-lib.c:5:
In file included from ./include/linux/mc146818rtc.h:15:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^

drivers/rtc/rtc-mc146818-lib.c should add these lines:
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL, EIO
#include "asm/mc146818rtc.h"         // for CMOS_READ, CMOS_WRITE, RTC_ALWAY...
#include "asm/processor.h"           // for boot_cpu_data, cpuinfo_x86, X86_...
#include "asm/string_32.h"           // for memset
#include "linux/rtc.h"               // for rtc_time
#include "linux/spinlock.h"          // for spin_unlock_irqrestore, spin_loc...
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool

drivers/rtc/rtc-mc146818-lib.c should remove these lines:

The full include-list for drivers/rtc/rtc-mc146818-lib.c:
#include <linux/bcd.h>               // for bin2bcd, bcd2bin
#include <linux/delay.h>             // for mdelay
#include <linux/export.h>            // for EXPORT_SYMBOL_GPL
#include <linux/mc146818rtc.h>       // for rtc_lock, RTC_FREQ_SELECT, RTC_C...
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL, EIO
#include "asm/mc146818rtc.h"         // for CMOS_READ, CMOS_WRITE, RTC_ALWAY...
#include "asm/processor.h"           // for boot_cpu_data, cpuinfo_x86, X86_...
#include "asm/string_32.h"           // for memset
#include "linux/rtc.h"               // for rtc_time
#include "linux/spinlock.h"          // for spin_unlock_irqrestore, spin_loc...
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool
---
  ./scripts/check-local-export drivers/rtc/rtc-mc146818-lib.o
  rm -f drivers/rtc/built-in.a; echo lib.o rtc-mc146818-lib.o | sed -E 's:([^ ]+):drivers/rtc/:g' | xargs llvm-ar cDPrST drivers/rtc/built-in.a
make -f ./scripts/Makefile.build obj=drivers/clocksource \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,drivers/clocksource/.i8253.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"drivers/clocksource/i8253"' -DKBUILD_BASENAME='"i8253"' -DKBUILD_MODNAME='"i8253"' -D__KBUILD_MODNAME=kmod_i8253 -c -o drivers/clocksource/i8253.o drivers/clocksource/i8253.c  

drivers/clocksource/i8253.c should add these lines:
#include "asm-generic/int-ll64.h"      // for u32, u64
#include "asm/io.h"                    // for outb_p, inb_p
#include "linux/cache.h"               // for __ro_after_init
#include "linux/clocksource.h"         // for clocksource_register_hz, CLOCK...
#include "linux/cpumask.h"             // for cpumask_of
#include "linux/export.h"              // for EXPORT_SYMBOL
#include "linux/jiffies.h"             // for jiffies
#include "linux/spinlock_types_raw.h"  // for DEFINE_RAW_SPINLOCK
#include "linux/stddef.h"              // for true
#include "linux/types.h"               // for bool

drivers/clocksource/i8253.c should remove these lines:
- #include <linux/io.h>  // lines 7-7
- #include <linux/module.h>  // lines 10-10

The full include-list for drivers/clocksource/i8253.c:
#include <linux/clockchips.h>          // for clock_event_device, clockevent...
#include <linux/i8253.h>               // for PIT_CH0, PIT_LATCH, PIT_MODE
#include <linux/init.h>                // for __init
#include <linux/smp.h>                 // for smp_processor_id
#include <linux/spinlock.h>            // for raw_spin_lock, raw_spin_unlock
#include <linux/timex.h>               // for PIT_TICK_RATE
#include "asm-generic/int-ll64.h"      // for u32, u64
#include "asm/io.h"                    // for outb_p, inb_p
#include "linux/cache.h"               // for __ro_after_init
#include "linux/clocksource.h"         // for clocksource_register_hz, CLOCK...
#include "linux/cpumask.h"             // for cpumask_of
#include "linux/export.h"              // for EXPORT_SYMBOL
#include "linux/jiffies.h"             // for jiffies
#include "linux/spinlock_types_raw.h"  // for DEFINE_RAW_SPINLOCK
#include "linux/stddef.h"              // for true
#include "linux/types.h"               // for bool
---
  ./scripts/check-local-export drivers/clocksource/i8253.o
  rm -f drivers/clocksource/built-in.a; echo i8253.o | sed -E 's:([^ ]+):drivers/clocksource/:g' | xargs llvm-ar cDPrST drivers/clocksource/built-in.a
  rm -f drivers/built-in.a; echo video/built-in.a tty/built-in.a char/built-in.a base/built-in.a input/serio/built-in.a input/built-in.a rtc/built-in.a clocksource/built-in.a | sed -E 's:([^ ]+):drivers/:g' | xargs llvm-ar cDPrST drivers/built-in.a
make -f ./scripts/Makefile.build obj=lib \
single-build= \
need-builtin=1 need-modorder=1
make -f ./scripts/Makefile.build obj=lib/math \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,lib/math/.div64.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/math/div64"' -DKBUILD_BASENAME='"div64"' -DKBUILD_MODNAME='"div64"' -D__KBUILD_MODNAME=kmod_div64 -c -o lib/math/div64.o lib/math/div64.c  

lib/math/div64.c should add these lines:
#include <stdint.h>                   // for uint64_t, uint32_t, int64_t
#include "asm-generic/bitsperlong.h"  // for BITS_PER_LONG
#include "asm-generic/int-ll64.h"     // for u64, s64, u32, s32
#include "asm/div64.h"                // for div_u64_rem
#include "vdso/math64.h"              // for __iter_div_u64_rem

lib/math/div64.c should remove these lines:

The full include-list for lib/math/div64.c:
#include <linux/bitops.h>             // for fls
#include <linux/export.h>             // for EXPORT_SYMBOL
#include <linux/log2.h>               // for ilog2
#include <linux/math.h>               // for abs
#include <linux/math64.h>             // for div_u64, div64_s64, div64_u64
#include <stdint.h>                   // for uint64_t, uint32_t, int64_t
#include "asm-generic/bitsperlong.h"  // for BITS_PER_LONG
#include "asm-generic/int-ll64.h"     // for u64, s64, u32, s32
#include "asm/div64.h"                // for div_u64_rem
#include "vdso/math64.h"              // for __iter_div_u64_rem
---
  ./scripts/check-local-export lib/math/div64.o
  iwyu2 -Wp,-MMD,lib/math/.gcd.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/math/gcd"' -DKBUILD_BASENAME='"gcd"' -DKBUILD_MODNAME='"gcd"' -D__KBUILD_MODNAME=kmod_gcd -c -o lib/math/gcd.o lib/math/gcd.c  

lib/math/gcd.c should add these lines:
#include <linux/bitops.h>  // for __ffs
#include "linux/minmax.h"  // for swap

lib/math/gcd.c should remove these lines:
- #include <linux/kernel.h>  // lines 2-2

The full include-list for lib/math/gcd.c:
#include <linux/bitops.h>  // for __ffs
#include <linux/export.h>  // for EXPORT_SYMBOL_GPL
#include <linux/gcd.h>     // for gcd
#include "linux/minmax.h"  // for swap
---
  ./scripts/check-local-export lib/math/gcd.o
  iwyu2 -Wp,-MMD,lib/math/.lcm.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/math/lcm"' -DKBUILD_BASENAME='"lcm"' -DKBUILD_MODNAME='"lcm"' -D__KBUILD_MODNAME=kmod_lcm -c -o lib/math/lcm.o lib/math/lcm.c  

lib/math/lcm.c should add these lines:

lib/math/lcm.c should remove these lines:
- #include <linux/compiler.h>  // lines 2-2

The full include-list for lib/math/lcm.c:
#include <linux/export.h>  // for EXPORT_SYMBOL_GPL
#include <linux/gcd.h>     // for gcd
#include <linux/lcm.h>     // for lcm, lcm_not_zero
---
  ./scripts/check-local-export lib/math/lcm.o
  iwyu2 -Wp,-MMD,lib/math/.int_pow.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/math/int_pow"' -DKBUILD_BASENAME='"int_pow"' -DKBUILD_MODNAME='"int_pow"' -D__KBUILD_MODNAME=kmod_int_pow -c -o lib/math/int_pow.o lib/math/int_pow.c  

lib/math/int_pow.c should add these lines:
#include "asm-generic/int-ll64.h"  // for u64

lib/math/int_pow.c should remove these lines:
- #include <linux/types.h>  // lines 10-10

The full include-list for lib/math/int_pow.c:
#include <linux/export.h>          // for EXPORT_SYMBOL_GPL
#include <linux/math.h>            // for int_pow
#include "asm-generic/int-ll64.h"  // for u64
---
  ./scripts/check-local-export lib/math/int_pow.o
  iwyu2 -Wp,-MMD,lib/math/.int_sqrt.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/math/int_sqrt"' -DKBUILD_BASENAME='"int_sqrt"' -DKBUILD_MODNAME='"int_sqrt"' -D__KBUILD_MODNAME=kmod_int_sqrt -c -o lib/math/int_sqrt.o lib/math/int_sqrt.c  

lib/math/int_sqrt.c should add these lines:
#include "asm-generic/bitops/fls64.h"  // for fls64
#include "asm-generic/bitsperlong.h"   // for BITS_PER_LONG
#include "asm-generic/int-ll64.h"      // for u64, u32
#include "vdso/limits.h"               // for ULONG_MAX

lib/math/int_sqrt.c should remove these lines:
- #include <linux/limits.h>  // lines 11-11

The full include-list for lib/math/int_sqrt.c:
#include <linux/bitops.h>              // for __fls
#include <linux/export.h>              // for EXPORT_SYMBOL
#include <linux/math.h>                // for int_sqrt, int_sqrt64
#include "asm-generic/bitops/fls64.h"  // for fls64
#include "asm-generic/bitsperlong.h"   // for BITS_PER_LONG
#include "asm-generic/int-ll64.h"      // for u64, u32
#include "vdso/limits.h"               // for ULONG_MAX
---
  ./scripts/check-local-export lib/math/int_sqrt.o
  iwyu2 -Wp,-MMD,lib/math/.reciprocal_div.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/math/reciprocal_div"' -DKBUILD_BASENAME='"reciprocal_div"' -DKBUILD_MODNAME='"reciprocal_div"' -D__KBUILD_MODNAME=kmod_reciprocal_div -c -o lib/math/reciprocal_div.o lib/math/reciprocal_div.c  

lib/math/reciprocal_div.c should add these lines:
#include <asm/bug.h>               // for WARN
#include "asm-generic/int-ll64.h"  // for u32, u64, u8
#include "asm/div64.h"             // for do_div

lib/math/reciprocal_div.c should remove these lines:
- #include <linux/bug.h>  // lines 3-3
- #include <linux/math.h>  // lines 6-6
- #include <linux/types.h>  // lines 8-8

The full include-list for lib/math/reciprocal_div.c:
#include <asm/bug.h>               // for WARN
#include <linux/bitops.h>          // for fls
#include <linux/export.h>          // for EXPORT_SYMBOL
#include <linux/limits.h>          // for U32_MAX
#include <linux/minmax.h>          // for max, min
#include <linux/reciprocal_div.h>  // for reciprocal_value_adv, reciprocal_v...
#include "asm-generic/int-ll64.h"  // for u32, u64, u8
#include "asm/div64.h"             // for do_div
---
  ./scripts/check-local-export lib/math/reciprocal_div.o
  rm -f lib/math/built-in.a; echo div64.o gcd.o lcm.o int_pow.o int_sqrt.o reciprocal_div.o | sed -E 's:([^ ]+):lib/math/:g' | xargs llvm-ar cDPrST lib/math/built-in.a
make -f ./scripts/Makefile.build obj=lib/crypto \
 \
need-builtin=1 \
need-modorder=1
  iwyu2 -Wp,-MMD,lib/crypto/.chacha.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/crypto/chacha"' -DKBUILD_BASENAME='"chacha"' -DKBUILD_MODNAME='"chacha"' -D__KBUILD_MODNAME=kmod_chacha -c -o lib/crypto/chacha.o lib/crypto/chacha.c  

lib/crypto/chacha.c should add these lines:
#include <asm/bug.h>                // for WARN_ON_ONCE
#include "asm-generic/int-ll64.h"   // for u32, u8
#include "asm-generic/unaligned.h"  // for put_unaligned_le32
#include "asm/string_32.h"          // for memcpy

lib/crypto/chacha.c should remove these lines:
- #include <asm/unaligned.h>  // lines 13-13
- #include <linux/bug.h>  // lines 8-8
- #include <linux/string.h>  // lines 12-12

The full include-list for lib/crypto/chacha.c:
#include <asm/bug.h>                // for WARN_ON_ONCE
#include <crypto/chacha.h>          // for chacha_block_generic, hchacha_blo...
#include <linux/bitops.h>           // for rol32
#include <linux/export.h>           // for EXPORT_SYMBOL
#include <linux/kernel.h>           // for ARRAY_SIZE
#include "asm-generic/int-ll64.h"   // for u32, u8
#include "asm-generic/unaligned.h"  // for put_unaligned_le32
#include "asm/string_32.h"          // for memcpy
---
  ./scripts/check-local-export lib/crypto/chacha.o
  iwyu2 -Wp,-MMD,lib/crypto/.blake2s.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/crypto/libblake2s"' -DKBUILD_BASENAME='"blake2s"' -DKBUILD_MODNAME='"libblake2s"' -D__KBUILD_MODNAME=kmod_libblake2s -c -o lib/crypto/blake2s.o lib/crypto/blake2s.c  

include/crypto/internal/blake2s.h should add these lines:
#include <linux/build_bug.h>            // for unlikely
#include <stddef.h>                     // for size_t
#include "asm-generic/errno-base.h"     // for EINVAL
#include "asm-generic/int-ll64.h"       // for u8, u32
#include "asm/string_32.h"              // for memcpy, memset
#include "crypto/hash.h"                // for shash_desc_ctx, crypto_shash_...
#include "crypto/internal/hash.h"       // for crypto_shash_ctx
#include "linux/byteorder/generic.h"    // for cpu_to_le32_array
#include "linux/compiler_attributes.h"  // for __always_inline
#include "linux/compiler_types.h"       // for inline
#include "linux/kernel.h"               // for ARRAY_SIZE
#include "linux/math.h"                 // for DIV_ROUND_UP
#include "linux/types.h"                // for bool

include/crypto/internal/blake2s.h should remove these lines:
- #include <crypto/internal/hash.h>  // lines 11-11
- #include <linux/string.h>  // lines 12-12

The full include-list for include/crypto/internal/blake2s.h:
#include <crypto/blake2s.h>             // for blake2s_state, BLAKE2S_BLOCK_...
#include <linux/build_bug.h>            // for unlikely
#include <stddef.h>                     // for size_t
#include "asm-generic/errno-base.h"     // for EINVAL
#include "asm-generic/int-ll64.h"       // for u8, u32
#include "asm/string_32.h"              // for memcpy, memset
#include "crypto/hash.h"                // for shash_desc_ctx, crypto_shash_...
#include "crypto/internal/hash.h"       // for crypto_shash_ctx
#include "linux/byteorder/generic.h"    // for cpu_to_le32_array
#include "linux/compiler_attributes.h"  // for __always_inline
#include "linux/compiler_types.h"       // for inline
#include "linux/kernel.h"               // for ARRAY_SIZE
#include "linux/math.h"                 // for DIV_ROUND_UP
#include "linux/types.h"                // for bool
---

lib/crypto/blake2s.c should add these lines:
#include <asm/bug.h>         // for WARN_ON
#include "crypto/blake2s.h"  // for blake2s_final, blake2s_state, blake2s_up...
#include "crypto/internal/blake2s.h"
#include "linux/export.h"    // for EXPORT_SYMBOL
#include "linux/kconfig.h"   // for IS_ENABLED
#include "linux/stddef.h"    // for false

lib/crypto/blake2s.c should remove these lines:
- #include <linux/bug.h>  // lines 17-17
- #include <linux/kernel.h>  // lines 14-14
- #include <linux/types.h>  // lines 12-12

The full include-list for lib/crypto/blake2s.c:
#include <crypto/internal/blake2s.h>
#include <asm/bug.h>         // for WARN_ON
#include <linux/init.h>      // for __exit, __init
#include <linux/module.h>    // for MODULE_AUTHOR, MODULE_DESCRIPTION, MODUL...
#include <linux/string.h>    // for memzero_explicit
#include "crypto/blake2s.h"  // for blake2s_final, blake2s_state, blake2s_up...
#include "crypto/internal/blake2s.h"
#include "linux/export.h"    // for EXPORT_SYMBOL
#include "linux/kconfig.h"   // for IS_ENABLED
#include "linux/stddef.h"    // for false
---
  ./scripts/check-local-export lib/crypto/blake2s.o
  iwyu2 -Wp,-MMD,lib/crypto/.blake2s-generic.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/crypto/libblake2s"' -DKBUILD_BASENAME='"blake2s_generic"' -DKBUILD_MODNAME='"libblake2s"' -D__KBUILD_MODNAME=kmod_libblake2s -c -o lib/crypto/blake2s-generic.o lib/crypto/blake2s-generic.c  

lib/crypto/blake2s-generic.c should add these lines:
#include <asm/bug.h>                    // for WARN_ON
#include <stddef.h>                     // for size_t
#include "asm-generic/int-ll64.h"       // for u32, u8
#include "asm/string_32.h"              // for memcpy
#include "crypto/blake2s.h"             // for blake2s_state, BLAKE2S_BLOCK_...
#include "crypto/internal/blake2s.h"
#include "linux/bitops.h"               // for ror32
#include "linux/byteorder/generic.h"    // for le32_to_cpu_array
#include "linux/compiler_attributes.h"  // for __alias, __weak
#include "linux/compiler_types.h"       // for inline
#include "linux/export.h"               // for EXPORT_SYMBOL
#include "linux/kconfig.h"              // for IS_ENABLED

lib/crypto/blake2s-generic.c should remove these lines:
- #include <asm/unaligned.h>  // lines 18-18
- #include <crypto/internal/blake2s.h>  // lines 11-11
- #include <linux/bug.h>  // lines 17-17
- #include <linux/init.h>  // lines 16-16
- #include <linux/string.h>  // lines 13-13
- #include <linux/types.h>  // lines 12-12

The full include-list for lib/crypto/blake2s-generic.c:
#include <asm/bug.h>                    // for WARN_ON
#include <linux/kernel.h>               // for ARRAY_SIZE
#include <linux/module.h>               // for MODULE_AUTHOR, MODULE_DESCRIP...
#include <stddef.h>                     // for size_t
#include "asm-generic/int-ll64.h"       // for u32, u8
#include "asm/string_32.h"              // for memcpy
#include "crypto/blake2s.h"             // for blake2s_state, BLAKE2S_BLOCK_...
#include "crypto/internal/blake2s.h"
#include "linux/bitops.h"               // for ror32
#include "linux/byteorder/generic.h"    // for le32_to_cpu_array
#include "linux/compiler_attributes.h"  // for __alias, __weak
#include "linux/compiler_types.h"       // for inline
#include "linux/export.h"               // for EXPORT_SYMBOL
#include "linux/kconfig.h"              // for IS_ENABLED
---
  ./scripts/check-local-export lib/crypto/blake2s-generic.o
  iwyu2 -Wp,-MMD,lib/crypto/.blake2s-selftest.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/crypto/libblake2s"' -DKBUILD_BASENAME='"blake2s_selftest"' -DKBUILD_MODNAME='"libblake2s"' -D__KBUILD_MODNAME=kmod_libblake2s -c -o lib/crypto/blake2s-selftest.o lib/crypto/blake2s-selftest.c  

lib/crypto/blake2s-selftest.c should add these lines:
#include "asm-generic/int-ll64.h"  // for u8
#include "asm/string_32.h"         // for memcmp
#include "crypto/blake2s.h"        // for blake2s_update, BLAKE2S_KEY_SIZE
#include "crypto/internal/blake2s.h"
#include "linux/init.h"            // for __init, __initconst
#include "linux/kernel.h"          // for ARRAY_SIZE
#include "linux/printk.h"          // for pr_err
#include "linux/stddef.h"          // for false, true
#include "linux/types.h"           // for bool

lib/crypto/blake2s-selftest.c should remove these lines:
- #include <crypto/internal/blake2s.h>  // lines 6-6
- #include <linux/string.h>  // lines 7-7

The full include-list for lib/crypto/blake2s-selftest.c:
#include "asm-generic/int-ll64.h"  // for u8
#include "asm/string_32.h"         // for memcmp
#include "crypto/blake2s.h"        // for blake2s_update, BLAKE2S_KEY_SIZE
#include "crypto/internal/blake2s.h"
#include "linux/init.h"            // for __init, __initconst
#include "linux/kernel.h"          // for ARRAY_SIZE
#include "linux/printk.h"          // for pr_err
#include "linux/stddef.h"          // for false, true
#include "linux/types.h"           // for bool
---
  ./scripts/check-local-export lib/crypto/blake2s-selftest.o
  rm -f lib/crypto/built-in.a; echo chacha.o blake2s.o blake2s-generic.o blake2s-selftest.o | sed -E 's:([^ ]+):lib/crypto/:g' | xargs llvm-ar cDPrST lib/crypto/built-in.a
  iwyu2 -Wp,-MMD,lib/.argv_split.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/argv_split"' -DKBUILD_BASENAME='"argv_split"' -DKBUILD_MODNAME='"argv_split"' -D__KBUILD_MODNAME=kmod_argv_split -c -o lib/argv_split.o lib/argv_split.c  

lib/argv_split.c should add these lines:
#include <stddef.h>        // for NULL
#include "linux/stddef.h"  // for true, false
#include "linux/types.h"   // for bool, gfp_t

lib/argv_split.c should remove these lines:
- #include <linux/kernel.h>  // lines 6-6

The full include-list for lib/argv_split.c:
#include <linux/ctype.h>   // for isspace
#include <linux/export.h>  // for EXPORT_SYMBOL
#include <linux/slab.h>    // for kfree, kmalloc_array, KMALLOC_MAX_SIZE
#include <linux/string.h>  // for kstrndup, argv_free, argv_split
#include <stddef.h>        // for NULL
#include "linux/stddef.h"  // for true, false
#include "linux/types.h"   // for bool, gfp_t
---
  ./scripts/check-local-export lib/argv_split.o
  iwyu2 -Wp,-MMD,lib/.buildid.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/buildid"' -DKBUILD_BASENAME='"buildid"' -DKBUILD_MODNAME='"buildid"' -D__KBUILD_MODNAME=kmod_buildid -c -o lib/buildid.o lib/buildid.c  

include/linux/buildid.h should add these lines:
#include "asm-generic/int-ll64.h"  // for __u32, u32
#include "linux/compiler_types.h"  // for inline
#include "linux/kconfig.h"         // for IS_ENABLED
struct vm_area_struct;

include/linux/buildid.h should remove these lines:
- #include <linux/mm_types.h>  // lines 5-5

The full include-list for include/linux/buildid.h:
#include "asm-generic/int-ll64.h"  // for __u32, u32
#include "linux/compiler_types.h"  // for inline
#include "linux/kconfig.h"         // for IS_ENABLED
struct vm_area_struct;
---

lib/buildid.c should add these lines:
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL, EFAULT
#include "asm/page_types.h"          // for PAGE_SIZE
#include "asm/string_32.h"           // for strcmp, memcmp, memcpy, memset
#include "linux/align.h"             // for ALIGN
#include "linux/elf.h"               // for Elf32_Nhdr, Elf32_Ehdr, Elf32_Phdr
#include "linux/fs.h"                // for file
#include "linux/highmem-internal.h"  // for kmap_atomic, kunmap_atomic
#include "linux/mm.h"                // for put_page
#include "linux/mm_types.h"          // for vm_area_struct

lib/buildid.c should remove these lines:
- #include <linux/cache.h>  // lines 4-4
- #include <linux/elf.h>  // lines 5-5
- #include <linux/kernel.h>  // lines 6-6

The full include-list for lib/buildid.c:
#include <linux/buildid.h>
#include <linux/pagemap.h>           // for find_get_page
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL, EFAULT
#include "asm/page_types.h"          // for PAGE_SIZE
#include "asm/string_32.h"           // for strcmp, memcmp, memcpy, memset
#include "linux/align.h"             // for ALIGN
#include "linux/elf.h"               // for Elf32_Nhdr, Elf32_Ehdr, Elf32_Phdr
#include "linux/fs.h"                // for file
#include "linux/highmem-internal.h"  // for kmap_atomic, kunmap_atomic
#include "linux/mm.h"                // for put_page
#include "linux/mm_types.h"          // for vm_area_struct
---
  ./scripts/check-local-export lib/buildid.o
  iwyu2 -Wp,-MMD,lib/.cmdline.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/cmdline"' -DKBUILD_BASENAME='"cmdline"' -DKBUILD_MODNAME='"cmdline"' -D__KBUILD_MODNAME=kmod_cmdline -c -o lib/cmdline.o lib/cmdline.c  

lib/cmdline.c should add these lines:
#include <stddef.h>                     // for NULL
#include "asm/string_32.h"              // for strlen, strncmp
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/kstrtox.h"              // for simple_strtoull, simple_strtol
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool

lib/cmdline.c should remove these lines:

The full include-list for lib/cmdline.c:
#include <linux/ctype.h>                // for isspace
#include <linux/export.h>               // for EXPORT_SYMBOL
#include <linux/kernel.h>               // for get_option, get_options, memp...
#include <linux/string.h>               // for skip_spaces
#include <stddef.h>                     // for NULL
#include "asm/string_32.h"              // for strlen, strncmp
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/kstrtox.h"              // for simple_strtoull, simple_strtol
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for bool
---
  ./scripts/check-local-export lib/cmdline.o
  iwyu2 -Wp,-MMD,lib/.ctype.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/ctype"' -DKBUILD_BASENAME='"ctype"' -DKBUILD_MODNAME='"ctype"' -D__KBUILD_MODNAME=kmod_ctype -c -o lib/ctype.o lib/ctype.c  

include/linux/ctype.h should add these lines:
#include "linux/compiler_types.h"  // for inline

include/linux/ctype.h should remove these lines:
- #include <linux/compiler.h>  // lines 5-5

The full include-list for include/linux/ctype.h:
#include "linux/compiler_types.h"  // for inline
---

lib/ctype.c should add these lines:

lib/ctype.c should remove these lines:
- #include <linux/compiler.h>  // lines 9-9

The full include-list for lib/ctype.c:
#include <linux/ctype.h>
#include <linux/export.h>  // for EXPORT_SYMBOL
---
  ./scripts/check-local-export lib/ctype.o
  iwyu2 -Wp,-MMD,lib/.dec_and_lock.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/dec_and_lock"' -DKBUILD_BASENAME='"dec_and_lock"' -DKBUILD_MODNAME='"dec_and_lock"' -D__KBUILD_MODNAME=kmod_dec_and_lock -c -o lib/dec_and_lock.o lib/dec_and_lock.c  

lib/dec_and_lock.c should add these lines:
#include "linux/atomic/atomic-instrumented.h"  // for atomic_add_unless, ato...
#include "linux/spinlock_types.h"              // for spinlock_t
#include "linux/types.h"                       // for atomic_t

lib/dec_and_lock.c should remove these lines:
- #include <linux/atomic.h>  // lines 4-4

The full include-list for lib/dec_and_lock.c:
#include <linux/export.h>                      // for EXPORT_SYMBOL
#include <linux/spinlock.h>                    // for spin_lock, spin_unlock
#include "linux/atomic/atomic-instrumented.h"  // for atomic_add_unless, ato...
#include "linux/spinlock_types.h"              // for spinlock_t
#include "linux/types.h"                       // for atomic_t
---
  ./scripts/check-local-export lib/dec_and_lock.o
  iwyu2 -Wp,-MMD,lib/.decompress.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/decompress"' -DKBUILD_BASENAME='"decompress"' -DKBUILD_MODNAME='"decompress"' -D__KBUILD_MODNAME=kmod_decompress -c -o lib/decompress.o lib/decompress.c  

lib/decompress.c should add these lines:
#include <stddef.h>                    // for NULL
#include "asm/string_32.h"             // for memcmp

lib/decompress.c should remove these lines:
- #include <linux/string.h>  // lines 19-19
- #include <linux/types.h>  // lines 18-18

The full include-list for lib/decompress.c:
#include <linux/decompress/generic.h>  // for decompress_fn, decompress_method
#include <linux/init.h>                // for __init, __initconst
#include <linux/printk.h>              // for pr_debug
#include <stddef.h>                    // for NULL
#include "asm/string_32.h"             // for memcmp
---
  ./scripts/check-local-export lib/decompress.o
  iwyu2 -Wp,-MMD,lib/.earlycpio.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/earlycpio"' -DKBUILD_BASENAME='"earlycpio"' -DKBUILD_MODNAME='"earlycpio"' -D__KBUILD_MODNAME=kmod_earlycpio -c -o lib/earlycpio.o lib/earlycpio.c  

include/linux/earlycpio.h should add these lines:
#include <stddef.h>  // for size_t

include/linux/earlycpio.h should remove these lines:
- #include <linux/types.h>  // lines 5-5

The full include-list for include/linux/earlycpio.h:
#include <stddef.h>  // for size_t
---

lib/earlycpio.c should add these lines:
#include "asm/string_32.h"  // for strlen, memcmp
#include "linux/align.h"    // for PTR_ALIGN
#include "linux/printk.h"   // for pr_warn

lib/earlycpio.c should remove these lines:
- #include <linux/kernel.h>  // lines 21-21

The full include-list for lib/earlycpio.c:
#include <linux/earlycpio.h>
#include <linux/string.h>   // for strlcpy
#include "asm/string_32.h"  // for strlen, memcmp
#include "linux/align.h"    // for PTR_ALIGN
#include "linux/printk.h"   // for pr_warn
---
  ./scripts/check-local-export lib/earlycpio.o
  iwyu2 -Wp,-MMD,lib/.extable.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/extable"' -DKBUILD_BASENAME='"extable"' -DKBUILD_MODNAME='"extable"' -D__KBUILD_MODNAME=kmod_extable -c -o lib/extable.o lib/extable.c  

lib/extable.c should add these lines:
#include <stddef.h>                // for size_t
#include "asm/extable.h"           // for exception_table_entry, ARCH_HAS_RE...
#include "linux/compiler_types.h"  // for inline

lib/extable.c should remove these lines:
- #include <linux/init.h>  // lines 10-10
- #include <linux/module.h>  // lines 9-9
- #include <linux/uaccess.h>  // lines 12-12

The full include-list for lib/extable.c:
#include <linux/bsearch.h>         // for bsearch
#include <linux/extable.h>         // for search_extable, sort_extable
#include <linux/sort.h>            // for sort
#include <stddef.h>                // for size_t
#include "asm/extable.h"           // for exception_table_entry, ARCH_HAS_RE...
#include "linux/compiler_types.h"  // for inline
---
  ./scripts/check-local-export lib/extable.o
  iwyu2 -Wp,-MMD,lib/.flex_proportions.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/flex_proportions"' -DKBUILD_BASENAME='"flex_proportions"' -DKBUILD_MODNAME='"flex_proportions"' -D__KBUILD_MODNAME=kmod_flex_proportions -c -o lib/flex_proportions.o lib/flex_proportions.c  

include/linux/flex_proportions.h should add these lines:
#include "linux/compiler_types.h"      // for inline
#include "linux/irqflags.h"            // for local_irq_restore, local_irq_save
#include "linux/spinlock_types_raw.h"  // for raw_spinlock_t, __RAW_SPIN_LOC...
#include "linux/types.h"               // for gfp_t, bool

include/linux/flex_proportions.h should remove these lines:
- #include <linux/gfp.h>  // lines 14-14
- #include <linux/spinlock.h>  // lines 12-12

The full include-list for include/linux/flex_proportions.h:
#include <linux/percpu_counter.h>      // for percpu_counter
#include <linux/seqlock.h>             // for seqcount_t
#include "linux/compiler_types.h"      // for inline
#include "linux/irqflags.h"            // for local_irq_restore, local_irq_save
#include "linux/spinlock_types_raw.h"  // for raw_spinlock_t, __RAW_SPIN_LOC...
#include "linux/types.h"               // for gfp_t, bool
---

lib/flex_proportions.c should add these lines:
#include "asm-generic/bitsperlong.h"  // for BITS_PER_LONG
#include "asm-generic/int-ll64.h"     // for s64, u64
#include "linux/compiler.h"           // for unlikely
#include "linux/cpumask.h"            // for nr_cpu_ids
#include "linux/log2.h"               // for ilog2
#include "linux/math64.h"             // for div_u64
#include "linux/percpu_counter.h"     // for percpu_counter_add, percpu_coun...
#include "linux/seqlock.h"            // for __seqprop_mutex_ptr, __seqprop_ptr
#include "linux/spinlock.h"           // for raw_spin_unlock_irqrestore, raw...
#include "linux/stddef.h"             // for false, true

lib/flex_proportions.c should remove these lines:

The full include-list for lib/flex_proportions.c:
#include <linux/flex_proportions.h>
#include "asm-generic/bitsperlong.h"  // for BITS_PER_LONG
#include "asm-generic/int-ll64.h"     // for s64, u64
#include "linux/compiler.h"           // for unlikely
#include "linux/cpumask.h"            // for nr_cpu_ids
#include "linux/log2.h"               // for ilog2
#include "linux/math64.h"             // for div_u64
#include "linux/percpu_counter.h"     // for percpu_counter_add, percpu_coun...
#include "linux/seqlock.h"            // for __seqprop_mutex_ptr, __seqprop_ptr
#include "linux/spinlock.h"           // for raw_spin_unlock_irqrestore, raw...
#include "linux/stddef.h"             // for false, true
---
  ./scripts/check-local-export lib/flex_proportions.o
  iwyu2 -Wp,-MMD,lib/.idr.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/idr"' -DKBUILD_BASENAME='"idr"' -DKBUILD_MODNAME='"idr"' -D__KBUILD_MODNAME=kmod_idr -c -o lib/idr.o lib/idr.c  

lib/idr.c should add these lines:
#include <asm/bitops.h>              // for __set_bit, __clear_bit, test_bit
#include <asm/bug.h>                 // for WARN_ON_ONCE, WARN
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for ENOSPC, EINVAL, ENOENT, ENOMEM
#include "asm-generic/int-ll64.h"    // for u32
#include "linux/compiler_types.h"    // for __rcu
#include "linux/err.h"               // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/gfp.h"               // for GFP_NOWAIT
#include "linux/radix-tree.h"        // for radix_tree_iter, __radix_tree_lo...
#include "linux/rcupdate.h"          // for rcu_dereference_raw
#include "linux/types.h"             // for gfp_t
#include "vdso/limits.h"             // for INT_MAX, ULONG_MAX

lib/idr.c should remove these lines:
- #include <linux/bug.h>  // lines 3-3
- #include <linux/spinlock.h>  // lines 7-7

The full include-list for lib/idr.c:
#include <asm/bitops.h>              // for __set_bit, __clear_bit, test_bit
#include <asm/bug.h>                 // for WARN_ON_ONCE, WARN
#include <linux/bitmap.h>            // for find_next_zero_bit, bitmap_empty
#include <linux/export.h>            // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/idr.h>               // for idr, IDA_BITMAP_BITS, ida_bitmap
#include <linux/slab.h>              // for kfree, kzalloc
#include <linux/xarray.h>            // for xas_store, xa_is_value, xa_mk_value
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for ENOSPC, EINVAL, ENOENT, ENOMEM
#include "asm-generic/int-ll64.h"    // for u32
#include "linux/compiler_types.h"    // for __rcu
#include "linux/err.h"               // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/gfp.h"               // for GFP_NOWAIT
#include "linux/radix-tree.h"        // for radix_tree_iter, __radix_tree_lo...
#include "linux/rcupdate.h"          // for rcu_dereference_raw
#include "linux/types.h"             // for gfp_t
#include "vdso/limits.h"             // for INT_MAX, ULONG_MAX
---
  ./scripts/check-local-export lib/idr.o
  iwyu2 -Wp,-MMD,lib/.irq_regs.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/irq_regs"' -DKBUILD_BASENAME='"irq_regs"' -DKBUILD_MODNAME='"irq_regs"' -D__KBUILD_MODNAME=kmod_irq_regs -c -o lib/irq_regs.o lib/irq_regs.c  

lib/irq_regs.c should add these lines:
#include <asm-generic/percpu.h>  // for DEFINE_PER_CPU, EXPORT_PER_CPU_SYMBOL

lib/irq_regs.c should remove these lines:
- #include <asm/irq_regs.h>  // lines 9-9
- #include <linux/export.h>  // lines 7-7
- #include <linux/percpu.h>  // lines 8-8

The full include-list for lib/irq_regs.c:
#include <asm-generic/percpu.h>  // for DEFINE_PER_CPU, EXPORT_PER_CPU_SYMBOL
---
  ./scripts/check-local-export lib/irq_regs.o
  iwyu2 -Wp,-MMD,lib/.is_single_threaded.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/is_single_threaded"' -DKBUILD_BASENAME='"is_single_threaded"' -DKBUILD_MODNAME='"is_single_threaded"' -D__KBUILD_MODNAME=kmod_is_single_threaded -c -o lib/is_single_threaded.o lib/is_single_threaded.c  

lib/is_single_threaded.c should add these lines:
#include <asm/barrier.h>                       // for smp_rmb
#include "asm/current.h"                       // for current
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read
#include "linux/compiler.h"                    // for unlikely, likely
#include "linux/mm_types.h"                    // for mm_struct, mm_struct::...
#include "linux/rcupdate.h"                    // for rcu_read_lock, rcu_rea...
#include "linux/sched.h"                       // for task_struct, PF_KTHREAD
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for list_head, bool

lib/is_single_threaded.c should remove these lines:
- #include <linux/sched/mm.h>  // lines 10-10
- #include <linux/sched/task.h>  // lines 9-9

The full include-list for lib/is_single_threaded.c:
#include <asm/barrier.h>                       // for smp_rmb
#include <linux/sched/signal.h>                // for current_is_single_thre...
#include "asm/current.h"                       // for current
#include "linux/atomic/atomic-instrumented.h"  // for atomic_read
#include "linux/compiler.h"                    // for unlikely, likely
#include "linux/mm_types.h"                    // for mm_struct, mm_struct::...
#include "linux/rcupdate.h"                    // for rcu_read_lock, rcu_rea...
#include "linux/sched.h"                       // for task_struct, PF_KTHREAD
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for list_head, bool
---
  ./scripts/check-local-export lib/is_single_threaded.o
  iwyu2 -Wp,-MMD,lib/.klist.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/klist"' -DKBUILD_BASENAME='"klist"' -DKBUILD_MODNAME='"klist"' -D__KBUILD_MODNAME=kmod_klist -c -o lib/klist.o lib/klist.c  

include/linux/klist.h should add these lines:
#include "linux/spinlock_types.h"  // for __SPIN_LOCK_UNLOCKED, spinlock_t
#include "linux/types.h"           // for list_head

include/linux/klist.h should remove these lines:
- #include <linux/spinlock.h>  // lines 13-13

The full include-list for include/linux/klist.h:
#include <linux/kref.h>            // for kref
#include <linux/list.h>            // for LIST_HEAD_INIT
#include "linux/spinlock_types.h"  // for __SPIN_LOCK_UNLOCKED, spinlock_t
#include "linux/types.h"           // for list_head
struct klist_node;  // lines 17-17
---

lib/klist.c should add these lines:
#include <asm/bug.h>             // for WARN_ON
#include <stddef.h>              // for NULL
#include "asm/barrier.h"         // for mb
#include "asm/current.h"         // for current
#include "linux/compiler.h"      // for likely
#include "linux/container_of.h"  // for container_of
#include "linux/kref.h"          // for kref_get, kref_get_unless_zero, kref...
#include "linux/list.h"          // for list_add, INIT_LIST_HEAD, list_add_tail
#include "linux/spinlock.h"      // for spin_lock, spin_unlock, spin_unlock_...
#include "linux/stddef.h"        // for false, true

lib/klist.c should remove these lines:

The full include-list for lib/klist.c:
#include <linux/klist.h>
#include <asm/bug.h>             // for WARN_ON
#include <linux/export.h>        // for EXPORT_SYMBOL_GPL
#include <linux/sched.h>         // for task_struct, schedule, wake_up_process
#include <stddef.h>              // for NULL
#include "asm/barrier.h"         // for mb
#include "asm/current.h"         // for current
#include "linux/compiler.h"      // for likely
#include "linux/container_of.h"  // for container_of
#include "linux/kref.h"          // for kref_get, kref_get_unless_zero, kref...
#include "linux/list.h"          // for list_add, INIT_LIST_HEAD, list_add_tail
#include "linux/spinlock.h"      // for spin_lock, spin_unlock, spin_unlock_...
#include "linux/stddef.h"        // for false, true
---
  ./scripts/check-local-export lib/klist.o
  iwyu2 -Wp,-MMD,lib/.kobject.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/kobject"' -DKBUILD_BASENAME='"kobject"' -DKBUILD_MODNAME='"kobject"' -D__KBUILD_MODNAME=kmod_kobject -c -o lib/kobject.o lib/kobject.c  

include/linux/kobject.h should add these lines:
#include <cstdio>                       // for NULL, size_t, ssize_t, va_list
#include "asm-generic/int-ll64.h"       // for u64
#include "linux/compiler_attributes.h"  // for __must_check, __printf
#include "linux/compiler_types.h"       // for inline, __randomize_layout
#include "linux/spinlock_types.h"       // for spinlock_t
struct kobj_type;

include/linux/kobject.h should remove these lines:
- #include <linux/atomic.h>  // lines 27-27
- #include <linux/compiler.h>  // lines 21-21
- #include <linux/kobject_ns.h>  // lines 25-25
- #include <linux/list.h>  // lines 19-19
- #include <linux/spinlock.h>  // lines 23-23
- #include <linux/wait.h>  // lines 26-26
- #include <linux/workqueue.h>  // lines 28-28
- struct sock;  // lines 146-146

The full include-list for include/linux/kobject.h:
#include <linux/container_of.h>         // for container_of
#include <linux/kref.h>                 // for kref
#include <linux/sysfs.h>                // for attribute, sysfs_ops
#include <linux/types.h>                // for list_head, gfp_t
#include <linux/uidgid.h>               // for kgid_t, kuid_t
#include <cstdio>                       // for NULL, size_t, ssize_t, va_list
#include "asm-generic/int-ll64.h"       // for u64
#include "linux/compiler_attributes.h"  // for __must_check, __printf
#include "linux/compiler_types.h"       // for inline, __randomize_layout
#include "linux/spinlock_types.h"       // for spinlock_t
struct kobj_type;
---

lib/kobject.c should add these lines:
#include <asm/bug.h>                 // for BUG_ON, WARN
#include "asm-generic/errno-base.h"  // for EINVAL, ENOMEM, EIO, EBUSY, EEXIST
#include "asm/string_32.h"           // for strlen, strchr, strcmp, memcpy
#include "linux/container_of.h"      // for container_of
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/kern_levels.h"       // for KERN_WARNING
#include "linux/kernel.h"            // for sprintf, kvasprintf_const
#include "linux/kobject_ns.h"        // for kobj_ns_type_operations, KOBJ_NS...
#include "linux/kref.h"              // for kref_get, kref_get_unless_zero
#include "linux/list.h"              // for INIT_LIST_HEAD, list_add_tail
#include "linux/printk.h"            // for pr_debug, dump_stack, pr_err
#include "linux/spinlock.h"          // for spin_lock, spin_unlock, spin_loc...
#include "linux/stdarg.h"            // for va_end, va_start
#include "linux/stddef.h"            // for true
#include "linux/sysfs.h"             // for sysfs_remove_dir, sysfs_create_d...
#include "linux/types.h"             // for list_head, bool, gfp_t
#include "linux/uidgid.h"            // for kgid_t, kuid_t, GLOBAL_ROOT_GID

lib/kobject.c should remove these lines:
- #include <linux/random.h>  // lines 18-18
- #include <linux/stat.h>  // lines 16-16

The full include-list for lib/kobject.c:
#include <linux/kobject.h>
#include <asm/bug.h>                 // for BUG_ON, WARN
#include <linux/export.h>            // for EXPORT_SYMBOL_GPL, EXPORT_SYMBOL
#include <linux/slab.h>              // for kfree, kzalloc, kmalloc
#include <linux/string.h>            // for kfree_const, kstrdup, kstrdup_const
#include "asm-generic/errno-base.h"  // for EINVAL, ENOMEM, EIO, EBUSY, EEXIST
#include "asm/string_32.h"           // for strlen, strchr, strcmp, memcpy
#include "linux/container_of.h"      // for container_of
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/kern_levels.h"       // for KERN_WARNING
#include "linux/kernel.h"            // for sprintf, kvasprintf_const
#include "linux/kobject_ns.h"        // for kobj_ns_type_operations, KOBJ_NS...
#include "linux/kref.h"              // for kref_get, kref_get_unless_zero
#include "linux/list.h"              // for INIT_LIST_HEAD, list_add_tail
#include "linux/printk.h"            // for pr_debug, dump_stack, pr_err
#include "linux/spinlock.h"          // for spin_lock, spin_unlock, spin_loc...
#include "linux/stdarg.h"            // for va_end, va_start
#include "linux/stddef.h"            // for true
#include "linux/sysfs.h"             // for sysfs_remove_dir, sysfs_create_d...
#include "linux/types.h"             // for list_head, bool, gfp_t
#include "linux/uidgid.h"            // for kgid_t, kuid_t, GLOBAL_ROOT_GID
---
  ./scripts/check-local-export lib/kobject.o
  iwyu2 -Wp,-MMD,lib/.kobject_uevent.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/kobject_uevent"' -DKBUILD_BASENAME='"kobject_uevent"' -DKBUILD_MODNAME='"kobject_uevent"' -D__KBUILD_MODNAME=kmod_kobject_uevent -c -o lib/kobject_uevent.o lib/kobject_uevent.c  
In file included from lib/kobject_uevent.c:23:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/kobject_uevent.c:23:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/kobject_uevent.c:23:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from lib/kobject_uevent.c:23:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from lib/kobject_uevent.c:28:
In file included from ./include/net/sock.h:46:
./include/linux/netdevice.h:1243:17: warning: declaration of 'struct rtnl_link_stats64' will not be visible outside of this function [-Wvisibility]
                                                   struct rtnl_link_stats64 *storage);
                                                          ^
./include/linux/netdevice.h:1268:19: warning: declaration of 'struct ifla_vf_info' will not be visible outside of this function [-Wvisibility]
                                                     struct ifla_vf_info *ivf);
                                                            ^
./include/linux/netdevice.h:1273:18: warning: declaration of 'struct ifla_vf_stats' will not be visible outside of this function [-Wvisibility]
                                                    struct ifla_vf_stats
                                                           ^
./include/linux/netdevice.h:1282:17: warning: declaration of 'struct ifla_vf_guid' will not be visible outside of this function [-Wvisibility]
                                                   struct ifla_vf_guid *node_guid,
                                                          ^
In file included from lib/kobject_uevent.c:28:
In file included from ./include/net/sock.h:53:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
9 warnings generated.
In file included from lib/kobject_uevent.c:23:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/kobject_uevent.c:23:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/kobject_uevent.c:23:
In file included from ./include/linux/skbuff.h:31:
In file included from ./include/linux/dma-mapping.h:7:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from lib/kobject_uevent.c:23:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from lib/kobject_uevent.c:28:
In file included from ./include/net/sock.h:46:
./include/linux/netdevice.h:1243:17: warning: declaration of 'struct rtnl_link_stats64' will not be visible outside of this function [-Wvisibility]
                                                   struct rtnl_link_stats64 *storage);
                                                          ^
./include/linux/netdevice.h:1268:19: warning: declaration of 'struct ifla_vf_info' will not be visible outside of this function [-Wvisibility]
                                                     struct ifla_vf_info *ivf);
                                                            ^
./include/linux/netdevice.h:1273:18: warning: declaration of 'struct ifla_vf_stats' will not be visible outside of this function [-Wvisibility]
                                                    struct ifla_vf_stats
                                                           ^
./include/linux/netdevice.h:1282:17: warning: declaration of 'struct ifla_vf_guid' will not be visible outside of this function [-Wvisibility]
                                                   struct ifla_vf_guid *node_guid,
                                                          ^
In file included from lib/kobject_uevent.c:28:
In file included from ./include/net/sock.h:53:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^

lib/kobject_uevent.c should add these lines:
#include <asm/bug.h>                 // for WARN
#include <cstdio>                    // for NULL, size_t, va_list
#include "asm-generic/errno-base.h"  // for EINVAL, ENOMEM, ENOENT
#include "asm-generic/int-ll64.h"    // for u64
#include "asm/string_32.h"           // for strncmp, memmove, strlen
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/kern_levels.h"       // for KERN_ERR
#include "linux/kernel.h"            // for vsnprintf, ARRAY_SIZE
#include "linux/mutex.h"             // for mutex, mutex_unlock, mutex_lock
#include "linux/printk.h"            // for pr_debug, pr_warn
#include "linux/stdarg.h"            // for va_end, va_start
#include "linux/types.h"             // for list_head

lib/kobject_uevent.c should remove these lines:
- #include <linux/kmod.h>  // lines 20-20
- #include <linux/netlink.h>  // lines 24-24
- #include <linux/skbuff.h>  // lines 23-23
- #include <linux/socket.h>  // lines 22-22
- #include <linux/spinlock.h>  // lines 16-16
- #include <linux/uidgid.h>  // lines 25-25
- #include <net/net_namespace.h>  // lines 30-30
- #include <net/netlink.h>  // lines 29-29
- #include <net/sock.h>  // lines 28-28

The full include-list for lib/kobject_uevent.c:
#include <asm/bug.h>                 // for WARN
#include <linux/ctype.h>             // for isalnum
#include <linux/export.h>            // for EXPORT_SYMBOL_GPL
#include <linux/kobject.h>           // for kobj_uevent_env, kobject_name
#include <linux/slab.h>              // for kfree, kzalloc
#include <linux/string.h>            // for strnchr
#include <linux/uuid.h>              // for UUID_STRING_LEN, uuid_is_valid
#include <cstdio>                    // for NULL, size_t, va_list
#include "asm-generic/errno-base.h"  // for EINVAL, ENOMEM, ENOENT
#include "asm-generic/int-ll64.h"    // for u64
#include "asm/string_32.h"           // for strncmp, memmove, strlen
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/kern_levels.h"       // for KERN_ERR
#include "linux/kernel.h"            // for vsnprintf, ARRAY_SIZE
#include "linux/mutex.h"             // for mutex, mutex_unlock, mutex_lock
#include "linux/printk.h"            // for pr_debug, pr_warn
#include "linux/stdarg.h"            // for va_end, va_start
#include "linux/types.h"             // for list_head
---
  ./scripts/check-local-export lib/kobject_uevent.o
  iwyu2 -Wp,-MMD,lib/.logic_pio.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/logic_pio"' -DKBUILD_BASENAME='"logic_pio"' -DKBUILD_MODNAME='"logic_pio"' -D__KBUILD_MODNAME=kmod_logic_pio -c -o lib/logic_pio.o lib/logic_pio.c  

lib/logic_pio.c should add these lines:
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for E2BIG, EINVAL, EEXIST, EFAULT
#include "asm/io.h"                  // for IO_SPACE_LIMIT
#include "linux/list.h"              // for LIST_HEAD, list_for_each_entry
#include "linux/mutex.h"             // for mutex, mutex_lock, mutex_unlock
#include "linux/printk.h"            // for pr_err, pr_warn
#include "linux/rcupdate.h"          // for rcu_read_unlock, rcu_read_lock
#include "linux/types.h"             // for list_head, resource_size_t
struct fwnode_handle;

lib/logic_pio.c should remove these lines:
- #include <linux/io.h>  // lines 12-12
- #include <linux/mm.h>  // lines 14-14
- #include <linux/of.h>  // lines 11-11
- #include <linux/slab.h>  // lines 17-17

The full include-list for lib/logic_pio.c:
#include <linux/logic_pio.h>         // for logic_pio_hwaddr, LOGIC_PIO_CPU_...
#include <linux/rculist.h>           // for list_add_tail_rcu, list_del_rcu
#include <linux/sizes.h>             // for SZ_64K
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for E2BIG, EINVAL, EEXIST, EFAULT
#include "asm/io.h"                  // for IO_SPACE_LIMIT
#include "linux/list.h"              // for LIST_HEAD, list_for_each_entry
#include "linux/mutex.h"             // for mutex, mutex_lock, mutex_unlock
#include "linux/printk.h"            // for pr_err, pr_warn
#include "linux/rcupdate.h"          // for rcu_read_unlock, rcu_read_lock
#include "linux/types.h"             // for list_head, resource_size_t
struct fwnode_handle;
---
  ./scripts/check-local-export lib/logic_pio.o
  iwyu2 -Wp,-MMD,lib/.memcat_p.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/memcat_p"' -DKBUILD_BASENAME='"memcat_p"' -DKBUILD_MODNAME='"memcat_p"' -D__KBUILD_MODNAME=kmod_memcat_p -c -o lib/memcat_p.o lib/memcat_p.c  

lib/memcat_p.c should add these lines:
#include <stddef.h>        // for NULL
#include "linux/export.h"  // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"     // for GFP_KERNEL
#include "linux/string.h"  // for __memcat_p

lib/memcat_p.c should remove these lines:

The full include-list for lib/memcat_p.c:
#include <linux/slab.h>    // for kmalloc_array
#include <stddef.h>        // for NULL
#include "linux/export.h"  // for EXPORT_SYMBOL_GPL
#include "linux/gfp.h"     // for GFP_KERNEL
#include "linux/string.h"  // for __memcat_p
---
  ./scripts/check-local-export lib/memcat_p.o
  iwyu2 -Wp,-MMD,lib/.nmi_backtrace.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/nmi_backtrace"' -DKBUILD_BASENAME='"nmi_backtrace"' -DKBUILD_MODNAME='"nmi_backtrace"' -D__KBUILD_MODNAME=kmod_nmi_backtrace -c -o lib/nmi_backtrace.o lib/nmi_backtrace.c  
In file included from lib/nmi_backtrace.c:20:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/nmi_backtrace.c:20:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/nmi_backtrace.c:20:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from lib/nmi_backtrace.c:20:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/nmi_backtrace.c:20:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/nmi_backtrace.c:20:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

lib/nmi_backtrace.c should add these lines:

lib/nmi_backtrace.c should remove these lines:
- #include <linux/cpu.h>  // lines 20-20
- #include <linux/cpumask.h>  // lines 16-16
- #include <linux/delay.h>  // lines 17-17
- #include <linux/kprobes.h>  // lines 18-18
- #include <linux/nmi.h>  // lines 19-19
- #include <linux/sched/debug.h>  // lines 21-21

The full include-list for lib/nmi_backtrace.c:
---
  ./scripts/check-local-export lib/nmi_backtrace.o
  iwyu2 -Wp,-MMD,lib/.nodemask.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/nodemask"' -DKBUILD_BASENAME='"nodemask"' -DKBUILD_MODNAME='"nodemask"' -D__KBUILD_MODNAME=kmod_nodemask -c -o lib/nodemask.o lib/nodemask.c  

include/linux/nodemask.h should add these lines:
#include <stddef.h>                                  // for NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/bitsperlong.h"                 // for BITS_PER_LONG
#include "linux/bitops.h"                            // for BITS_TO_LONGS
#include "linux/compiler_attributes.h"               // for __always_inline
#include "linux/compiler_types.h"                    // for inline, __user
#include "linux/types.h"                             // for bool, DECLARE_BI...

include/linux/nodemask.h should remove these lines:
- #include <linux/threads.h>  // lines 93-93

The full include-list for include/linux/nodemask.h:
#include <linux/bitmap.h>                            // for find_first_bit
#include <linux/minmax.h>                            // for min_t
#include <linux/numa.h>                              // for MAX_NUMNODES
#include <stddef.h>                                  // for NULL
#include "asm-generic/bitops/instrumented-atomic.h"  // for clear_bit, set_bit
#include "asm-generic/bitsperlong.h"                 // for BITS_PER_LONG
#include "linux/bitops.h"                            // for BITS_TO_LONGS
#include "linux/compiler_attributes.h"               // for __always_inline
#include "linux/compiler_types.h"                    // for inline, __user
#include "linux/types.h"                             // for bool, DECLARE_BI...
---

lib/nodemask.c should add these lines:
#include "linux/export.h"  // for EXPORT_SYMBOL
#include "linux/numa.h"    // for MAX_NUMNODES

lib/nodemask.c should remove these lines:
- #include <linux/module.h>  // lines 3-3
- #include <linux/random.h>  // lines 4-4

The full include-list for lib/nodemask.c:
#include <linux/nodemask.h>
#include "linux/export.h"  // for EXPORT_SYMBOL
#include "linux/numa.h"    // for MAX_NUMNODES
---
  ./scripts/check-local-export lib/nodemask.o
  iwyu2 -Wp,-MMD,lib/.plist.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/plist"' -DKBUILD_BASENAME='"plist"' -DKBUILD_MODNAME='"plist"' -D__KBUILD_MODNAME=kmod_plist -c -o lib/plist.o lib/plist.c  

lib/plist.c should add these lines:
#include <asm/bug.h>      // for BUG_ON, WARN_ON
#include <stddef.h>       // for NULL
#include "linux/list.h"   // for list_add_tail, list_empty, list_del_init
#include "linux/types.h"  // for list_head

lib/plist.c should remove these lines:
- #include <linux/bug.h>  // lines 25-25

The full include-list for lib/plist.c:
#include <asm/bug.h>      // for BUG_ON, WARN_ON
#include <linux/plist.h>  // for plist_node, plist_head_empty, plist_node_empty
#include <stddef.h>       // for NULL
#include "linux/list.h"   // for list_add_tail, list_empty, list_del_init
#include "linux/types.h"  // for list_head
---
  ./scripts/check-local-export lib/plist.o
  iwyu2 -Wp,-MMD,lib/.radix-tree.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/radix-tree"' -DKBUILD_BASENAME='"radix_tree"' -DKBUILD_MODNAME='"radix_tree"' -D__KBUILD_MODNAME=kmod_radix_tree -c -o lib/radix-tree.o lib/radix-tree.c  
In file included from lib/radix-tree.c:15:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/radix-tree.c:15:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/radix-tree.c:15:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from lib/radix-tree.c:15:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/radix-tree.c:15:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/radix-tree.c:15:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

lib/radix-tree.c should add these lines:
#include <asm-generic/percpu.h>         // for this_cpu_ptr, DEFINE_PER_CPU
#include <asm/bitops.h>                 // for __clear_bit, __set_bit, test_bit
#include <asm/bug.h>                    // for BUG_ON, WARN_ON_ONCE, WARN_ON
#include <linux/local_lock.h>           // for INIT_LOCAL_LOCK
#include <stddef.h>                     // for NULL
#include "asm-generic/bitsperlong.h"    // for BITS_PER_LONG
#include "asm-generic/errno-base.h"     // for ENOMEM, ENOSPC, EEXIST
#include "asm/string_32.h"              // for memset
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/compiler.h"             // for unlikely, likely
#include "linux/compiler_attributes.h"  // for __always_inline, __must_check
#include "linux/compiler_types.h"       // for __rcu, inline, __force
#include "linux/container_of.h"         // for container_of
#include "linux/cpuhotplug.h"           // for cpuhp_setup_state_nocalls
#include "linux/err.h"                  // for ERR_PTR
#include "linux/gfp.h"                  // for gfpflags_allow_blocking, GFP_...
#include "linux/list.h"                 // for list_empty, INIT_LIST_HEAD
#include "linux/local_lock.h"           // for local_lock, local_unlock
#include "linux/math.h"                 // for DIV_ROUND_UP
#include "linux/minmax.h"               // for max, min
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for gfp_t, bool, rcu_head

lib/radix-tree.c should remove these lines:
- #include <linux/bug.h>  // lines 14-14
- #include <linux/cpu.h>  // lines 15-15
- #include <linux/errno.h>  // lines 16-16
- #include <linux/kernel.h>  // lines 20-20
- #include <linux/percpu.h>  // lines 22-22
- #include <linux/string.h>  // lines 27-27

The full include-list for lib/radix-tree.c:
#include <asm-generic/percpu.h>         // for this_cpu_ptr, DEFINE_PER_CPU
#include <asm/bitops.h>                 // for __clear_bit, __set_bit, test_bit
#include <asm/bug.h>                    // for BUG_ON, WARN_ON_ONCE, WARN_ON
#include <linux/bitmap.h>               // for bitmap_fill
#include <linux/bitops.h>               // for __ffs
#include <linux/export.h>               // for EXPORT_SYMBOL
#include <linux/idr.h>                  // for IDR_FREE, idr, idr_destroy
#include <linux/init.h>                 // for __init
#include <linux/kmemleak.h>             // for kmemleak_update_trace
#include <linux/local_lock.h>           // for INIT_LOCAL_LOCK
#include <linux/preempt.h>              // for in_interrupt
#include <linux/radix-tree.h>           // for radix_tree_is_internal_node
#include <linux/rcupdate.h>             // for rcu_dereference_raw, rcu_assi...
#include <linux/slab.h>                 // for kmem_cache_alloc, kmem_cache_...
#include <linux/xarray.h>               // for xa_node, xarray, xa_is_value
#include <stddef.h>                     // for NULL
#include "asm-generic/bitsperlong.h"    // for BITS_PER_LONG
#include "asm-generic/errno-base.h"     // for ENOMEM, ENOSPC, EEXIST
#include "asm/string_32.h"              // for memset
#include "linux/build_bug.h"            // for BUILD_BUG_ON
#include "linux/compiler.h"             // for unlikely, likely
#include "linux/compiler_attributes.h"  // for __always_inline, __must_check
#include "linux/compiler_types.h"       // for __rcu, inline, __force
#include "linux/container_of.h"         // for container_of
#include "linux/cpuhotplug.h"           // for cpuhp_setup_state_nocalls
#include "linux/err.h"                  // for ERR_PTR
#include "linux/gfp.h"                  // for gfpflags_allow_blocking, GFP_...
#include "linux/list.h"                 // for list_empty, INIT_LIST_HEAD
#include "linux/local_lock.h"           // for local_lock, local_unlock
#include "linux/math.h"                 // for DIV_ROUND_UP
#include "linux/minmax.h"               // for max, min
#include "linux/stddef.h"               // for false, true
#include "linux/types.h"                // for gfp_t, bool, rcu_head
---
  ./scripts/check-local-export lib/radix-tree.o
  iwyu2 -Wp,-MMD,lib/.ratelimit.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/ratelimit"' -DKBUILD_BASENAME='"ratelimit"' -DKBUILD_MODNAME='"ratelimit"' -D__KBUILD_MODNAME=kmod_ratelimit -c -o lib/ratelimit.o lib/ratelimit.c  

include/linux/ratelimit.h should add these lines:
#include <asm/bug.h>                // for WARN, WARN_ON
#include "asm/current.h"            // for current
#include "asm/string_32.h"          // for memset
#include "linux/compiler_types.h"   // for inline
#include "linux/printk.h"           // for pr_warn

include/linux/ratelimit.h should remove these lines:

The full include-list for include/linux/ratelimit.h:
#include <asm/bug.h>                // for WARN, WARN_ON
#include <linux/ratelimit_types.h>  // for ratelimit_state, DEFAULT_RATELIMI...
#include <linux/sched.h>            // for task_struct
#include <linux/spinlock.h>         // for raw_spin_lock_init
#include "asm/current.h"            // for current
#include "asm/string_32.h"          // for memset
#include "linux/compiler_types.h"   // for inline
#include "linux/printk.h"           // for pr_warn
---

lib/ratelimit.c should add these lines:
#include "linux/kern_levels.h"      // for KERN_WARNING
#include "linux/ratelimit_types.h"  // for ratelimit_state, RATELIMIT_MSG_ON...
#include "linux/spinlock.h"         // for raw_spin_trylock_irqsave, raw_spi...

lib/ratelimit.c should remove these lines:

The full include-list for lib/ratelimit.c:
#include <linux/ratelimit.h>
#include <linux/export.h>           // for EXPORT_SYMBOL
#include <linux/jiffies.h>          // for jiffies, time_is_before_jiffies
#include "linux/kern_levels.h"      // for KERN_WARNING
#include "linux/ratelimit_types.h"  // for ratelimit_state, RATELIMIT_MSG_ON...
#include "linux/spinlock.h"         // for raw_spin_trylock_irqsave, raw_spi...
---
  ./scripts/check-local-export lib/ratelimit.o
  iwyu2 -Wp,-MMD,lib/.rbtree.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/rbtree"' -DKBUILD_BASENAME='"rbtree"' -DKBUILD_MODNAME='"rbtree"' -D__KBUILD_MODNAME=kmod_rbtree -c -o lib/rbtree.o lib/rbtree.c  

lib/rbtree.c should add these lines:
#include <stddef.h>                     // for NULL
#include "asm-generic/rwonce.h"         // for WRITE_ONCE
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __always_inline
#include "linux/compiler_types.h"       // for inline
#include "linux/rbtree.h"               // for rb_parent, RB_EMPTY_NODE, rb_...
#include "linux/rbtree_types.h"         // for rb_node, rb_root
#include "linux/stddef.h"               // for true

lib/rbtree.c should remove these lines:

The full include-list for lib/rbtree.c:
#include <linux/export.h>               // for EXPORT_SYMBOL
#include <linux/rbtree_augmented.h>     // for rb_set_parent_color, RB_BLACK
#include <stddef.h>                     // for NULL
#include "asm-generic/rwonce.h"         // for WRITE_ONCE
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __always_inline
#include "linux/compiler_types.h"       // for inline
#include "linux/rbtree.h"               // for rb_parent, RB_EMPTY_NODE, rb_...
#include "linux/rbtree_types.h"         // for rb_node, rb_root
#include "linux/stddef.h"               // for true
---
  ./scripts/check-local-export lib/rbtree.o
  iwyu2 -Wp,-MMD,lib/.seq_buf.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/seq_buf"' -DKBUILD_BASENAME='"seq_buf"' -DKBUILD_MODNAME='"seq_buf"' -D__KBUILD_MODNAME=kmod_seq_buf -c -o lib/seq_buf.o lib/seq_buf.c  

lib/seq_buf.c should add these lines:
#include <asm/bug.h>                 // for WARN_ON, WARN_ON_ONCE
#include <cstdio>                    // for size_t, va_list
#include "asm-generic/errno-base.h"  // for EBUSY, EFAULT
#include "asm-generic/int-ll64.h"    // for u8
#include "asm/string_32.h"           // for strlen, memcpy
#include "linux/build_bug.h"         // for BUILD_BUG_ON
#include "linux/compiler_types.h"    // for __user
#include "linux/dcache.h"            // for d_path
#include "linux/err.h"               // for IS_ERR
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/kernel.h"            // for vsnprintf, hex_asc_hi, hex_asc_lo
#include "linux/minmax.h"            // for min
#include "linux/printk.h"            // for hex_dump_to_buffer, DUMP_PREFIX_...
#include "linux/stdarg.h"            // for va_end, va_start
#include "linux/types.h"             // for bool
struct path;

lib/seq_buf.c should remove these lines:

The full include-list for lib/seq_buf.c:
#include <asm/bug.h>                 // for WARN_ON, WARN_ON_ONCE
#include <linux/seq_buf.h>           // for seq_buf, seq_buf_set_overflow
#include <linux/seq_file.h>          // for mangle_path, seq_write
#include <linux/uaccess.h>           // for copy_to_user
#include <cstdio>                    // for size_t, va_list
#include "asm-generic/errno-base.h"  // for EBUSY, EFAULT
#include "asm-generic/int-ll64.h"    // for u8
#include "asm/string_32.h"           // for strlen, memcpy
#include "linux/build_bug.h"         // for BUILD_BUG_ON
#include "linux/compiler_types.h"    // for __user
#include "linux/dcache.h"            // for d_path
#include "linux/err.h"               // for IS_ERR
#include "linux/export.h"            // for EXPORT_SYMBOL_GPL
#include "linux/kernel.h"            // for vsnprintf, hex_asc_hi, hex_asc_lo
#include "linux/minmax.h"            // for min
#include "linux/printk.h"            // for hex_dump_to_buffer, DUMP_PREFIX_...
#include "linux/stdarg.h"            // for va_end, va_start
#include "linux/types.h"             // for bool
struct path;
---
  ./scripts/check-local-export lib/seq_buf.o
  iwyu2 -Wp,-MMD,lib/.sha1.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/sha1"' -DKBUILD_BASENAME='"sha1"' -DKBUILD_MODNAME='"sha1"' -D__KBUILD_MODNAME=kmod_sha1 -c -o lib/sha1.o lib/sha1.c  

lib/sha1.c should add these lines:
#include "asm-generic/int-ll64.h"   // for __u32
#include "asm-generic/unaligned.h"  // for get_unaligned_be32

lib/sha1.c should remove these lines:
- #include <asm/unaligned.h>  // lines 14-14
- #include <linux/kernel.h>  // lines 9-9
- #include <linux/string.h>  // lines 12-12

The full include-list for lib/sha1.c:
#include <crypto/sha1.h>            // for sha1_init, sha1_transform
#include <linux/bitops.h>           // for rol32, ror32
#include <linux/export.h>           // for EXPORT_SYMBOL
#include "asm-generic/int-ll64.h"   // for __u32
#include "asm-generic/unaligned.h"  // for get_unaligned_be32
---
  ./scripts/check-local-export lib/sha1.o
  iwyu2 -Wp,-MMD,lib/.show_mem.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/show_mem"' -DKBUILD_BASENAME='"show_mem"' -DKBUILD_MODNAME='"show_mem"' -D__KBUILD_MODNAME=kmod_show_mem -c -o lib/show_mem.o lib/show_mem.c  

lib/show_mem.c should add these lines:
#include "generated/bounds.h"  // for MAX_NR_ZONES
#include "linux/mmzone.h"      // for zone, is_highmem_idx, populated_zone
#include "linux/nodemask.h"    // for nodemask_t
#include "linux/printk.h"      // for printk

lib/show_mem.c should remove these lines:

The full include-list for lib/show_mem.c:
#include <linux/mm.h>          // for show_free_areas, show_mem
#include "generated/bounds.h"  // for MAX_NR_ZONES
#include "linux/mmzone.h"      // for zone, is_highmem_idx, populated_zone
#include "linux/nodemask.h"    // for nodemask_t
#include "linux/printk.h"      // for printk
---
  ./scripts/check-local-export lib/show_mem.o
  iwyu2 -Wp,-MMD,lib/.siphash.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/siphash"' -DKBUILD_BASENAME='"siphash"' -DKBUILD_MODNAME='"siphash"' -D__KBUILD_MODNAME=kmod_siphash -c -o lib/siphash.o lib/siphash.c  

include/linux/siphash.h should add these lines:
#include <stddef.h>                     // for size_t
#include "asm-generic/int-ll64.h"       // for u64, u32
#include "generated/autoconf.h"         // for CONFIG_HAVE_EFFICIENT_UNALIGN...
#include "linux/align.h"                // for IS_ALIGNED
#include "linux/bitops.h"               // for rol64, rol32
#include "linux/byteorder/generic.h"    // for le32_to_cpu, le64_to_cpu, le3...
#include "linux/compiler_attributes.h"  // for __aligned
#include "linux/compiler_types.h"       // for inline
#include "linux/kconfig.h"              // for __ARG_PLACEHOLDER_1, IS_ENABLED
#include "linux/types.h"                // for __le32, __le64

include/linux/siphash.h should remove these lines:
- #include <linux/kernel.h>  // lines 16-16

The full include-list for include/linux/siphash.h:
#include <linux/types.h>                // for bool
#include <stddef.h>                     // for size_t
#include "asm-generic/int-ll64.h"       // for u64, u32
#include "generated/autoconf.h"         // for CONFIG_HAVE_EFFICIENT_UNALIGN...
#include "linux/align.h"                // for IS_ALIGNED
#include "linux/bitops.h"               // for rol64, rol32
#include "linux/byteorder/generic.h"    // for le32_to_cpu, le64_to_cpu, le3...
#include "linux/compiler_attributes.h"  // for __aligned
#include "linux/compiler_types.h"       // for inline
#include "linux/kconfig.h"              // for __ARG_PLACEHOLDER_1, IS_ENABLED
#include "linux/types.h"                // for __le32, __le64
---

lib/siphash.c should add these lines:
#include "asm-generic/bitsperlong.h"  // for BITS_PER_LONG
#include "asm-generic/unaligned.h"    // for get_unaligned_le16, get_unalign...
#include "linux/export.h"             // for EXPORT_SYMBOL

lib/siphash.c should remove these lines:
- #include <asm/unaligned.h>  // lines 13-13

The full include-list for lib/siphash.c:
#include <linux/siphash.h>
#include "asm-generic/bitsperlong.h"  // for BITS_PER_LONG
#include "asm-generic/unaligned.h"    // for get_unaligned_le16, get_unalign...
#include "linux/export.h"             // for EXPORT_SYMBOL
---
  ./scripts/check-local-export lib/siphash.o
  iwyu2 -Wp,-MMD,lib/.string.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types -ffreestanding    -DKBUILD_MODFILE='"lib/string"' -DKBUILD_BASENAME='"string"' -DKBUILD_MODNAME='"string"' -D__KBUILD_MODNAME=kmod_string -c -o lib/string.o lib/string.c  

lib/string.c should add these lines:
#include <asm/bug.h>                    // for BUG_ON, WARN_ON_ONCE
#include <stdint.h>                     // for uint64_t
#include <cstdio>                       // for size_t, NULL, ssize_t
#include "asm-generic/bitsperlong.h"    // for BITS_PER_LONG
#include "asm-generic/errno-base.h"     // for E2BIG
#include "asm-generic/int-ll64.h"       // for u8, u64
#include "asm-generic/rwonce.h"         // for read_word_at_a_time
#include "asm-generic/unaligned.h"      // for get_unaligned
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/string_32.h"              // for strlen, strchr, memcpy, __HAV...
#include "generated/autoconf.h"         // for CONFIG_ARCH_HAS_FAST_MULTIPLIER
#include "linux/compiler_attributes.h"  // for __visible
#include "vdso/limits.h"                // for INT_MAX

lib/string.c should remove these lines:
- #include <asm/byteorder.h>  // lines 28-28
- #include <asm/page.h>  // lines 30-30
- #include <asm/unaligned.h>  // lines 27-27
- #include <linux/bug.h>  // lines 23-23
- #include <linux/errno.h>  // lines 24-24
- #include <linux/kernel.h>  // lines 21-21
- #include <linux/slab.h>  // lines 25-25
- #include <linux/types.h>  // lines 18-18

The full include-list for lib/string.c:
#include <asm/bug.h>                    // for BUG_ON, WARN_ON_ONCE
#include <asm/word-at-a-time.h>         // for create_zero_mask, find_zero
#include <linux/ctype.h>                // for tolower
#include <linux/export.h>               // for EXPORT_SYMBOL
#include <linux/string.h>               // for bcmp, memchr_inv, memset64
#include <stdint.h>                     // for uint64_t
#include <cstdio>                       // for size_t, NULL, ssize_t
#include "asm-generic/bitsperlong.h"    // for BITS_PER_LONG
#include "asm-generic/errno-base.h"     // for E2BIG
#include "asm-generic/int-ll64.h"       // for u8, u64
#include "asm-generic/rwonce.h"         // for read_word_at_a_time
#include "asm-generic/unaligned.h"      // for get_unaligned
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/string_32.h"              // for strlen, strchr, memcpy, __HAV...
#include "generated/autoconf.h"         // for CONFIG_ARCH_HAS_FAST_MULTIPLIER
#include "linux/compiler_attributes.h"  // for __visible
#include "vdso/limits.h"                // for INT_MAX
---
  ./scripts/check-local-export lib/string.o
  iwyu2 -Wp,-MMD,lib/.timerqueue.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/timerqueue"' -DKBUILD_BASENAME='"timerqueue"' -DKBUILD_MODNAME='"timerqueue"' -D__KBUILD_MODNAME=kmod_timerqueue -c -o lib/timerqueue.o lib/timerqueue.c  

lib/timerqueue.c should add these lines:
#include <asm/bug.h>               // for WARN_ON_ONCE
#include <stddef.h>                // for NULL
#include "linux/compiler_types.h"  // for inline
#include "linux/container_of.h"    // for container_of
#include "linux/rbtree_types.h"    // for rb_root_cached, rb_node (ptr only)
#include "linux/types.h"           // for bool

lib/timerqueue.c should remove these lines:
- #include <linux/bug.h>  // lines 12-12

The full include-list for lib/timerqueue.c:
#include <asm/bug.h>               // for WARN_ON_ONCE
#include <linux/export.h>          // for EXPORT_SYMBOL_GPL
#include <linux/rbtree.h>          // for rb_add_cached, rb_entry, rb_erase_...
#include <linux/timerqueue.h>      // for timerqueue_node, timerqueue_head
#include <stddef.h>                // for NULL
#include "linux/compiler_types.h"  // for inline
#include "linux/container_of.h"    // for container_of
#include "linux/rbtree_types.h"    // for rb_root_cached, rb_node (ptr only)
#include "linux/types.h"           // for bool
---
  ./scripts/check-local-export lib/timerqueue.o
  iwyu2 -Wp,-MMD,lib/.vsprintf.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/vsprintf"' -DKBUILD_BASENAME='"vsprintf"' -DKBUILD_MODNAME='"vsprintf"' -D__KBUILD_MODNAME=kmod_vsprintf -c -o lib/vsprintf.o lib/vsprintf.c  
In file included from lib/vsprintf.c:36:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/vsprintf.c:36:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/vsprintf.c:36:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from lib/vsprintf.c:36:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
In file included from lib/vsprintf.c:40:
In file included from ./include/net/addrconf.h:52:
In file included from ./include/linux/ipv6.h:75:
In file included from ./include/linux/tcp.h:17:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from lib/vsprintf.c:40:
In file included from ./include/net/addrconf.h:52:
In file included from ./include/linux/ipv6.h:75:
In file included from ./include/linux/tcp.h:19:
In file included from ./include/net/sock.h:46:
./include/linux/netdevice.h:1243:17: warning: declaration of 'struct rtnl_link_stats64' will not be visible outside of this function [-Wvisibility]
                                                   struct rtnl_link_stats64 *storage);
                                                          ^
./include/linux/netdevice.h:1268:19: warning: declaration of 'struct ifla_vf_info' will not be visible outside of this function [-Wvisibility]
                                                     struct ifla_vf_info *ivf);
                                                            ^
./include/linux/netdevice.h:1273:18: warning: declaration of 'struct ifla_vf_stats' will not be visible outside of this function [-Wvisibility]
                                                    struct ifla_vf_stats
                                                           ^
./include/linux/netdevice.h:1282:17: warning: declaration of 'struct ifla_vf_guid' will not be visible outside of this function [-Wvisibility]
                                                   struct ifla_vf_guid *node_guid,
                                                          ^
In file included from lib/vsprintf.c:40:
In file included from ./include/net/addrconf.h:52:
In file included from ./include/linux/ipv6.h:75:
In file included from ./include/linux/tcp.h:19:
In file included from ./include/net/sock.h:53:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
lib/vsprintf.c:1886:42: warning: declaration of 'struct clk' will not be visible outside of this function [-Wvisibility]
char *clock(char *buf, char *end, struct clk *clk, struct printf_spec spec,
                                         ^
11 warnings generated.
In file included from lib/vsprintf.c:36:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/vsprintf.c:36:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/vsprintf.c:36:
In file included from ./include/linux/rtc.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from lib/vsprintf.c:36:
./include/linux/rtc.h:223:15: warning: declaration of 'struct nvmem_config' will not be visible outside of this function [-Wvisibility]
                                          struct nvmem_config *nvmem_config)
                                                 ^
In file included from lib/vsprintf.c:40:
In file included from ./include/net/addrconf.h:52:
In file included from ./include/linux/ipv6.h:75:
In file included from ./include/linux/tcp.h:17:
./include/linux/skbuff.h:1487:31: warning: declaration of 'struct ts_config' will not be visible outside of this function [-Wvisibility]
                           unsigned int to, struct ts_config *config);
                                                   ^
In file included from lib/vsprintf.c:40:
In file included from ./include/net/addrconf.h:52:
In file included from ./include/linux/ipv6.h:75:
In file included from ./include/linux/tcp.h:19:
In file included from ./include/net/sock.h:46:
./include/linux/netdevice.h:1243:17: warning: declaration of 'struct rtnl_link_stats64' will not be visible outside of this function [-Wvisibility]
                                                   struct rtnl_link_stats64 *storage);
                                                          ^
./include/linux/netdevice.h:1268:19: warning: declaration of 'struct ifla_vf_info' will not be visible outside of this function [-Wvisibility]
                                                     struct ifla_vf_info *ivf);
                                                            ^
./include/linux/netdevice.h:1273:18: warning: declaration of 'struct ifla_vf_stats' will not be visible outside of this function [-Wvisibility]
                                                    struct ifla_vf_stats
                                                           ^
./include/linux/netdevice.h:1282:17: warning: declaration of 'struct ifla_vf_guid' will not be visible outside of this function [-Wvisibility]
                                                   struct ifla_vf_guid *node_guid,
                                                          ^
In file included from lib/vsprintf.c:40:
In file included from ./include/net/addrconf.h:52:
In file included from ./include/linux/ipv6.h:75:
In file included from ./include/linux/tcp.h:19:
In file included from ./include/net/sock.h:53:
In file included from ./include/linux/memcontrol.h:13:
./include/linux/cgroup.h:41:44: warning: declaration of 'struct cgroupstats' will not be visible outside of this function [-Wvisibility]
static inline int cgroupstats_build(struct cgroupstats *stats,
                                           ^
lib/vsprintf.c:1886:42: warning: declaration of 'struct clk' will not be visible outside of this function [-Wvisibility]
char *clock(char *buf, char *end, struct clk *clk, struct printf_spec spec,
                                         ^

lib/vsprintf.c should add these lines:
#include <asm/bitops.h>                 // for test_bit, __clear_bit, __set_bit
#include <asm/bug.h>                    // for WARN_ONCE, WARN_ON_ONCE
#include <linux/bitmap.h>               // for for_each_set_bitrange
#include <linux/mm.h>                   // for PAGEFLAGS_MASK
#include <stddef.h>                     // for ptrdiff_t
#include <stdint.h>                     // for uint32_t, uint64_t
#include <sys/socket.h>                 // for size_t, sockaddr, ssize_t
#include <cstdio>                       // for va_list, NULL
#include "asm-generic/bitsperlong.h"    // for BITS_PER_LONG, BITS_PER_LONG_...
#include "asm-generic/errno-base.h"     // for EAGAIN, EFAULT
#include "asm-generic/int-ll64.h"       // for u16, u8, u32, u64, __u8, s16
#include "asm-generic/rwonce.h"         // for READ_ONCE
#include "asm-generic/unaligned.h"      // for get_unaligned
#include "asm/cache.h"                  // for __read_mostly
#include "asm/current.h"                // for current
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/string_32.h"              // for memmove, memset, strcpy, strlen
#include "linux/align.h"                // for ALIGN
#include "linux/bitmap.h"               // for bitmap_complement
#include "linux/byteorder/generic.h"    // for cpu_to_le16, ntohs, ntohl
#include "linux/cache.h"                // for __ro_after_init
#include "linux/capability.h"           // for has_capability_noaudit, CAP_S...
#include "linux/compiler_attributes.h"  // for fallthrough, __aligned, noinline
#include "linux/compiler_types.h"       // for __force, noinline_for_stack
#include "linux/err.h"                  // for IS_ERR, IS_ERR_OR_NULL, PTR_ERR
#include "linux/export.h"               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/fs.h"                   // for file
#include "linux/hash.h"                 // for hash_long
#include "linux/in.h"                   // for sockaddr_in, in_addr
#include "linux/in6.h"                  // for in6_addr, sockaddr_in6, s6_ad...
#include "linux/init.h"                 // for __init, early_param
#include "linux/jump_label.h"           // for DEFINE_STATIC_KEY_FALSE, stat...
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kstrtox.h"              // for simple_strtol, simple_strtoll
#include "linux/math.h"                 // for DIV_ROUND_UP
#include "linux/minmax.h"               // for clamp, max_t, max, min_t
#include "linux/mm.h"                   // for KASAN_TAG_MASK, KASAN_TAG_PGS...
#include "linux/netdev_features.h"      // for netdev_features_t
#include "linux/page-flags-layout.h"    // for KASAN_TAG_WIDTH, LAST_CPUPID_...
#include "linux/path.h"                 // for path
#include "linux/preempt.h"              // for in_irq, in_nmi, in_serving_so...
#include "linux/printk.h"               // for pr_warn, va_format, pr_info
#include "linux/random.h"               // for get_random_bytes, rng_is_init...
#include "linux/rcupdate.h"             // for rcu_read_unlock, rcu_read_lock
#include "linux/rtc.h"                  // for rtc_time
#include "linux/sched.h"                // for task_struct
#include "linux/socket.h"               // for AF_INET, AF_INET6
#include "linux/spinlock.h"             // for spin_unlock_irqrestore, spin_...
#include "linux/spinlock_types.h"       // for DEFINE_SPINLOCK
#include "linux/stddef.h"               // for true, false
#include "linux/time64.h"               // for time64_t
#include "linux/tracepoint-defs.h"      // for trace_print_flags
#include "linux/types.h"                // for __be16
#include "linux/uidgid.h"               // for gid_eq, uid_eq
#include "linux/workqueue.h"            // for work_struct, queue_work, syst...
#include "net/ipv6.h"                   // for ipv6_addr_v4mapped, IPV6_FLOW...
#include "vdso/bits.h"                  // for BIT
#include "vdso/limits.h"                // for INT_MAX, SHRT_MAX
struct clock::clk;
struct fwnode_handle;

lib/vsprintf.c should remove these lines:
- #include <asm/byteorder.h>  // lines 48-48
- #include <asm/page.h>  // lines 47-47
- #include <asm/unaligned.h>  // lines 49-49
- #include <linux/compiler.h>  // lines 42-42
- #include <linux/math64.h>  // lines 31-31
- #include <linux/module.h>  // lines 25-25
- #include <linux/rtc.h>  // lines 36-36
- #include <linux/uaccess.h>  // lines 32-32

The full include-list for lib/vsprintf.c:
#include <asm/bitops.h>                 // for test_bit, __clear_bit, __set_bit
#include <asm/bug.h>                    // for WARN_ONCE, WARN_ON_ONCE
#include <linux/bitmap.h>               // for for_each_set_bitrange
#include <linux/build_bug.h>            // for unlikely, BUILD_BUG_ON, stati...
#include <linux/cred.h>                 // for cred, current_cred
#include <linux/ctype.h>                // for isdigit, _tolower, isspace
#include <linux/dcache.h>               // for dentry, qstr
#include <linux/errname.h>              // for errname
#include <linux/ioport.h>               // for resource, resource_size, IORE...
#include <linux/kallsyms.h>             // for dereference_symbol_descriptor
#include <linux/kernel.h>               // for hex_byte_pack, hex_asc_lo
#include <linux/mm.h>                   // for PAGEFLAGS_MASK
#include <linux/of.h>                   // for of_node_check_flag, of_fwnode...
#include <linux/property.h>             // for fwnode_get_name, fwnode_count...
#include <linux/siphash.h>              // for siphash_1u32, siphash_key_t
#include <linux/stdarg.h>               // for va_arg, va_end, va_start, va_...
#include <linux/string.h>               // for skip_spaces, strchrnul, strcspn
#include <linux/string_helpers.h>       // for string_escape_mem, ESCAPE_ANY
#include <linux/time.h>                 // for tm, time64_to_tm
#include <linux/types.h>                // for bool, resource_size_t, dma_ad...
#include <linux/uuid.h>                 // for UUID_STRING_LEN, guid_index
#include <net/addrconf.h>               // for ipv6_addr_is_isatap
#include <stddef.h>                     // for ptrdiff_t
#include <stdint.h>                     // for uint32_t, uint64_t
#include <sys/socket.h>                 // for size_t, sockaddr, ssize_t
#include <cstdio>                       // for va_list, NULL
#include "../mm/internal.h"             // for gfpflag_names, pageflag_names
#include "asm-generic/bitsperlong.h"    // for BITS_PER_LONG, BITS_PER_LONG_...
#include "asm-generic/errno-base.h"     // for EAGAIN, EFAULT
#include "asm-generic/int-ll64.h"       // for u16, u8, u32, u64, __u8, s16
#include "asm-generic/rwonce.h"         // for READ_ONCE
#include "asm-generic/unaligned.h"      // for get_unaligned
#include "asm/cache.h"                  // for __read_mostly
#include "asm/current.h"                // for current
#include "asm/page_types.h"             // for PAGE_SIZE
#include "asm/string_32.h"              // for memmove, memset, strcpy, strlen
#include "kstrtox.h"                    // for _parse_integer_fixup_radix
#include "linux/align.h"                // for ALIGN
#include "linux/bitmap.h"               // for bitmap_complement
#include "linux/byteorder/generic.h"    // for cpu_to_le16, ntohs, ntohl
#include "linux/cache.h"                // for __ro_after_init
#include "linux/capability.h"           // for has_capability_noaudit, CAP_S...
#include "linux/compiler_attributes.h"  // for fallthrough, __aligned, noinline
#include "linux/compiler_types.h"       // for __force, noinline_for_stack
#include "linux/err.h"                  // for IS_ERR, IS_ERR_OR_NULL, PTR_ERR
#include "linux/export.h"               // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include "linux/fs.h"                   // for file
#include "linux/hash.h"                 // for hash_long
#include "linux/in.h"                   // for sockaddr_in, in_addr
#include "linux/in6.h"                  // for in6_addr, sockaddr_in6, s6_ad...
#include "linux/init.h"                 // for __init, early_param
#include "linux/jump_label.h"           // for DEFINE_STATIC_KEY_FALSE, stat...
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/kstrtox.h"              // for simple_strtol, simple_strtoll
#include "linux/math.h"                 // for DIV_ROUND_UP
#include "linux/minmax.h"               // for clamp, max_t, max, min_t
#include "linux/mm.h"                   // for KASAN_TAG_MASK, KASAN_TAG_PGS...
#include "linux/netdev_features.h"      // for netdev_features_t
#include "linux/page-flags-layout.h"    // for KASAN_TAG_WIDTH, LAST_CPUPID_...
#include "linux/path.h"                 // for path
#include "linux/preempt.h"              // for in_irq, in_nmi, in_serving_so...
#include "linux/printk.h"               // for pr_warn, va_format, pr_info
#include "linux/random.h"               // for get_random_bytes, rng_is_init...
#include "linux/rcupdate.h"             // for rcu_read_unlock, rcu_read_lock
#include "linux/rtc.h"                  // for rtc_time
#include "linux/sched.h"                // for task_struct
#include "linux/socket.h"               // for AF_INET, AF_INET6
#include "linux/spinlock.h"             // for spin_unlock_irqrestore, spin_...
#include "linux/spinlock_types.h"       // for DEFINE_SPINLOCK
#include "linux/stddef.h"               // for true, false
#include "linux/time64.h"               // for time64_t
#include "linux/tracepoint-defs.h"      // for trace_print_flags
#include "linux/types.h"                // for __be16
#include "linux/uidgid.h"               // for gid_eq, uid_eq
#include "linux/workqueue.h"            // for work_struct, queue_work, syst...
#include "net/ipv6.h"                   // for ipv6_addr_v4mapped, IPV6_FLOW...
#include "vdso/bits.h"                  // for BIT
#include "vdso/limits.h"                // for INT_MAX, SHRT_MAX
struct clock::clk;
struct fwnode_handle;
---
  ./scripts/check-local-export lib/vsprintf.o
  iwyu2 -Wp,-MMD,lib/.win_minmax.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/win_minmax"' -DKBUILD_BASENAME='"win_minmax"' -DKBUILD_MODNAME='"win_minmax"' -D__KBUILD_MODNAME=kmod_win_minmax -c -o lib/win_minmax.o lib/win_minmax.c  

lib/win_minmax.c should add these lines:
#include "asm-generic/int-ll64.h"  // for u32
#include "linux/compiler.h"        // for unlikely
#include "linux/export.h"          // for EXPORT_SYMBOL

lib/win_minmax.c should remove these lines:
- #include <linux/module.h>  // lines 25-25

The full include-list for lib/win_minmax.c:
#include <linux/win_minmax.h>      // for minmax_sample, minmax, minmax_reset
#include "asm-generic/int-ll64.h"  // for u32
#include "linux/compiler.h"        // for unlikely
#include "linux/export.h"          // for EXPORT_SYMBOL
---
  ./scripts/check-local-export lib/win_minmax.o
  iwyu2 -Wp,-MMD,lib/.xarray.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/xarray"' -DKBUILD_BASENAME='"xarray"' -DKBUILD_MODNAME='"xarray"' -D__KBUILD_MODNAME=kmod_xarray -c -o lib/xarray.o lib/xarray.c  

lib/xarray.c should add these lines:
#include <asm/bitops.h>              // for __set_bit, __test_and_clear_bit
#include <asm/bug.h>                 // for WARN_ON_ONCE
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL, ENOMEM, EBUSY
#include "asm-generic/int-ll64.h"    // for u32
#include "linux/compiler.h"          // for unlikely
#include "linux/compiler_types.h"    // for inline, __force, __rcu, __must_hold
#include "linux/gfp.h"               // for __GFP_ACCOUNT, gfpflags_allow_bl...
#include "linux/kconfig.h"           // for IS_ENABLED
#include "linux/minmax.h"            // for max
#include "linux/rcupdate.h"          // for rcu_read_unlock, rcu_read_lock
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool, gfp_t, rcu_head

lib/xarray.c should remove these lines:
- #include <linux/list.h>  // lines 11-11

The full include-list for lib/xarray.c:
#include <asm/bitops.h>              // for __set_bit, __test_and_clear_bit
#include <asm/bug.h>                 // for WARN_ON_ONCE
#include <linux/bitmap.h>            // for bitmap_clear, bitmap_empty, bitm...
#include <linux/export.h>            // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/slab.h>              // for kmem_cache_alloc_lru
#include <linux/xarray.h>            // for xa_state, xa_node, xa_to_node
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL, ENOMEM, EBUSY
#include "asm-generic/int-ll64.h"    // for u32
#include "linux/compiler.h"          // for unlikely
#include "linux/compiler_types.h"    // for inline, __force, __rcu, __must_hold
#include "linux/gfp.h"               // for __GFP_ACCOUNT, gfpflags_allow_bl...
#include "linux/kconfig.h"           // for IS_ENABLED
#include "linux/minmax.h"            // for max
#include "linux/rcupdate.h"          // for rcu_read_unlock, rcu_read_lock
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool, gfp_t, rcu_head
---
  ./scripts/check-local-export lib/xarray.o
  rm -f lib/lib.a; llvm-ar cDPrsT lib/lib.a lib/argv_split.o lib/buildid.o lib/cmdline.o lib/ctype.o lib/dec_and_lock.o lib/decompress.o lib/earlycpio.o lib/extable.o lib/flex_proportions.o lib/idr.o lib/irq_regs.o lib/is_single_threaded.o lib/klist.o lib/kobject.o lib/kobject_uevent.o lib/logic_pio.o lib/memcat_p.o lib/nmi_backtrace.o lib/nodemask.o lib/plist.o lib/radix-tree.o lib/ratelimit.o lib/rbtree.o lib/seq_buf.o lib/sha1.o lib/show_mem.o lib/siphash.o lib/string.o lib/timerqueue.o lib/vsprintf.o lib/win_minmax.o lib/xarray.o
  iwyu2 -Wp,-MMD,lib/.lockref.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/lockref"' -DKBUILD_BASENAME='"lockref"' -DKBUILD_MODNAME='"lockref"' -D__KBUILD_MODNAME=kmod_lockref -c -o lib/lockref.o lib/lockref.c  

lib/lockref.c should add these lines:
#include "linux/spinlock.h"  // for spin_lock, spin_unlock, assert_spin_locked

lib/lockref.c should remove these lines:

The full include-list for lib/lockref.c:
#include <linux/export.h>    // for EXPORT_SYMBOL
#include <linux/lockref.h>   // for lockref, lockref::(anonymous union)::(an...
#include "linux/spinlock.h"  // for spin_lock, spin_unlock, assert_spin_locked
---
  ./scripts/check-local-export lib/lockref.o
  iwyu2 -Wp,-MMD,lib/.bcd.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/bcd"' -DKBUILD_BASENAME='"bcd"' -DKBUILD_MODNAME='"bcd"' -D__KBUILD_MODNAME=kmod_bcd -c -o lib/bcd.o lib/bcd.c  

include/linux/bcd.h should add these lines:
#include "linux/compiler_attributes.h"  // for __attribute_const__

include/linux/bcd.h should remove these lines:
- #include <linux/compiler.h>  // lines 5-5

The full include-list for include/linux/bcd.h:
#include "linux/compiler_attributes.h"  // for __attribute_const__
---

(lib/bcd.c has correct #includes/fwd-decls)
  ./scripts/check-local-export lib/bcd.o
  iwyu2 -Wp,-MMD,lib/.sort.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/sort"' -DKBUILD_BASENAME='"sort"' -DKBUILD_MODNAME='"sort"' -D__KBUILD_MODNAME=kmod_sort -c -o lib/sort.o lib/sort.c  

lib/sort.c should add these lines:
#include <stddef.h>                     // for size_t, NULL
#include "asm-generic/int-ll64.h"       // for u32
#include "linux/compiler_attributes.h"  // for __always_inline, __attribute_...

lib/sort.c should remove these lines:

The full include-list for lib/sort.c:
#include <linux/export.h>               // for EXPORT_SYMBOL
#include <linux/sort.h>                 // for sort, sort_r
#include <linux/types.h>                // for swap_r_func_t, cmp_r_func_t
#include <stddef.h>                     // for size_t, NULL
#include "asm-generic/int-ll64.h"       // for u32
#include "linux/compiler_attributes.h"  // for __always_inline, __attribute_...
---
  ./scripts/check-local-export lib/sort.o
  iwyu2 -Wp,-MMD,lib/.parser.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/parser"' -DKBUILD_BASENAME='"parser"' -DKBUILD_MODNAME='"parser"' -D__KBUILD_MODNAME=kmod_parser -c -o lib/parser.o lib/parser.c  

lib/parser.c should add these lines:
#include <stddef.h>                  // for size_t
#include "asm-generic/errno-base.h"  // for ENOMEM, EINVAL, ERANGE
#include "asm-generic/int-ll64.h"    // for u64
#include "asm/string_32.h"           // for strchr, strcmp, strlen, strncmp
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/stddef.h"            // for false, true
#include "vdso/limits.h"             // for INT_MAX, INT_MIN

lib/parser.c should remove these lines:

The full include-list for lib/parser.c:
#include <linux/ctype.h>             // for isdigit
#include <linux/export.h>            // for EXPORT_SYMBOL
#include <linux/kstrtox.h>           // for simple_strtoul, simple_strtol
#include <linux/parser.h>            // for substring_t, match_token, MAX_OP...
#include <linux/slab.h>              // for kfree
#include <linux/string.h>            // for kmemdup_nul
#include <linux/types.h>             // for bool
#include <stddef.h>                  // for size_t
#include "asm-generic/errno-base.h"  // for ENOMEM, EINVAL, ERANGE
#include "asm-generic/int-ll64.h"    // for u64
#include "asm/string_32.h"           // for strchr, strcmp, strlen, strncmp
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/stddef.h"            // for false, true
#include "vdso/limits.h"             // for INT_MAX, INT_MIN
---
  ./scripts/check-local-export lib/parser.o
  iwyu2 -Wp,-MMD,lib/.debug_locks.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/debug_locks"' -DKBUILD_BASENAME='"debug_locks"' -DKBUILD_MODNAME='"debug_locks"' -D__KBUILD_MODNAME=kmod_debug_locks -c -o lib/debug_locks.o lib/debug_locks.c  

lib/debug_locks.c should add these lines:
#include "asm/cache.h"          // for __read_mostly
#include "linux/printk.h"       // for console_verbose

lib/debug_locks.c should remove these lines:
- #include <linux/mutex.h>  // lines 13-13
- #include <linux/rwsem.h>  // lines 12-12
- #include <linux/spinlock.h>  // lines 15-15

The full include-list for lib/debug_locks.c:
#include <linux/debug_locks.h>  // for __debug_locks_off, debug_locks_off
#include <linux/export.h>       // for EXPORT_SYMBOL_GPL
#include "asm/cache.h"          // for __read_mostly
#include "linux/printk.h"       // for console_verbose
---
  ./scripts/check-local-export lib/debug_locks.o
  iwyu2 -Wp,-MMD,lib/.random32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/random32"' -DKBUILD_BASENAME='"random32"' -DKBUILD_MODNAME='"random32"' -D__KBUILD_MODNAME=kmod_random32 -c -o lib/random32.o lib/random32.c  

lib/random32.c should add these lines:
#include <asm-generic/percpu.h>     // for per_cpu_ptr
#include <stddef.h>                 // for size_t
#include "asm-generic/int-ll64.h"   // for u32, u8
#include "asm-generic/unaligned.h"  // for put_unaligned
#include "linux/bits.h"             // for BITS_PER_BYTE
#include "linux/compiler_types.h"   // for __percpu
#include "linux/cpumask.h"          // for for_each_possible_cpu
#include "linux/prandom.h"          // for rnd_state, __seed, prandom_bytes_...

lib/random32.c should remove these lines:
- #include <asm/unaligned.h>  // lines 43-43
- #include <linux/bitops.h>  // lines 41-41
- #include <linux/jiffies.h>  // lines 38-38
- #include <linux/percpu.h>  // lines 36-36
- #include <linux/sched.h>  // lines 40-40
- #include <linux/slab.h>  // lines 42-42
- #include <linux/types.h>  // lines 35-35

The full include-list for lib/random32.c:
#include <asm-generic/percpu.h>     // for per_cpu_ptr
#include <linux/export.h>           // for EXPORT_SYMBOL
#include <linux/random.h>           // for get_random_bytes
#include <stddef.h>                 // for size_t
#include "asm-generic/int-ll64.h"   // for u32, u8
#include "asm-generic/unaligned.h"  // for put_unaligned
#include "linux/bits.h"             // for BITS_PER_BYTE
#include "linux/compiler_types.h"   // for __percpu
#include "linux/cpumask.h"          // for for_each_possible_cpu
#include "linux/prandom.h"          // for rnd_state, __seed, prandom_bytes_...
---
  ./scripts/check-local-export lib/random32.o
  iwyu2 -Wp,-MMD,lib/.bust_spinlocks.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/bust_spinlocks"' -DKBUILD_BASENAME='"bust_spinlocks"' -DKBUILD_MODNAME='"bust_spinlocks"' -D__KBUILD_MODNAME=kmod_bust_spinlocks -c -o lib/bust_spinlocks.o lib/bust_spinlocks.c  
In file included from lib/bust_spinlocks.c:15:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/bust_spinlocks.c:15:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/bust_spinlocks.c:15:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from lib/bust_spinlocks.c:15:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/bust_spinlocks.c:15:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/bust_spinlocks.c:15:
In file included from ./include/linux/tty.h:10:
In file included from ./include/linux/tty_driver.h:9:
In file included from ./include/linux/cdev.h:8:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

lib/bust_spinlocks.c should add these lines:

lib/bust_spinlocks.c should remove these lines:
- #include <linux/spinlock.h>  // lines 14-14
- #include <linux/tty.h>  // lines 15-15
- #include <linux/wait.h>  // lines 16-16

The full include-list for lib/bust_spinlocks.c:
#include <linux/console.h>  // for console_unblank
#include <linux/kernel.h>   // for bust_spinlocks
#include <linux/printk.h>   // for wake_up_klogd, oops_in_progress
#include <linux/vt_kern.h>  // for unblank_screen
---
  ./scripts/check-local-export lib/bust_spinlocks.o
  iwyu2 -Wp,-MMD,lib/.kasprintf.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/kasprintf"' -DKBUILD_BASENAME='"kasprintf"' -DKBUILD_MODNAME='"kasprintf"' -D__KBUILD_MODNAME=kmod_kasprintf -c -o lib/kasprintf.o lib/kasprintf.c  

lib/kasprintf.c should add these lines:
#include <asm/bug.h>        // for WARN
#include <cstdio>           // for va_list, NULL
#include "asm/string_32.h"  // for strchr, strcmp
#include "linux/kernel.h"   // for vsnprintf, kasprintf, kvasprintf, kvaspri...

lib/kasprintf.c should remove these lines:

The full include-list for lib/kasprintf.c:
#include <asm/bug.h>        // for WARN
#include <linux/export.h>   // for EXPORT_SYMBOL
#include <linux/slab.h>     // for kmalloc_track_caller
#include <linux/stdarg.h>   // for va_end, va_arg, va_copy, va_start
#include <linux/string.h>   // for kstrdup_const
#include <linux/types.h>    // for gfp_t
#include <cstdio>           // for va_list, NULL
#include "asm/string_32.h"  // for strchr, strcmp
#include "linux/kernel.h"   // for vsnprintf, kasprintf, kvasprintf, kvaspri...
---
  ./scripts/check-local-export lib/kasprintf.o
  iwyu2 -Wp,-MMD,lib/.bitmap.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/bitmap"' -DKBUILD_BASENAME='"bitmap"' -DKBUILD_MODNAME='"bitmap"' -D__KBUILD_MODNAME=kmod_bitmap -c -o lib/bitmap.o lib/bitmap.c  
In file included from lib/bitmap.c:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/bitmap.c:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/bitmap.c:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from lib/bitmap.c:11:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/bitmap.c:11:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/bitmap.c:11:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

include/linux/bitmap.h should add these lines:
#include <asm/bitops.h>                 // for __clear_bit, __set_bit
#include <stddef.h>                     // for size_t
#include "asm-generic/bitsperlong.h"    // for BITS_PER_LONG, small_const_nbits
#include "asm-generic/int-ll64.h"       // for u64
#include "asm/bitsperlong.h"            // for __BITS_PER_LONG
#include "asm/string_32.h"              // for memset, memcmp, memcpy
#include "linux/bits.h"                 // for BIT_WORD
#include "linux/compiler_attributes.h"  // for __always_inline, __pure
#include "linux/compiler_types.h"       // for inline, __user
#include "linux/kconfig.h"              // for __LITTLE_ENDIAN
#include "vdso/limits.h"                // for ULONG_MAX

include/linux/bitmap.h should remove these lines:
- #include <linux/limits.h>  // lines 10-10
- #include <linux/string.h>  // lines 11-11

The full include-list for include/linux/bitmap.h:
#include <asm/bitops.h>                 // for __clear_bit, __set_bit
#include <linux/align.h>                // for IS_ALIGNED
#include <linux/bitops.h>               // for BITS_TO_LONGS, hweight_long
#include <linux/find.h>                 // for find_first_bit, find_first_ze...
#include <linux/types.h>                // for bool, gfp_t, loff_t
#include <stddef.h>                     // for size_t
#include "asm-generic/bitsperlong.h"    // for BITS_PER_LONG, small_const_nbits
#include "asm-generic/int-ll64.h"       // for u64
#include "asm/bitsperlong.h"            // for __BITS_PER_LONG
#include "asm/string_32.h"              // for memset, memcmp, memcpy
#include "linux/bits.h"                 // for BIT_WORD
#include "linux/compiler_attributes.h"  // for __always_inline, __pure
#include "linux/compiler_types.h"       // for inline, __user
#include "linux/kconfig.h"              // for __LITTLE_ENDIAN
#include "vdso/limits.h"                // for ULONG_MAX
struct device;  // lines 14-14
---

lib/bitmap.c should add these lines:
#include <sys/types.h>                               // for ssize_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit
#include "asm-generic/errno-base.h"                  // for EINVAL, ENOMEM
#include "asm-generic/errno.h"                       // for EOVERFLOW
#include "asm/page_types.h"                          // for PAGE_SIZE
#include "linux/align.h"                             // for __ALIGN_MASK
#include "linux/err.h"                               // for ERR_PTR, IS_ERR
#include "linux/find.h"                              // for find_next_bit
#include "linux/gfp.h"                               // for __GFP_ZERO, GFP_...
#include "linux/minmax.h"                            // for min
#include "linux/stddef.h"                            // for false, true
#include "linux/types.h"                             // for bool, gfp_t, loff_t

lib/bitmap.c should remove these lines:
- #include <asm/page.h>  // lines 21-21
- #include <linux/bug.h>  // lines 9-9
- #include <linux/errno.h>  // lines 12-12
- #include <linux/thread_info.h>  // lines 18-18
- #include <linux/uaccess.h>  // lines 19-19

The full include-list for lib/bitmap.c:
#include <linux/bitmap.h>
#include <linux/bitops.h>                            // for BITS_TO_LONGS
#include <linux/ctype.h>                             // for isspace
#include <linux/device.h>                            // for devm_add_action_...
#include <linux/export.h>                            // for EXPORT_SYMBOL
#include <linux/kernel.h>                            // for hex_to_bin, scnp...
#include <linux/mm.h>                                // for offset_in_page
#include <linux/slab.h>                              // for kfree, kmalloc_a...
#include <linux/string.h>                            // for memdup_user_nul
#include <sys/types.h>                               // for ssize_t
#include "asm-generic/bitops/instrumented-atomic.h"  // for set_bit
#include "asm-generic/errno-base.h"                  // for EINVAL, ENOMEM
#include "asm-generic/errno.h"                       // for EOVERFLOW
#include "asm/page_types.h"                          // for PAGE_SIZE
#include "kstrtox.h"                                 // for _parse_integer
#include "linux/align.h"                             // for __ALIGN_MASK
#include "linux/err.h"                               // for ERR_PTR, IS_ERR
#include "linux/find.h"                              // for find_next_bit
#include "linux/gfp.h"                               // for __GFP_ZERO, GFP_...
#include "linux/minmax.h"                            // for min
#include "linux/stddef.h"                            // for false, true
#include "linux/types.h"                             // for bool, gfp_t, loff_t
---
  ./scripts/check-local-export lib/bitmap.o
  iwyu2 -Wp,-MMD,lib/.scatterlist.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/scatterlist"' -DKBUILD_BASENAME='"scatterlist"' -DKBUILD_MODNAME='"scatterlist"' -D__KBUILD_MODNAME=kmod_scatterlist -c -o lib/scatterlist.o lib/scatterlist.c  

lib/scatterlist.c should add these lines:
#include <asm/bug.h>                   // for WARN_ON, BUG_ON, WARN_ON_ONCE
#include <cstdio>                      // for off_t, size_t, NULL
#include "asm-generic/cacheflush.h"    // for flush_dcache_page
#include "asm-generic/errno-base.h"    // for EINVAL, ENOMEM
#include "asm-generic/errno.h"         // for EOPNOTSUPP
#include "asm-generic/int-ll64.h"      // for u64
#include "asm-generic/memory_model.h"  // for page_to_pfn
#include "asm/page_types.h"            // for PAGE_SIZE, PAGE_SHIFT
#include "asm/string_32.h"             // for memset, memcpy
#include "linux/align.h"               // for ALIGN_DOWN
#include "linux/compiler.h"            // for unlikely
#include "linux/err.h"                 // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/gfp.h"                 // for __get_free_page, free_page
#include "linux/highmem-internal.h"    // for kmap, kmap_atomic, kunmap, kun...
#include "linux/kconfig.h"             // for IS_ENABLED
#include "linux/minmax.h"              // for min_t, min
#include "linux/mm.h"                  // for PAGE_ALIGN
#include "linux/stddef.h"              // for false, true
#include "linux/types.h"               // for bool, gfp_t
#include "linux/uaccess.h"             // for pagefault_disabled
struct page;

lib/scatterlist.c should remove these lines:
- #include <linux/highmem.h>  // lines 10-10

The full include-list for lib/scatterlist.c:
#include <asm/bug.h>                   // for WARN_ON, BUG_ON, WARN_ON_ONCE
#include <linux/export.h>              // for EXPORT_SYMBOL
#include <linux/kmemleak.h>            // for kmemleak_alloc, kmemleak_free
#include <linux/scatterlist.h>         // for sg_mapping_iter, sg_page_iter
#include <linux/slab.h>                // for kfree, kmalloc_array
#include <cstdio>                      // for off_t, size_t, NULL
#include "asm-generic/cacheflush.h"    // for flush_dcache_page
#include "asm-generic/errno-base.h"    // for EINVAL, ENOMEM
#include "asm-generic/errno.h"         // for EOPNOTSUPP
#include "asm-generic/int-ll64.h"      // for u64
#include "asm-generic/memory_model.h"  // for page_to_pfn
#include "asm/page_types.h"            // for PAGE_SIZE, PAGE_SHIFT
#include "asm/string_32.h"             // for memset, memcpy
#include "linux/align.h"               // for ALIGN_DOWN
#include "linux/compiler.h"            // for unlikely
#include "linux/err.h"                 // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/gfp.h"                 // for __get_free_page, free_page
#include "linux/highmem-internal.h"    // for kmap, kmap_atomic, kunmap, kun...
#include "linux/kconfig.h"             // for IS_ENABLED
#include "linux/minmax.h"              // for min_t, min
#include "linux/mm.h"                  // for PAGE_ALIGN
#include "linux/stddef.h"              // for false, true
#include "linux/types.h"               // for bool, gfp_t
#include "linux/uaccess.h"             // for pagefault_disabled
struct page;
---
  ./scripts/check-local-export lib/scatterlist.o
  iwyu2 -Wp,-MMD,lib/.list_sort.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/list_sort"' -DKBUILD_BASENAME='"list_sort"' -DKBUILD_MODNAME='"list_sort"' -D__KBUILD_MODNAME=kmod_list_sort -c -o lib/list_sort.o lib/list_sort.c  

lib/list_sort.c should add these lines:
#include <stddef.h>                // for NULL, size_t
#include "asm-generic/int-ll64.h"  // for u8
#include "linux/types.h"           // for list_head

lib/list_sort.c should remove these lines:
- #include <linux/bug.h>  // lines 3-3
- #include <linux/kernel.h>  // lines 2-2
- #include <linux/list.h>  // lines 8-8
- #include <linux/string.h>  // lines 6-6

The full include-list for lib/list_sort.c:
#include <linux/compiler.h>        // for likely, unlikely
#include <linux/export.h>          // for EXPORT_SYMBOL
#include <linux/list_sort.h>       // for list_cmp_func_t, list_sort
#include <stddef.h>                // for NULL, size_t
#include "asm-generic/int-ll64.h"  // for u8
#include "linux/types.h"           // for list_head
---
  ./scripts/check-local-export lib/list_sort.o
  iwyu2 -Wp,-MMD,lib/.uuid.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/uuid"' -DKBUILD_BASENAME='"uuid"' -DKBUILD_MODNAME='"uuid"' -D__KBUILD_MODNAME=kmod_uuid -c -o lib/uuid.o lib/uuid.c  

lib/uuid.c should add these lines:
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm-generic/int-ll64.h"    // for __u8, u8
#include "linux/prandom.h"           // for prandom_bytes
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool
#include "linux/uuid.h"              // for guid_t

lib/uuid.c should remove these lines:
- #include <linux/errno.h>  // lines 11-11

The full include-list for lib/uuid.c:
#include <linux/ctype.h>             // for isxdigit
#include <linux/export.h>            // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/kernel.h>            // for hex_to_bin
#include <linux/random.h>            // for get_random_bytes
#include <linux/uuid.h>              // for uuid_t, UUID_STRING_LEN, generat...
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm-generic/int-ll64.h"    // for __u8, u8
#include "linux/prandom.h"           // for prandom_bytes
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool
#include "linux/uuid.h"              // for guid_t
---
  ./scripts/check-local-export lib/uuid.o
  iwyu2 -Wp,-MMD,lib/.iov_iter.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/iov_iter"' -DKBUILD_BASENAME='"iov_iter"' -DKBUILD_MODNAME='"iov_iter"' -D__KBUILD_MODNAME=kmod_iov_iter -c -o lib/iov_iter.o lib/iov_iter.c  

lib/iov_iter.c should add these lines:
#include <asm/bug.h>                      // for WARN_ON, BUG_ON, WARN_ON_ONCE
#include <asm/compat.h>                   // for compat_uptr_t, compat_size_t
#include <linux/mm.h>                     // for folio_test_hugetlb, compoun...
#include <cstdio>                         // for size_t, ssize_t, NULL
#include "asm-generic/errno-base.h"       // for EFAULT, ENOMEM, EINVAL
#include "asm/bug.h"                      // for BUG
#include "asm/checksum_32.h"              // for csum_and_copy_from_user
#include "asm/page_types.h"               // for PAGE_SIZE, PAGE_MASK, PAGE_...
#include "asm/string_32.h"                // for memcpy, memset
#include "asm/uaccess.h"                  // for access_ok, clear_user, unsa...
#include "asm/uaccess_32.h"               // for __copy_from_user_inatomic_n...
#include "linux/build_bug.h"              // for BUILD_BUG_ON
#include "linux/compiler.h"               // for unlikely, likely
#include "linux/compiler_types.h"         // for __user, inline
#include "linux/err.h"                    // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/fs.h"                     // for MAX_RW_COUNT
#include "linux/gfp.h"                    // for GFP_KERNEL, GFP_USER, alloc...
#include "linux/highmem-internal.h"       // for kmap_local_page, kmap_local...
#include "linux/kconfig.h"                // for IS_ENABLED
#include "linux/kern_levels.h"            // for KERN_ERR
#include "linux/kernel.h"                 // for might_fault, READ, WRITE
#include "linux/math.h"                   // for DIV_ROUND_UP
#include "linux/minmax.h"                 // for min, min_t
#include "linux/mm.h"                     // for folio_size, get_page, offse...
#include "linux/mm_types.h"               // for page
#include "linux/pipe_fs_i.h"              // for pipe_buffer, pipe_inode_info
#include "linux/printk.h"                 // for printk
#include "linux/rcupdate.h"               // for rcu_read_lock, rcu_read_unlock
#include "linux/stddef.h"                 // for false, true
#include "linux/string.h"                 // for kmemdup
#include "linux/types.h"                  // for pgoff_t, __wsum, loff_t, bool
#include "linux/uaccess.h"                // for copy_from_user
#include "linux/uio.h"                    // for iovec, iov_iter (ptr only)
#include "linux/xarray.h"                 // for xas_retry, xa_is_value, XA_...
#include "vdso/limits.h"                  // for ULONG_MAX

lib/iov_iter.c should remove these lines:
- #include <crypto/hash.h>  // lines 2-2
- #include <linux/scatterlist.h>  // lines 14-14
- #include <linux/vmalloc.h>  // lines 10-10

The full include-list for lib/iov_iter.c:
#include <asm/bug.h>                      // for WARN_ON, BUG_ON, WARN_ON_ONCE
#include <asm/compat.h>                   // for compat_uptr_t, compat_size_t
#include <linux/bvec.h>                   // for bio_vec, bvec_iter, bvec_it...
#include <linux/compat.h>                 // for compat_iovec, compat_ptr
#include <linux/export.h>                 // for EXPORT_SYMBOL
#include <linux/fault-inject-usercopy.h>  // for should_fail_usercopy
#include <linux/highmem.h>                // for memcpy_to_page
#include <linux/instrumented.h>           // for instrument_copy_from_user
#include <linux/mm.h>                     // for folio_test_hugetlb, compoun...
#include <linux/pagemap.h>                // for fault_in_readable, fault_in...
#include <linux/slab.h>                   // for kfree, kvfree, kmalloc_array
#include <linux/splice.h>                 // for default_pipe_buf_ops, page_...
#include <linux/uio.h>                    // for iov_iter, iov_iter::(anonym...
#include <net/checksum.h>                 // for csum_block_add, csum_shift
#include <cstdio>                         // for size_t, ssize_t, NULL
#include "asm-generic/errno-base.h"       // for EFAULT, ENOMEM, EINVAL
#include "asm/bug.h"                      // for BUG
#include "asm/checksum_32.h"              // for csum_and_copy_from_user
#include "asm/page_types.h"               // for PAGE_SIZE, PAGE_MASK, PAGE_...
#include "asm/string_32.h"                // for memcpy, memset
#include "asm/uaccess.h"                  // for access_ok, clear_user, unsa...
#include "asm/uaccess_32.h"               // for __copy_from_user_inatomic_n...
#include "linux/build_bug.h"              // for BUILD_BUG_ON
#include "linux/compiler.h"               // for unlikely, likely
#include "linux/compiler_types.h"         // for __user, inline
#include "linux/err.h"                    // for ERR_PTR, IS_ERR, PTR_ERR
#include "linux/fs.h"                     // for MAX_RW_COUNT
#include "linux/gfp.h"                    // for GFP_KERNEL, GFP_USER, alloc...
#include "linux/highmem-internal.h"       // for kmap_local_page, kmap_local...
#include "linux/kconfig.h"                // for IS_ENABLED
#include "linux/kern_levels.h"            // for KERN_ERR
#include "linux/kernel.h"                 // for might_fault, READ, WRITE
#include "linux/math.h"                   // for DIV_ROUND_UP
#include "linux/minmax.h"                 // for min, min_t
#include "linux/mm.h"                     // for folio_size, get_page, offse...
#include "linux/mm_types.h"               // for page
#include "linux/pipe_fs_i.h"              // for pipe_buffer, pipe_inode_info
#include "linux/printk.h"                 // for printk
#include "linux/rcupdate.h"               // for rcu_read_lock, rcu_read_unlock
#include "linux/stddef.h"                 // for false, true
#include "linux/string.h"                 // for kmemdup
#include "linux/types.h"                  // for pgoff_t, __wsum, loff_t, bool
#include "linux/uaccess.h"                // for copy_from_user
#include "linux/uio.h"                    // for iovec, iov_iter (ptr only)
#include "linux/xarray.h"                 // for xas_retry, xa_is_value, XA_...
#include "vdso/limits.h"                  // for ULONG_MAX
---
  ./scripts/check-local-export lib/iov_iter.o
  iwyu2 -Wp,-MMD,lib/.clz_ctz.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/clz_ctz"' -DKBUILD_BASENAME='"clz_ctz"' -DKBUILD_MODNAME='"clz_ctz"' -D__KBUILD_MODNAME=kmod_clz_ctz -c -o lib/clz_ctz.o lib/clz_ctz.c  

lib/clz_ctz.c should add these lines:
#include <linux/bitops.h>               // for __ffs, fls
#include "asm-generic/bitsperlong.h"    // for BITS_PER_LONG
#include "asm-generic/int-ll64.h"       // for u32
#include "linux/compiler_attributes.h"  // for __weak

lib/clz_ctz.c should remove these lines:
- #include <linux/kernel.h>  // lines 15-15

The full include-list for lib/clz_ctz.c:
#include <linux/bitops.h>               // for __ffs, fls
#include <linux/export.h>               // for EXPORT_SYMBOL
#include "asm-generic/bitsperlong.h"    // for BITS_PER_LONG
#include "asm-generic/int-ll64.h"       // for u32
#include "linux/compiler_attributes.h"  // for __weak
---
  ./scripts/check-local-export lib/clz_ctz.o
  iwyu2 -Wp,-MMD,lib/.bsearch.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/bsearch"' -DKBUILD_BASENAME='"bsearch"' -DKBUILD_MODNAME='"bsearch"' -D__KBUILD_MODNAME=kmod_bsearch -c -o lib/bsearch.o lib/bsearch.c  

lib/bsearch.c should add these lines:
#include <stddef.h>               // for size_t
#include "asm-generic/kprobes.h"  // for NOKPROBE_SYMBOL
#include "linux/types.h"          // for cmp_func_t

lib/bsearch.c should remove these lines:
- #include <linux/kprobes.h>  // lines 11-11

The full include-list for lib/bsearch.c:
#include <linux/bsearch.h>        // for __inline_bsearch, bsearch
#include <linux/export.h>         // for EXPORT_SYMBOL
#include <stddef.h>               // for size_t
#include "asm-generic/kprobes.h"  // for NOKPROBE_SYMBOL
#include "linux/types.h"          // for cmp_func_t
---
  ./scripts/check-local-export lib/bsearch.o
  iwyu2 -Wp,-MMD,lib/.find_bit.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/find_bit"' -DKBUILD_BASENAME='"find_bit"' -DKBUILD_MODNAME='"find_bit"' -D__KBUILD_MODNAME=kmod_find_bit -c -o lib/find_bit.o lib/find_bit.c  

lib/find_bit.c should add these lines:
#include "asm-generic/bitsperlong.h"  // for BITS_PER_LONG
#include "linux/compiler.h"           // for unlikely

lib/find_bit.c should remove these lines:

The full include-list for lib/find_bit.c:
#include <linux/bitmap.h>             // for bitmap_get_value8, find_next_bit
#include <linux/bitops.h>             // for __ffs, ffz, __fls
#include <linux/export.h>             // for EXPORT_SYMBOL
#include <linux/math.h>               // for round_down
#include <linux/minmax.h>             // for min
#include <linux/swab.h>               // for swab
#include "asm-generic/bitsperlong.h"  // for BITS_PER_LONG
#include "linux/compiler.h"           // for unlikely
---
  ./scripts/check-local-export lib/find_bit.o
  iwyu2 -Wp,-MMD,lib/.llist.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/llist"' -DKBUILD_BASENAME='"llist"' -DKBUILD_MODNAME='"llist"' -D__KBUILD_MODNAME=kmod_llist -c -o lib/llist.o lib/llist.c  

lib/llist.c should add these lines:
#include <asm/barrier.h>                       // for smp_load_acquire
#include <stddef.h>                            // for NULL
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "linux/atomic/atomic-instrumented.h"  // for cmpxchg
#include "linux/types.h"                       // for bool

lib/llist.c should remove these lines:
- #include <linux/kernel.h>  // lines 13-13

The full include-list for lib/llist.c:
#include <asm/barrier.h>                       // for smp_load_acquire
#include <linux/export.h>                      // for EXPORT_SYMBOL_GPL
#include <linux/llist.h>                       // for llist_head, llist_node
#include <stddef.h>                            // for NULL
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "linux/atomic/atomic-instrumented.h"  // for cmpxchg
#include "linux/types.h"                       // for bool
---
  ./scripts/check-local-export lib/llist.o
  iwyu2 -Wp,-MMD,lib/.memweight.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/memweight"' -DKBUILD_BASENAME='"memweight"' -DKBUILD_MODNAME='"memweight"' -D__KBUILD_MODNAME=kmod_memweight -c -o lib/memweight.o lib/memweight.c  

lib/memweight.c should add these lines:
#include <asm/bug.h>                           // for BUG_ON
#include <stddef.h>                            // for size_t
#include "asm-generic/bitops/const_hweight.h"  // for hweight8
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "linux/string.h"                      // for memweight
#include "vdso/limits.h"                       // for INT_MAX

lib/memweight.c should remove these lines:
- #include <linux/bug.h>  // lines 3-3

The full include-list for lib/memweight.c:
#include <asm/bug.h>                           // for BUG_ON
#include <linux/bitmap.h>                      // for bitmap_weight
#include <linux/export.h>                      // for EXPORT_SYMBOL
#include <stddef.h>                            // for size_t
#include "asm-generic/bitops/const_hweight.h"  // for hweight8
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "linux/string.h"                      // for memweight
#include "vdso/limits.h"                       // for INT_MAX
---
  ./scripts/check-local-export lib/memweight.o
  iwyu2 -Wp,-MMD,lib/.kfifo.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/kfifo"' -DKBUILD_BASENAME='"kfifo"' -DKBUILD_MODNAME='"kfifo"' -D__KBUILD_MODNAME=kmod_kfifo -c -o lib/kfifo.o lib/kfifo.c  

lib/kfifo.c should add these lines:
#include <asm/barrier.h>             // for smp_wmb
#include <asm/bug.h>                 // for BUG_ON
#include <stddef.h>                  // for size_t, NULL
#include "asm-generic/errno-base.h"  // for EFAULT, EINVAL, ENOMEM
#include "asm/io.h"                  // for page_to_phys
#include "asm/page.h"                // for virt_to_page
#include "asm/page_types.h"          // for PAGE_SIZE
#include "asm/string_32.h"           // for memcpy
#include "linux/compiler.h"          // for unlikely
#include "linux/compiler_types.h"    // for __user, inline
#include "linux/math.h"              // for DIV_ROUND_UP
#include "linux/minmax.h"            // for min
#include "linux/mm.h"                // for offset_in_page
#include "linux/scatterlist.h"       // for sg_set_page, sg_next, scatterlist
#include "linux/types.h"             // for gfp_t

lib/kfifo.c should remove these lines:
- #include <linux/err.h>  // lines 11-11
- #include <linux/kernel.h>  // lines 8-8

The full include-list for lib/kfifo.c:
#include <asm/barrier.h>             // for smp_wmb
#include <asm/bug.h>                 // for BUG_ON
#include <linux/export.h>            // for EXPORT_SYMBOL
#include <linux/kfifo.h>             // for __kfifo, __kfifo_alloc, __kfifo_...
#include <linux/log2.h>              // for is_power_of_2, rounddown_pow_of_two
#include <linux/slab.h>              // for kfree, kmalloc_array
#include <linux/uaccess.h>           // for copy_from_user, copy_to_user
#include <stddef.h>                  // for size_t, NULL
#include "asm-generic/errno-base.h"  // for EFAULT, EINVAL, ENOMEM
#include "asm/io.h"                  // for page_to_phys
#include "asm/page.h"                // for virt_to_page
#include "asm/page_types.h"          // for PAGE_SIZE
#include "asm/string_32.h"           // for memcpy
#include "linux/compiler.h"          // for unlikely
#include "linux/compiler_types.h"    // for __user, inline
#include "linux/math.h"              // for DIV_ROUND_UP
#include "linux/minmax.h"            // for min
#include "linux/mm.h"                // for offset_in_page
#include "linux/scatterlist.h"       // for sg_set_page, sg_next, scatterlist
#include "linux/types.h"             // for gfp_t
---
  ./scripts/check-local-export lib/kfifo.o
  iwyu2 -Wp,-MMD,lib/.percpu-refcount.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/percpu-refcount"' -DKBUILD_BASENAME='"percpu_refcount"' -DKBUILD_MODNAME='"percpu_refcount"' -D__KBUILD_MODNAME=kmod_percpu_refcount -c -o lib/percpu-refcount.o lib/percpu-refcount.c  

lib/percpu-refcount.c should add these lines:
#include <asm-generic/percpu.h>                // for per_cpu_ptr
#include <asm/barrier.h>                       // for smp_store_release
#include <asm/bug.h>                           // for WARN_ON_ONCE, WARN_ONCE
#include <stddef.h>                            // for size_t, NULL
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm-generic/errno-base.h"            // for ENOMEM
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_read, atom...
#include "linux/compiler_types.h"              // for __percpu
#include "linux/container_of.h"                // for container_of
#include "linux/cpumask.h"                     // for for_each_possible_cpu
#include "linux/export.h"                      // for EXPORT_SYMBOL_GPL
#include "linux/lockdep.h"                     // for lockdep_assert_held
#include "linux/minmax.h"                      // for max_t
#include "linux/percpu.h"                      // for free_percpu, __alloc_p...
#include "linux/printk.h"                      // for pr_debug, pr_err
#include "linux/rcupdate.h"                    // for call_rcu
#include "linux/spinlock.h"                    // for spin_unlock_irqrestore
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for rcu_head, atomic_t, bool

lib/percpu-refcount.c should remove these lines:
- #include <linux/kernel.h>  // lines 4-4
- #include <linux/sched.h>  // lines 5-5

The full include-list for lib/percpu-refcount.c:
#include <asm-generic/percpu.h>                // for per_cpu_ptr
#include <asm/barrier.h>                       // for smp_store_release
#include <asm/bug.h>                           // for WARN_ON_ONCE, WARN_ONCE
#include <linux/mm.h>                          // for mem_dump_obj
#include <linux/percpu-refcount.h>             // for percpu_ref, percpu_ref...
#include <linux/slab.h>                        // for kfree, kzalloc
#include <linux/wait.h>                        // for wait_queue_head, DECLA...
#include <stddef.h>                            // for size_t, NULL
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm-generic/errno-base.h"            // for ENOMEM
#include "linux/atomic/atomic-instrumented.h"  // for atomic_long_read, atom...
#include "linux/compiler_types.h"              // for __percpu
#include "linux/container_of.h"                // for container_of
#include "linux/cpumask.h"                     // for for_each_possible_cpu
#include "linux/export.h"                      // for EXPORT_SYMBOL_GPL
#include "linux/lockdep.h"                     // for lockdep_assert_held
#include "linux/minmax.h"                      // for max_t
#include "linux/percpu.h"                      // for free_percpu, __alloc_p...
#include "linux/printk.h"                      // for pr_debug, pr_err
#include "linux/rcupdate.h"                    // for call_rcu
#include "linux/spinlock.h"                    // for spin_unlock_irqrestore
#include "linux/spinlock_types.h"              // for DEFINE_SPINLOCK
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for rcu_head, atomic_t, bool
---
  ./scripts/check-local-export lib/percpu-refcount.o
  iwyu2 -Wp,-MMD,lib/.rhashtable.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/rhashtable"' -DKBUILD_BASENAME='"rhashtable"' -DKBUILD_MODNAME='"rhashtable"' -D__KBUILD_MODNAME=kmod_rhashtable -c -o lib/rhashtable.o lib/rhashtable.c  

lib/rhashtable.c should add these lines:
#include <asm/barrier.h>                       // for smp_rmb
#include <linux/build_bug.h>                   // for unlikely, likely
#include <stddef.h>                            // for NULL, size_t
#include "asm-generic/errno-base.h"            // for EAGAIN, EEXIST, ENOENT
#include "asm-generic/int-ll64.h"              // for u16, u32
#include "asm/page_types.h"                    // for PAGE_SHIFT, PAGE_SIZE
#include "asm/string_32.h"                     // for memcpy, memset
#include "linux/atomic/atomic-instrumented.h"  // for atomic_inc, atomic_read
#include "linux/compiler_types.h"              // for __rcu, __acquires, __r...
#include "linux/container_of.h"                // for container_of
#include "linux/gfp.h"                         // for GFP_KERNEL, GFP_ATOMIC
#include "linux/list.h"                        // for list_add, list_del
#include "linux/lockdep.h"                     // for lockdep_is_held, SINGL...
#include "linux/lockdep_types.h"               // for lock_class_key
#include "linux/minmax.h"                      // for max, max_t
#include "linux/mutex.h"                       // for mutex_lock, mutex_unlock
#include "linux/overflow.h"                    // for struct_size
#include "linux/rcupdate.h"                    // for rcu_dereference, RCU_I...
#include "linux/rhashtable-types.h"            // for rhashtable, rhashtable...
#include "linux/spinlock.h"                    // for spin_lock, spin_unlock
#include "linux/stddef.h"                      // for true, false
#include "linux/types.h"                       // for bool, list_head, gfp_t
#include "linux/workqueue.h"                   // for schedule_work, cancel_...

lib/rhashtable.c should remove these lines:
- #include <linux/atomic.h>  // lines 14-14
- #include <linux/init.h>  // lines 16-16
- #include <linux/kernel.h>  // lines 15-15
- #include <linux/mm.h>  // lines 22-22
- #include <linux/rculist.h>  // lines 19-19
- #include <linux/vmalloc.h>  // lines 21-21

The full include-list for lib/rhashtable.c:
#include <asm/barrier.h>                       // for smp_rmb
#include <linux/build_bug.h>                   // for unlikely, likely
#include <linux/err.h>                         // for ERR_PTR, PTR_ERR, ERR_...
#include <linux/export.h>                      // for EXPORT_SYMBOL_GPL
#include <linux/jhash.h>                       // for jhash2, jhash
#include <linux/log2.h>                        // for ilog2, roundup_pow_of_two
#include <linux/random.h>                      // for get_random_u32
#include <linux/rhashtable.h>                  // for bucket_table, rht_obj
#include <linux/sched.h>                       // for cond_resched
#include <linux/slab.h>                        // for kfree, kzalloc, kvfree
#include <stddef.h>                            // for NULL, size_t
#include "asm-generic/errno-base.h"            // for EAGAIN, EEXIST, ENOENT
#include "asm-generic/int-ll64.h"              // for u16, u32
#include "asm/page_types.h"                    // for PAGE_SHIFT, PAGE_SIZE
#include "asm/string_32.h"                     // for memcpy, memset
#include "linux/atomic/atomic-instrumented.h"  // for atomic_inc, atomic_read
#include "linux/compiler_types.h"              // for __rcu, __acquires, __r...
#include "linux/container_of.h"                // for container_of
#include "linux/gfp.h"                         // for GFP_KERNEL, GFP_ATOMIC
#include "linux/list.h"                        // for list_add, list_del
#include "linux/lockdep.h"                     // for lockdep_is_held, SINGL...
#include "linux/lockdep_types.h"               // for lock_class_key
#include "linux/minmax.h"                      // for max, max_t
#include "linux/mutex.h"                       // for mutex_lock, mutex_unlock
#include "linux/overflow.h"                    // for struct_size
#include "linux/rcupdate.h"                    // for rcu_dereference, RCU_I...
#include "linux/rhashtable-types.h"            // for rhashtable, rhashtable...
#include "linux/spinlock.h"                    // for spin_lock, spin_unlock
#include "linux/stddef.h"                      // for true, false
#include "linux/types.h"                       // for bool, list_head, gfp_t
#include "linux/workqueue.h"                   // for schedule_work, cancel_...
---
  ./scripts/check-local-export lib/rhashtable.o
  iwyu2 -Wp,-MMD,lib/.once.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/once"' -DKBUILD_BASENAME='"once"' -DKBUILD_MODNAME='"once"' -D__KBUILD_MODNAME=kmod_once -c -o lib/once.o lib/once.c  

lib/once.c should add these lines:
#include <asm/bug.h>               // for BUG_ON
#include "linux/compiler_types.h"  // for __acquire, __acquires, __releases
#include "linux/container_of.h"    // for container_of
#include "linux/export.h"          // for EXPORT_SYMBOL
#include "linux/gfp.h"             // for GFP_ATOMIC
#include "linux/jump_label.h"      // for static_key_true (ptr only), static...
#include "linux/spinlock_types.h"  // for DEFINE_SPINLOCK
#include "linux/stddef.h"          // for true, false
#include "linux/types.h"           // for bool
#include "linux/workqueue.h"       // for work_struct, schedule_work, INIT_WORK
struct module;

lib/once.c should remove these lines:
- #include <linux/random.h>  // lines 5-5

The full include-list for lib/once.c:
#include <asm/bug.h>               // for BUG_ON
#include <linux/module.h>          // for __module_get, module_put
#include <linux/slab.h>            // for kfree, kmalloc
#include <linux/spinlock.h>        // for spin_unlock_irqrestore, spin_lock_...
#include "linux/compiler_types.h"  // for __acquire, __acquires, __releases
#include "linux/container_of.h"    // for container_of
#include "linux/export.h"          // for EXPORT_SYMBOL
#include "linux/gfp.h"             // for GFP_ATOMIC
#include "linux/jump_label.h"      // for static_key_true (ptr only), static...
#include "linux/spinlock_types.h"  // for DEFINE_SPINLOCK
#include "linux/stddef.h"          // for true, false
#include "linux/types.h"           // for bool
#include "linux/workqueue.h"       // for work_struct, schedule_work, INIT_WORK
struct module;
---
  ./scripts/check-local-export lib/once.o
  iwyu2 -Wp,-MMD,lib/.refcount.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/refcount"' -DKBUILD_BASENAME='"refcount"' -DKBUILD_MODNAME='"refcount"' -D__KBUILD_MODNAME=kmod_refcount -c -o lib/refcount.o lib/refcount.c  

lib/refcount.c should add these lines:
#include <asm/bug.h>                           // for WARN_ONCE
#include "linux/atomic/atomic-instrumented.h"  // for atomic_try_cmpxchg_rel...
#include "linux/compiler.h"                    // for unlikely
#include "linux/export.h"                      // for EXPORT_SYMBOL
#include "linux/spinlock_types.h"              // for spinlock_t
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for bool

lib/refcount.c should remove these lines:
- #include <linux/bug.h>  // lines 9-9

The full include-list for lib/refcount.c:
#include <asm/bug.h>                           // for WARN_ONCE
#include <linux/mutex.h>                       // for mutex_lock, mutex_unlock
#include <linux/refcount.h>                    // for refcount_dec_and_test
#include <linux/spinlock.h>                    // for spin_lock, spin_unlock
#include "linux/atomic/atomic-instrumented.h"  // for atomic_try_cmpxchg_rel...
#include "linux/compiler.h"                    // for unlikely
#include "linux/export.h"                      // for EXPORT_SYMBOL
#include "linux/spinlock_types.h"              // for spinlock_t
#include "linux/stddef.h"                      // for false, true
#include "linux/types.h"                       // for bool
---
  ./scripts/check-local-export lib/refcount.o
  iwyu2 -Wp,-MMD,lib/.usercopy.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/usercopy"' -DKBUILD_BASENAME='"usercopy"' -DKBUILD_MODNAME='"usercopy"' -D__KBUILD_MODNAME=kmod_usercopy -c -o lib/usercopy.o lib/usercopy.c  

lib/usercopy.c should add these lines:
#include <stddef.h>                       // for size_t
#include <stdint.h>                       // for uintptr_t
#include "asm-generic/errno-base.h"       // for EFAULT
#include "asm/string_32.h"                // for memset
#include "asm/uaccess.h"                  // for access_ok, unsafe_get_user
#include "asm/uaccess_32.h"               // for raw_copy_from_user, raw_cop...
#include "linux/compiler.h"               // for unlikely, likely
#include "linux/compiler_types.h"         // for __user
#include "linux/export.h"                 // for EXPORT_SYMBOL
#include "linux/kernel.h"                 // for might_fault

lib/usercopy.c should remove these lines:

The full include-list for lib/usercopy.c:
#include <linux/bitops.h>                 // for aligned_byte_mask
#include <linux/fault-inject-usercopy.h>  // for should_fail_usercopy
#include <linux/instrumented.h>           // for instrument_copy_from_user
#include <linux/uaccess.h>                // for user_read_access_end, _copy...
#include <stddef.h>                       // for size_t
#include <stdint.h>                       // for uintptr_t
#include "asm-generic/errno-base.h"       // for EFAULT
#include "asm/string_32.h"                // for memset
#include "asm/uaccess.h"                  // for access_ok, unsafe_get_user
#include "asm/uaccess_32.h"               // for raw_copy_from_user, raw_cop...
#include "linux/compiler.h"               // for unlikely, likely
#include "linux/compiler_types.h"         // for __user
#include "linux/export.h"                 // for EXPORT_SYMBOL
#include "linux/kernel.h"                 // for might_fault
---
  ./scripts/check-local-export lib/usercopy.o
  iwyu2 -Wp,-MMD,lib/.errseq.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/errseq"' -DKBUILD_BASENAME='"errseq"' -DKBUILD_MODNAME='"errseq"' -D__KBUILD_MODNAME=kmod_errseq -c -o lib/errseq.o lib/errseq.c  

lib/errseq.c should add these lines:
#include <asm/bug.h>                           // for WARN
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "linux/atomic/atomic-instrumented.h"  // for cmpxchg
#include "linux/build_bug.h"                   // for BUILD_BUG_ON_NOT_POWER...
#include "linux/compiler.h"                    // for likely, unlikely
#include "linux/export.h"                      // for EXPORT_SYMBOL

lib/errseq.c should remove these lines:
- #include <linux/atomic.h>  // lines 4-4
- #include <linux/bug.h>  // lines 3-3

The full include-list for lib/errseq.c:
#include <asm/bug.h>                           // for WARN
#include <linux/err.h>                         // for MAX_ERRNO
#include <linux/errseq.h>                      // for errseq_t, errseq_check
#include <linux/log2.h>                        // for ilog2
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "linux/atomic/atomic-instrumented.h"  // for cmpxchg
#include "linux/build_bug.h"                   // for BUILD_BUG_ON_NOT_POWER...
#include "linux/compiler.h"                    // for likely, unlikely
#include "linux/export.h"                      // for EXPORT_SYMBOL
---
  ./scripts/check-local-export lib/errseq.o
  iwyu2 -Wp,-MMD,lib/.bucket_locks.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/bucket_locks"' -DKBUILD_BASENAME='"bucket_locks"' -DKBUILD_MODNAME='"bucket_locks"' -D__KBUILD_MODNAME=kmod_bucket_locks -c -o lib/bucket_locks.o lib/bucket_locks.c  

lib/bucket_locks.c should add these lines:
#include <stddef.h>                  // for NULL, size_t
#include "asm-generic/errno-base.h"  // for ENOMEM
#include "linux/cpumask.h"           // for num_possible_cpus
#include "linux/lockdep.h"           // for lockdep_init_map
#include "linux/minmax.h"            // for min_t
#include "linux/spinlock.h"          // for __alloc_bucket_spinlocks, free_b...
#include "linux/spinlock_types.h"    // for spinlock_t
#include "linux/types.h"             // for gfp_t
struct lock_class_key;

lib/bucket_locks.c should remove these lines:
- #include <linux/kernel.h>  // lines 2-2
- #include <linux/mm.h>  // lines 3-3
- #include <linux/vmalloc.h>  // lines 5-5

The full include-list for lib/bucket_locks.c:
#include <linux/export.h>            // for EXPORT_SYMBOL
#include <linux/slab.h>              // for kvfree, kvmalloc_array
#include <stddef.h>                  // for NULL, size_t
#include "asm-generic/errno-base.h"  // for ENOMEM
#include "linux/cpumask.h"           // for num_possible_cpus
#include "linux/lockdep.h"           // for lockdep_init_map
#include "linux/minmax.h"            // for min_t
#include "linux/spinlock.h"          // for __alloc_bucket_spinlocks, free_b...
#include "linux/spinlock_types.h"    // for spinlock_t
#include "linux/types.h"             // for gfp_t
struct lock_class_key;
---
  ./scripts/check-local-export lib/bucket_locks.o
  iwyu2 -Wp,-MMD,lib/.generic-radix-tree.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/generic-radix-tree"' -DKBUILD_BASENAME='"generic_radix_tree"' -DKBUILD_MODNAME='"generic_radix_tree"' -D__KBUILD_MODNAME=kmod_generic_radix_tree -c -o lib/generic-radix-tree.o lib/generic-radix-tree.c  

lib/generic-radix-tree.c should add these lines:
#include <stddef.h>                            // for NULL, size_t
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm-generic/errno-base.h"            // for ENOMEM
#include "asm-generic/int-ll64.h"              // for u8
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "asm/cmpxchg.h"                       // for __xchg_wrong_size
#include "asm/page_types.h"                    // for PAGE_SIZE, PAGE_SHIFT
#include "linux/atomic/atomic-instrumented.h"  // for cmpxchg_release, xchg
#include "linux/compiler_types.h"              // for inline
#include "linux/log2.h"                        // for ilog2, roundup_pow_of_two
#include "linux/math.h"                        // for DIV_ROUND_UP, round_down
#include "linux/minmax.h"                      // for swap
#include "linux/types.h"                       // for gfp_t
struct genradix_root;

lib/generic-radix-tree.c should remove these lines:

The full include-list for lib/generic-radix-tree.c:
#include <linux/export.h>                      // for EXPORT_SYMBOL
#include <linux/generic-radix-tree.h>          // for __genradix, genradix_iter
#include <linux/gfp.h>                         // for __GFP_ZERO, __get_free...
#include <linux/kmemleak.h>                    // for kmemleak_alloc, kmemle...
#include <stddef.h>                            // for NULL, size_t
#include "asm-generic/bitsperlong.h"           // for BITS_PER_LONG
#include "asm-generic/errno-base.h"            // for ENOMEM
#include "asm-generic/int-ll64.h"              // for u8
#include "asm-generic/rwonce.h"                // for READ_ONCE
#include "asm/cmpxchg.h"                       // for __xchg_wrong_size
#include "asm/page_types.h"                    // for PAGE_SIZE, PAGE_SHIFT
#include "linux/atomic/atomic-instrumented.h"  // for cmpxchg_release, xchg
#include "linux/compiler_types.h"              // for inline
#include "linux/log2.h"                        // for ilog2, roundup_pow_of_two
#include "linux/math.h"                        // for DIV_ROUND_UP, round_down
#include "linux/minmax.h"                      // for swap
#include "linux/types.h"                       // for gfp_t
struct genradix_root;
---
  ./scripts/check-local-export lib/generic-radix-tree.o
  iwyu2 -Wp,-MMD,lib/.string_helpers.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/string_helpers"' -DKBUILD_BASENAME='"string_helpers"' -DKBUILD_MODNAME='"string_helpers"' -D__KBUILD_MODNAME=kmod_string_helpers -c -o lib/string_helpers.o lib/string_helpers.c  
In file included from lib/string_helpers.c:13:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/string_helpers.c:13:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/string_helpers.c:13:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from lib/string_helpers.c:13:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/string_helpers.c:13:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/string_helpers.c:13:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

lib/string_helpers.c should add these lines:
#include <asm/bug.h>                 // for WARN_ON
#include <cstdio>                    // for size_t, NULL, ssize_t
#include "asm-generic/errno-base.h"  // for EINVAL, ENOMEM
#include "asm-generic/int-ll64.h"    // for u32, u64, u8
#include "asm/div64.h"               // for do_div
#include "asm/page_types.h"          // for PAGE_SIZE
#include "asm/string_32.h"           // for strlen, strchr, strcmp, memcpy
#include "linux/err.h"               // for ERR_PTR, IS_ERR
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/limits.h"            // for PATH_MAX
#include "linux/stddef.h"            // for true, false
#include "linux/types.h"             // for bool, gfp_t
struct task_struct;

lib/string_helpers.c should remove these lines:
- #include <linux/bug.h>  // lines 8-8
- #include <linux/errno.h>  // lines 14-14
- #include <linux/limits.h>  // lines 16-16
- #include <linux/math64.h>  // lines 10-10

The full include-list for lib/string_helpers.c:
#include <asm/bug.h>                 // for WARN_ON
#include <linux/ctype.h>             // for isodigit, isascii, isprint, isspace
#include <linux/device.h>            // for devres_add, devres_free, devres_...
#include <linux/export.h>            // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/fs.h>                // for file_path
#include <linux/kernel.h>            // for hex_to_bin, snprintf, kasprintf
#include <linux/mm.h>                // for get_cmdline
#include <linux/slab.h>              // for kfree, kmalloc, kcalloc
#include <linux/string.h>            // for kstrdup, strscpy, __sysfs_match_...
#include <linux/string_helpers.h>    // for STRING_UNITS_2, ESCAPE_HEX, STRI...
#include <cstdio>                    // for size_t, NULL, ssize_t
#include "asm-generic/errno-base.h"  // for EINVAL, ENOMEM
#include "asm-generic/int-ll64.h"    // for u32, u64, u8
#include "asm/div64.h"               // for do_div
#include "asm/page_types.h"          // for PAGE_SIZE
#include "asm/string_32.h"           // for strlen, strchr, strcmp, memcpy
#include "linux/err.h"               // for ERR_PTR, IS_ERR
#include "linux/gfp.h"               // for GFP_KERNEL
#include "linux/limits.h"            // for PATH_MAX
#include "linux/stddef.h"            // for true, false
#include "linux/types.h"             // for bool, gfp_t
struct task_struct;
---
  ./scripts/check-local-export lib/string_helpers.o
  iwyu2 -Wp,-MMD,lib/.hexdump.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/hexdump"' -DKBUILD_BASENAME='"hexdump"' -DKBUILD_MODNAME='"hexdump"' -D__KBUILD_MODNAME=kmod_hexdump -c -o lib/hexdump.o lib/hexdump.c  

lib/hexdump.c should add these lines:
#include <stddef.h>                  // for size_t
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm-generic/int-ll64.h"    // for u8, u16, u32, u64
#include "asm-generic/unaligned.h"   // for get_unaligned
#include "linux/compiler.h"          // for unlikely
#include "linux/log2.h"              // for is_power_of_2
#include "linux/printk.h"            // for hex_dump_to_buffer

lib/hexdump.c should remove these lines:
- #include <asm/unaligned.h>  // lines 12-12
- #include <linux/errno.h>  // lines 8-8
- #include <linux/minmax.h>  // lines 10-10

The full include-list for lib/hexdump.c:
#include <linux/ctype.h>             // for isascii, isprint
#include <linux/export.h>            // for EXPORT_SYMBOL
#include <linux/kernel.h>            // for snprintf, hex_byte_pack, bin2hex
#include <linux/types.h>             // for bool
#include <stddef.h>                  // for size_t
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm-generic/int-ll64.h"    // for u8, u16, u32, u64
#include "asm-generic/unaligned.h"   // for get_unaligned
#include "linux/compiler.h"          // for unlikely
#include "linux/log2.h"              // for is_power_of_2
#include "linux/printk.h"            // for hex_dump_to_buffer
---
  ./scripts/check-local-export lib/hexdump.o
  iwyu2 -Wp,-MMD,lib/.kstrtox.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/kstrtox"' -DKBUILD_BASENAME='"kstrtox"' -DKBUILD_MODNAME='"kstrtox"' -D__KBUILD_MODNAME=kmod_kstrtox -c -o lib/kstrtox.o lib/kstrtox.c  

lib/kstrtox.h should add these lines:
#include <stddef.h>  // for size_t

lib/kstrtox.h should remove these lines:

The full include-list for lib/kstrtox.h:
#include <stddef.h>  // for size_t
---

lib/kstrtox.c should add these lines:
#include "asm-generic/errno-base.h"     // for EFAULT, ERANGE, EINVAL
#include "asm-generic/int-ll64.h"       // for s16, s8, u16, u8
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for noinline
#include "linux/compiler_types.h"       // for __user
#include "linux/minmax.h"               // for min
#include "linux/stddef.h"               // for false, true
#include "vdso/limits.h"                // for INT_MAX, ULLONG_MAX

lib/kstrtox.c should remove these lines:
- #include <linux/errno.h>  // lines 16-16

The full include-list for lib/kstrtox.c:
#include "kstrtox.h"
#include <linux/ctype.h>                // for _tolower, isxdigit
#include <linux/export.h>               // for EXPORT_SYMBOL
#include <linux/kstrtox.h>              // for kstrtol, kstrtoul, _kstrtol
#include <linux/math64.h>               // for div_u64
#include <linux/types.h>                // for bool
#include <linux/uaccess.h>              // for copy_from_user
#include "asm-generic/errno-base.h"     // for EFAULT, ERANGE, EINVAL
#include "asm-generic/int-ll64.h"       // for s16, s8, u16, u8
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for noinline
#include "linux/compiler_types.h"       // for __user
#include "linux/minmax.h"               // for min
#include "linux/stddef.h"               // for false, true
#include "vdso/limits.h"                // for INT_MAX, ULLONG_MAX
---
  ./scripts/check-local-export lib/kstrtox.o
  iwyu2 -Wp,-MMD,lib/.iomap.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/iomap"' -DKBUILD_BASENAME='"iomap"' -DKBUILD_MODNAME='"iomap"' -D__KBUILD_MODNAME=kmod_iomap -c -o lib/iomap.o lib/iomap.c  
In file included from lib/iomap.c:7:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/iomap.c:7:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/iomap.c:7:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from lib/iomap.c:7:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^
5 warnings generated.
In file included from lib/iomap.c:7:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/iomap.c:7:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/iomap.c:7:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from lib/iomap.c:7:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^

lib/iomap.c should add these lines:
#include <asm/bug.h>               // for WARN
#include <asm/io.h>                // for ioport_map, ioport_unmap
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u16, u32, u8
#include "asm/io.h"                // for readl, readw, writel, writew, __ra...
#include "asm/shared/io.h"         // for inl, inw, outl, outw, inb, outb
#include "linux/compiler_types.h"  // for __iomem, __force, inline
#include "linux/kern_levels.h"     // for KERN_ERR
#include "linux/swab.h"            // for swab16, swab32, swab64

lib/iomap.c should remove these lines:
- #include <linux/io.h>  // lines 8-8
- #include <linux/pci.h>  // lines 7-7

The full include-list for lib/iomap.c:
#include <asm/bug.h>               // for WARN
#include <asm/io.h>                // for ioport_map, ioport_unmap
#include <linux/export.h>          // for EXPORT_SYMBOL
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u16, u32, u8
#include "asm/io.h"                // for readl, readw, writel, writew, __ra...
#include "asm/shared/io.h"         // for inl, inw, outl, outw, inb, outb
#include "linux/compiler_types.h"  // for __iomem, __force, inline
#include "linux/kern_levels.h"     // for KERN_ERR
#include "linux/swab.h"            // for swab16, swab32, swab64
---
  ./scripts/check-local-export lib/iomap.o
  iwyu2 -Wp,-MMD,lib/.pci_iomap.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/pci_iomap"' -DKBUILD_BASENAME='"pci_iomap"' -DKBUILD_MODNAME='"pci_iomap"' -D__KBUILD_MODNAME=kmod_pci_iomap -c -o lib/pci_iomap.o lib/pci_iomap.c  
In file included from lib/pci_iomap.c:7:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/pci_iomap.c:7:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/pci_iomap.c:7:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from lib/pci_iomap.c:7:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^
5 warnings generated.
In file included from lib/pci_iomap.c:7:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/pci_iomap.c:7:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/pci_iomap.c:7:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from lib/pci_iomap.c:7:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^

lib/pci_iomap.c should add these lines:

lib/pci_iomap.c should remove these lines:
- #include <linux/export.h>  // lines 10-10
- #include <linux/io.h>  // lines 8-8
- #include <linux/pci.h>  // lines 7-7

The full include-list for lib/pci_iomap.c:
---
  ./scripts/check-local-export lib/pci_iomap.o
  iwyu2 -Wp,-MMD,lib/.iomap_copy.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/iomap_copy"' -DKBUILD_BASENAME='"iomap_copy"' -DKBUILD_MODNAME='"iomap_copy"' -D__KBUILD_MODNAME=kmod_iomap_copy -c -o lib/iomap_copy.o lib/iomap_copy.c  

lib/iomap_copy.c should add these lines:
#include <stddef.h>                // for size_t
#include "asm-generic/int-ll64.h"  // for u32
#include "asm/io.h"                // for __raw_readl, __raw_writel
#include "linux/compiler_types.h"  // for __iomem

lib/iomap_copy.c should remove these lines:

The full include-list for lib/iomap_copy.c:
#include <linux/export.h>          // for EXPORT_SYMBOL_GPL
#include <linux/io.h>              // for __ioread32_copy, __iowrite32_copy
#include <stddef.h>                // for size_t
#include "asm-generic/int-ll64.h"  // for u32
#include "asm/io.h"                // for __raw_readl, __raw_writel
#include "linux/compiler_types.h"  // for __iomem
---
  ./scripts/check-local-export lib/iomap_copy.o
  iwyu2 -Wp,-MMD,lib/.devres.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/devres"' -DKBUILD_BASENAME='"devres"' -DKBUILD_MODNAME='"devres"' -D__KBUILD_MODNAME=kmod_devres -c -o lib/devres.o lib/devres.c  
In file included from lib/devres.c:3:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/devres.c:3:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/devres.c:3:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from lib/devres.c:3:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^
5 warnings generated.
In file included from lib/devres.c:3:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from lib/devres.c:3:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from lib/devres.c:3:
In file included from ./include/linux/pci.h:37:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
In file included from lib/devres.c:3:
./include/linux/pci.h:301:46: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pci_bus_speed pcie_get_speed_cap(struct pci_dev *dev);
                                             ^
./include/linux/pci.h:302:48: warning: declaration of 'struct pci_dev' will not be visible outside of this function [-Wvisibility]
enum pcie_link_width pcie_get_width_cap(struct pci_dev *dev);
                                               ^

lib/devres.c should add these lines:
#include <asm/bug.h>                 // for WARN_ON, BUG_ON
#include <asm/io.h>                  // for ioport_unmap, ioport_map, iorema...
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for ENOMEM, EINVAL, EBUSY
#include "asm/io.h"                  // for iounmap, ioremap, ioremap_uc
#include "linux/compiler_types.h"    // for __iomem, __force
#include "linux/dev_printk.h"        // for dev_err
#include "linux/device.h"            // for device (ptr only), devres_add
#include "linux/ioport.h"            // for resource, resource_size, resourc...
#include "linux/types.h"             // for resource_size_t
struct device_node;

lib/devres.c should remove these lines:
- #include <linux/err.h>  // lines 2-2
- #include <linux/pci.h>  // lines 3-3

The full include-list for lib/devres.c:
#include <asm/bug.h>                 // for WARN_ON, BUG_ON
#include <asm/io.h>                  // for ioport_unmap, ioport_map, iorema...
#include <linux/export.h>            // for EXPORT_SYMBOL, EXPORT_SYMBOL_GPL
#include <linux/gfp.h>               // for GFP_KERNEL
#include <linux/io.h>                // for IOMEM_ERR_PTR, arch_io_free_memt...
#include <linux/of_address.h>        // for of_address_to_resource
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for ENOMEM, EINVAL, EBUSY
#include "asm/io.h"                  // for iounmap, ioremap, ioremap_uc
#include "linux/compiler_types.h"    // for __iomem, __force
#include "linux/dev_printk.h"        // for dev_err
#include "linux/device.h"            // for device (ptr only), devres_add
#include "linux/ioport.h"            // for resource, resource_size, resourc...
#include "linux/types.h"             // for resource_size_t
struct device_node;
---
  ./scripts/check-local-export lib/devres.o
  iwyu2 -Wp,-MMD,lib/.syscall.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/syscall"' -DKBUILD_BASENAME='"syscall"' -DKBUILD_MODNAME='"syscall"' -D__KBUILD_MODNAME=kmod_syscall -c -o lib/syscall.o lib/syscall.c  

lib/syscall.c should add these lines:
#include "asm-generic/errno-base.h"  // for EAGAIN
#include "asm-generic/int-ll64.h"    // for __u64
#include "asm-generic/rwonce.h"      // for READ_ONCE
#include "asm/current.h"             // for current
#include "asm/processor.h"           // for task_pt_regs
#include "asm/ptrace.h"              // for instruction_pointer, user_stack_...
#include "asm/string_32.h"           // for memset
#include "linux/compiler.h"          // for unlikely
#include "linux/seccomp.h"           // for seccomp_data

lib/syscall.c should remove these lines:
- #include <linux/export.h>  // lines 5-5

The full include-list for lib/syscall.c:
#include <asm/syscall.h>             // for syscall_get_arguments, syscall_g...
#include <linux/ptrace.h>            // for syscall_info, task_current_syscall
#include <linux/sched.h>             // for task_struct, wait_task_inactive
#include <linux/sched/task_stack.h>  // for put_task_stack, try_get_task_stack
#include "asm-generic/errno-base.h"  // for EAGAIN
#include "asm-generic/int-ll64.h"    // for __u64
#include "asm-generic/rwonce.h"      // for READ_ONCE
#include "asm/current.h"             // for current
#include "asm/processor.h"           // for task_pt_regs
#include "asm/ptrace.h"              // for instruction_pointer, user_stack_...
#include "asm/string_32.h"           // for memset
#include "linux/compiler.h"          // for unlikely
#include "linux/seccomp.h"           // for seccomp_data
---
  ./scripts/check-local-export lib/syscall.o
  iwyu2 -Wp,-MMD,lib/.strncpy_from_user.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/strncpy_from_user"' -DKBUILD_BASENAME='"strncpy_from_user"' -DKBUILD_MODNAME='"strncpy_from_user"' -D__KBUILD_MODNAME=kmod_strncpy_from_user -c -o lib/strncpy_from_user.o lib/strncpy_from_user.c  

lib/strncpy_from_user.c should add these lines:
#include <asm/page_types.h>               // for TASK_SIZE_MAX
#include "asm-generic/errno-base.h"       // for EFAULT
#include "asm/uaccess.h"                  // for unsafe_get_user, strncpy_fr...
#include "linux/compiler_attributes.h"    // for __always_inline
#include "linux/compiler_types.h"         // for __user
#include "linux/stddef.h"                 // for false

lib/strncpy_from_user.c should remove these lines:
- #include <asm/byteorder.h>  // lines 12-12
- #include <linux/errno.h>  // lines 9-9

The full include-list for lib/strncpy_from_user.c:
#include <asm/page_types.h>               // for TASK_SIZE_MAX
#include <asm/word-at-a-time.h>           // for create_zero_mask, find_zero
#include <linux/compiler.h>               // for likely, unlikely
#include <linux/export.h>                 // for EXPORT_SYMBOL
#include <linux/fault-inject-usercopy.h>  // for should_fail_usercopy
#include <linux/kasan-checks.h>           // for kasan_check_write
#include <linux/kernel.h>                 // for might_fault
#include <linux/mm.h>                     // for untagged_addr
#include <linux/thread_info.h>            // for check_object_size
#include <linux/uaccess.h>                // for user_read_access_begin, use...
#include "asm-generic/errno-base.h"       // for EFAULT
#include "asm/uaccess.h"                  // for unsafe_get_user, strncpy_fr...
#include "linux/compiler_attributes.h"    // for __always_inline
#include "linux/compiler_types.h"         // for __user
#include "linux/stddef.h"                 // for false
---
  ./scripts/check-local-export lib/strncpy_from_user.o
  iwyu2 -Wp,-MMD,lib/.strnlen_user.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"lib/strnlen_user"' -DKBUILD_BASENAME='"strnlen_user"' -DKBUILD_MODNAME='"strnlen_user"' -D__KBUILD_MODNAME=kmod_strnlen_user -c -o lib/strnlen_user.o lib/strnlen_user.c  

lib/strnlen_user.c should add these lines:
#include <asm/page_types.h>             // for TASK_SIZE_MAX
#include "asm/uaccess.h"                // for unsafe_get_user, strnlen_user
#include "linux/compiler.h"             // for unlikely, likely
#include "linux/compiler_attributes.h"  // for __always_inline
#include "linux/compiler_types.h"       // for __user

lib/strnlen_user.c should remove these lines:
- #include <linux/kernel.h>  // lines 2-2

The full include-list for lib/strnlen_user.c:
#include <asm/page_types.h>             // for TASK_SIZE_MAX
#include <asm/word-at-a-time.h>         // for create_zero_mask, find_zero
#include <linux/bitops.h>               // for aligned_byte_mask
#include <linux/export.h>               // for EXPORT_SYMBOL
#include <linux/mm.h>                   // for untagged_addr
#include <linux/uaccess.h>              // for user_read_access_begin, user_...
#include "asm/uaccess.h"                // for unsafe_get_user, strnlen_user
#include "linux/compiler.h"             // for unlikely, likely
#include "linux/compiler_attributes.h"  // for __always_inline
#include "linux/compiler_types.h"       // for __user
---
  ./scripts/check-local-export lib/strnlen_user.o
  rm -f lib/built-in.a; echo lockref.o bcd.o sort.o parser.o debug_locks.o random32.o bust_spinlocks.o kasprintf.o bitmap.o scatterlist.o list_sort.o uuid.o iov_iter.o clz_ctz.o bsearch.o find_bit.o llist.o memweight.o kfifo.o percpu-refcount.o rhashtable.o once.o refcount.o usercopy.o errseq.o bucket_locks.o generic-radix-tree.o string_helpers.o hexdump.o kstrtox.o math/built-in.a crypto/built-in.a iomap.o pci_iomap.o iomap_copy.o devres.o syscall.o strncpy_from_user.o strnlen_user.o | sed -E 's:([^ ]+):lib/:g' | xargs llvm-ar cDPrST lib/built-in.a
make -f ./scripts/Makefile.build obj=arch/x86/lib \
single-build= \
need-builtin=1 need-modorder=1
  iwyu2 -Wp,-MMD,arch/x86/lib/.atomic64_cx8_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -D__ASSEMBLY__ -fno-PIE --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -m32 -fno-lto    -c -o arch/x86/lib/atomic64_cx8_32.o arch/x86/lib/atomic64_cx8_32.S 
  ./scripts/check-local-export arch/x86/lib/atomic64_cx8_32.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.checksum_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -D__ASSEMBLY__ -fno-PIE --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -m32 -fno-lto    -c -o arch/x86/lib/checksum_32.o arch/x86/lib/checksum_32.S 
  ./scripts/check-local-export arch/x86/lib/checksum_32.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.cmdline.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/lib/cmdline"' -DKBUILD_BASENAME='"cmdline"' -DKBUILD_MODNAME='"cmdline"' -D__KBUILD_MODNAME=kmod_cmdline -c -o arch/x86/lib/cmdline.o arch/x86/lib/cmdline.c  

arch/x86/lib/cmdline.c should add these lines:
#include <stddef.h>                     // for NULL
#include "asm-generic/int-ll64.h"       // for u8
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for inline

arch/x86/lib/cmdline.c should remove these lines:
- #include <linux/ctype.h>  // lines 8-8
- #include <linux/kernel.h>  // lines 6-6
- #include <linux/string.h>  // lines 7-7

The full include-list for arch/x86/lib/cmdline.c:
#include <asm/setup.h>                  // for COMMAND_LINE_SIZE
#include <stddef.h>                     // for NULL
#include "asm-generic/int-ll64.h"       // for u8
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for inline
---
  ./scripts/check-local-export arch/x86/lib/cmdline.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.cpu.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/lib/cpu"' -DKBUILD_BASENAME='"cpu"' -DKBUILD_MODNAME='"cpu"' -D__KBUILD_MODNAME=kmod_cpu -c -o arch/x86/lib/cpu.o arch/x86/lib/cpu.c  
In file included from arch/x86/lib/cpu.c:4:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/lib/cpu.c:4:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/lib/cpu.c:4:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/lib/cpu.c:4:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/lib/cpu.c:4:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/lib/cpu.c:4:
In file included from ./arch/x86/include/asm/cpu.h:5:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/lib/cpu.c should add these lines:

arch/x86/lib/cpu.c should remove these lines:
- #include <linux/types.h>  // lines 2-2

The full include-list for arch/x86/lib/cpu.c:
#include <asm/cpu.h>       // for x86_family, x86_model, x86_stepping
#include <linux/export.h>  // for EXPORT_SYMBOL_GPL
---
  ./scripts/check-local-export arch/x86/lib/cpu.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.delay.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/lib/delay"' -DKBUILD_BASENAME='"delay"' -DKBUILD_MODNAME='"delay"' -D__KBUILD_MODNAME=kmod_delay -c -o arch/x86/lib/delay.o arch/x86/lib/delay.c  

arch/x86/lib/delay.c should add these lines:
#include <asm-generic/percpu.h>         // for raw_cpu_ptr, this_cpu_read
#include <asm/percpu.h>                 // for this_cpu_read_8
#include "asm-generic/delay.h"          // for __const_udelay, __delay, __nd...
#include "asm-generic/int-ll64.h"       // for u64, u32
#include "asm-generic/param.h"          // for HZ
#include "asm/msr.h"                    // for rdtsc_ordered, rdtsc
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/vdso/processor.h"         // for rep_nop
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for noinline
#include "linux/init.h"                 // for __init
#include "linux/kernel.h"               // for lower_32_bits, upper_32_bits
#include "linux/minmax.h"               // for min_t
#include "linux/smp.h"                  // for smp_processor_id

arch/x86/lib/delay.c should remove these lines:
- #include <asm/timer.h>  // lines 23-23
- #include <linux/sched.h>  // lines 16-16

The full include-list for arch/x86/lib/delay.c:
#include <asm-generic/percpu.h>         // for raw_cpu_ptr, this_cpu_read
#include <asm/delay.h>                  // for use_mwaitx_delay, use_tpause_...
#include <asm/mwait.h>                  // for __monitorx, __mwaitx, __tpause
#include <asm/percpu.h>                 // for this_cpu_read_8
#include <asm/processor.h>              // for cpuinfo_x86, cpu_tss_rw, cpu_...
#include <linux/delay.h>                // for loops_per_jiffy
#include <linux/export.h>               // for EXPORT_SYMBOL
#include <linux/preempt.h>              // for preempt_disable, preempt_enable
#include <linux/timex.h>                // for read_current_timer
#include "asm-generic/delay.h"          // for __const_udelay, __delay, __nd...
#include "asm-generic/int-ll64.h"       // for u64, u32
#include "asm-generic/param.h"          // for HZ
#include "asm/msr.h"                    // for rdtsc_ordered, rdtsc
#include "asm/percpu.h"                 // for __pcpu_op2_1, __pcpu_op2_2
#include "asm/vdso/processor.h"         // for rep_nop
#include "linux/cache.h"                // for __ro_after_init
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for noinline
#include "linux/init.h"                 // for __init
#include "linux/kernel.h"               // for lower_32_bits, upper_32_bits
#include "linux/minmax.h"               // for min_t
#include "linux/smp.h"                  // for smp_processor_id
---
  ./scripts/check-local-export arch/x86/lib/delay.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.getuser.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -D__ASSEMBLY__ -fno-PIE --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -m32 -fno-lto    -c -o arch/x86/lib/getuser.o arch/x86/lib/getuser.S 
  ./scripts/check-local-export arch/x86/lib/getuser.o
  awk -f ./arch/x86/tools/gen-insn-attr-x86.awk ./arch/x86/lib/x86-opcode-map.txt > arch/x86/lib/inat-tables.c
  iwyu2 -Wp,-MMD,arch/x86/lib/.inat.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/lib/inat"' -DKBUILD_BASENAME='"inat"' -DKBUILD_MODNAME='"inat"' -D__KBUILD_MODNAME=kmod_inat -c -o arch/x86/lib/inat.o arch/x86/lib/inat.c  

arch/x86/lib/inat.c should add these lines:
#include "asm/inat.h"        // for inat_group_common_attribute, inat_has_va...
#include "asm/inat_types.h"  // for insn_attr_t, insn_byte_t

arch/x86/lib/inat.c should remove these lines:

The full include-list for arch/x86/lib/inat.c:
#include <asm/insn.h>        // for X86_MODRM_REG, X86_VEX_M_MAX
#include "asm/inat.h"        // for inat_group_common_attribute, inat_has_va...
#include "asm/inat_types.h"  // for insn_attr_t, insn_byte_t
#include "inat-tables.c"     // for inat_avx_tables, inat_escape_tables, ina...
---
  ./scripts/check-local-export arch/x86/lib/inat.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.insn-eval.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/lib/insn-eval"' -DKBUILD_BASENAME='"insn_eval"' -DKBUILD_MODNAME='"insn_eval"' -D__KBUILD_MODNAME=kmod_insn_eval -c -o arch/x86/lib/insn-eval.o arch/x86/lib/insn-eval.c  
In file included from arch/x86/lib/insn-eval.c:9:
In file included from ./include/linux/mmu_context.h:5:
In file included from ./arch/x86/include/asm/mmu_context.h:10:
In file included from ./include/trace/events/tlb.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/lib/insn-eval.c:9:
In file included from ./include/linux/mmu_context.h:5:
In file included from ./arch/x86/include/asm/mmu_context.h:10:
In file included from ./include/trace/events/tlb.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/lib/insn-eval.c:9:
In file included from ./include/linux/mmu_context.h:5:
In file included from ./arch/x86/include/asm/mmu_context.h:10:
In file included from ./include/trace/events/tlb.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/lib/insn-eval.c:9:
In file included from ./include/linux/mmu_context.h:5:
In file included from ./arch/x86/include/asm/mmu_context.h:10:
In file included from ./include/trace/events/tlb.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/lib/insn-eval.c:9:
In file included from ./include/linux/mmu_context.h:5:
In file included from ./arch/x86/include/asm/mmu_context.h:10:
In file included from ./include/trace/events/tlb.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/lib/insn-eval.c:9:
In file included from ./include/linux/mmu_context.h:5:
In file included from ./arch/x86/include/asm/mmu_context.h:10:
In file included from ./include/trace/events/tlb.h:9:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/lib/insn-eval.c should add these lines:
#include <asm/bug.h>                    // for WARN_ONCE
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EINVAL, EDOM
#include "asm/inat_types.h"             // for insn_byte_t, insn_attr_t
#include "asm/msr-index.h"              // for MSR_FS_BASE, MSR_GS_BASE, MSR...
#include "asm/msr.h"                    // for rdmsrl
#include "asm/ptrace.h"                 // for pt_regs, regs_get_register
#include "asm/segment.h"                // for SEGMENT_RPL_MASK, SEGMENT_TI_...
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for __user
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/printk.h"               // for pr_err_ratelimited
#include "linux/stddef.h"               // for offsetof, false, true
#include "linux/types.h"                // for bool
#include "linux/uaccess.h"              // for __copy_from_user_inatomic
#include "vdso/bits.h"                  // for BIT

arch/x86/lib/insn-eval.c should remove these lines:
- #include <asm/ldt.h>  // lines 15-15
- #include <linux/mmu_context.h>  // lines 9-9
- #include <linux/ratelimit.h>  // lines 8-8
- #include <linux/string.h>  // lines 7-7

The full include-list for arch/x86/lib/insn-eval.c:
#include <asm/bug.h>                    // for WARN_ONCE
#include <asm/desc.h>                   // for get_desc_base, get_desc_limit
#include <asm/desc_defs.h>              // for desc_struct, desc_ptr
#include <asm/inat.h>                   // for INAT_SEG_REG_CS, INAT_MAKE_PR...
#include <asm/insn-eval.h>              // for INSN_CODE_SEG_PARAMS, MMIO_DE...
#include <asm/insn.h>                   // for insn, insn_field, insn_field:...
#include <asm/vm86.h>                   // for kernel_vm86_regs
#include <linux/kernel.h>               // for ARRAY_SIZE
#include <stddef.h>                     // for NULL
#include "asm-generic/errno-base.h"     // for EINVAL, EDOM
#include "asm/inat_types.h"             // for insn_byte_t, insn_attr_t
#include "asm/msr-index.h"              // for MSR_FS_BASE, MSR_GS_BASE, MSR...
#include "asm/msr.h"                    // for rdmsrl
#include "asm/ptrace.h"                 // for pt_regs, regs_get_register
#include "asm/segment.h"                // for SEGMENT_RPL_MASK, SEGMENT_TI_...
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for __user
#include "linux/kconfig.h"              // for IS_ENABLED
#include "linux/printk.h"               // for pr_err_ratelimited
#include "linux/stddef.h"               // for offsetof, false, true
#include "linux/types.h"                // for bool
#include "linux/uaccess.h"              // for __copy_from_user_inatomic
#include "vdso/bits.h"                  // for BIT
---
  ./scripts/check-local-export arch/x86/lib/insn-eval.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.insn.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/lib/insn"' -DKBUILD_BASENAME='"insn"' -DKBUILD_MODNAME='"insn"' -D__KBUILD_MODNAME=kmod_insn -c -o arch/x86/lib/insn.o arch/x86/lib/insn.c  

arch/x86/lib/insn.c should add these lines:
#include <stddef.h>                   // for size_t
#include "asm-generic/errno-base.h"   // for EINVAL
#include "asm-generic/errno.h"        // for ENODATA
#include "asm-generic/unaligned.h"    // for get_unaligned
#include "asm/inat_types.h"           // for insn_byte_t, insn_attr_t
#include "asm/string_32.h"            // for memset
#include "linux/build_bug.h"          // for BUILD_BUG
#include "linux/byteorder/generic.h"  // for le16_to_cpu, le32_to_cpu
#include "linux/compiler.h"           // for unlikely
#include "linux/compiler_types.h"     // for inline

arch/x86/lib/insn.c should remove these lines:
- #include <asm/unaligned.h>  // lines 16-16
- #include <linux/errno.h>  // lines 18-18
- #include <linux/kernel.h>  // lines 8-8
- #include <linux/string.h>  // lines 10-10

The full include-list for arch/x86/lib/insn.c:
#include <asm/emulate_prefix.h>       // for __KVM_EMULATE_PREFIX, __XEN_EMU...
#include <asm/inat.h>                 // for inat_get_opcode_attribute, inat...
#include <asm/insn.h>                 // for insn, insn_field_set, insn_field
#include <linux/kconfig.h>            // for IS_ENABLED
#include <stddef.h>                   // for size_t
#include "asm-generic/errno-base.h"   // for EINVAL
#include "asm-generic/errno.h"        // for ENODATA
#include "asm-generic/unaligned.h"    // for get_unaligned
#include "asm/inat_types.h"           // for insn_byte_t, insn_attr_t
#include "asm/string_32.h"            // for memset
#include "linux/build_bug.h"          // for BUILD_BUG
#include "linux/byteorder/generic.h"  // for le16_to_cpu, le32_to_cpu
#include "linux/compiler.h"           // for unlikely
#include "linux/compiler_types.h"     // for inline
---
  ./scripts/check-local-export arch/x86/lib/insn.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.memcpy_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/lib/memcpy_32"' -DKBUILD_BASENAME='"memcpy_32"' -DKBUILD_MODNAME='"memcpy_32"' -D__KBUILD_MODNAME=kmod_memcpy_32 -c -o arch/x86/lib/memcpy_32.o arch/x86/lib/memcpy_32.c  

arch/x86/lib/memcpy_32.c should add these lines:
#include <stddef.h>                     // for size_t
#include "asm/string_32.h"              // for __memcpy, __memset, memcpy
#include "linux/compiler_attributes.h"  // for __visible

arch/x86/lib/memcpy_32.c should remove these lines:
- #include <linux/string.h>  // lines 2-2

The full include-list for arch/x86/lib/memcpy_32.c:
#include <linux/export.h>               // for EXPORT_SYMBOL
#include <stddef.h>                     // for size_t
#include "asm/string_32.h"              // for __memcpy, __memset, memcpy
#include "linux/compiler_attributes.h"  // for __visible
---
  ./scripts/check-local-export arch/x86/lib/memcpy_32.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.misc.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/lib/misc"' -DKBUILD_BASENAME='"misc"' -DKBUILD_MODNAME='"misc"' -D__KBUILD_MODNAME=kmod_misc -c -o arch/x86/lib/misc.o arch/x86/lib/misc.c  

(arch/x86/lib/misc.c has correct #includes/fwd-decls)
  ./scripts/check-local-export arch/x86/lib/misc.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.pc-conf-reg.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/lib/pc-conf-reg"' -DKBUILD_BASENAME='"pc_conf_reg"' -DKBUILD_MODNAME='"pc_conf_reg"' -D__KBUILD_MODNAME=kmod_pc_conf_reg -c -o arch/x86/lib/pc-conf-reg.o arch/x86/lib/pc-conf-reg.c  

arch/x86/lib/pc-conf-reg.c should add these lines:
#include "linux/spinlock_types_raw.h"  // for DEFINE_RAW_SPINLOCK

arch/x86/lib/pc-conf-reg.c should remove these lines:
- #include <asm/pc-conf-reg.h>  // lines 11-11
- #include <linux/spinlock.h>  // lines 9-9

The full include-list for arch/x86/lib/pc-conf-reg.c:
#include "linux/spinlock_types_raw.h"  // for DEFINE_RAW_SPINLOCK
---
  ./scripts/check-local-export arch/x86/lib/pc-conf-reg.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.putuser.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -D__ASSEMBLY__ -fno-PIE --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -m32 -fno-lto    -c -o arch/x86/lib/putuser.o arch/x86/lib/putuser.S 
  ./scripts/check-local-export arch/x86/lib/putuser.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.string_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/lib/string_32"' -DKBUILD_BASENAME='"string_32"' -DKBUILD_MODNAME='"string_32"' -D__KBUILD_MODNAME=kmod_string_32 -c -o arch/x86/lib/string_32.o arch/x86/lib/string_32.c  

arch/x86/lib/string_32.c should add these lines:
#include <stddef.h>         // for size_t, NULL
#include "asm/string_32.h"  // for __HAVE_ARCH_MEMCHR, __HAVE_ARCH_MEMSCAN

arch/x86/lib/string_32.c should remove these lines:
- #include <linux/string.h>  // lines 15-15

The full include-list for arch/x86/lib/string_32.c:
#include <linux/export.h>   // for EXPORT_SYMBOL
#include <stddef.h>         // for size_t, NULL
#include "asm/string_32.h"  // for __HAVE_ARCH_MEMCHR, __HAVE_ARCH_MEMSCAN
---
  ./scripts/check-local-export arch/x86/lib/string_32.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.strstr_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/lib/strstr_32"' -DKBUILD_BASENAME='"strstr_32"' -DKBUILD_MODNAME='"strstr_32"' -D__KBUILD_MODNAME=kmod_strstr_32 -c -o arch/x86/lib/strstr_32.o arch/x86/lib/strstr_32.c  

arch/x86/lib/strstr_32.c should add these lines:
#include "asm/string_32.h"  // for strstr

arch/x86/lib/strstr_32.c should remove these lines:
- #include <linux/string.h>  // lines 2-2

The full include-list for arch/x86/lib/strstr_32.c:
#include <linux/export.h>   // for EXPORT_SYMBOL
#include "asm/string_32.h"  // for strstr
---
  ./scripts/check-local-export arch/x86/lib/strstr_32.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.usercopy.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/lib/usercopy"' -DKBUILD_BASENAME='"usercopy"' -DKBUILD_MODNAME='"usercopy"' -D__KBUILD_MODNAME=kmod_usercopy -c -o arch/x86/lib/usercopy.o arch/x86/lib/usercopy.c  

arch/x86/lib/usercopy.c should add these lines:
#include <asm/uaccess.h>           // for __access_ok
#include "asm/uaccess.h"           // for copy_from_user_nmi
#include "linux/compiler_types.h"  // for __user

arch/x86/lib/usercopy.c should remove these lines:

The full include-list for arch/x86/lib/usercopy.c:
#include <asm/tlbflush.h>          // for nmi_uaccess_okay
#include <asm/uaccess.h>           // for __access_ok
#include <linux/export.h>          // for EXPORT_SYMBOL_GPL
#include <linux/uaccess.h>         // for __copy_from_user_inatomic, pagefau...
#include "asm/uaccess.h"           // for copy_from_user_nmi
#include "linux/compiler_types.h"  // for __user
---
  ./scripts/check-local-export arch/x86/lib/usercopy.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.usercopy_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/lib/usercopy_32"' -DKBUILD_BASENAME='"usercopy_32"' -DKBUILD_MODNAME='"usercopy_32"' -D__KBUILD_MODNAME=kmod_usercopy_32 -c -o arch/x86/lib/usercopy_32.o arch/x86/lib/usercopy_32.c  

arch/x86/lib/usercopy_32.c should add these lines:
#include "asm/extable_fixup_types.h"  // for EX_TYPE_UCOPY_LEN4, EX_TYPE_UCO...
#include "asm/smap.h"                 // for ASM_CLAC, ASM_STAC
#include "asm/uaccess.h"              // for __uaccess_begin_nospec, __uacce...
#include "asm/uaccess_32.h"           // for __copy_from_user_ll_nocache_nozero
#include "linux/compiler_types.h"     // for __user, inline
#include "linux/kernel.h"             // for might_fault

arch/x86/lib/usercopy_32.c should remove these lines:
- #include <linux/uaccess.h>  // lines 10-10

The full include-list for arch/x86/lib/usercopy_32.c:
#include <asm/asm.h>                  // for _ASM_EXTABLE_TYPE_REG, _ASM_EXT...
#include <linux/export.h>             // for EXPORT_SYMBOL
#include "asm/extable_fixup_types.h"  // for EX_TYPE_UCOPY_LEN4, EX_TYPE_UCO...
#include "asm/smap.h"                 // for ASM_CLAC, ASM_STAC
#include "asm/uaccess.h"              // for __uaccess_begin_nospec, __uacce...
#include "asm/uaccess_32.h"           // for __copy_from_user_ll_nocache_nozero
#include "linux/compiler_types.h"     // for __user, inline
#include "linux/kernel.h"             // for might_fault
---
  ./scripts/check-local-export arch/x86/lib/usercopy_32.o
  rm -f arch/x86/lib/lib.a; llvm-ar cDPrsT arch/x86/lib/lib.a arch/x86/lib/atomic64_cx8_32.o arch/x86/lib/checksum_32.o arch/x86/lib/cmdline.o arch/x86/lib/cpu.o arch/x86/lib/delay.o arch/x86/lib/getuser.o arch/x86/lib/inat.o arch/x86/lib/insn-eval.o arch/x86/lib/insn.o arch/x86/lib/memcpy_32.o arch/x86/lib/misc.o arch/x86/lib/pc-conf-reg.o arch/x86/lib/putuser.o arch/x86/lib/string_32.o arch/x86/lib/strstr_32.o arch/x86/lib/usercopy.o arch/x86/lib/usercopy_32.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.msr.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/lib/msr"' -DKBUILD_BASENAME='"msr"' -DKBUILD_MODNAME='"msr"' -D__KBUILD_MODNAME=kmod_msr -c -o arch/x86/lib/msr.o arch/x86/lib/msr.c  
In file included from arch/x86/lib/msr.c:7:
In file included from ./arch/x86/include/asm/msr-trace.h:14:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/lib/msr.c:7:
In file included from ./arch/x86/include/asm/msr-trace.h:14:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/lib/msr.c:7:
In file included from ./arch/x86/include/asm/msr-trace.h:14:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^
3 warnings generated.
In file included from arch/x86/lib/msr.c:7:
In file included from ./arch/x86/include/asm/msr-trace.h:14:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:30:
./include/linux/device/bus.h:190:63: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
bus_find_device_by_of_node(struct bus_type *bus, const struct device_node *np)
                                                              ^
In file included from arch/x86/lib/msr.c:7:
In file included from ./arch/x86/include/asm/msr-trace.h:14:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:31:
./include/linux/device/class.h:140:64: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
class_find_device_by_of_node(struct class *class, const struct device_node *np)
                                                               ^
In file included from arch/x86/lib/msr.c:7:
In file included from ./arch/x86/include/asm/msr-trace.h:14:
In file included from ./include/linux/tracepoint.h:22:
In file included from ./include/linux/static_call.h:135:
In file included from ./include/linux/cpu.h:17:
In file included from ./include/linux/node.h:18:
In file included from ./include/linux/device.h:32:
./include/linux/device/driver.h:185:23: warning: declaration of 'struct device_node' will not be visible outside of this function [-Wvisibility]
                              const struct device_node *np)
                                           ^

arch/x86/lib/msr.c should add these lines:
#include <linux/bitops.h>            // for BIT_64
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm-generic/int-ll64.h"    // for u32, u8, u64
#include "asm/shared/msr.h"          // for msr, msr::(anonymous)
#include "linux/compiler_types.h"    // for inline
#include "linux/printk.h"            // for pr_warn
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool

arch/x86/lib/msr.c should remove these lines:
- #include <asm/msr-trace.h>  // lines 7-7
- #include <linux/preempt.h>  // lines 4-4

The full include-list for arch/x86/lib/msr.c:
#include <asm/msr.h>                 // for rdmsrl_safe, wrmsrl_safe, msr_cl...
#include <linux/bitops.h>            // for BIT_64
#include <linux/export.h>            // for EXPORT_SYMBOL
#include <linux/percpu.h>            // for free_percpu, alloc_percpu
#include <stddef.h>                  // for NULL
#include "asm-generic/errno-base.h"  // for EINVAL
#include "asm-generic/int-ll64.h"    // for u32, u8, u64
#include "asm/shared/msr.h"          // for msr, msr::(anonymous)
#include "linux/compiler_types.h"    // for inline
#include "linux/printk.h"            // for pr_warn
#include "linux/stddef.h"            // for false, true
#include "linux/types.h"             // for bool
---
  ./scripts/check-local-export arch/x86/lib/msr.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.msr-reg.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -D__ASSEMBLY__ -fno-PIE --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -m32 -fno-lto    -c -o arch/x86/lib/msr-reg.o arch/x86/lib/msr-reg.S 
  ./scripts/check-local-export arch/x86/lib/msr-reg.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.msr-reg-export.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/lib/msr-reg-export"' -DKBUILD_BASENAME='"msr_reg_export"' -DKBUILD_MODNAME='"msr_reg_export"' -D__KBUILD_MODNAME=kmod_msr_reg_export -c -o arch/x86/lib/msr-reg-export.o arch/x86/lib/msr-reg-export.c  

arch/x86/lib/msr-reg-export.c should add these lines:

arch/x86/lib/msr-reg-export.c should remove these lines:
- #include <asm/msr.h>  // lines 3-3

The full include-list for arch/x86/lib/msr-reg-export.c:
#include <linux/export.h>  // for EXPORT_SYMBOL
---
  ./scripts/check-local-export arch/x86/lib/msr-reg-export.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.hweight.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -D__ASSEMBLY__ -fno-PIE --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -m32 -fno-lto    -c -o arch/x86/lib/hweight.o arch/x86/lib/hweight.S 
  ./scripts/check-local-export arch/x86/lib/hweight.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.iomem.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/lib/iomem"' -DKBUILD_BASENAME='"iomem"' -DKBUILD_MODNAME='"iomem"' -D__KBUILD_MODNAME=kmod_iomem -c -o arch/x86/lib/iomem.o arch/x86/lib/iomem.c  

arch/x86/lib/iomem.c should add these lines:
#include <stddef.h>                     // for size_t
#include "asm/io.h"                     // for memcpy_fromio, memcpy_toio
#include "asm/string_32.h"              // for memset
#include "linux/cc_platform.h"          // for cc_platform_has, CC_ATTR_GUES...
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __always_inline
#include "linux/compiler_types.h"       // for __iomem
#include "linux/export.h"               // for EXPORT_SYMBOL

arch/x86/lib/iomem.c should remove these lines:
- #include <linux/io.h>  // lines 3-3
- #include <linux/module.h>  // lines 2-2
- #include <linux/string.h>  // lines 1-1

The full include-list for arch/x86/lib/iomem.c:
#include <stddef.h>                     // for size_t
#include "asm/io.h"                     // for memcpy_fromio, memcpy_toio
#include "asm/string_32.h"              // for memset
#include "linux/cc_platform.h"          // for cc_platform_has, CC_ATTR_GUES...
#include "linux/compiler.h"             // for unlikely
#include "linux/compiler_attributes.h"  // for __always_inline
#include "linux/compiler_types.h"       // for __iomem
#include "linux/export.h"               // for EXPORT_SYMBOL
---
  ./scripts/check-local-export arch/x86/lib/iomem.o
  iwyu2 -Wp,-MMD,arch/x86/lib/.atomic64_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -Wall -Wundef -Werror=strict-prototypes -Wno-trigraphs -fno-strict-aliasing -fno-common -fshort-wchar -fno-PIE -Werror=implicit-function-declaration -Werror=implicit-int -Werror=return-type -Wno-format-security -std=gnu11 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -mno-sse -mno-mmx -mno-sse2 -mno-3dnow -mno-avx -fcf-protection=none -m32 -msoft-float -mregparm=3 -freg-struct-return -fno-pic -march=i686 -ffreestanding -Wno-sign-compare -fno-asynchronous-unwind-tables -fno-delete-null-pointer-checks -Wno-frame-address -Wno-address-of-packed-member -Os -Wframe-larger-than=1024 -fno-stack-protector -Wimplicit-fallthrough -Wno-gnu -Wno-unused-but-set-variable -Wno-unused-const-variable -fomit-frame-pointer -fno-stack-clash-protection -fno-lto -flto -fvisibility=hidden -Wdeclaration-after-statement -Wvla -Wno-pointer-sign -Wcast-function-type -fno-strict-overflow -fno-stack-check -Werror=date-time -Werror=incompatible-pointer-types    -DKBUILD_MODFILE='"arch/x86/lib/atomic64_32"' -DKBUILD_BASENAME='"atomic64_32"' -DKBUILD_MODNAME='"atomic64_32"' -D__KBUILD_MODNAME=kmod_atomic64_32 -c -o arch/x86/lib/atomic64_32.o arch/x86/lib/atomic64_32.c  

arch/x86/lib/atomic64_32.c should add these lines:

arch/x86/lib/atomic64_32.c should remove these lines:
- #include <linux/atomic.h>  // lines 4-4

The full include-list for arch/x86/lib/atomic64_32.c:
#include <linux/export.h>  // for EXPORT_SYMBOL
---
  ./scripts/check-local-export arch/x86/lib/atomic64_32.o
  rm -f arch/x86/lib/built-in.a; echo msr.o msr-reg.o msr-reg-export.o hweight.o iomem.o atomic64_32.o | sed -E 's:([^ ]+):arch/x86/lib/:g' | xargs llvm-ar cDPrST arch/x86/lib/built-in.a
  sh scripts/link-vmlinux.sh "ld.lld" "-m elf_i386 -mllvm -import-instr-limit=5" "--build-id=sha1 --orphan-handling=warn";  true
+ [ ld.lld = clean ]
+ info GEN .version
+ printf   %-7s %s\n GEN .version
  GEN     .version
+ [ -r .version ]
+ rm -f .version
+ echo 1
+ make -f ./scripts/Makefile.build obj=init need-builtin=1
  sh ./scripts/mkcompile_h include/generated/compile.h "i386" "" "" "" "" "Debian clang version 14.0.6" "ld.lld"
+ make -f ./scripts/Makefile.vmlinux_o
  python3 ./scripts/jobserver-exec perl scripts/generate_initcall_order.pl arch/x86/kernel/head_32.o arch/x86/kernel/head32.o arch/x86/kernel/ebda.o arch/x86/kernel/platform-quirks.o init/built-in.a usr/built-in.a arch/x86/built-in.a kernel/built-in.a mm/built-in.a fs/built-in.a security/built-in.a lib/built-in.a arch/x86/lib/built-in.a drivers/built-in.a lib/lib.a arch/x86/lib/lib.a > .tmp_initcalls.lds
  ld.lld -m elf_i386 -mllvm -import-instr-limit=5 -r -o vmlinux.o -T .tmp_initcalls.lds --whole-archive arch/x86/kernel/head_32.o arch/x86/kernel/head32.o arch/x86/kernel/ebda.o arch/x86/kernel/platform-quirks.o init/built-in.a usr/built-in.a arch/x86/built-in.a kernel/built-in.a mm/built-in.a fs/built-in.a security/built-in.a lib/built-in.a arch/x86/lib/built-in.a drivers/built-in.a --no-whole-archive --start-group lib/lib.a arch/x86/lib/lib.a --end-group 
+ echo arch/x86/kernel/head_32.o
+ echo arch/x86/kernel/head32.o
+ echo arch/x86/kernel/ebda.o
+ echo arch/x86/kernel/platform-quirks.o
+ llvm-ar t init/built-in.a
+ llvm-ar t usr/built-in.a
+ llvm-ar t arch/x86/built-in.a
+ llvm-ar t kernel/built-in.a
+ llvm-ar t mm/built-in.a
+ llvm-ar t fs/built-in.a
+ llvm-ar t security/built-in.a
+ llvm-ar t lib/built-in.a
+ llvm-ar t arch/x86/lib/built-in.a
+ llvm-ar t drivers/built-in.a
+ llvm-ar t lib/lib.a
+ llvm-ar t arch/x86/lib/lib.a
+ make -f ./scripts/Makefile.modpost MODPOST_VMLINUX=1
  scripts/mod/modpost   -E -o vmlinux.symvers vmlinux.o
+ info MODINFO modules.builtin.modinfo
+ printf   %-7s %s\n MODINFO modules.builtin.modinfo
  MODINFO modules.builtin.modinfo
+ llvm-objcopy -j .modinfo -O binary vmlinux.o modules.builtin.modinfo
+ info GEN modules.builtin
+ printf   %-7s %s\n GEN modules.builtin
  GEN     modules.builtin
+ tr \0 \n
+ sed -n s/^[[:alnum:]:_]*\.file=//p
+ tr   \n
+ uniq
+ sed -e s:^:kernel/: -e s/$/.ko/
+ is_enabled CONFIG_MODULES
+ grep -q ^CONFIG_MODULES=y include/config/auto.conf
+ btf_vmlinux_bin_o=
+ is_enabled CONFIG_DEBUG_INFO_BTF
+ grep -q ^CONFIG_DEBUG_INFO_BTF=y include/config/auto.conf
+ kallsymso=
+ kallsymso_prev=
+ kallsyms_vmlinux=
+ is_enabled CONFIG_KALLSYMS
+ grep -q ^CONFIG_KALLSYMS=y include/config/auto.conf
+ vmlinux_link vmlinux 
+ local output=vmlinux
+ local objs
+ local libs
+ local ld
+ local ldflags
+ local ldlibs
+ info LD vmlinux
+ printf   %-7s %s\n LD vmlinux
  LD      vmlinux
+ shift
+ is_enabled CONFIG_LTO_CLANG
+ grep -q ^CONFIG_LTO_CLANG=y include/config/auto.conf
+ objs=vmlinux.o
+ libs=
+ is_enabled CONFIG_MODULES
+ grep -q ^CONFIG_MODULES=y include/config/auto.conf
+ [ x86 = um ]
+ wl=
+ ld=ld.lld
+ ldflags=-m elf_i386 -mllvm -import-instr-limit=5 --build-id=sha1 --orphan-handling=warn
+ ldlibs=
+ ldflags=-m elf_i386 -mllvm -import-instr-limit=5 --build-id=sha1 --orphan-handling=warn --script=./arch/x86/kernel/vmlinux.lds
+ [ vmlinux != vmlinux ]
+ is_enabled CONFIG_VMLINUX_MAP
+ grep -q ^CONFIG_VMLINUX_MAP=y include/config/auto.conf
+ ld.lld -m elf_i386 -mllvm -import-instr-limit=5 --build-id=sha1 --orphan-handling=warn --script=./arch/x86/kernel/vmlinux.lds -o vmlinux --whole-archive vmlinux.o --no-whole-archive --start-group --end-group
+ is_enabled CONFIG_DEBUG_INFO_BTF
+ grep -q ^CONFIG_DEBUG_INFO_BTF=y include/config/auto.conf
+ info SYSMAP System.map
+ printf   %-7s %s\n SYSMAP System.map
  SYSMAP  System.map
+ mksysmap vmlinux System.map
+ sh ./scripts/mksysmap vmlinux System.map
+ is_enabled CONFIG_BUILDTIME_TABLE_SORT
+ grep -q ^CONFIG_BUILDTIME_TABLE_SORT=y include/config/auto.conf
+ info SORTTAB vmlinux
+ printf   %-7s %s\n SORTTAB vmlinux
  SORTTAB vmlinux
+ sorttable vmlinux
+ ./scripts/sorttable vmlinux
+ is_enabled CONFIG_KALLSYMS
+ grep -q ^CONFIG_KALLSYMS=y include/config/auto.conf
+ echo vmlinux: scripts/link-vmlinux.sh
make -f ./scripts/Makefile.build obj=arch/x86/boot arch/x86/boot/bzImage
  iwyu2 -Wp,-MMD,arch/x86/boot/.a20.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/a20"' -DKBUILD_BASENAME='"a20"' -DKBUILD_MODNAME='"a20"' -D__KBUILD_MODNAME=kmod_a20 -c -o arch/x86/boot/a20.o arch/x86/boot/a20.c  

arch/x86/boot/a20.c should add these lines:
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u8
#include "io.h"                    // for outb, inb

arch/x86/boot/a20.c should remove these lines:

The full include-list for arch/x86/boot/a20.c:
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u8
#include "boot.h"                  // for io_delay, wrfs32, initregs, intcall
#include "io.h"                    // for outb, inb
---
  ./scripts/check-local-export arch/x86/boot/a20.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.bioscall.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -D__ASSEMBLY__ -DSVGA_MODE=NORMAL_VGA    -c -o arch/x86/boot/bioscall.o arch/x86/boot/bioscall.S 
  ./scripts/check-local-export arch/x86/boot/bioscall.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.cmdline.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/cmdline"' -DKBUILD_BASENAME='"cmdline"' -DKBUILD_MODNAME='"cmdline"' -D__KBUILD_MODNAME=kmod_cmdline -c -o arch/x86/boot/cmdline.o arch/x86/boot/cmdline.c  

arch/x86/boot/cmdline.c should add these lines:
#include <stddef.h>                     // for NULL
#include "asm-generic/int-ll64.h"       // for u8
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for inline

arch/x86/boot/cmdline.c should remove these lines:

The full include-list for arch/x86/boot/cmdline.c:
#include <stddef.h>                     // for NULL
#include "asm-generic/int-ll64.h"       // for u8
#include "boot.h"                       // for rdfs8, set_fs, addr_t, __cmdl...
#include "linux/compiler_attributes.h"  // for fallthrough
#include "linux/compiler_types.h"       // for inline
---
  ./scripts/check-local-export arch/x86/boot/cmdline.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.copy.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -D__ASSEMBLY__ -DSVGA_MODE=NORMAL_VGA    -c -o arch/x86/boot/copy.o arch/x86/boot/copy.S 
  ./scripts/check-local-export arch/x86/boot/copy.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.cpu.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/cpu"' -DKBUILD_BASENAME='"cpu"' -DKBUILD_MODNAME='"cpu"' -D__KBUILD_MODNAME=kmod_cpu -c -o arch/x86/boot/cpu.o arch/x86/boot/cpu.c  

arch/x86/boot/cpu.c should add these lines:
#include "asm-generic/int-ll64.h"  // for u32
#include "asm/cpufeatures.h"       // for NCAPINTS

arch/x86/boot/cpu.c should remove these lines:

The full include-list for arch/x86/boot/cpu.c:
#include "asm-generic/int-ll64.h"  // for u32
#include "asm/cpufeatures.h"       // for NCAPINTS
#include "boot.h"                  // for printf, check_cpu, check_knl_erratum
---
  ./scripts/check-local-export arch/x86/boot/cpu.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.cpuflags.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/cpuflags"' -DKBUILD_BASENAME='"cpuflags"' -DKBUILD_MODNAME='"cpuflags"' -D__KBUILD_MODNAME=kmod_cpuflags -c -o arch/x86/boot/cpuflags.o arch/x86/boot/cpuflags.c  

arch/x86/boot/cpuflags.h should add these lines:
#include "asm-generic/int-ll64.h"  // for u32

arch/x86/boot/cpuflags.h should remove these lines:
- #include <asm/processor-flags.h>  // lines 6-6

The full include-list for arch/x86/boot/cpuflags.h:
#include <asm/cpufeatures.h>       // for NCAPINTS
#include "asm-generic/int-ll64.h"  // for u32
---

arch/x86/boot/cpuflags.c should add these lines:
#include "asm/cpufeatures.h"      // for X86_FEATURE_FPU
#include "asm/processor-flags.h"  // for X86_CR0_EM, X86_CR0_TS, X86_EFLAGS_ID
#include "linux/stddef.h"         // for true

arch/x86/boot/cpuflags.c should remove these lines:
- #include <asm/msr-index.h>  // lines 7-7
- #include <asm/processor-flags.h>  // lines 5-5
- #include <asm/required-features.h>  // lines 6-6

The full include-list for arch/x86/boot/cpuflags.c:
#include "cpuflags.h"
#include <linux/types.h>          // for bool
#include "asm/cpufeatures.h"      // for X86_FEATURE_FPU
#include "asm/processor-flags.h"  // for X86_CR0_EM, X86_CR0_TS, X86_EFLAGS_ID
#include "bitops.h"               // for set_bit
#include "linux/stddef.h"         // for true
---
  ./scripts/check-local-export arch/x86/boot/cpuflags.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.cpucheck.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/cpucheck"' -DKBUILD_BASENAME='"cpucheck"' -DKBUILD_MODNAME='"cpucheck"' -D__KBUILD_MODNAME=kmod_cpucheck -c -o arch/x86/boot/cpucheck.o arch/x86/boot/cpucheck.c  

arch/x86/boot/cpucheck.c should add these lines:
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u32
#include "asm/cpufeatures.h"       // for NCAPINTS, X86_FEATURE_CX8, X86_FEA...
#include "asm/processor-flags.h"   // for X86_EFLAGS_AC
#include "asm/shared/msr.h"        // for msr, msr::(anonymous union)::(anon...
#include "bitops.h"                // for set_bit, test_bit
#include "cpuflags.h"              // for cpu, cpu_features, cpu_vendor, get...
#include "generated/autoconf.h"    // for CONFIG_X86_MINIMUM_CPU_FAMILY
#include "linux/kconfig.h"         // for IS_ENABLED

arch/x86/boot/cpucheck.c should remove these lines:
- #include <asm/processor-flags.h>  // lines 26-26
- #include <asm/required-features.h>  // lines 27-27
- #include <linux/types.h>  // lines 24-24

The full include-list for arch/x86/boot/cpucheck.c:
#include <asm/cpufeatures.h>       // for REQUIRED_MASK0, REQUIRED_MASK1
#include <asm/intel-family.h>      // for INTEL_FAM6_XEON_PHI_KNL
#include <asm/msr-index.h>         // for MSR_K7_HWCR, MSR_VIA_FCR
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u32
#include "asm/cpufeatures.h"       // for NCAPINTS, X86_FEATURE_CX8, X86_FEA...
#include "asm/processor-flags.h"   // for X86_EFLAGS_AC
#include "asm/shared/msr.h"        // for msr, msr::(anonymous union)::(anon...
#include "bitops.h"                // for set_bit, test_bit
#include "boot.h"                  // for puts, cmdline_find_option_bool
#include "cpuflags.h"              // for cpu, cpu_features, cpu_vendor, get...
#include "generated/autoconf.h"    // for CONFIG_X86_MINIMUM_CPU_FAMILY
#include "linux/kconfig.h"         // for IS_ENABLED
#include "msr.h"                   // for boot_wrmsr, boot_rdmsr
#include "string.h"                // for memset
---
  ./scripts/check-local-export arch/x86/boot/cpucheck.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.early_serial_console.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/early_serial_console"' -DKBUILD_BASENAME='"early_serial_console"' -DKBUILD_MODNAME='"early_serial_console"' -D__KBUILD_MODNAME=kmod_early_serial_console -c -o arch/x86/boot/early_serial_console.o arch/x86/boot/early_serial_console.c  

arch/x86/boot/early_serial_console.c should add these lines:
#include "io.h"    // for outb, inb

arch/x86/boot/early_serial_console.c should remove these lines:

The full include-list for arch/x86/boot/early_serial_console.c:
#include "boot.h"  // for simple_strtoull, strncmp, cmdline_find_option, ear...
#include "io.h"    // for outb, inb
---
  ./scripts/check-local-export arch/x86/boot/early_serial_console.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.edd.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/edd"' -DKBUILD_BASENAME='"edd"' -DKBUILD_MODNAME='"edd"' -D__KBUILD_MODNAME=kmod_edd -c -o arch/x86/boot/edd.o arch/x86/boot/edd.c  

arch/x86/boot/edd.c should add these lines:

arch/x86/boot/edd.c should remove these lines:
- #include <linux/edd.h>  // lines 15-15
- #include "boot.h"  // lines 14-14
- #include "string.h"  // lines 16-16

The full include-list for arch/x86/boot/edd.c:
---
  ./scripts/check-local-export arch/x86/boot/edd.o
make -f ./scripts/Makefile.build obj=arch/x86/boot/compressed arch/x86/boot/compressed/vmlinux
  iwyu2 -E -Wp,-MMD,arch/x86/boot/compressed/.vmlinux.lds.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./=   -P -Ux86 -D__ASSEMBLY__ -DLINKER_SCRIPT -o arch/x86/boot/compressed/vmlinux.lds arch/x86/boot/compressed/vmlinux.lds.S
  iwyu2 -Wp,-MMD,arch/x86/boot/compressed/.kernel_info.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m32 -O2 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -fno-strict-aliasing -fPIE -Wundef -DDISABLE_BRANCH_PROFILING -march=i386 -mno-mmx -mno-sse -ffreestanding -fshort-wchar -fno-stack-protector -Wno-address-of-packed-member -Wno-gnu -Wno-pointer-sign -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables -D__DISABLE_EXPORTS -include ./include/linux/hidden.h -D__ASSEMBLY__    -c -o arch/x86/boot/compressed/kernel_info.o arch/x86/boot/compressed/kernel_info.S 
  ./scripts/check-local-export arch/x86/boot/compressed/kernel_info.o
  iwyu2 -Wp,-MMD,arch/x86/boot/compressed/.head_32.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m32 -O2 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -fno-strict-aliasing -fPIE -Wundef -DDISABLE_BRANCH_PROFILING -march=i386 -mno-mmx -mno-sse -ffreestanding -fshort-wchar -fno-stack-protector -Wno-address-of-packed-member -Wno-gnu -Wno-pointer-sign -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables -D__DISABLE_EXPORTS -include ./include/linux/hidden.h -D__ASSEMBLY__    -c -o arch/x86/boot/compressed/head_32.o arch/x86/boot/compressed/head_32.S 
  ./scripts/check-local-export arch/x86/boot/compressed/head_32.o
  llvm-nm vmlinux | sed -n -e 's/^\([0-9a-fA-F]*\) [ABCDGRSTVW] \(_text\|__bss_start\|_end\)$/#define VO_ _AC(0x,UL)/p' > arch/x86/boot/compressed/../voffset.h
  iwyu2 -Wp,-MMD,arch/x86/boot/compressed/.misc.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m32 -O2 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -fno-strict-aliasing -fPIE -Wundef -DDISABLE_BRANCH_PROFILING -march=i386 -mno-mmx -mno-sse -ffreestanding -fshort-wchar -fno-stack-protector -Wno-address-of-packed-member -Wno-gnu -Wno-pointer-sign -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables -D__DISABLE_EXPORTS -include ./include/linux/hidden.h    -DKBUILD_MODFILE='"arch/x86/boot/compressed/misc"' -DKBUILD_BASENAME='"misc"' -DKBUILD_MODNAME='"misc"' -D__KBUILD_MODNAME=kmod_misc -c -o arch/x86/boot/compressed/misc.o arch/x86/boot/compressed/misc.c  
In file included from arch/x86/boot/compressed/misc.c:15:
In file included from arch/x86/boot/compressed/misc.h:33:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
4 warnings generated.
In file included from arch/x86/boot/compressed/misc.c:15:
In file included from arch/x86/boot/compressed/misc.h:33:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^

arch/x86/boot/compressed/misc.h should add these lines:
#include "acpi/actypes.h"              // for acpi_physical_address
#include "asm-generic/errno-base.h"    // for ENOENT
#include "asm-generic/int-ll64.h"      // for u64
#include "asm/pgtable-2level_types.h"  // for pteval_t
#include "linux/compiler_types.h"      // for inline
#include "linux/stddef.h"              // for false
#include "linux/types.h"               // for bool
struct boot_params;

arch/x86/boot/compressed/misc.h should remove these lines:
- #include <asm/boot.h>  // lines 26-26
- #include <asm/bootparam.h>  // lines 27-27
- #include <asm/page.h>  // lines 25-25
- #include <linux/acpi.h>  // lines 33-33
- #include <linux/elf.h>  // lines 24-24
- #include <linux/linkage.h>  // lines 22-22
- #include <linux/screen_info.h>  // lines 23-23
- #include "../io.h"  // lines 37-37
- #include "tdx.h"  // lines 30-30

The full include-list for arch/x86/boot/compressed/misc.h:
#include <asm/desc_defs.h>             // for BOOT_IDT_ENTRIES, desc_ptr
#include "../ctype.h"  // lines 36-36
#include "acpi/actypes.h"              // for acpi_physical_address
#include "asm-generic/errno-base.h"    // for ENOENT
#include "asm-generic/int-ll64.h"      // for u64
#include "asm/pgtable-2level_types.h"  // for pteval_t
#include "efi.h"                       // for efi_guid_t
#include "linux/compiler_types.h"      // for inline
#include "linux/stddef.h"              // for false
#include "linux/types.h"               // for bool
struct boot_params;
---

arch/x86/boot/compressed/misc.c should add these lines:
#include <asm/page_types.h>                                       // for __P...
#include <linux/linkage.h>                                        // for asm...
#include <stdlib.h>                                               // for NULL
#include "/tmp/minimal-kernel-build/minified/arch/x86/boot/io.h"  // for outb
#include "asm/boot.h"                                             // for LOA...
#include "asm/bootparam.h"                                        // for boo...
#include "asm/vdso/processor.h"                                   // for cpu...
#include "linux/compiler_attributes.h"                            // for __s...
#include "linux/elf.h"                                            // for Elf...
#include "linux/minmax.h"                                         // for max
#include "linux/screen_info.h"                                    // for scr...
#include "tdx.h"                                                  // for ear...

arch/x86/boot/compressed/misc.c should remove these lines:
- #include "pgtable.h"  // lines 17-17

The full include-list for arch/x86/boot/compressed/misc.c:
#include "misc.h"
#include <asm/bootparam_utils.h>                                  // for san...
#include <asm/page_types.h>                                       // for __P...
#include <linux/decompress/mm.h>  // lines 33-33
#include <linux/linkage.h>                                        // for asm...
#include <stdlib.h>                                               // for NULL
#include "../../../../lib/decompress_unxz.c"                      // for __d...
#include "../string.h"                                            // for memset
#include "../voffset.h"                                           // for VO_...
#include "/tmp/minimal-kernel-build/minified/arch/x86/boot/io.h"  // for outb
#include "asm/boot.h"                                             // for LOA...
#include "asm/bootparam.h"                                        // for boo...
#include "asm/vdso/processor.h"                                   // for cpu...
#include "error.h"                                                // for error
#include "linux/compiler_attributes.h"                            // for __s...
#include "linux/elf.h"                                            // for Elf...
#include "linux/minmax.h"                                         // for max
#include "linux/screen_info.h"                                    // for scr...
#include "tdx.h"                                                  // for ear...
---
  ./scripts/check-local-export arch/x86/boot/compressed/misc.o
  iwyu2 -Wp,-MMD,arch/x86/boot/compressed/.string.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m32 -O2 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -fno-strict-aliasing -fPIE -Wundef -DDISABLE_BRANCH_PROFILING -march=i386 -mno-mmx -mno-sse -ffreestanding -fshort-wchar -fno-stack-protector -Wno-address-of-packed-member -Wno-gnu -Wno-pointer-sign -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables -D__DISABLE_EXPORTS -include ./include/linux/hidden.h    -DKBUILD_MODFILE='"arch/x86/boot/compressed/string"' -DKBUILD_BASENAME='"string"' -DKBUILD_MODNAME='"string"' -D__KBUILD_MODNAME=kmod_string -c -o arch/x86/boot/compressed/string.o arch/x86/boot/compressed/string.c  

arch/x86/boot/compressed/string.c should add these lines:
#include <stddef.h>
#include "/tmp/minimal-kernel-build/minified/arch/x86/boot/string.h"

arch/x86/boot/compressed/string.c should remove these lines:

The full include-list for arch/x86/boot/compressed/string.c:
#include <stddef.h>
#include "../string.c"
#include "/tmp/minimal-kernel-build/minified/arch/x86/boot/string.h"
#include "error.h"
---
  ./scripts/check-local-export arch/x86/boot/compressed/string.o
  iwyu2 -Wp,-MMD,arch/x86/boot/compressed/.cmdline.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m32 -O2 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -fno-strict-aliasing -fPIE -Wundef -DDISABLE_BRANCH_PROFILING -march=i386 -mno-mmx -mno-sse -ffreestanding -fshort-wchar -fno-stack-protector -Wno-address-of-packed-member -Wno-gnu -Wno-pointer-sign -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables -D__DISABLE_EXPORTS -include ./include/linux/hidden.h    -DKBUILD_MODFILE='"arch/x86/boot/compressed/cmdline"' -DKBUILD_BASENAME='"cmdline"' -DKBUILD_MODNAME='"cmdline"' -D__KBUILD_MODNAME=kmod_cmdline -c -o arch/x86/boot/compressed/cmdline.o arch/x86/boot/compressed/cmdline.c  
In file included from arch/x86/boot/compressed/cmdline.c:2:
In file included from arch/x86/boot/compressed/misc.h:33:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
4 warnings generated.
In file included from arch/x86/boot/compressed/cmdline.c:2:
In file included from arch/x86/boot/compressed/misc.h:33:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^

arch/x86/boot/compressed/cmdline.c should add these lines:
#include "asm-generic/int-ll64.h"  // for u64
#include "asm/bootparam.h"         // for boot_params, setup_header
#include "linux/compiler_types.h"  // for inline

arch/x86/boot/compressed/cmdline.c should remove these lines:

The full include-list for arch/x86/boot/compressed/cmdline.c:
#include "../cmdline.c"            // for __cmdline_find_option, __cmdline_f...
#include "asm-generic/int-ll64.h"  // for u64
#include "asm/bootparam.h"         // for boot_params, setup_header
#include "linux/compiler_types.h"  // for inline
#include "misc.h"                  // for boot_params, cmdline_find_option
---
  ./scripts/check-local-export arch/x86/boot/compressed/cmdline.o
  iwyu2 -Wp,-MMD,arch/x86/boot/compressed/.error.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m32 -O2 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -fno-strict-aliasing -fPIE -Wundef -DDISABLE_BRANCH_PROFILING -march=i386 -mno-mmx -mno-sse -ffreestanding -fshort-wchar -fno-stack-protector -Wno-address-of-packed-member -Wno-gnu -Wno-pointer-sign -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables -D__DISABLE_EXPORTS -include ./include/linux/hidden.h    -DKBUILD_MODFILE='"arch/x86/boot/compressed/error"' -DKBUILD_BASENAME='"error"' -DKBUILD_MODNAME='"error"' -D__KBUILD_MODNAME=kmod_error -c -o arch/x86/boot/compressed/error.o arch/x86/boot/compressed/error.c  
In file included from arch/x86/boot/compressed/error.c:7:
In file included from arch/x86/boot/compressed/misc.h:33:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^
4 warnings generated.
In file included from arch/x86/boot/compressed/error.c:7:
In file included from arch/x86/boot/compressed/misc.h:33:
./include/linux/acpi.h:373:54: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_irq_resource(struct acpi_resource *ares,
                                                     ^
./include/linux/acpi.h:374:19: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                              struct acpi_resource_gpio **agpio)
                                                     ^
./include/linux/acpi.h:378:53: warning: declaration of 'struct acpi_resource' will not be visible outside of this function [-Wvisibility]
static inline bool acpi_gpio_get_io_resource(struct acpi_resource *ares,
                                                    ^
./include/linux/acpi.h:379:18: warning: declaration of 'struct acpi_resource_gpio' will not be visible outside of this function [-Wvisibility]
                                             struct acpi_resource_gpio **agpio)
                                                    ^

arch/x86/boot/compressed/error.h should add these lines:
#include "linux/compiler_attributes.h"  // for __noreturn

arch/x86/boot/compressed/error.h should remove these lines:
- #include <linux/compiler.h>  // lines 5-5

The full include-list for arch/x86/boot/compressed/error.h:
#include "linux/compiler_attributes.h"  // for __noreturn
---

(arch/x86/boot/compressed/error.c has correct #includes/fwd-decls)
  ./scripts/check-local-export arch/x86/boot/compressed/error.o
  llvm-objcopy  -R .comment -S vmlinux arch/x86/boot/compressed/vmlinux.bin
  { cat arch/x86/boot/compressed/vmlinux.bin | sh ./scripts/xz_wrap.sh; printf \274\066\026\000; } > arch/x86/boot/compressed/vmlinux.bin.xz
  clang -Wp,-MMD,arch/x86/boot/compressed/.mkpiggy.d -Wall -Wmissing-prototypes -Wstrict-prototypes -O2 -fomit-frame-pointer -std=gnu11 -Wdeclaration-after-statement     -I./tools/include    -o arch/x86/boot/compressed/mkpiggy arch/x86/boot/compressed/mkpiggy.c   
  arch/x86/boot/compressed/mkpiggy arch/x86/boot/compressed/vmlinux.bin.xz > arch/x86/boot/compressed/piggy.S
  iwyu2 -Wp,-MMD,arch/x86/boot/compressed/.piggy.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m32 -O2 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -fno-strict-aliasing -fPIE -Wundef -DDISABLE_BRANCH_PROFILING -march=i386 -mno-mmx -mno-sse -ffreestanding -fshort-wchar -fno-stack-protector -Wno-address-of-packed-member -Wno-gnu -Wno-pointer-sign -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables -D__DISABLE_EXPORTS -include ./include/linux/hidden.h -D__ASSEMBLY__    -c -o arch/x86/boot/compressed/piggy.o arch/x86/boot/compressed/piggy.S 
  ./scripts/check-local-export arch/x86/boot/compressed/piggy.o
  iwyu2 -Wp,-MMD,arch/x86/boot/compressed/.cpuflags.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m32 -O2 --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -fno-strict-aliasing -fPIE -Wundef -DDISABLE_BRANCH_PROFILING -march=i386 -mno-mmx -mno-sse -ffreestanding -fshort-wchar -fno-stack-protector -Wno-address-of-packed-member -Wno-gnu -Wno-pointer-sign -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables -D__DISABLE_EXPORTS -include ./include/linux/hidden.h    -DKBUILD_MODFILE='"arch/x86/boot/compressed/cpuflags"' -DKBUILD_BASENAME='"cpuflags"' -DKBUILD_MODNAME='"cpuflags"' -D__KBUILD_MODNAME=kmod_cpuflags -c -o arch/x86/boot/compressed/cpuflags.o arch/x86/boot/compressed/cpuflags.c  

arch/x86/boot/cpuflags.c should add these lines:
#include "asm-generic/int-ll64.h"  // for u32, u16
#include "asm/cpufeatures.h"       // for X86_FEATURE_FPU
#include "asm/processor-flags.h"   // for X86_CR0_EM, X86_CR0_TS, X86_EFLAGS_ID
#include "linux/stddef.h"          // for true

arch/x86/boot/cpuflags.c should remove these lines:
- #include <asm/msr-index.h>  // lines 7-7
- #include <asm/processor-flags.h>  // lines 5-5
- #include <asm/required-features.h>  // lines 6-6

The full include-list for arch/x86/boot/cpuflags.c:
#include <linux/types.h>           // for bool
#include "asm-generic/int-ll64.h"  // for u32, u16
#include "asm/cpufeatures.h"       // for X86_FEATURE_FPU
#include "asm/processor-flags.h"   // for X86_CR0_EM, X86_CR0_TS, X86_EFLAGS_ID
#include "bitops.h"                // for set_bit
#include "cpuflags.h"              // for cpu_features, cpuid_count, get_cpu...
#include "linux/stddef.h"          // for true
---

arch/x86/boot/compressed/cpuflags.c should add these lines:
#include "/tmp/minimal-kernel-build/minified/arch/x86/boot/bitops.h"
#include "/tmp/minimal-kernel-build/minified/arch/x86/boot/cpuflags.h"
#include "linux/types.h"

arch/x86/boot/compressed/cpuflags.c should remove these lines:

The full include-list for arch/x86/boot/compressed/cpuflags.c:
#include "../cpuflags.c"
#include "/tmp/minimal-kernel-build/minified/arch/x86/boot/bitops.h"
#include "/tmp/minimal-kernel-build/minified/arch/x86/boot/cpuflags.h"
#include "linux/types.h"
---
  ./scripts/check-local-export arch/x86/boot/compressed/cpuflags.o
  ld.lld -m elf_i386  -pie  --no-dynamic-linker --orphan-handling=warn -T arch/x86/boot/compressed/vmlinux.lds arch/x86/boot/compressed/kernel_info.o arch/x86/boot/compressed/head_32.o arch/x86/boot/compressed/misc.o arch/x86/boot/compressed/string.o arch/x86/boot/compressed/cmdline.o arch/x86/boot/compressed/error.o arch/x86/boot/compressed/piggy.o arch/x86/boot/compressed/cpuflags.o -o arch/x86/boot/compressed/vmlinux
  llvm-nm arch/x86/boot/compressed/vmlinux | sed -n -e 's/^\([0-9a-fA-F]*\) [a-zA-Z] \(startup_32\|startup_64\|efi32_stub_entry\|efi64_stub_entry\|efi_pe_entry\|efi32_pe_entry\|input_data\|kernel_info\|_end\|_ehead\|_text\|z_.*\)$/#define ZO_ 0x/p' > arch/x86/boot/zoffset.h
  iwyu2 -Wp,-MMD,arch/x86/boot/.header.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -D__ASSEMBLY__ -DSVGA_MODE=NORMAL_VGA -I./arch/x86/boot    -c -o arch/x86/boot/header.o arch/x86/boot/header.S 
  ./scripts/check-local-export arch/x86/boot/header.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.main.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/main"' -DKBUILD_BASENAME='"main"' -DKBUILD_MODNAME='"main"' -D__KBUILD_MODNAME=kmod_main -c -o arch/x86/boot/main.o arch/x86/boot/main.c  

arch/x86/boot/main.c should add these lines:
#include <stddef.h>                // for NULL, size_t
#include "asm-generic/int-ll64.h"  // for u16
#include "asm/bootparam.h"         // for boot_params, setup_header, CAN_USE...
#include "asm/ist.h"               // for ist_info
#include "asm/setup.h"             // for OLD_CL_ADDRESS, OLD_CL_MAGIC
#include "cpuflags.h"              // for cpu, cpu_features
#include "io.h"                    // for init_default_io_ops, port_io_ops
#include "linux/compiler.h"        // for absolute_pointer

arch/x86/boot/main.c should remove these lines:

The full include-list for arch/x86/boot/main.c:
#include <linux/build_bug.h>       // for BUILD_BUG_ON
#include <stddef.h>                // for NULL, size_t
#include "asm-generic/int-ll64.h"  // for u16
#include "asm/bootparam.h"         // for boot_params, setup_header, CAN_USE...
#include "asm/ist.h"               // for ist_info
#include "asm/setup.h"             // for OLD_CL_ADDRESS, OLD_CL_MAGIC
#include "boot.h"                  // for biosregs, biosregs::(anonymous uni...
#include "cpuflags.h"              // for cpu, cpu_features
#include "io.h"                    // for init_default_io_ops, port_io_ops
#include "linux/compiler.h"        // for absolute_pointer
#include "string.h"                // for memcpy
---
  ./scripts/check-local-export arch/x86/boot/main.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.memory.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/memory"' -DKBUILD_BASENAME='"memory"' -DKBUILD_MODNAME='"memory"' -D__KBUILD_MODNAME=kmod_memory -c -o arch/x86/boot/memory.o arch/x86/boot/memory.c  

arch/x86/boot/memory.c should add these lines:
#include <stddef.h>               // for size_t
#include "asm/bootparam.h"        // for boot_params, boot_e820_entry
#include "asm/processor-flags.h"  // for X86_EFLAGS_CF
#include "linux/screen_info.h"    // for screen_info

arch/x86/boot/memory.c should remove these lines:

The full include-list for arch/x86/boot/memory.c:
#include <stddef.h>               // for size_t
#include "asm/bootparam.h"        // for boot_params, boot_e820_entry
#include "asm/processor-flags.h"  // for X86_EFLAGS_CF
#include "boot.h"                 // for biosregs, biosregs::(anonymous unio...
#include "linux/screen_info.h"    // for screen_info
---
  ./scripts/check-local-export arch/x86/boot/memory.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.pm.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/pm"' -DKBUILD_BASENAME='"pm"' -DKBUILD_MODNAME='"pm"' -D__KBUILD_MODNAME=kmod_pm -c -o arch/x86/boot/pm.o arch/x86/boot/pm.c  

arch/x86/boot/pm.c should add these lines:
#include "asm-generic/int-ll64.h"  // for u32, u16, u64
#include "asm/bootparam.h"         // for boot_params, setup_header
#include "io.h"                    // for outb

arch/x86/boot/pm.c should remove these lines:

The full include-list for arch/x86/boot/pm.c:
#include <asm/segment.h>           // for GDT_ENTRY, GDT_ENTRY_BOOT_CS, GDT_...
#include "asm-generic/int-ll64.h"  // for u32, u16, u64
#include "asm/bootparam.h"         // for boot_params, setup_header
#include "boot.h"                  // for io_delay, ds, boot_params, die
#include "io.h"                    // for outb
---
  ./scripts/check-local-export arch/x86/boot/pm.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.pmjump.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -D__ASSEMBLY__ -DSVGA_MODE=NORMAL_VGA    -c -o arch/x86/boot/pmjump.o arch/x86/boot/pmjump.S 
  ./scripts/check-local-export arch/x86/boot/pmjump.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.printf.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/printf"' -DKBUILD_BASENAME='"printf"' -DKBUILD_MODNAME='"printf"' -D__KBUILD_MODNAME=kmod_printf -c -o arch/x86/boot/printf.o arch/x86/boot/printf.c  

arch/x86/boot/printf.c should add these lines:
#include <cstdio>          // for va_list, NULL
#include "ctype.h"         // for isdigit
#include "linux/stdarg.h"  // for va_arg, va_end, va_start

arch/x86/boot/printf.c should remove these lines:

The full include-list for arch/x86/boot/printf.c:
#include <cstdio>          // for va_list, NULL
#include "boot.h"          // for puts, strnlen, printf, sprintf, vsprintf
#include "ctype.h"         // for isdigit
#include "linux/stdarg.h"  // for va_arg, va_end, va_start
---
  ./scripts/check-local-export arch/x86/boot/printf.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.regs.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/regs"' -DKBUILD_BASENAME='"regs"' -DKBUILD_MODNAME='"regs"' -D__KBUILD_MODNAME=kmod_regs -c -o arch/x86/boot/regs.o arch/x86/boot/regs.c  

arch/x86/boot/regs.c should add these lines:
#include "asm/processor-flags.h"  // for X86_EFLAGS_CF

arch/x86/boot/regs.c should remove these lines:

The full include-list for arch/x86/boot/regs.c:
#include "asm/processor-flags.h"  // for X86_EFLAGS_CF
#include "boot.h"                 // for biosregs, ds, biosregs::(anonymous ...
#include "string.h"               // for memset
---
  ./scripts/check-local-export arch/x86/boot/regs.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.string.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/string"' -DKBUILD_BASENAME='"string"' -DKBUILD_MODNAME='"string"' -D__KBUILD_MODNAME=kmod_string -c -o arch/x86/boot/string.o arch/x86/boot/string.c  

arch/x86/boot/string.h should add these lines:
#include <stddef.h>  // for size_t

arch/x86/boot/string.h should remove these lines:

The full include-list for arch/x86/boot/string.h:
#include <stddef.h>  // for size_t
---

arch/x86/boot/string.c should add these lines:
#include "asm-generic/errno-base.h"  // for EINVAL, ERANGE
#include "asm-generic/int-ll64.h"    // for u32, u64
#include "linux/compiler_types.h"    // for inline
#include "vdso/limits.h"             // for ULLONG_MAX

arch/x86/boot/string.c should remove these lines:
- #include <linux/errno.h>  // lines 15-15
- #include <linux/limits.h>  // lines 16-16

The full include-list for arch/x86/boot/string.c:
#include "string.h"
#include <asm/asm.h>                 // for CC_OUT, CC_SET
#include <linux/compiler.h>          // for unlikely
#include <linux/types.h>             // for bool
#include "asm-generic/errno-base.h"  // for EINVAL, ERANGE
#include "asm-generic/int-ll64.h"    // for u32, u64
#include "ctype.h"                   // for isxdigit, isdigit
#include "linux/compiler_types.h"    // for inline
#include "vdso/limits.h"             // for ULLONG_MAX
---
  ./scripts/check-local-export arch/x86/boot/string.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.tty.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/tty"' -DKBUILD_BASENAME='"tty"' -DKBUILD_MODNAME='"tty"' -D__KBUILD_MODNAME=kmod_tty -c -o arch/x86/boot/tty.o arch/x86/boot/tty.c  

arch/x86/boot/tty.c should add these lines:
#include <stddef.h>                     // for NULL
#include "asm-generic/int-ll64.h"       // for u8
#include "asm/processor-flags.h"        // for X86_EFLAGS_ZF
#include "io.h"                         // for inb, outb
#include "linux/compiler_attributes.h"  // for __section

arch/x86/boot/tty.c should remove these lines:

The full include-list for arch/x86/boot/tty.c:
#include <stddef.h>                     // for NULL
#include "asm-generic/int-ll64.h"       // for u8
#include "asm/processor-flags.h"        // for X86_EFLAGS_ZF
#include "boot.h"                       // for biosregs, initregs, intcall
#include "io.h"                         // for inb, outb
#include "linux/compiler_attributes.h"  // for __section
---
  ./scripts/check-local-export arch/x86/boot/tty.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.video.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/video"' -DKBUILD_BASENAME='"video"' -DKBUILD_MODNAME='"video"' -D__KBUILD_MODNAME=kmod_video -c -o arch/x86/boot/video.o arch/x86/boot/video.c  

arch/x86/boot/video.h should add these lines:
#include "asm-generic/int-ll64.h"       // for u16, u8
#include "io.h"                         // for inb, outb, outw
#include "linux/compiler_attributes.h"  // for __section
#include "linux/compiler_types.h"       // for inline

arch/x86/boot/video.h should remove these lines:
- #include <linux/types.h>  // lines 16-16

The full include-list for arch/x86/boot/video.h:
#include "asm-generic/int-ll64.h"       // for u16, u8
#include "io.h"                         // for inb, outb, outw
#include "linux/compiler_attributes.h"  // for __section
#include "linux/compiler_types.h"       // for inline
---

arch/x86/boot/video.c should add these lines:
#include <stddef.h>             // for NULL
#include "asm/bootparam.h"      // for boot_params, setup_header
#include "linux/screen_info.h"  // for screen_info, VIDEO_FLAGS_NOCURSOR

arch/x86/boot/video.c should remove these lines:
- #include "vesa.h"  // lines 18-18

The full include-list for arch/x86/boot/video.c:
#include "video.h"
#include <stddef.h>             // for NULL
#include <uapi/asm/boot.h>      // for ASK_VGA
#include "asm/bootparam.h"      // for boot_params, setup_header
#include "boot.h"               // for boot_params, putchar, biosregs, biosr...
#include "linux/screen_info.h"  // for screen_info, VIDEO_FLAGS_NOCURSOR
---
  ./scripts/check-local-export arch/x86/boot/video.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.video-mode.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/video-mode"' -DKBUILD_BASENAME='"video_mode"' -DKBUILD_MODNAME='"video_mode"' -D__KBUILD_MODNAME=kmod_video_mode -c -o arch/x86/boot/video-mode.o arch/x86/boot/video-mode.c  

arch/x86/boot/video-mode.c should add these lines:
#include "asm-generic/int-ll64.h"  // for u16, u8
#include "asm/bootparam.h"         // for boot_params, setup_header

arch/x86/boot/video-mode.c should remove these lines:
- #include "vesa.h"  // lines 18-18

The full include-list for arch/x86/boot/video-mode.c:
#include <uapi/asm/boot.h>         // for EXTENDED_VGA, NORMAL_VGA
#include "asm-generic/int-ll64.h"  // for u16, u8
#include "asm/bootparam.h"         // for boot_params, setup_header
#include "boot.h"                  // for rdfs8, set_fs, boot_params, mode_d...
#include "video.h"                 // for card_info, mode_info, out_idx, in_idx
---
  ./scripts/check-local-export arch/x86/boot/video-mode.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.version.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/version"' -DKBUILD_BASENAME='"version"' -DKBUILD_MODNAME='"version"' -D__KBUILD_MODNAME=kmod_version -c -o arch/x86/boot/version.o arch/x86/boot/version.c  

arch/x86/boot/version.c should add these lines:

arch/x86/boot/version.c should remove these lines:
- #include "boot.h"  // lines 13-13

The full include-list for arch/x86/boot/version.c:
#include <generated/compile.h>     // for LINUX_COMPILE_BY, LINUX_COMPILE_HOST
#include <generated/utsrelease.h>  // for UTS_RELEASE
---
  ./scripts/check-local-export arch/x86/boot/version.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.video-vga.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/video-vga"' -DKBUILD_BASENAME='"video_vga"' -DKBUILD_MODNAME='"video_vga"' -D__KBUILD_MODNAME=kmod_video_vga -c -o arch/x86/boot/video-vga.o arch/x86/boot/video-vga.c  

arch/x86/boot/video-vga.c should add these lines:
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u8, u16
#include "asm/bootparam.h"         // for boot_params
#include "io.h"                    // for inb, outb
#include "linux/screen_info.h"     // for screen_info

arch/x86/boot/video-vga.c should remove these lines:

The full include-list for arch/x86/boot/video-vga.c:
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u8, u16
#include "asm/bootparam.h"         // for boot_params
#include "boot.h"                  // for intcall, biosregs, biosregs::(anon...
#include "io.h"                    // for inb, outb
#include "linux/screen_info.h"     // for screen_info
#include "video.h"                 // for out_idx, mode_info, adapter, VIDEO...
---
  ./scripts/check-local-export arch/x86/boot/video-vga.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.video-vesa.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/video-vesa"' -DKBUILD_BASENAME='"video_vesa"' -DKBUILD_MODNAME='"video_vesa"' -D__KBUILD_MODNAME=kmod_video_vesa -c -o arch/x86/boot/video-vesa.o arch/x86/boot/video-vesa.c  

arch/x86/boot/video-vesa.c should add these lines:
#include <stddef.h>                // for size_t
#include "asm-generic/int-ll64.h"  // for u16, u8
#include "asm/bootparam.h"         // for boot_params
#include "linux/screen_info.h"     // for screen_info, VIDEO_TYPE_VLFB

arch/x86/boot/video-vesa.c should remove these lines:

The full include-list for arch/x86/boot/video-vesa.c:
#include <stddef.h>                // for size_t
#include "asm-generic/int-ll64.h"  // for u16, u8
#include "asm/bootparam.h"         // for boot_params
#include "boot.h"                  // for biosregs, biosregs::(anonymous uni...
#include "linux/screen_info.h"     // for screen_info, VIDEO_TYPE_VLFB
#include "string.h"                // for memset, memcpy
#include "vesa.h"                  // for vesa_mode_info, vesa_general_info
#include "video.h"                 // for mode_info, VIDEO_FIRST_VESA, __vid...
---
  ./scripts/check-local-export arch/x86/boot/video-vesa.o
  iwyu2 -Wp,-MMD,arch/x86/boot/.video-bios.o.d -nostdinc -I./arch/x86/include -I./arch/x86/include/generated  -I./include -I./arch/x86/include/uapi -I./arch/x86/include/generated/uapi -I./include/uapi -I./include/generated/uapi -include ./include/linux/compiler-version.h -include ./include/linux/kconfig.h -include ./include/linux/compiler_types.h -D__KERNEL__ -Qunused-arguments -fmacro-prefix-map=./= -m16 -g -Os -DDISABLE_BRANCH_PROFILING -D__DISABLE_EXPORTS -Wall -Wstrict-prototypes -march=i386 -mregparm=3 -fno-strict-aliasing -fomit-frame-pointer -fno-pic -mno-mmx -mno-sse -fcf-protection=none -ffreestanding -fno-stack-protector -Wno-address-of-packed-member --target=x86_64-linux-gnu -fintegrated-as -Werror=unknown-warning-option -Werror=ignored-optimization-argument -D_SETUP -fmacro-prefix-map=./= -fno-asynchronous-unwind-tables    -DKBUILD_MODFILE='"arch/x86/boot/video-bios"' -DKBUILD_BASENAME='"video_bios"' -DKBUILD_MODNAME='"video_bios"' -D__KBUILD_MODNAME=kmod_video_bios -c -o arch/x86/boot/video-bios.o arch/x86/boot/video-bios.c  

arch/x86/boot/video-bios.c should add these lines:
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u8, u16
#include "asm/bootparam.h"         // for boot_params
#include "linux/screen_info.h"     // for screen_info

arch/x86/boot/video-bios.c should remove these lines:

The full include-list for arch/x86/boot/video-bios.c:
#include <stddef.h>                // for NULL
#include "asm-generic/int-ll64.h"  // for u8, u16
#include "asm/bootparam.h"         // for boot_params
#include "boot.h"                  // for intcall, biosregs, biosregs::(anon...
#include "linux/screen_info.h"     // for screen_info
#include "video.h"                 // for mode_info, in_idx, VIDEO_FIRST_BIOS
---
  ./scripts/check-local-export arch/x86/boot/video-bios.o
  ld.lld -m elf_i386 -mllvm -import-instr-limit=5  -m elf_i386 -T arch/x86/boot/setup.ld arch/x86/boot/a20.o arch/x86/boot/bioscall.o arch/x86/boot/cmdline.o arch/x86/boot/copy.o arch/x86/boot/cpu.o arch/x86/boot/cpuflags.o arch/x86/boot/cpucheck.o arch/x86/boot/early_serial_console.o arch/x86/boot/edd.o arch/x86/boot/header.o arch/x86/boot/main.o arch/x86/boot/memory.o arch/x86/boot/pm.o arch/x86/boot/pmjump.o arch/x86/boot/printf.o arch/x86/boot/regs.o arch/x86/boot/string.o arch/x86/boot/tty.o arch/x86/boot/video.o arch/x86/boot/video-mode.o arch/x86/boot/version.o arch/x86/boot/video-vga.o arch/x86/boot/video-vesa.o arch/x86/boot/video-bios.o -o arch/x86/boot/setup.elf
  llvm-objcopy  -O binary arch/x86/boot/setup.elf arch/x86/boot/setup.bin
  llvm-objcopy  -O binary -R .note -R .comment -S arch/x86/boot/compressed/vmlinux arch/x86/boot/vmlinux.bin
  clang -Wp,-MMD,arch/x86/boot/tools/.build.d -Wall -Wmissing-prototypes -Wstrict-prototypes -O2 -fomit-frame-pointer -std=gnu11 -Wdeclaration-after-statement     -I./tools/include -include include/generated/autoconf.h -D__EXPORTED_HEADERS__    -o arch/x86/boot/tools/build arch/x86/boot/tools/build.c   
  arch/x86/boot/tools/build arch/x86/boot/setup.bin arch/x86/boot/vmlinux.bin arch/x86/boot/zoffset.h arch/x86/boot/bzImage 
mkdir -p ./arch/i386/boot
ln -fsn ../../x86/boot/bzImage ./arch/i386/boot/bzImage
